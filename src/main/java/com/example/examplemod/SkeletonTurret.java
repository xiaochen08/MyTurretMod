package com.example.examplemod;


// 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰鍐€妞ゆ劦婢€缁墎绱?闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箻閺屸剝寰勭€ｎ亝顔呭┑鐐叉▕娴滃爼寮崶顒佺厪闊洦娲栧暩闂佸憡绻冮〃濠傤潖缂佹鐟归柛銉戝喚娼婚梻浣告啞椤ㄥ棗煤濡警鍤楅柛鏇ㄥ灠缁犳稒銇勯幒鍡椾壕缂備焦鍔栭惄顖氼潖濞差亜浼犻柛鏇炵仛鏁堥梻浣规偠閸斿矂濡堕幖浣哄祦婵°倕鎳庨崡鎶芥煏韫囧﹥顎嗛柟閿嬫そ濮婂宕掑鍗烆杸婵炴挻纰嶉〃鍛祫闂佸壊鍋呭ú姗€鎮￠弴銏犵缂侇喛顫夐～濠囨煕閵堝洤鏋涢柡灞界Х椤т線鏌涢幘瀛樼殤闁哥姴锕ら鍏煎緞鐎ｎ亙鐢婚梻浣瑰濮婂宕戦幘宕囨殾闁告瑥顦辩粻楣冩煙鐎涙鎳冮柣蹇ｄ邯閺岋繝宕ㄩ鎯у绩闂佸搫鏈惄顖炪€侀弴銏╂晝妞ゎ偒鍘鹃惄搴㈢節閻㈤潧浠滈柣妤佺矒瀹曘垽鎮剧仦鎯у簥濠电娀娼уΛ宀勫几閺冨牊鐓曟い顓熷灥閺嬬喖鏌ｈ箛鏃€宕屾慨濠呮缁瑥鈻庨幆褍澹嬮梻浣侯焾椤戝棝鎯勯鐐茬伋闁挎洖鍊搁悙濠囨煃閸濆嫬鈧悂鎮甸弶搴撴斀闁绘劕鐡ㄧ紞鎴炪亜閹存繃顥㈤柟顔筋殕缁绘繂顫濋鐘插箥闂備胶鍘у﹢杈ㄦ櫠濡ゅ嫨浜圭憸蹇曟閹烘鐭楀璺猴工婵垽鏌涘Δ鍛喚闁哄苯绉烽¨渚€鏌涢幘璺烘瀻妞ゎ偄绻橀幖鍦喆閸曨偆褰撮梻浣告啞閻熴儵藝閺夎法鏆﹂柟鎯板Г閳锋垿寮堕悙鏉戭棆闁告柨绉归弻鐔碱敊閻撳簶鍋撻幖浣瑰仼闁绘垼妫勯～鍛存煥濠靛棗顒㈤棄瀣⒒?
import net.minecraft.ChatFormatting;
import java.util.Map;
import java.util.HashMap;
import net.minecraft.world.entity.ExperienceOrb;
import net.minecraft.world.entity.item.ItemEntity;
import net.minecraft.world.item.Item;
import net.minecraft.world.entity.projectile.FireworkRocketEntity;
import net.minecraft.nbt.ListTag;
import net.minecraft.core.BlockPos;
import net.minecraft.core.particles.ItemParticleOption;
import net.minecraft.core.particles.ParticleTypes;
import net.minecraft.nbt.CompoundTag;
import net.minecraft.network.chat.Component;
import net.minecraft.network.syncher.EntityDataAccessor;
import net.minecraft.network.syncher.EntityDataSerializers;
import net.minecraft.network.syncher.SynchedEntityData;
import net.minecraft.server.level.ServerLevel;
import net.minecraft.server.level.ServerPlayer;
import net.minecraft.sounds.SoundEvents;
import net.minecraft.world.DifficultyInstance;
import net.minecraft.world.InteractionHand;
import net.minecraft.world.InteractionResult;
import net.minecraft.world.SimpleContainer;
import net.minecraft.world.SimpleMenuProvider;
import net.minecraft.world.damagesource.DamageSource;
import net.minecraft.world.effect.MobEffectInstance;
import net.minecraft.world.effect.MobEffects;
import net.minecraft.world.entity.*;
import net.minecraft.world.entity.ai.attributes.AttributeSupplier;
import net.minecraft.world.entity.ai.attributes.Attributes;
import net.minecraft.world.entity.ai.goal.Goal;
import net.minecraft.world.entity.ai.goal.LookAtPlayerGoal;
import net.minecraft.world.entity.ai.goal.target.HurtByTargetGoal;
import net.minecraft.world.entity.ai.goal.target.NearestAttackableTargetGoal;
import net.minecraft.world.entity.animal.IronGolem;
import net.minecraft.world.entity.monster.Monster;
import net.minecraft.world.entity.monster.Enemy;
import net.minecraft.world.entity.monster.Skeleton;
import net.minecraft.world.entity.player.Player;
import net.minecraft.world.entity.projectile.AbstractArrow;
import net.minecraft.world.entity.projectile.ProjectileUtil;
import net.minecraft.world.food.FoodProperties;
import net.minecraft.world.item.ItemStack;
import net.minecraft.world.item.Items;
import net.minecraft.world.item.PickaxeItem;
import net.minecraft.world.item.AxeItem;
import net.minecraft.world.item.HoeItem;
import net.minecraft.world.item.ShovelItem;
import net.minecraft.world.item.FishingRodItem;
import net.minecraft.world.item.enchantment.EnchantmentHelper;
import net.minecraft.world.level.Level;
import net.minecraft.world.level.ServerLevelAccessor;
import net.minecraft.world.level.block.state.BlockState;
import net.minecraftforge.network.NetworkHooks;



import javax.annotation.Nullable;
import java.util.*;



import net.minecraft.world.ContainerListener;
import net.minecraft.world.Container;

public class SkeletonTurret extends net.minecraft.world.entity.monster.Skeleton {



    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱樈閸犳顕欏ú顏呪拺缂侇垱娲栨晶鍙夈亜閵娿儲鍣界紒顔碱煼瀹曨偊宕熼崹顐㈢槣闂備線娼ч悧鍡涘箠濮椻偓閹澘顭ㄩ崨顖滐紲缂傚倷鐒﹂…鍥╃不閻愮鍋撳▓鍨灈妞ゎ參鏀辨穱濠囧醇閺囩偟鍊為梺鎸庣箓閹冲秵绔熼弴銏♀拺闂傚牃鏅涢惁婊堟煕濡厧甯堕柣鈽嗗弮閺岋綁鎮欑€靛壊鏆￠梺鐓庣秺缁犳牠鍨鹃弮鍫濈妞ゆ柨妲堣閺屾盯鍩勯崘鐐暭闂佽崵鍠愰悡鈥愁潖濞差亝鍊婚柍鍝勫€归悵锕傛⒑閹肩偛濡奸柣鏍с偢楠炲啯瀵奸幖顓熸櫔闂侀€炲苯澧撮柣娑卞枤閳ь剨缍嗛崰妤呭疾濠婂牊鐓㈡俊顖欒濡查绱掗妸銉吋闁哄矉绲鹃幆鏃堟晲閸℃鐣梺璇插閸戝綊宕㈤悾宀€鍗氶柣鏃傚帶楠炪垺绻涢崱妯虹仼闁绘挸顑呴—鍐Χ閸℃锛曢梺绋款儐閹稿骞?
    // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箻閺岀喖骞嗛弶鍟冩捇鏌涙繝鍌涘仴闁哄被鍔戝鏉懳旈埀顒佺閹屾富闁靛牆楠搁獮鏍煟韫囨梻绠氶柣蹇斿浮濮婃椽宕楅懖鈹垮仦闂佸搫鎳忕换鍫ｆ濡炪倖鐗滈崑鐐哄磹閸偒娈介柣鎰皺娴犮垽鏌涢弮鈧喊宥嗙┍婵犲浂鏁冮柨婵嗘处閸掓盯姊虹化鏇熸澓闁搞劏妫勯锝夘敆娴ｇ懓鍔呴梺瑙勫劤閻°劑寮堕幖浣光拻濞达綀娅ｇ敮娑欍亜椤撶偟澧㈤柛鎺撳笚閵堬綁宕橀妸褜妲梺璇茬箳閸嬫﹢宕熷Ο鑽ゎ洸婵犲﹤鐗忛崣鎾绘煕閵夛絽濡奸柛婵囨そ閺屾稑鈹戞繝鍐句哗缂備浇椴哥敮鐐垫閹烘嚦鐔煎礂閻撳骸鐏￠梺璇叉唉椤煤濠靛牆鍨濋柛鎾楀懍绗夊┑鐐村灟閸ㄥ湱绮绘繝姘厸闁稿本锚閸旀粓鎮楀鍗炴瀾缂佺粯绻堥幃浠嬫濞磋埖鐩弻鐔风暋閺夋寧娈婚悗瑙勬礃閿曘垽銆侀幘娲绘晬闁糕剝顨嗛崳鎶芥煕鐎ｎ偅灏甸柟鍙夋尦瀹曠喖顢楅崒銈喰ら梻鍌欒兌椤牏鎹㈤幋锝嗘噷濠电儑绲藉ú銈夋晝閵堝缍栭柕蹇曞Х閺嗗棗鈹戦悩鎻掓暘妞ゅ繐鐗婇埛鎺懨归敐澶樻濞戞捁灏欑槐鎾愁吋閸曨厼濡界紓浣稿€哥粔鐟扮暦婵傜鍗抽柣鎰煐閹茬増绻濋悽闈涗沪闁割煈鍨跺畷纭呫亹閹烘垹顦ㄩ梺閫炲苯澧撮柟顔煎槻椤劑宕橀鐓庡強婵°倗濮烽崑娑樜涘┑鍡欐殾濠靛倸鎲￠崑鍕煣韫囨凹鍤冮柛鐔烽叄濮婅櫣鎷犻懠顒傤唶缂備胶绮崹鍧楀箖瑜斿鎾偄閸涘﹦褰块梻浣告惈鐞氼偊宕曢弻銉﹀亗婵炲棙鍨熼崑鎾绘偡閺夋浼€婵犫拃鍕垫疁鐎规洖纾幉鎾礋閳衡偓缁ㄥ姊洪悷鏉库挃闁稿鍔戝畷鎴﹀閳垛晛浜鹃悷娆忓缁€鈧梺缁樼墪閵堢鐣峰ú顏呮櫢闁绘灏欓敍婊冣攽閻樻瑥瀚崝銈吤?
    // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箻閺屸剝寰勭€ｎ亝顔呴悷婊呭鐢帞澹曟總鍛婄厽闁归偊鍨伴惃娲煟閹炬潙鐏存慨濠冩そ瀹曘劍绻濋崒姣挎洟姊洪崫銉バｆい銊ワ工閻ｇ兘骞嬮敃鈧壕濂告煟閹邦剦鍤熼柛妯哄船椤啴濡堕崱妤€衼缂備焦褰冩晶鐣屽垝閸儱鐒垫い鎺戝€荤壕钘壝归敐鍡楃祷濞存粓绠栧娲川婵犲倸袝婵炲瓨绮嶉悧鐘茬暦閹达箑绠荤紓浣姑禒顓㈡⒑閸濆嫷妲规い鎴炵懄缁傛帡骞嗚閺€浠嬫煟濮楀棗鏋涢柣蹇ｄ簼閵囧嫰顢橀悙鏉戠獩闂佸憡甯楃敮妤冩崲濠靛鐐婇柕濞у啫笑闂佽楠哥粻宥夊磿閸楃倣娑樜旀担渚祫濡炪倖鐗楃粙鎾剁不妤ｅ啫绾ч柛顐ｇ箓閳锋梻绱掓径妯哄闁靛洤瀚伴、鏇㈠閳哄倐銊モ攽閻愬弶顥撻柛銊ょ矙楠炲﹪鎮╁ú缁樻櫌闂佺鏈划锝囨?
    private net.minecraft.world.level.ChunkPos keptChunkPos;
    private double spawnX, spawnY, spawnZ;
    private double guardLockX, guardLockY, guardLockZ;
    private boolean guardLockValid = false;
    private int guardLastHardSnapTick = -200;
    private static final double GUARD_REANCHOR_DISTANCE_SQR = 0.25D; // 0.5m
    private static final double GUARD_HARD_SNAP_DISTANCE_SQR = 9.0D; // 3m
    private static final int GUARD_HARD_SNAP_COOLDOWN_TICKS = 10;
    private static final boolean GUARD_STUTTER_DEBUG = true;
    private int debugLastGuardHurtTime = -1;
    private int debugLastGuardDamageCooldown = -1;
    private int debugLastGuardInvuln = -1;
    private int debugLastVanillaInvuln = -1;
    private int debugGuardPrevHurtTime = -1;
    private int debugGuardHurtStuckTicks = 0;
    private int guardLastAcceptedHurtTick = -200;
    private static final java.util.UUID FOLLOW_SPEED_BOOST_UUID = java.util.UUID.fromString("8e9a8a4c-30d2-4f45-b3f7-5b2f6e8a1c3d");
    private static final double FOLLOW_SPEED_BOOST_MULTIPLIER = 0.40D; // +40%
    private static final float GUARD_DAMAGE_TAKEN_MULTIPLIER = 0.40F; // -60% damage taken
    private boolean terminalTeleportOverride = false;
    private boolean forceTerminalRecall = false;
    private long lastHeatStackTime = 0;
    private int consecutiveMisses = 0;   // 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫鍐煥閺囨浜鹃梺姹囧€楅崑鎾舵崲濠靛顥堟繛鎴濆船閸撴壆绱掗悙顒€鍔ゆい顓犲厴瀵鏁愭径濠冾棟闂佸壊鐓堥崰妤呭磹椤栫偞鈷戠紒瀣儥閸庡秹鏌涢弬璺ㄧ劯闁糕晝鍋ら獮瀣晜閽樺姹楅梺璇查濠€杈ㄦ叏閹绢啟澶娾攽鐎ｎ偆鍘介柟鍏肩暘閸ㄥ吋绔熷Ο姹囦簻闁挎柨鐏濆畵鍡椻攽閿涘嫭鏆€规洜鍠栭、娆撳礈瑜庡鎴︽⒒娴ｇ瓔娼愮€规洘锚閳绘柨鈽夐～顑藉亾閸岀偞鍋ㄩ柛娑樑堥幏铏圭磽娴ｅ壊鍎愭い鎴炵懇瀹曟洟骞囬悧鍫㈠幍闂佽崵鍠撴晶妤呭窗濡椿娈介柣鎰絻閺嗭綁鏌涢埡瀣瘈鐎规洏鍔戦、姗€鎮埀顒€危娴煎瓨鈷掑ù锝堟娴滃綊鏌嶅畡鎵ⅵ鐎规洘顨呴埥澶娢熻箛鏇熷殌闁伙綇绻濋獮宥夋惞椤愶絾婢戦梻鍌欒兌缁垶宕濋弴鐐嶇喐绻濋崶褍鎯為梺缁樻⒐閹埖绂嶅鍫熺厵閻庣數顭堟禒锔剧磼閳ь剛鈧綆鍏橀崑鎾舵喆閸曨剛顦ㄩ梺鍛婃⒐閻熴儵顢氶敐澶婄妞ゆ梻鈷堝濠囨⒑閸愬弶鎯堥柛濠勬嚀閳诲秹骞橀弬銉︽杸闂佺粯锚閻忔岸寮抽埡浣叉斀妞ゆ棁濮ょ紞鎴︽偂閵堝鐓ラ柡鍥╁仜閳ь剙鎽滄竟鏇犳崉閵娿垹浜炬鐐茬仢閸旀碍銇勯敂鍨祮闁诡噯绻濆鎾閿涘嫬骞愰梻浣规偠閸庮垶宕曟潏銊ょ箚闁绘挸瀵掗悢鍡欐喐瀹ュ鈧箓鎮滈挊澶庢憰濠电偞鍨堕崺鍐磻閹剧粯鏅查柛鈩冾焽閸欏棗鈹戦悙棰濆殝缂佺姵鎹囬獮?
    private int blockedSightTime = 0;    // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煟閵忋埄鐒剧紒鎰殜閺岀喖骞嶉纰辨毉闂佺顑戠换婵嬪蓟閺囩喎绶為柛顐ｇ箓婢规柨鈹戦悙鏉戠仸閼裤倖淇婇幓鎺斿ⅵ闁哄本娲濈粻娑㈠即閻愭劑鍨介弻鐔碱敍濠婂啩妲愰梺鍝勭灱閸犳牠骞婂┑瀣亱闁割偅绻冮柨顓犵磽閸屾瑧鍔嶉柣鎿勭磿缁寮借閺嗭箓鏌熸潏鍓х暠闁告劏鍋撻梻渚€娼ч…顓犲緤閼测晞濮冲┑鐘崇閳锋垿鎮峰▎蹇擃仾缂佽埖褰冮…鑳槻婵炴潙鍢插嵄闁圭増婢樼粻銉︺亜閺傚灝鈷旈柨娑欑矒閺屸剝寰勬繝鍕暥闂佸憡鏌ㄧ粔鍓佸垝閸懇鍋撻敐搴℃灍闁绘挻绋撻埀顒€鍘滈崑鎾绘煃瑜滈崜鐔风暦娴兼潙鍐€妞ゎ剦鍓氶惄顖氱暦濮椻偓椤㈡瑩鎳栭埡浣哥闂傚倷绀侀幉锟犲礉閿旂晫顩插瀣椤洟鏌涢…鎴濅簽缂佲檧鍋撻梻浣圭湽閸ㄨ棄顭囪缁傛帒顭ㄩ崼鐔哄幗濠德板€愰崑鎾绘煥閺囥劋绨婚柣锝囨焿閵囨劙骞掗幋婵堚偓顓烆渻閵堝棙绀€闁瑰啿楠搁埢鎾诲Ω閵夘喗瀵岄梺闈涚墕濡瑧澹曢悽鍛婄厱閻庯綆鍋呯亸鐢告煃瑜滈崜婵嬶綖婢跺⊕娲冀椤撶倣褏绱掔€ｎ偒鍎ラ柛銈嗘礋閺岀喓绱掗姀鐘崇亶闂佺顑呭Λ婵嬪蓟濞戞矮娌柛鎾楀懐鍘愰梻?(tick)
    private long lastDamageTimestamp = 0; // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓闁搞劌鍊块弻娑㈩敃閿濆棛顦ョ紓浣哄С閸楁娊寮婚悢鍏尖拻閻庣數顭堟俊浠嬫⒑閸濆嫭鍣虹紒璇茬墦瀵寮撮悢椋庣獮闂佺硶鍓濊摫闁绘繐绠撳鐑樻姜閹殿噮妲梺鍝ュ櫏閸嬪﹪宕洪悙鍝勭闁挎洍鍋撶痪鎯у悑閹便劌顫滈崱妤€绠归梺鍝勬閻楁挸顫忛搹鍦＜婵☆垵娅ｉ悷銊ヮ渻閵堝骸骞橀柛蹇斆锝嗙節濮橆厽娅滈梺鍛婄☉閸婂宕伴弽褏鏆︽い鎰剁畱缁€瀣亜閹哄秷鍏屾俊宸邯濮婂宕掑▎鎰偘濡炪倖娉﹂崨顔煎簥闂佸綊鍋婇崕顏劽洪鍕幯冾熆鐠轰警鍎戦柣锝呯－缁辨捇宕掑顑藉亾閻戣姤鍊块柨鏇炲€堕埀顒€鍟村畷銊╁级閹寸媭鍟囨俊鐐€栭崝褏绮婚幋锔藉€块柛顭戝亖娴滄粓鏌熼崫鍕ら柛鏂跨Ф缁辨帡鍩€椤掑倵鍋撻敐搴′簴濞存粍绮撻弻鏇＄疀閵壯咃紵闂佺懓鍟跨€氼喚妲愰幒鏃傜＜婵☆垵鍋愰悿鍕倵鐟欏嫭绀€闁绘牕鍚嬫穱濠囧箹娴ｈ倽銊╂煏婢跺牆鍔存俊顐㈠濮婂宕掑顑藉亾妞嬪海鐭嗗〒姘ｅ亾妤犵偛顦甸崹鍓ф惥娴ｈ銇濋柡浣稿暣瀹曟帒顫濇鏍ㄐゅ┑鐘愁問閸犳鈥﹂崶顒夋晜妞ゆ帒瀚悙濠冦亜韫囨挾校闁宠鏈换婵嗏枔閸喗鐏堥梺鎸庢磸閸婃繈鍨鹃敃鈧悾锟犲箥椤旇姤顔曢梻浣告贡閸庛倝宕洪崼婵愮劷闁冲搫鎳庣痪褔鏌涢锝団槈濠碘€茬矙閺屾盯鎮╁畷鍥р拰濠?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弴妤€浜惧銈庝簻閸熸潙鐣疯ぐ鎺濇晪闁告侗鍨版慨娲⒒娴ｄ警娼掗柛鏇炵仛閻ｅ墎绱撴担鎻掍壕婵犮垼鍩栭崝鏍磹閻㈠憡鐓ユ繝闈涙椤庢顭胯瑜板啴鍩為幋锔绘晩闁圭娴疯ぐ褔姊洪棃娑欐悙閻庢矮鍗抽悰顕€骞掗幋顓炴倯闂佹悶鍎滈崘鍓р偓瀵哥磽閸屾艾鈧悂宕愰崫銉х煋闁哄鍤氬ú顏嶆晣闁靛繒濮鹃幗鏇炩攽閻愭潙鐏﹂懣銈嗕繆閹绘帞澧﹂柡灞剧☉铻栭柛鎰╁妺缁墎绱撴担鍝勑㈢紓宥咃躬楠炲啰鎹勬笟顖涘兊闂佸憡顨堥崑鎰板几閸涱厸鏀芥い鏃傘€嬮弨缁樹繆閻愯埖顥夐柣锝囧厴婵℃悂鏁傞崜褏妲囬梻浣侯焾閺堫剛鍒掗悩鍐差嚤婵犻潧顑嗛埛鎺懨归敐鍕劅闁绘帡绠栭弻銊╁即濡搫濮﹂梺璇″暙閸ャ劌浜归悗鐟板閸犳牕鈻?

    // 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰鍐€妞ゆ劦婢€缁爼姊?1. 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑鏅悷婊冪Ч閿濈偛鈹戠€ｎ偅娅囬梺绋跨焿婵″洨绮欒箛鏃傜瘈闁靛骏绲介悡鎰版煕閺冣偓閻楃姴鐣烽弴鐐嶆梹鎷呴崗鍝ョ泿闂備礁鎼崐鎼佹倶濠靛鐓曢柡鍌氱氨濡插牓鏌熼幆褏锛嶉弫鍫ユ⒑閸濆嫮鐒跨紓宥勭椤曪綁顢氶埀顒€鐣烽幒鎴僵妞ゆ巻鍋撴い顒€妫濋弻锝嗘償閵堝孩缍堝┑鐐插级閻楃姾妫熼梺姹囧灮椤牓鎷戦悢鍏肩叆婵犻潧妫Σ鍛婁繆椤愶綇鑰块柡灞剧洴閳ワ箓骞嬪┑鍥╀憾闂備胶顭堥…顒勫垂娴肩补鈧棃宕橀鍢壯囨煕閳╁厾顏嗗閳轰緡娓婚柕鍫濋娴滄粍銇勯敂钘夘棆缂侇喗纰嶅蹇涘Ω瑜忛惁鍫ユ⒑閹肩偛鍔ラ柛鈺傜墵瀵煡顢楅埀顒勫煘閹达附鏅柛鏇ㄥ亗閸濇顪冮妶鍡樿偁闁告洦鍙庡ú鎼佹⒑閸涘﹥瀵欓柍褜鍓熷畷鎴﹀箻閼搁潧鏋傞梺鍛婃处閸撴盯藝閵夈儮鏀介柣鎰皺濠€鎾煕閺冣偓閸ㄦ寧淇婄€涙鐟归柍褜鍓欓悾鐑藉Ω瑜夐崑鎾斥槈濞呰鲸宀搁獮蹇涘传閸曘劍鏂€濡炪倖姊婚崑鎾诲吹閳ь剙鈹戦悙鑼勾闁稿﹥鐗楃粚杈ㄧ節閸愵亪妾梺鍛婄☉閿曘倝鍩€椤掆偓閻忔岸骞堥妸銉庣喖鎮℃惔鈥茬帛闁诲孩顔栭崳顕€宕板璺虹劦妞ゆ帊绶￠崯蹇涙煕閻樻剚娈曠紒缁樼⊕缁绘繈宕惰閻ｆ椽姊洪棃娑氱疄闁稿﹥鐗犲畷鎴﹀磼閻愯尙顔愰柡澶婄墕婢х晫绮旈悽鍛婄厱闁绘劘灏欑粔鐑樻叏婵犲嫮甯涢柟宄版嚇瀹曨偊宕熼鈶挎洟姊绘担鐑樺殌闁哥喎鐏濈叅妞ゆ挾鍋熼弳锕傛煙鏉堝墽鐣辩紒?(闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ巻鍋撴潻婵嬫⒑闁偛鑻晶鎾煛鐏炲墽銆掗柍褜鍓ㄧ紞鍡涘磻閸涱厾鏆︾€光偓閸曨剛鍘搁悗鍏夊亾闁逞屽墴瀹曚即寮介婧惧亾娴ｇ硶妲堥柕蹇曞Т閼板灝鈹戞幊閸婃劙宕戦幘娣簻闊浄绲芥晶鎾煛鐏炲墽鈽夋い顐ｇ箞閹剝鎯斿┑鍫熸櫦缂傚倸鍊峰ù鍥ㄣ仈閹间礁绠伴柤濮愬€楃粻鏃堟煟閺冨倸甯堕柣鎰功閹茬鐣濋崟顐ゎ槱闂佽姤锚椤﹁棄銆掓繝姘厪闁割偅绻冮ˉ鐐烘煠閼碱剙鈻堥柡灞剧洴婵＄兘鏁愰崨顓х€冲┑鐐差嚟婵挳濡剁粙娆炬綎闁惧繐婀辩壕鍏间繆椤栨碍鎯堢悮婵嬫⒒娴ｅ憡鍟為柟绋款煼閹嫰顢涢悙鍙夋К闂侀潧绻堥崐鏇㈠础閹惰姤鐓熼柟瀛樼箖椤ョ娀鏌涢悙鍨毈闁哄矉缍侀幃鈺呮倻濮楀棔鍝楅梻浣侯焾缁ㄦ椽宕愰弴銏℃櫇闁靛繆鈧剚鍤ら柣搴㈢⊕椤洭宕㈡禒瀣拺闁圭娴风粻鎾淬亜閿旇娅嶆鐐差槹閵堬綁宕橀埡鍐ㄥ箰闁诲骸鍘滈崑鎾绘倵閿濆骸澧伴柣锕€鐗撻幃妤冩喆閸曨剛顦梺鍛婎焼閸ラ绋忓┑鐘绘涧椤戞劙寮崟顖涚厱妞ゎ厽鍨靛▍妯讳繆椤愶絿鐭婇柍瑙勫灴閹晠宕归锝嗙槑闂備胶顭堥鍥磻閵堝懐鏆︾憸鐗堝笒闁卞洭鏌￠崶鈺佷户妞ゆ柨娲楦裤亹閹烘搫绱甸梺缁樺釜缁犳挸顕ｉ幓鎺嗘斀闁搞儯鍎扮花濠氭椤愩垺澶勯柟鍛婃倐椤㈡棃骞橀鐣屽幗?
    private static final EntityDataAccessor<Boolean> FOLLOW_MODE = SynchedEntityData.defineId(SkeletonTurret.class, EntityDataSerializers.BOOLEAN);
    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱槸濞寸兘宕伴弽褏鏆︽い鎰剁畱缁€瀣亜閺冨洤浜归柛妯侯嚟缁辨捇宕掑▎鎴濆濡炪們鍔屽Λ婵嗙暦瑜版帒鍨傛い鏇炴噺缂嶅酣姊洪幆褏绠烘い顐㈩槺閳ь剚纰嶅畝鎼佸蓟瀹ュ唯闁靛鍎插В鎰旈悩闈涗沪闁告梹顨堝Σ鎰板箻鐎涙ê顎撻梺鍦帛鐢﹥绔熼弴鐐╂斀闁绘劕鐡ㄧ亸浼存煕閳轰礁鏆ｇ€规洘鍨块獮姗€骞栭鐕佸晬闂備胶绮崝鏍亹閸愵喖姹查柨婵嗘－濞堜粙鏌ｉ幇顓熷剹闁绘帞鏅槐鎺撴綇閵娿儳鐟ㄩ柧浼欑悼缁辨挻鎷呴惂闀愮返婵?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弴妤€浜惧銈庝簻閸熸潙鐣疯ぐ鎺濇晪闁告侗鍨版慨娲⒒娴ｄ警娼掗柛鏇炵仛閻ｅ墎绱撴担鎻掍壕婵犮垼鍩栭崝鏍磹閻㈠憡鐓ユ繝闈涙椤庢顭胯瑜板啴鍩?HUD 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犖ч柛灞剧煯婢规洖鈹戦绛嬬劷闁告鍕珷妞ゆ牜鍋為悡娑㈡煕濞戞瑦绶查柣鎾村姉缁辨帡宕掑☉妯碱儌闂侀€炲苯澧剧紓宥呮閸┾偓?
    private static final EntityDataAccessor<Boolean> IS_PURGE_ACTIVE = SynchedEntityData.defineId(SkeletonTurret.class, EntityDataSerializers.BOOLEAN);
    private static final EntityDataAccessor<Boolean> IS_SCAVENGING = SynchedEntityData.defineId(SkeletonTurret.class, EntityDataSerializers.BOOLEAN);
    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱槸濞寸兘宕伴幘璇茬闁绘顥嗛崷顓涘亾閿濆骸浜炲ù婊呭仱濮婂宕掑▎鎺戝帯缂備緡鍣崹鍫曠嵁閹版澘绠绘い鏃囧亹閺屟冣攽閻愭潙鐏熼柛銊ㄦ缁骞掑Δ浣叉嫽婵炶揪缍€濞咃絿鏁☉銏＄叆婵鍩栭悡鐔肩叓閸ャ劍顥嗗瑙勶耿閺屽秶鎷犻懠顑呪偓娈垮枟閹告娊骞冮埡鍛仺缁炬澘顦辨惔濠冪節绾版ê澧茬憸鏉垮暣瀵敻顢楅崟顒€浜遍梺鍝勫暙閻楀﹪鎮為懞銉ｄ簻闁哄稁鍋勬禒锕傛煟?(001-999)
    public static final EntityDataAccessor<Integer> UNIT_ID = SynchedEntityData.defineId(SkeletonTurret.class, EntityDataSerializers.INT);
    public static final EntityDataAccessor<Integer> DEATH_PLAQUE_FATAL_HIT_COUNT = SynchedEntityData.defineId(SkeletonTurret.class, EntityDataSerializers.INT);
    // RANGE_LEVEL removed - derived from TIER

    // ==================== 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰鍐€妞ゆ劦婢€濞岊亪姊洪崫鍕闁告挾鍠栧璇测槈閵忕姈銊︺亜閺冨倸甯舵い顐邯濮?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繐霉閸忓吋缍戦柛銊ュ€搁埞鎴﹀磼濠婂海鍔搁梺鍝勫閸庣敻寮婚垾鎰佸悑閹肩补鈧磭顔愮紓鍌欒兌婵娊宕￠幎钘夎摕闁绘梻鍘х粻姘舵煟濡も偓閻楁粌螞閸曨垰绾ч柍鍝勫€荤粻鏍磼缂佹绠為柟顔荤矙濡啫霉闊彃鐏紒缁樼〒娴狅箓宕掑锝呬壕婵犻潧妫涢弳锕傛煥濠靛棙顥犵紒鈾€鍋撻梻浣规偠閸庮垶宕濇惔銊ュ偍闂侇剙绉甸埛鎴︽煕閿旇骞栧ù婊堢畺閺屾洟宕堕埡浣风捕濡炪値浜滈崯鎾嵁閹烘妫橀柛顭戝枤娴滀即姊绘担鍦菇闁搞劌顭峰顐﹀传閵夈儺妫滈梺鑺ッˇ顓㈠焵椤掍礁绗掓い顐ｇ箞椤㈡鎷呯憴鍕偓鐑芥⒒娴ｇ瓔鍤欑紒璇茬墦瀹曟洟骞庨挊澶屽姦濡炪倖甯掗崰姘焽閹邦厾绠鹃柛娆忣槺閻帞鈧鍣崑濠囩嵁閺嶃劍濯撮柛婵勫労濡叉挳姊绘担鍛婅础闁稿簺鍊濆畷闈涱潩椤戠偞妞介、鏂款吋閸℃ɑ鐝曢梻鍌欑閹测€趁洪敃鍌氱婵炴垯鍨归悞鍨亜閹烘埈妲稿褍鐡ㄩ幈銊︾節閸涱噮浠╃紓浣介哺鐢帡锝炲鍫濆耿婵☆垰鍚嬪▓浠嬫⒒閸屾瑨鍏岀紒顕呭灦閵嗗啴宕ㄩ鍥ㄧ☉閳藉顫濋鈧悘?====================
    // 1. 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈠姊绘担鐟邦嚋婵☆偂绀佽灋闁告洦鍨伴崹鍌炴煛閸屾冻绱╃憸鐗堝笚閸嬫劗鈧懓澹婇崰鏍礈闁秵鈷戠紒瀣健椤庢鏌ㄩ弴妯哄姢闁瑰箍鍨归埞鎴犫偓锝庡亽濡啫鈹戦悙鏉戠仴鐎规洦鍓熷畷婊堝箥椤斿墽锛濇繛杈剧稻瑜板啯绂嶆ィ鍐┾拺闁告稑锕ゆ慨锕傛煕閻樻剚娈滈柟顕嗙節瀵挳鎮㈤搹璇″晭闂備胶鎳撻悺銊ф崲閸岀偞鍤嬮柛锔诲幐閸嬫挸鈻撻崹顔界彎缂備胶濮甸悧鐘差嚕?(缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋敐鍛闂備胶鎳撶壕顓㈠窗閺嶎厹鈧礁鈽夐姀鈥斥偓鐑芥煠绾板崬澧婚柛鐔锋处娣囧﹪鎮欓鍕ㄥ亾閺嶎厼绀夌憸鏂款潖娴犲绀嬫い鏍ㄦ皑閿涙盯姊洪棃娑氬婵炶绠撳畷浼村箛閹殿喖褰勯梺鎼炲劘閸斿秶绮堥埀顒勬⒑閹肩偛濡界紒璇插暣婵＄敻宕熼姘鳖啋闂佸憡顨堥崑鐔哥妤ｅ啯鈷戦柛婵嗗閸ｈ櫣绱掗鑺ュ磳鐎殿喖顭锋俊鑸靛緞婵犲嫮鏉稿┑鐐舵彧缁蹭粙骞楀鍕嚤闁搞儜鈧弨浠嬫煟閹邦剙绾ч柍缁樻礋閺屾盯骞樼€涙娈ら梺鐟扮畭閸ㄥ綊鍩ユ径濠庢僵闁挎繂鎳嶆竟鏇㈡⒑濮瑰洤鐏い鏃€鐗犻幃鐐烘倷椤戝彞绨婚柟鍏肩暘閸ㄨ櫣浜搁悽鐢电＜閺夊牄鍔嶇亸顓熴亜閹惧啿鎮戦柟宄版嚇濮婂綊骞囬澶嬵棥闂傚倸鍊搁崐鎼佸磹妞嬪孩顐芥慨姗嗗墻閻掔晫鎲稿鍫罕婵犲痉鏉库偓鏇㈠箠鎼淬劍鍋い鏂款潟娴滄粓鏌熼弶鍨暢闁伙綁浜堕弻锝夊箻鐎靛摜鐣甸梻鍥ь樀閺岋絽螣閻戞ǚ鏋欓梺绋垮閸旀牠濡甸崟顒佸劅闁靛繒濮撮～灞筋渻閵堝簼绨婚柛鐔风摠娣囧﹪宕奸弴鐐茶€垮┑鈽嗗灣閵嗗妲愰埡鍛拻濞达絽鎲￠幆鍫ユ煙閾忣偄濮堢紒缁樼洴閸┾偓妞ゆ帒鍊甸崑?
    // 2. 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈠姊绘担鐟邦嚋婵☆偂绀佽灋闁告洦鍨伴崹鍌炴煛閸屾冻绱╃憸鐗堝笚閸嬫劗鈧懓澹婇崰鏍礈闁秵鈷戠紒瀣健椤庢鏌ㄩ弴妯哄姢闁瑰箍鍨归埞鎴犫偓锝庡亽濡啫鈹戦悙鏉戠仴鐎规洦鍓熷畷婊堝箥椤斿墽锛濇繛杈剧稻瑜板啯绂嶆ィ鍐┾拺闁告挻褰冩禍鏍煕鎼淬垻鍙€闁诡噯绻濆畷姗€顢欓挊澶夊摋婵犵數鍋為崹璺侯啅婵犳艾纾婚柟鎹愵嚙缁€鍌炴煕濞戝崬寮炬俊顐ｇ矌缁辨捇宕掑顑藉亾閹间礁纾归柟闂寸绾惧綊鏌涘┑鍕姢闁活厽鎹囬弻锝夊閵忊晝鍔搁梺鎼炲妼閸婂潡寮诲☉鈶┾偓锕傚箣濠靛洨褰梻浣规偠閸婃牕煤閺嶎厽绠掗梻浣侯焾缁绘劙宕ョ€ｎ剛绀婇柟瀵稿Х绾惧ジ鏌嶈閸撶喎鐣锋總绋款潊闁炽儴娅曢悗楣冩⒑鐠囨彃鍤辩紓宥呮瀹曟垿宕卞☉鏍ゅ亾閸涘瓨鐓ラ悗锝庡墰椤旀洟姊洪悷鎵憼闁荤喆鍎甸幃姗€顢旈崼鐔哄幗闂佽鍎抽顓灻洪幘顔界厸閻忕偛澧藉ú瀛橆殽閻愬弶鍠橀柛鈹惧墲閹峰懘宕滈懠顑藉亾閻戣姤鈷掑ù锝堟閵嗗﹪鏌￠崪浣风敖鐎垫澘锕幃娆擃敆閸屾鏁?(Tick)
    // 3. 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼槮闁搞劍绻冮妵鍕冀椤愵澀姹楅梺閫炲苯澧剧紒鐘虫尭閻ｉ攱绺界粙璇俱劑鏌曟径娑㈡鐞氾綁姊婚崒娆戭槮闁圭⒈鍋嗙划娆愮瑹閳ь剙鐣烽姀锛勯檮闁告稑锕ら埀顒€娼￠弻娑⑩€﹂幋婵呯按婵炲瓨绮嶇划鎾诲蓟閻斿憡缍囬柛鎾楀惙鎴犵磼缂併垹骞栭柣鏍с偢瀵鈽夐姀鐘愁棟闁荤姵浜介崜杈樄闁哄备鈧磭鏆嗛悗锝庡墰琚﹂柣搴㈩問閸犳洜鍒掑▎蹇ｅ殨闁割偅娲栫粻锝夋煟閹扮増娑х紓宥呮濮婅櫣鎷犻崣澶婃敪濡炪値鍋勯ˇ顖滃弲濠殿喗銇涢崑鎾绘煛娴ｇ鏆ｅ┑顔瑰亾闂佺粯锚閻忔艾鈻撴ィ鍐┾拺闂傚牊鍗曢崼銉ョ柧闁冲搫鎳庨弸渚€鏌涢妷銏℃珕闁哥姵鍔楅埀顒€绠嶉崕閬嵥囬鐐村仾?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弴妤€浜惧銈庝簻閸熸潙鐣疯ぐ鎺濇晪闁告侗鍨版慨娲⒒娴ｄ警娼掗柛鏇炵仛閻ｅ墎绱撴担鎻掍壕婵犮垼鍩栭崝鏍磹閻㈠憡鐓ユ繝闈涙椤庢顭胯瑜板啴鍩為幋锔绘晩闁圭娴疯ぐ褔姊洪棃娑欐悙閻庢矮鍗抽悰顕€骞掑Δ鈧粻锝嗙節閸偄濮冮柟顕嗙秮濮婄粯鎷呴崨濠傛殘闂佽崵鍠嗛崕鐢稿极閸愵噮鏁傞柛顐ｇ箚閹芥洖鈹戦悙鏉戠仧闁搞劌婀辩划鑽ょ磼濡湱绠氶梺缁樺姍濞佳勭閻愵兙浜滈柨鏇炲亞濡垹绱?闂?25s 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙闁稿被鍔庨幉鎼佸籍閸惊銉╂煕閹般劍娅嗛柛搴ｅ枛閺屾洝绠涚€ｎ亞鍔村┑鐐跺皺椤牓鍩為幋锔藉亹缂備焦蓱闁款厼顪冮妶鍡楃仴婵☆偅绻傞悾?/ 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰绠涢柍杞拌閸嬫挸螖閸愵亙绗?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙闁稿被鍔庨幉鎼佸棘鐠恒劍娈惧銈嗙墱閸嬫盯鏌ㄩ妶鍡曠箚闁靛牆瀚ˇ锔界箾閸剛鍒版い顏勫暣婵″爼宕卞▎蹇ｆ椒濠电姰鍨奸～澶娒洪悢椋庢殾闁硅揪绠戠粻濠氭偣閸ャ劌绲婚柣搴幖椤啴濡堕崱妤€顫呴梺绋款儐閹稿濡甸崟顔剧杸闁规崘娉涢埛鍫ユ⒑鏉炴壆顦﹂柨鏇ㄤ邯閹繝顢曢敃鈧悙濠囨煏婵炑€鍋撴俊鎻掔墦濮婂搫煤鐠囨彃绠哄銈冨妼閹虫﹢鍨鹃敂鐐磯闁靛绠戠壕顖炴⒑缂佹顣叉繛鍏肩懄鐎靛ジ骞囬悧鍫濅哗?闂?
    private static final EntityDataAccessor<String> DATA_STATUS_OVERLAY = SynchedEntityData.defineId(SkeletonTurret.class, EntityDataSerializers.STRING);
    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱樈閸犳顕欏ú顏呪拺缂侇垱娲栨晶鍙夈亜閵娿儲鍣界紒顔芥閵囨劙骞掗幘璺哄箥婵＄偑鍊栭悧妤冨垝瀹€鍕嚑婵炴垶鐟﹂崣蹇撯攽閻樺弶鍣烘い蹇曞Х缁辨帗娼忛妸銉х懆闁句紮缍侀弻褑绠涢弴鐔锋畬婵犳鍠栭妶绋款潖缂佹ɑ濯撮柛娑橈工閺嗗牆顪冮妶搴″箹闁绘鎸搁悾鐑藉箣閿曗偓缁犳盯鏌℃径搴㈢《闁告棑绠戦—鍐Χ閸℃鐟ㄩ梺鍝ュУ閼归箖鈥﹂崶顒€绠涙い鎴ｅГ閺傗偓闂備胶绮崝姗€顢氬鍐惧晠闁靛鏅滈悡鐔兼煥濠靛棙鎼愰柛妯绘尦閺屸剝鎷呴悷鏉款潚閻庤娲忛崝鎴濈暦閹烘埈鐓ラ柛鎰ㄦ櫇娴滄牠姊绘担鍝ョШ妞ゃ儲鎸荤换娑㈠焵椤掑嫭鐓欑€规洖娲ら埢鍫熴亜閵忥紕澧垫鐐村姈閹棃濮€閻樼粯锛楅梻鍌氬€搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰级閻ゅ嫬鈹戞幊閸娧呭緤娴犲鐤い鎰╁€愰崑鎾愁潩椤掑效闂侀潧娲ょ€氫即鐛幒妤€绠ｆ繝鍨姃缁辨繈姊绘担鑺ャ€冪紒鈧担鑲濇稑鈹戠€ｎ亣鎽曢梺鎸庣箓椤︻垳绮诲☉娆嶄簻闁瑰搫绉堕崝宥夋煕鎼淬垺宕屾慨濠冩そ瀹曨偊宕熼棃娑樺缂傚倷娴囬崺鏍х暆缁嬫鍤曞┑鐘崇閺呮煡鏌涘☉妯衡偓鐟拔涢崘顔兼槬闁逞屽墯閵囧嫰骞掗幋婵愪痪闂佺顑呴澶愬蓟濞戙垹鐒洪柛鎰典簼閸ｎ噣姊哄ú璇插箹闁绘鎹囧濠氬Ω閳轰礁宓嗛梺缁樺姈缁佹挳宕戦幘骞夸汗闁圭儤鎸告禍妤呮⒑闂堟侗妾у┑鈥虫川缁粯銈ｉ崘鈺冨幍闁诲海鏁搁…鍫ュ礈闁秵鐓熼柟鍝勭Ф閻瑩鏌″畝瀣М妤犵偞甯掕灃濠电姴鍠氬Λ鏍磽閸屾瑦绁板鏉戞憸閺侇噣鎮欓崹顐綗闂佸湱鍎ら崵锕傛偄閸忕厧浜楅柟鐓庣摠钃遍悗姘叀濮?UI 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗霉閿濆牊顏犵紒鈧繝鍌楁斀闁绘ɑ褰冩禍鐐烘煟閹烘梹娅曢柟鍙夌摃缁犳盯寮撮悙鑼喊闂備礁鎼崯顐︽偋婵犲洤纾瑰┑鐘崇閻撱垺淇婇娆掝劅婵¤尙鍎ら妵鍕唩闁告劧绲鹃弬鈧梻浣哥枃濡嫬螞濡ゅ懏鍊堕柣妯肩帛閻撶喖鏌曟繛褍鍟獮瀣倵鐟欏嫭绀冮柛銊ユ健閻涱喖螣閸忕厧鐝伴梺鍛婄懃椤︻垳绮婇懜鍏哥箚闁绘劦浜滈埀顒佺墵楠炴劖銈ｉ崘銊э紱濠碘槅鍨甸妴鈧柡宀嬮檮閵囧嫯绠涢幘鎰佷槐闂佽　鍋撳ù鐘差儐閻撱儲绻涢幋鐏活亪顢旈埡浼卞綊鎮╁畷鍥╃厜闂佸搫鏈粙鎺旀崲濠靛纾兼繛鎴灻煎ǎ顔戒繆閵堝洤啸闁稿绋戣灋婵犻潧妫涢弳锕傛煕椤愶絾绀€闁绘挻锕㈤弻鐔碱敍閸℃鈧悂藟濮樿埖鈷掑ù锝囨嚀椤曟粎绱掔拠鎻掆偓濠氭嚍闁秵鍤冮柍鍝勫灏忓┑鐘垫暩婵數鍠婂澶嬪亗闁绘柨鍚嬮悡娆撴煙椤栧棗鍟В鎰版⒑闁偛鑻晶顔界箾绾绡€闁绘侗鍣ｅ畷姗€濡告惔銏☆棃鐎规洏鍔戦、娆撴⒒鐎靛憡鏆伴梻鍌氬€风粈渚€骞栭位鍥箥椤旂懓浜剧紒妤佺☉閸熺娀寮搁弮鈧换娑橆啅椤旇崵鍑归梺鎶芥敱閸ㄥ湱妲愰幘瀛樺濠殿喗鍩堟禍顏堝箖閿熺姴鐒垫い鎺戝€荤壕钘壝归敐鍛儓閺嶏繝姊洪悷鐗堝暈闁诡喖鍊块獮鍐箚瑜忛弳瀣煙娴ｅ啯鐝柡鍌楀亾闂備浇顕ч崙浠嬪箑閵夆晛鐒垫い鎺戝绾惧鏌熼崜褏甯涢柡鍛箞閺屾稓浠﹂悙顒傛濡炪倖鏌ㄩ敃顏勵潖濞差亜浼犻柛鏇ㄥ亝濞堫參姊虹粙娆惧剰闁挎洩绠戝嵄?
    private static final EntityDataAccessor<Integer> DATA_HEAT = SynchedEntityData.defineId(SkeletonTurret.class, EntityDataSerializers.INT);
    private static final EntityDataAccessor<Integer> TIER = SynchedEntityData.defineId(SkeletonTurret.class, EntityDataSerializers.INT);
    public static final EntityDataAccessor<Boolean> IS_FOLLOWING = SynchedEntityData.defineId(SkeletonTurret.class, EntityDataSerializers.BOOLEAN);
    public static final EntityDataAccessor<Integer> KILL_COUNT = SynchedEntityData.defineId(SkeletonTurret.class, EntityDataSerializers.INT);

    private static final EntityDataAccessor<Boolean> IS_BRUTAL = SynchedEntityData.defineId(SkeletonTurret.class, EntityDataSerializers.BOOLEAN);
    private static final EntityDataAccessor<Integer> UPGRADE_PROGRESS = SynchedEntityData.defineId(SkeletonTurret.class, EntityDataSerializers.INT);
    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱槸濞寸兘宕伴弽褏鏆︾憸鐗堝俯閺佸﹪鏌熼鍡楀暟缁变即姊绘担钘夊惞闁稿鍋熼崰濠傤吋閸ャ劌搴婇梺鍓插亝缁诲秴顭囬弽褉鏀介柣妯虹枃婢规鐥幆褍鎮戝ǎ鍥э躬婵″爼宕掑顐㈩棜婵犵數鍋涢悺銊у垝閹惧墎涓嶉柡宓本缍庡┑鐐叉▕娴滄粓骞戦懜鐐逛簻闁圭偓顨呴幊搴㈡叏閸忚偐绡€闁汇垽娼ф禒婊勩亜閺囥劌寮€规洘顨呰灒闁惧繗顫夊▓楣冩煟閻斿摜鎳冮悗姘煎櫍濮婁粙宕熼娑氬幈濠电偞鍨堕敃顐﹀礉閻斿吋鐓?
    private static final EntityDataAccessor<Boolean> IS_CAPTAIN = SynchedEntityData.defineId(SkeletonTurret.class, EntityDataSerializers.BOOLEAN);
    private static final EntityDataAccessor<Boolean> IS_SQUAD_MEMBER = SynchedEntityData.defineId(SkeletonTurret.class, EntityDataSerializers.BOOLEAN);
    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱樈閸犳顕欏ú顏呪拺缂侇垱娲栨晶鍙夈亜閵娿儲鍤囬柨婵堝仱椤㈡棃宕奸悢鍙夊缂傚倷绀侀鍛焊閸涱啣娑橆潩椤掑瀵岄柣搴㈢⊕钃遍柛濠冨姈椤ㄣ儵鎮欓懠顒€鈪垫繝纰樺墲閹倹淇婇悜钘夘潊闁斥晛鍟鎴︽⒒閸屾瑧顦﹂柟娴嬧偓瓒佹椽鏁冮崒姘憋紱闂佸憡娲﹂崜姘跺矗韫囨稒鐓忛煫鍥ㄦ礀琚ラ梺琛″亾濞寸姴顑嗛悡鐔兼煙闁箑鐏犻柣銊ユ惈椤儻顦抽柣鈺婂灦瀵鈽夐姀鐘栤晠鏌曟竟顖氬€藉鎼佹⒒娴ｉ涓茬紒韫矙瀹曟煡鎳犻鈧鍙変繆閻愵亜鈧洜鎹㈤幇鏉跨疇闊洦绋戠壕鎸庛亜韫囨挾澧涢柣鎾跺枛閺岋絽螣閸濆嫮楠囩紓浣插亾鐎光偓閸曨剛鍘遍梺瑙勫劤椤曨厾绮婚悙纰樺亾濞堝灝娅橀柛瀣攻娣囧﹪鎳滈棃娑氱獮闁诲函鎬ラ崟顐紪闂傚倸鍊风粈渚€骞夐敍鍕煓闁硅揪闄勯弲婵嬫煏婵犲繐顩柣婵婂煐娣囧﹪顢涘┑鍡曟睏缂佹儳澧介崢褔鈥︾捄銊﹀磯濞撴凹鍨伴崜閬嶆煟韫囨捇鐛滅紒鐘虫崌瀵?(闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煟閵忋埄鐒剧紒鎰殜閺岀喖骞嶉纰辨毉闂佺顑戠换婵嗩嚕閸洖閱囨慨姗嗗幗閻濇梻绱撴担鐣屽牚闁稿﹥娲熷﹢渚€姊虹紒妯忣亜螣婵犲洤纾块煫鍥ㄦ礈绾惧ジ鏌熼柇锕€寮炬繛鍫熺矒閺岋紕浠﹂崜褉妲堥梺瀹犳椤︻垶鍩㈡惔銊ョ疀妞ゆ棃鏁弸蹇曠磽閸屾艾鈧悂宕愭搴㈠闁哄被鍎遍悿楣冩煟濡鍤欓柦鍐枛閺屻劌鈹戦崱鈺傂ч梺绋款儏鐎氫即寮诲☉妯锋斀闁糕剝顨忔导宀勬⒑閸濆嫭锛嶉柛娆忓暙椤繘鎼归崷顓犵厯闂佸憡鐗戦崜婵嬪极閻愵剛绡€闁汇垽娼ф禒婊堟煥閺囥劋绨绘い鏇悼閹风姴霉鐎ｎ偒娼旀繝娈垮枟椤ㄥ懎螞濞嗘挸纾介梻鍫熶緱濞撳鏌曢崼婵囶棞缂佹甯￠幃妤€顫濋崡鐐插箣闂佺硶鏂侀崑鎾愁渻閵堝棗绗傜紒鍨涒偓鏂ユ灁婵せ鍋撻柡宀€鍠栧畷锝嗗緞鐎ｎ亖鍋撻幇顔瑰亾濞堝灝鏋︽繛澶嬬洴閸┿垺鎯旈妸锕€鈧攱銇勯幋锝呅撻柣搴濆嵆濮婅櫣鎷犻崣澶婃敪濡炪値鍋勯ˇ顖滃弲闂佸搫绋侀崢浠嬪磻婢跺ň鏀介柛灞剧矤閻掑墽绱掗悩宕囧缂佺粯鐩畷鍗炍熺拠鑼暡缂傚倷鑳舵慨鐑藉极婵犳艾钃熼柣鏂垮悑閸婄粯淇婇婵愬殭闂傚绉瑰铏规嫚閼碱剛顔夋繝鐢靛仜閿曘倝锝炶箛鏇犵＜婵☆垵顕ч鎾绘⒑閸涘﹦鈽夐柨鏇樺劦瀹曟洟骞橀崜浣猴紳婵炶揪绲芥竟濠偽ｉ崫銉х＝鐎广儱鎷戞Λ姘繆椤愮姴鐏叉慨濠冩そ瀹曠兘顢橀悙鏉款棜闂備礁鎼鍛村Χ缁嬫鍤曢柟闂寸缁秹鏌涢銈呮灁闁告鏁婚弻鈩冨緞婵犲嫬鈪电紓浣哄У閻楁洟鈥栨繝鍥舵晪闁逞屽墴瀵顓兼径瀣弳闁诲函缍嗘禍鐐烘偡閺屻儲鈷戦梻鍫熺⊕閹兼劙鎮楀顓熺凡妞ゆ洩缍佸鍫曞箠閾忣偅顥堥柛鈹惧亾濡炪倖甯婇懗鍫曘€呴弻銉︾厵妞ゆ牕妫楅張顒傗偓?
    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈢粯淇婇悙顏勨偓鏍偋濡ゅ啰鐭欓柟鐐湽閳ь剙鎳樺畷锝嗗緞瀹€鈧鏇㈡⒑缁洖澧查柨姘舵煟韫囥儱顩柍褜鍓濋～澶娒洪弽褜鍤曢柛顐ｆ礀缁犵偤鏌曟繛鍨壔闁绘梻鍘ч崹鍌涖亜閺冣偓閸庡磭鏁崸妤佲拻濞达絼璀﹂悞鐐亜閹存繂鈧灝顕ｉ幓鎺濈叆闁告侗鍠栨惔濠傗攽閻愭潙鐏熼柛銊ョ秺閻涱噣濮€閳ヨ尙绠氬銈嗙墬缁诲啴顢旈悩鐐戒簻闁瑰瓨绻傞埀顒冨吹濡叉劙骞樼€涙ê顎撻梺鍛婄箓鐎氬懘濡烽埡鍌滃幍闂佹儳娴氶崑鍛暦瀹€鍕厱闁崇懓鐏濋崝婊呪偓鍨緲鐎氫即鐛崶顒夋晢闁稿被鍊曢弲顏勨攽閿涘嫬浜奸柛濠冪墵閹兾旈崨顔煎壒濡炪倖姊婚弲顐︽偟閸洘鐓涢柛銉㈡櫅娴滃綊鏌￠埀顒佺鐎ｎ偆鍘介梺褰掑亰閸樼晫绱為幋锔界厽闊洢鍎抽悾鐢告煛瀹€鈧崰鎾寸閹间礁鍐€闁靛濡囪ぐ鍡欑磽閸屾瑧顦﹂柛濠傛憸缁棃鎮介弶鍡楁喘閹囧醇閻斿嘲濡抽梻渚€娼х换鍡涘疾濠婂懐绀婃俊銈呮噺閳锋帒霉閿濆懏鍟為悹鎰剁節閺屾稒鎯斿☉妯峰亾濠靛宓侀柟閭﹀枤绾惧吋淇婇婧炬嫛婵炲弶鎮傚娲濞戞艾顣哄┑鈽嗗亝缁嬫挾鍒掔紒妯稿亝闁告劏鏅濋崢閬嶆⒑閺傘儲娅呴柛姗€绠栭、鏃堝川椤旂厧浼庨梻浣稿閸嬩線宕归懡銈囦笉闁哄啫鐗婇悡娆撳级閸儳鐣烘俊缁㈠櫍閺屽秹鏌ㄧ€ｎ亞浼岄梺鍝勭焿缂嶄線骞冮姀銏㈢煓婵炲棛鍋撻ˉ瀣⒒娴ｅ憡璐￠柡鍜佸亝缁绘盯鍩€椤掑嫭鐓涢悘鐐插⒔濞叉潙鈹戦埄鍐╁€愬┑锛勫厴婵＄兘鏁傞悾灞拘樻繝纰夌磿閸嬫垿宕愰妶澶婂偍鐟滅増甯掔粈澶愭煙鏉堟儳顩€规挷绶氶幃妤呮晲鎼粹剝鐏嶉梺鍝勬噺缁诲牓寮诲鍫闂佸憡鎸鹃崰鏍嵁婵犲偆鐓ラ柛娑卞枛閺嬪倿姊洪崨濠冪５闁哄懏鐟ч懞杈ㄧ節濮橆厸鎷洪梺鍛婄箓鐎氼喛鈪归梻浣告啞閺屻劑鏌婇敐澶屽祦濠电姴娲ゅ婵囥亜閺冨洦銆冪紒銊ヮ煼濡懘顢曢姀鈥愁槱缂備礁顑嗛崝娆撶嵁婢跺鍋呴柛鎰ㄦ櫇閸橀潧顪冮妶鍡樷拹闁稿孩濞婂畷銏⑩偓鐢电《閸嬫挸鈻撻崹顔界亶濠电偛鍚嬮悷鈺呮晲閻愭祴鏀介悗锝庝簽椤︺劑姊洪崷顓犲笡閻㈩垱甯￠幊娆撳箛閻楀牃鎷婚梺绋挎湰閻燂妇绮婇悧鍫滅箚婵＄偟鍘ф慨鍌涙叏婵犲懏顥夋い鎾冲悑瀵板嫭绻濋崟鍓佷覆濠电姷鏁告繛鈧繛浣冲浂鏁勯柛娑卞灣娑撳秵鎱ㄥΟ鍨厫闁绘挻娲熼弻鐔稿鐎涙ɑ閿梺鍝勵儐缁嬫挾妲愰幒妤€鐒垫い鎺戝€甸崑鎾绘晲鎼粹剝鐏嶉梺缁樻尭缁绘劙鍩為幋锔藉€烽柤纰卞厸閾忓酣姊虹拠鑼畾闁哄懏鐩﹢浣糕攽閻樿宸ラ柟鍐插缁傚秹宕滆绾捐偐绱撴担璇＄劷缂佺姵鐗滅槐鎺旂磼濡偐鐤勯悗瑙勬礃鐢帡鍩ユ径濞㈢喎煤鐠佸磭鏁鹃梻鍌氬€搁崐鐑芥嚄閸撲焦鍏滈柛顐ｆ礀閻ょ偓绻涢幋娆忕仼缁炬儳缍婇弻娑滎槼妞ゃ劌鎳橀幏鎴︽偄閸濄儳顔曢梺鐟邦嚟閸庢垶绗熷☉娆戠閻忓繑鐗楀▍鍡涙煏閸パ冾伃妤犵偞甯￠獮瀣攽閸愩劋澹曢梺鍦濠㈡﹢锝為崨瀛樼厪闁割偅绻冮ˉ鐘绘煕濡湱鐭欐慨濠冩そ楠炲洦鎷呴崫銉ょ敾闂備浇宕甸崰鍡涘磿鏉堚晛寮查梻浣瑰濞叉牠宕愰幖浣瑰仾?
    private static final EntityDataAccessor<String> SYNC_BASE_NAME = SynchedEntityData.defineId(SkeletonTurret.class, EntityDataSerializers.STRING);
    public static final String DEFAULT_BASE_NAME_TOKEN = "__default_vanguard__";
    private static final String PLAYER_NAME_LOCK_TAG = "PlayerNameLocked";
    public static final int MAX_BASE_NAME_LENGTH = 14;
    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱樈閸犳顕欏ú顏呪拺缂侇垱娲栨晶鍙夈亜閵娿儲鍤囬柨婵堝仱椤㈡棃宕奸悢鍙夊缂傚倷绀侀鍛焊閸涱啣娑橆潩椤掑瀵岄柣搴㈢⊕钃遍柛濠冨姈椤ㄣ儵鎮欓懠顒€鈪垫繝纰樺墲閹倹淇婇悜钘夘潊闁斥晛鍟鎴︽⒒閸屾瑧顦﹂柟娴嬧偓瓒佹椽鏁冮崒姘憋紱闂佸憡娲﹂崜姘跺矗韫囨稒鐓忛煫鍥ㄦ礀琚ラ梺琛″亾濞寸姴顑嗛悡鐔兼煙闁箑鐏犻柣銊ユ惈椤儻顦抽柣鈺婂灦瀵鈽夐姀鐘栤晠鏌曟径鍫濆姶闁哄棎鍨荤槐鎾寸瑹閸パ勭亶闂佽崵鍣︾粻鎴︻敋閵夆晛绀嬫い鎾寸箖閸曞啴姊虹拠鈥崇€婚悘鐐殿焾娴滅偓绻涢幋娆忕仾闁抽攱鍨块弻鐔碱敍閸℃顏い鈺€鍗冲铏圭矙濞嗘儳鍓板┑鈽嗗亝椤ㄥ﹪宕洪悙鍝勭妞ゆ棁鍋愰ˇ顐︽⒑閸涘﹤绗掗柛銈嗐偋 (闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煟閵忋埄鐒剧紒鎰殜閺岀喖骞嶉纰辨毉闂佺顑戠换婵嗩嚕閸洖閱囨慨姗嗗幗閻濇梻绱撴担鐣屽牚闁稿﹥娲熷﹢渚€姊虹紒妯忣亜螣婵犲洤纾块煫鍥ㄦ礈绾惧ジ鏌熼柇锕€寮炬繛鍫熺矒閺岋紕浠﹂崜褉妲堥梺瀹犳椤﹂潧鐣烽敓鐘冲€烽柛蹇撴憸濞夊﹪姊婚崒娆掑厡妞ゎ厼鐗撻、鏍幢濞戞顔夐梺鎼炲労閸撴岸宕戝Ο姹囦簻闁哄洦顨呮禍楣冩倵鐟欏嫭绀€缂傚秴锕妴浣糕枎閹惧磭鐓戦梺闈涳紡閸曞墎纭€闂傚倸鍊搁崐鎼佸磹閻戣姤鍤勯柛鎾茬劍閸忔粓鏌涢锝嗙闁汇倗鍋撶换婵囩節閸屾稑娅ч梺娲诲幗閻熲晠寮婚悢鐓庣闁归偊鍘鹃妴鎰版⒑閹肩偛濡界紒璇茬墦瀵顓兼径濠佺炊闂佸憡娲﹂崜娆擃敁濞戙垺鈷戦弶鐐村椤︼妇绱掓径灞炬毄闁瑰箍鍨归埥澶愬閻樻鍚呴梻浣虹帛閸旀洟鎮樺璺哄惞闁稿本绋愮换鍡涙煏閸繃鎼愮€涙繄绱撴担铏瑰笡闁告梹鐟╁畷娲倷閸濆嫮顓洪梺鎸庢濡嫰鍩€椤掑嫷妫戦柍褜鍓涢幊鎾寸珶婵犲洤绐楁俊銈勭劍濞呭繑绻濋悽闈浶ラ柡浣规倐瀹曟垵鈽夊鍡楁闂佸憡鎸烽悞锕€鐣烽弻銉︾厱妞ゆ劗濮撮崝婊堟煕鐎ｎ倖鎴﹀Φ閸曨垰绫嶉柛銉ｅ妿閵嗗﹪姊哄Ч鍥р偓鎰板磻閹惧绡€闁汇垽娼ф禒锕傛煕閵娿儳鍩ｉ柍銉畵瀹曞爼顢楁担闀愮暗闂備胶顢婇幓顏堟⒔閸曨垰鐓曢柟杈鹃檮閻撴洘绻濋棃娑欘棞妞ゅ浚鍋婇弻宥囨嫚閼碱剛浼囩紓浣介哺鐢繝骞冮埡鍛闁肩⒈鍏涚槐婵嬫⒒娴ｇ瓔鍤冮柛顭戝灣缁牊绗熼埀顒勫灳閿曞倸惟闁宠桨鑳堕ˇ褔姊虹紒妯忣亪鎮樺璺哄惞闁逞屽墮椤啴濡舵惔鈥崇闂佸憡姊归崹鐢告偩閻戣棄纭€闁绘劕绉堕崰鎾诲礌閺嶎厼鍗抽柣鎰緲椤ユ岸姊绘担鍛婂暈闁告梹鍨垮畷婊堟晲閸℃ê鍔呴梺闈涱焾閸庢娊宕愰悙鐑樺仭婵犲﹤瀚粻鐐烘煟閹垮啫澧存い銏☆殕缁楃喖宕堕…鎴濇櫖闂傚倷鑳剁划顖炲礉閺嶃劎鐝堕柛鈩冪懅閻滃鏌￠崘锝呬壕闂侀潧娲ょ€氱増鎱ㄩ埀顒勬煥濞戞ê顏ゆ俊鎻掔墕椤啴濡舵惔鈥崇闂佸憡姊归崹鐢告偩閻戣姤鍋勭痪鎷岄哺閺咃綁姊虹紒妯荤叆濠㈢懓锕畷顖炲川鐎涙ǚ鎷婚梺绋挎湰閼归箖鍩€椤掍焦鍊愮€规洘鍔欓獮鏍ㄦ媴閸濄儻绱梻浣哥秺濡法绮堟担鍝勵棜濠电姵纰嶉悡鏇㈡煃閳轰礁鏆熼柍钘夘樀濮婂宕掗妶鍛桓闂佸搫琚崝宀勫煘閹达箑骞㈤柍鍝勫€愰妶澶嬧拺?



    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱樈閸犳顕欏ú顏呪拺缂侇垱娲栨晶鏌ユ煏閸モ晛浠ч柤楦块哺缁绘繂顫濋娑欏濠电偞娼欓崥瀣偡閳轰緡鐎舵い鏂垮⒔绾惧吋銇勯弮鍥т汗闁绘帒鎲＄换婵嬪焵椤掍焦濯寸紒顖涙礃閺傗偓闂備胶绮…鍫ヮ敋濠婂喚鍟呴柕澶嗘櫆閻撶喐淇婇妶鍌氫壕缂備胶绮敮鎺戝祫闂佸綊鍋婇崢濂割敋闁秵鍊垫繛鎴烆伄濮樿泛绠紓浣诡焽缁♀偓闂佹眹鍨藉褎绂掕閺屾稓鈧綆鍋呯亸顓㈡煃鐠囪尙效鐎规洖宕埢搴ㄥ箣閻欏懐搴婇梻鍌欒兌椤牓寮甸鍌滅煓闁瑰瓨绶疯ぐ鎺濇晪闁逞屽墴瀵鎮㈤搹鍦厯闂佸憡鐗戦崜婵嬪极妤ｅ啯鍊甸柛顭戝亝缁舵煡鎮楀鐓庢珝闁糕斁鍋撳銈嗗笒閿曪妇绮旈棃娴㈢懓顭ㄩ崟顓炩拰閻庤娲橀崹鍧楃嵁濡皷鍋撳☉娆樼劷缂佸鐖煎娲濞戣京鍙氱紓浣哄У閸ㄧ敻顢氶敐澶婂瀭妞ゆ棁顫夐弬鈧梻浣虹帛椤洨鍒掗姘ｆ鐟滄棃骞冨Δ鈧～婵嬫偂鎼粹檧鎷柣搴ゎ潐濞叉鎹㈤崼銉ユ瀬闁告劦鍠栫壕鍏肩箾閹寸偠澹橀悽顖涱殜閺岋綁鎮㈤崫銉х厑缂備緡鍠楅幐鎼佹偩瀹勯偊鐓ラ柛鎰亾閸嶉潧顪冮妶鍡楃瑨闁稿﹦鎳撻埢鎾诲即閵忊檧鎷洪梺鍛婄☉閿曪箓鍩ユ径鎰叆闁哄浂浜為悾鐢告煏?(闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煟閵忋埄鐒剧紒鎰殜閺岀喖骞嶉纰辨毉闂佺顑戠换婵嗩嚕閸洖閱囨慨姗嗗幗閻濇梻绱撴担鐣屽牚闁稿﹥娲熷﹢渚€姊虹紒妯忣亜螣婵犲洤纾块煫鍥ㄦ礈绾?HUD 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓闁搞劌鍊块弻娑㈩敃閿濆棛顦ョ紓浣哄С閸楁娊寮诲☉妯锋斀闁告洦鍋勬慨銏ゆ⒑濞茶骞楅柟鐟版搐椤繑绻濆顒勫敹闂佺粯鏌ㄩ崲鏌ョ嵁韫囨稒鈷戠紓浣股戦埛鎺撱亜椤撶偟澧㈡繛鍡愬灲閹瑧鍠婂Ο杞板闂佺绻愰ˇ顖涚妤ｅ啯鈷戦梺顐ゅ仜閼活垱鏅堕幘顔界厵妞ゆ牗姘ㄩ悞鍝モ偓瑙勬礀瀹曨剟鍩ユ径濞炬瀻闁瑰瓨绻傞崣濠囨⒒閸屾凹鐓柛瀣鐓ら柨鏇炲€哥粈鍕煟閻旂厧浜伴柣鎺嶇矙閺岀喖骞嶉纰辨毉闂佺粯鎸鹃崰鏍蓟閵娿儮鏀介柛鈾€鏅滃暩闂備浇顫夐悡锛勭不閺嶎厼钃熼柨娑樺濞岊亞绱掗娑欑濞存粓绠栭弻鐔革紣娴ｄ警妲梺璇″枟閸ㄥ灝顫忓ú顏勭闁绘劖褰冩慨搴㈢節閳封偓閸愵喖寮伴悗瑙勬礃缁诲牆鐣烽锕€唯鐟滃繘鏁?
    private static final EntityDataAccessor<Optional<UUID>> OWNER_UUID_SYNC = SynchedEntityData.defineId(SkeletonTurret.class, EntityDataSerializers.OPTIONAL_UUID);

    // DATA_LEVEL removed - derived from TIER

    private static final EntityDataAccessor<Integer> DATA_XP = SynchedEntityData.defineId(SkeletonTurret.class, EntityDataSerializers.INT);

    // 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌熼梻瀵割槮缁惧墽绮换娑㈠箣閺冣偓閸ゅ秹鏌涢妷顔煎⒒闁轰礁娲弻鏇＄疀閺囩倫銉︺亜閿旇娅嶉柟顔筋殜閻涱噣宕归鐓庮潛婵＄偑鍊х€靛矂宕瑰畷鍥у灊闁割偁鍎遍柋鍥ㄧ節閵忥紕绠撶紓宥咃躬楠炲啴鍩勯崘鈺佸妳闂佹寧绻傚Λ娆撳窗閺嶎厽鈷掑ù锝呮啞閹牓鏌熷畡閭﹀剶鐎规洘绮岄～婵堟崉閾忓湱鏉介梻渚€娼ч…鍫ュ磿椤曗偓瀵劍绂掔€ｎ偆鍘卞銈嗗姧缁茶法绮诲鈧弻宥堫檨闁告挻鐩敐鐐层€掗崪鐬杔ay 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯锋嫼閻熸粎澧楃敮鎺撶娴煎瓨鐓曢柟鎯ь嚟閹冲啯銇勯弴顏嗗埌闁伙綇绻濋弻鍥晜閽樺妲ｉ梻鍌欑窔濞佳囨偋閸℃あ娑樷槈濞嗘劖鐝烽梻渚囧墮缁夌敻鎮￠弴銏″€甸柨婵嗛娴滄粌鈹戦鑲┬ら柍褜鍓濋～澶娒哄鈧畷褰掑锤濡ゅ啫绁﹀┑鈽嗗灠閸氬鈧碍宀搁弻鐔虹磼濡櫣鐟ㄩ梺瑙勬偠閸婃繂顫忕紒妯肩瘈閹肩补鈧尙鐩庢繝鐢靛仩椤曟粎绮婚幋鐘插疾闂備礁鎼粙渚€宕戦崱娑樼婵﹩鍏橀弨浠嬫煕鐏炲墽顣查柛鐔哄仱閺屽秹鏌ㄧ€ｎ亞浼岄梺鍝勬湰缁嬫垿鍩ユ径濠庢建闁割偅绻傞～鐘绘⒒娴ｇ儤鍤€闁哥喕娉曢埀顒佺煯閸楀啿顕ｆ繝姘╅柍杞扮瀹撳棗鈹戦埥鍡楃仴婵炲拑绲剧€靛ジ宕奸妷锕€鈧敻鎮峰▎蹇擃仾缂佲偓閳ь剟姊洪崫銉ユ灆婵炲娲熷畷锝夊川椤撗勫瘜闂侀潧鐗嗛幊鎰不娴煎瓨鐓欓柛鎰皺缁犱即鏌嶇拠鑼х€殿喕绮欓、姗€鎮㈤崫鍕闂傚倸顭崑鍕洪敃鈧叅闁哄秲鍔庨々鐑芥煃閸濆嫭鍣洪柣鎾存礋閹鏁愭惔鈥茬盎婵犳鍠栫粔褰掑蓟閻旂⒈鏁婇柣鎾冲浜涢梻浣哥枃椤宕硅ぐ鎺戠劦妞ゆ帒锕︾粔鐢告煕鐎Ｑ冧壕闂備胶鎳撻崲鏌モ€﹀畡閭︽綎婵炲樊浜滅粻褰掓煟閹邦厼绲诲┑顕€顥撶槐鎾存媴閽樺鏁挎繝娈垮枔閸婃鍒掔€ｎ亶鍚嬮柛鈩冨姇娴滄繈姊洪崨濠傚闁哄懏绻堝畷銏＄鐎ｎ偀鎷虹紓鍌欑劍钃遍柣鎾卞劦閺岀喓鎷犺绾惧灝顭跨憴鍕闁圭绻濇俊鍫曞炊閳哄搴婇梻鍌欑窔閳ь剛鍋涢懟顖涙櫠椤栨粎纾兼俊銈呭暙閺嬫盯鏌涢埞鎯т壕婵＄偑鍊栫敮鎺斺偓姘煎枛閻ｅ灚绗熼埀顒勫蓟濞戙垹绠涢梻鍫熺⊕閻忓牏绱撴担鍝勑㈡い顓犲厴瀵鎮㈤棃鈺冪煑婵炶揪绲介幖顐ｄ繆閽樺鏀介柍鈺佸暔娴犵娀鏌涢弮鈧崹鐢革綖韫囨拋娲敂閸滀焦顥堟繝鐢靛仦閸ㄥ吋銇旈幖浣哥厺闁瑰墽绮埛鎴︽煙閼测晛浠滃┑陇鍋愰惀顏嗙磼閵忕姴绠婚梺鍛婂笚鐢€崇暦婵傚憡鍋勫瀣捣閻涱噣姊绘担鍝ョШ闁稿锕畷銏°偅閸愩劌鍋嶉梺鍛婎殘閸嬫劙寮ㄦ禒瀣厽闁归偊鍓欑痪褎銇勯妷褍浠遍柟顖氭处瀵板嫰骞囬娑欏婵＄偑鍊栭幐鍡涘礃椤忓啰鏁剧紓鍌氬€烽懗鍓佸垝椤栫偞鍎庢い鏍仧瀹撲焦淇婇婵囶仩闁哄棴绠撻弻娑㈠Ψ閹存繃鍣规鐐搭殜濮婅櫣鎷犻崣澶婃敪濡炪値鍋勯ˇ顖滃弲濠殿喗銇涢崑鎾绘煏閸℃鏆炵紒缁樼箞瀹曞爼濡烽姀鐘卞婵炶揪缍€閸婁粙寮崼婵嗙獩濡炪倖鎸炬慨瀛樻叏閿旀垝绻嗛柣鎰典簻閳ь剚鐗滈弫顕€骞掑Δ鈧壕鍦喐閻楀牆閲滅紓宥嗙墵閺岋繝宕堕妷銉т痪闂佺粯鎸婚悷鈺呭箖濡ゅ懏鍋ㄦ繛鍫ｆ硶閸旀悂鏌″浣稿⒉缂佺粯绻傞埢鎾诲垂椤斿彞鍝楅梻渚€娼ч悧濠囧箖閸屾凹鍤曢悹鍥ㄧゴ濡插牊绻濇繝鍌氼劉濮濆洤鈹戦敍鍕杭闁稿﹥鍨垮畷婵堜沪鏉炴寧绋戦埞鎴犫偓锝庝簼閻?
    private int decayTimer = 0;
    private int eatCooldown = 0;

    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱樈閸犳顕欏ú顏呪拺缂侇垱娲栨晶鏌ユ煏閸モ晛浠ч柤楦块哺缁傛帞鈧綆鍋€閹疯櫣绱撻崒娆戝妽闁挎艾鈹戦鍏煎枠闁哄被鍔戝鎾Ω閵堝洨娉挎俊鐐€ら崑鍕崲閹邦喖寮叉俊鐐€曠换鎰矓閻㈢鐤炬繝闈涱儐閳锋垿鏌熺粙鎸庢崳闁宠棄顦甸幃妤€顫濋鈧Σ濠氬础鏉堛劊浜滈柡鍥殔娴滄儳鈹戦纭烽練婵炲拑缍侀獮蹇涙偐鐠囪尙浼嬮梺鎯ф禋閸嬪棙绂嶉懜鍏哥箚闁绘劦浜滈埀顒佸灴瀹曟繂鐣濋崟顒佹珖闂侀潧鐗嗛ˇ浠嬪极鐎ｎ喗鐓ユ繝闈涙－濡叉悂骞嗛悢鍏煎仭婵犲﹤鍟幑锝夋煃瑜滈崜姘卞枈瀹ュ懐鏆嗛柟闂寸閽冪喖鏌ｉ弮鍥仩缁炬儳鍚嬫穱濠囶敍濠靛浂浠╅梺鑽ゅ枑閻撯€愁潖閻戞ê顕辨繛鍡樻尰椤庡秹姊虹紒姗嗘畼濠电偐鍋撳Δ鐘靛仜閸燁偉鐏冮梺鍛婁緱閸犳牠鍩€椤掑倸鍘撮柡宀嬬秮閹垻绮欏▎鐐棑闂備胶顭堥鍡涘箲閸パ屽殨濞寸姴顑愰弫鍥煟閹邦噮鏆滅紒杈╂暬濮婄粯鎷呯粙鎸庡€紓浣风劍閹稿啿顕ｉ幓鎺濈叆闁告劦浜濆▓楣冩⒑閸涘﹦鎳冩い锕佷含瀵囧焵椤掍胶绡€闁汇垽娼у瓭闂佺锕︾划顖炲疾閸洖鍗抽柣鏂垮缁犳岸姊虹紒妯哄濠㈢懓妫濋幆灞解枎閹惧鍘靛銈嗘⒐閺嬪鎳撻崸妤佺厵妞ゆ梻鏅幊鍥ㄤ繆椤愩垹鏆欓柍钘夘槸铻栭柍褜鍓熻棢婵鍩栭埛鎺懨归敐鍫澬撶痪顓炵埣閺屾盯鎮╅崣澶樻＆閻庤娲樺ú鐔煎箖閻ｅ瞼鐭欓柤鎰佸灡閹蹭即姊绘担瑙勭伇闁哄懏鐩畷顖烆敍濞戞ê鐏侀梺鍦檸閸犳鎮￠弴鐔虹闁瑰鍎戦崗顒勬煛閳ь剚绻濆顓犲幍閻庣懓瀚姗€鎳滆ぐ鎺撶厓閻熸瑥瀚悘鎾煛娴ｅ摜效鐎规洜鍠栭、鏇㈡晬閸曨剙绀嬮梻鍌氬€烽懗鍫曗€﹂崼銉︽櫇闁靛牆鎷嬮悞浠嬫煃閵夛箑澧柛?
    private int postTeleportAttackDelay = 0;
    private int invincibilityTimer = 0;
    private int guardDamageCooldown = 0;
    private static final int GUARD_DAMAGE_COOLDOWN_TICKS = 8;

    public void notifyTeleport() {
        this.invincibilityTimer = 6; // 0.3s (6 ticks)
        this.postTeleportAttackDelay = 4; // 0.2s (4 ticks)
        this.shotCounter = 0; // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛濠傛健閺屻劑寮村鑸殿€栨繛瀛樼矊缂嶅﹪寮诲☉銏犵疀闁稿繐鎽滈弫鏍⒑濞茶骞楅柟鐟版喘瀵鈽夐姀鈺傛櫇闂佹寧绻傚Λ娑⑺囬妸鈺傗拺缂佸顑欓崕娑樏瑰搴濋偗鐎殿喛顕ч埥澶愬閻橀潧濮堕梻浣告啞閸旓附绂嶉弽顬綁宕奸姀銏紳闂佺鏈悷銊╊敊婢舵劖鐓涢柛娑卞灠閳诲牊顨ラ悙鎻掓殺闁靛洦鍔欓獮鎺楀箣閻樻祴鍋撻悙鐑樷拺闂傚牊渚楅悞楣冩煕鎼达紕锛嶇紒顔硷工閻ｏ繝骞嶉搹顐ｆ澑婵＄偑鍊栧ú鏍涘☉銏犵濞寸厧鐡ㄩ悡銉╂煛閸ャ儱濡洪梺顓у灣閳ь剚顔栭崰鏍€﹂柨瀣╃箚闁兼悂娼х欢鐐测攽閻樿精鍏岄柣鎰躬濮婄粯鎷呴崨濠傛殘濠电偠顕滅粻鎾崇暦閹达箑鐒垫い鎺戝閻撴洟鎮楅敐搴′簼鐎规洖鏈〃銉╂倷鐎电顫ч梺鐟板槻閹虫劙宕版繝鍋界喐娼弶娆炬?
        this.playSound(SoundEvents.CHORUS_FRUIT_TELEPORT, 1.0F, 1.0F);

        // Speed Boost: 40% - 80% based on tier
        // Tier 0-1: Speed II (+40%)
        // Tier 2-3: Speed III (+60%)
        // Tier 4+: Speed IV (+80%)
        int tier = getTier();
        int amplifier = 1; // Base Speed II
        if (tier >= 4) amplifier = 3;
        else if (tier >= 2) amplifier = 2;

        this.addEffect(new MobEffectInstance(MobEffects.MOVEMENT_SPEED, 100, amplifier, false, false, false)); // 5 seconds duration, no status particles

        // Spawn particles
        spawnTeleportParticles();
    }

    public void spawnTeleportParticles() {
        if (this.level() instanceof ServerLevel serverLevel) {
            // Use Soul Fire Flame for blue trail effect
            serverLevel.sendParticles(ParticleTypes.SOUL_FIRE_FLAME, this.getX(), this.getY() + 0.5, this.getZ(), 25, 0.5, 0.5, 0.5, 0.1);
            serverLevel.sendParticles(ParticleTypes.PORTAL, this.getX(), this.getY() + 1.0, this.getZ(), 10, 0.3, 0.5, 0.3, 0.05);
        }
    }



    private int shotCounter = 0;
    private int overheatCooldown = 0;
    private int xpBuffer = 0;

    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱樈閸犳顕欏ú顏呪拺缂侇垱娲栨晶鍙夈亜閵娿儲鍤囬柨婵堝仱閸╋繝宕橀鍡闯濠电偠鎻徊鍧楁偤閺冨牆鑸归柧蹇撴贡绾惧ジ鏌ら幖浣规锭闁告繆娅ｉ埀顒侇問閸犳盯顢氳閸┿儲寰勯幇顒夋綂闂佺粯蓱椤旀牠宕ú顏呪拻濞达絽鎲￠幆鍫熺箾鐏炲倸濮傜€规洘鍨块幃銏ゆ偂鎼粹€充憾婵＄偑鍊栭崝褔姊介崟顖氱厱闁硅揪闄勯悡鏇熺節闂堟稒顥滄い蹇ｄ邯閺屾盯鏁愰崨顔藉創闂佸疇顫夐崹鍧楀箖濞嗘垶瀚氱憸鎴﹀触椤愶附鈷戠紓浣姑肩欢閬嶆煕閿濆繒绉柣娑卞枛椤粓鍩€椤掆偓閻ｇ兘鎮烽幍铏潔濠碘槅鍨抽幊鎾凰夊顓犵瘈闁汇垽娼ф禒锕傛煕閵娿儳鍩ｉ柟顔惧厴婵偓闁绘ɑ鐗楅惄顖炲春閳╁啫顕遍柛妤冨仧缁夋椽鏌℃担鐟板鐎规洏鍔戦、妯款槼妞ゃ儲鍨垮缁樻媴鐟欏嫬浠╅梺绋匡攻閻楁洜鍙呴梺缁樻煥閸氬宕戦崒娑栦簻闁规澘澧庨悾閬嶆煟閹邦剨韬柡灞炬礃缁绘繆绠涢弴鐘虫闂備礁鎼Λ娆撱€冮崼銏☆潟闁圭儤顨嗛崐閿嬨亜閹哄棗浜鹃梺鍛婃煟閸婃牠濡甸崟顖ｆ晣闁绘ɑ褰冮獮瀣倵?
    private boolean isCommandRescue = false;

    public void setCommandRescue(boolean rescue) {
        this.isCommandRescue = rescue;
    }

    public boolean isCommandRescue() {
        return this.isCommandRescue;
    }

    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱槸濞寸兘宕伴弽褏鏆︽い鎰剁畱缁€瀣亜閺冨洤浜归柛妯绘綑閳规垿鏁嶉崟顐℃澀闂佺锕ュú姗€銆冮妷鈺佺濞达絽婀遍崢鎰版⒑閹稿海绠撴い锔诲灦閹锋垿鎮㈤崗鑲╁弳闂佺粯鏌ㄩ幖顐㈢摥婵°倗濮烽崑鎴﹀垂閻戞鈹嶅┑鐘叉搐鍥撮梺鍛婁緱閸樿棄鈻撻弻銉︹拺閻熸瑥瀚徊濠氭煕濮橆剦鍎戦柟骞垮灩閳规垿宕煎┑鍥┾偓鍐测攽閳藉棗鐏熼悹鈧敃鈧…鍥ь潩閼哥鎷洪梺纭呭亹閸嬫盯宕濆鈧弻娑㈠棘閼愁垰顏梺宕囩帛閹瑰洭鐛€ｎ喗鏅滈悷娆欑稻鐎氱厧鈹戦悙瀛樼稇闁告艾顑夐幃鐤樄鐎规洘纰嶇€佃偐鈧稒顭囬崢鎼佹⒑閸撴彃浜介柛瀣閺呭爼骞橀鐣屽幍濡炪倖娲嶉崑鎾剁磼閻樺磭澧电€殿喖顭峰畷鍗炍旀繝鍌涘€梻浣虹《閸撴繈濡甸悙鍝勭闁哄诞鈧弨浠嬫煟閹邦垰鐓愮憸鎶婂懐纾奸柛娆忣槸缁€鍐煏閸ャ劌濮嶇€规洘锕㈤崺锟犲磼濞戞艾濞囬梻鍌欑閹诧繝鎮烽妷鈹у洭顢欓悙顒€搴婇梺绯曞墲缁嬫帡鎮￠悢鍏肩厵闂侇叏绠戦獮鏍磼閹绘帩鐓奸柡灞界Х椤т線鏌涢幘瀵告噧妞ゎ厼娲崹楣冨箛娴ｅ憡顓?
    private int brutalityActiveTimer = 0;
    private int brutalityCooldown = 0;

    private UUID ownerUUID;
    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱槸濞寸兘宕伴幘璇茬闁绘顕х粻鐢告煙閻戞绠栨繛鏉戞喘濮婂宕掑▎鎴М闂佺濮ょ划鎾崇暦閹存績妲堟繛鍡樺姈閻濈兘鏌熼崗鑲╂殬闁告柨鐬肩划濠氭偄閸忚偐鍘甸梻鍌氬€搁顓㈠礉瀹ュ鐓曢悗锝庝憾閸庢棃鏌＄仦鍓ф创妞ゃ垺娲熸俊鍫曞川椤斿彞绨村┑锛勫亼閸娧呮嫻閻旂厧纾块梻鍫熶緱濞兼牗绻涘顔荤盎鐎瑰憡绻傞埞鎴︽偐閹绘帩浠鹃梺闈╂€ラ崘锝嗘杸闂佸疇妫勫Λ妤佺濠靛牏纾奸悹鍥ㄥ絻閳ь剙娼￠弫鎰版倷閸撲胶鏉搁梺鍝勫暙閸婂灝顬婇鈧娲川婵犲嫧妲堥梺鎸庢磸閸婃牜绮嬪鍜佺叆闁割偆鍟块幏娲⒑閸涘﹦鈽夐柨鏇畵閸┿儲寰勭€ｃ劋绨诲銈嗘寙閸愵煈娼婚梺鍛婎殙妞存悂濡甸崟顖氬唨妞ゆ劦婢€濞岊亪姊?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弴妤€浜惧銈庝簻閸熸潙鐣疯ぐ鎺濇晪闁告侗鍨版慨娲⒒娴ｄ警娼掗柛鏇炵仛閻ｅ墎绱撴担鎻掍壕婵犮垼鍩栭崝鏍磹閻㈠憡鐓ユ繝闈涙椤庢顭胯瑜板啴鍩為幋锔绘晩闁圭娴疯ぐ褔姊洪棃娑欐悙閻庢矮鍗抽悰顕€骞掑Δ鈧粻锝嗙節閸偄濮冮柟顕嗙悼缁辨捇宕掑▎鎺戝帯婵犳鍠栭悘姘辨崲濞戞瑧绡€闁搞儜鍡樻啺闂備胶绮弻銊╁触鐎ｎ喖纾圭紓浣姑肩换鍡樸亜閺嶃劎绠栨い蹇曞Т闇夐柣妯烘惈娴滃湱绱掓潏銊ユ诞闁诡喗鐟╅、妤佹媴閸濆嫬娈ョ紓鍌氬€风粈渚€藝椤栨粎绀婂┑鐘插亞閸ゆ洖鈹戦悩瀹犲閹喖姊洪棃娑辨Ф闁搞劍妞介敐鐐差吋閸涱亝鏂€闂佺粯鍔曞鍫曀夊鍛＜闁靛鍔屾禍褰掓煃瑜滈崜姘辩矙閸儱鐤鹃柣妯烘▕濞兼牠鏌涘┑鍡楃彅鐟滄柨鐣烽幆閭︽Щ濡炪値鍓欓ˇ杈╂閹惧瓨濯寸紒娑橆儏濞堫參姊虹紒姗嗘當婵☆偅绻堥獮鍐箚瑜忛弳瀣煙闁垮鈷愭俊顐㈠暙閻ｇ兘濡搁埡濠冩櫍闂侀潧绻掓慨鐢稿汲椤忓牊鈷掗柛灞剧懆閸忓瞼绱掗鍛仩妞ゎ偄绻楅妵鎰板箳閹寸姷鏆梻浣侯焾閺堫剟宕欒ぐ鎺撳€甸柛顐ｆ礃閻撶喖鏌熸潏鍓у埌鐞氭岸姊虹紒妯诲暗闁哥姵鐗犲濠氭晲閸涘倻鍠栭幃婊兾熼柨瀣簽闂傚倷鑳堕…鍫燁殽缁嬫５瑙勵槹鎼淬埄娼熼梺鍦劋椤ㄥ懘鎮為崹顐犱簻闁瑰搫绉堕崝宥呪攽椤栨稒灏︽慨濠傤煼瀹曠厧顫濋鐔哄綀闂備線鈧偛鑻晶顖炴倵缁楁稑娲ゆ闂佸憡娲﹂崰姘舵偪閳ь剟姊洪崷顓炰壕婵炲吋鐟ラ埢宥堫樄婵﹤鎼悾鐑藉炊閳轰胶顐奸梻浣告惈鐞氼偊宕濋幋锕€鏄ラ柣鎰惈缁狅綁鏌ㄩ弮鍥棄濞存粌缍婂娲川婵犲嫭鍣у銈忓瘜閸ㄦ儼妫熼梺瀹犳〃鐠佹煡寮?
    private long squadJoinTime = 0;
    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱樈閸犳顕欏ú顏呪拺缂侇垱娲栨晶鏌ユ煏閸モ晛浠ч柤楦块哺缁傛帞鈧綆鍋€閹疯櫣绱撻崒娆戝妽闁挎艾鈹戦鍏煎枠闁哄被鍔戝鎾Ω閵堝洨娉挎俊鐐€ら崑鍕崲閹邦喖寮叉俊鐐€曠换鎰矓閻㈢鐤炬繝闈涱儐閳锋垿鏌熺粙鎸庢崳闁宠棄顦甸幃妤€顫濋悡搴☆潽婵烇絽娲ら敃銉х矉閹烘柡鍋撻敐搴′簽闁告﹢绠栧娲箹閻愭彃顬夌紓浣割儐鐢帡鍩㈠鍡欑瘈闁搞儯鍔庨崢鎼佹煟韫囨洖浠滃褌绮欓垾鏍礂缁楄桨绨婚梺鎸庢磻閻掞箓鎮甸鍫熺厪闁搞儜鍐句純婵犵鍓濋幃鍌涗繆閻ゎ垼妲诲銈冨€愰崑鎾绘⒒閸屾瑧绐旈柍褜鍓氱粙鎾诲煘閹烘鐓曢柡鍐ｅ亾闁搞劌娼￠幃浼搭敋閳ь剙顕ｆ禒瀣╅柨鏇楀亾妞ゅ孩鎹囬弻锝夋偄閸濄儲鍣ч柣搴㈠嚬閸欏啴銆?
    private static final EntityDataAccessor<Boolean> HAS_TELEPORT_MODULE = SynchedEntityData.defineId(SkeletonTurret.class, EntityDataSerializers.BOOLEAN);
    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱樈閸犳顕欏ú顏呪拺缂侇垱娲栨晶鏌ユ煏閸モ晛浠ч柤楦块哺缁傛帞鈧綆鍋€閹疯櫣绱撻崒娆戝妽闁挎艾鈹戦鍏煎枠闁哄被鍔戝鎾Ω閵堝洨娉挎俊鐐€ら崑鍕崲閹邦喖寮叉俊鐐€曠换鎰矓閻㈢鐤炬繝闈涱儐閳锋垿鏌熺粙鎸庢崳闁宠棄顦甸幃妤€顫濋鈧Σ濠氬础鏉堛劊浜滈柡鍥殔娴滄儳鈹戦纭锋敾婵＄偠妫勯悾鐑筋敃閿曗偓鍞梺闈涱槹閸旀垿宕归挊澶樻綎闁惧繗顫夐弳婊勩亜閺傚灝鈷旂悮锕傛煟?(Tick)
    private int teleportCooldown = 0;
    public int getTeleportCooldown() { return this.teleportCooldown; } // Added getter
    private int teleportModuleLevel = 0;
    private int multiShotLevel = 0;
    private int blackHoleCooldown = 0;
    private int blackHoleActiveTicks = 0;
    private net.minecraft.world.phys.Vec3 blackHoleCenter = net.minecraft.world.phys.Vec3.ZERO;
    private boolean deathRecordDropped = false;
    private TurretMobilityProfile mobilityProfile = TurretMobilityProfile.SCOUT_BOT;

    public final SimpleContainer inventory = new SimpleContainer(45);

    public SkeletonTurret(EntityType<? extends Skeleton> type, Level level) {
        super(type, level);
        // 1.20.1 闂?Mob 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌熼梻瀵割槮缁惧墽绮换娑㈠箣閻愬灚鍣х紓浣稿閸嬨倝寮诲☉銏犖ㄦい鏃傚帶椤晝绱撴担鎻掍壕闂佸壊鍋嗛崰鎾跺姬閳ь剟姊婚崒姘卞缂佸甯￠弫宥夊籍閸喓鍘?createMoveControl 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煟閵忋埄鐒剧紒鎰殜閺岀喖鏌囬敃鈧崝鎺撶箾瀹割喕绨婚柛鎰ㄥ亾婵＄偑鍊ら崜锕傚礈濮樿京鐭欓柟杈剧悼娴滄瑩姊绘担鍛婂暈濞撴碍顨婂畷銏°偅閸愩劏鎽曢梺鍓插亖閸庢煡鍩涢幋锔界厽闁绘柨鎲＄欢鏌ユ煃闁垮鈷掔紒杈ㄥ浮椤㈡岸宕ㄩ鐘辨闁诲氦顫夊ú姗€宕濆▎鎾崇畺婵犲﹤鐗婇崵宥夋煏婢诡垰鍟粻娲⒑閼姐倕鏋戠紒顔肩灱缁棁銇愰幒鏂跨ウ濠德板€愰崑鎾淬亜椤撴粌濮傜€规洏鍔戦、娑橆煥閸涱厼笑濠电姷鏁告慨浼村垂婵傜鏄ラ柡宥庡幖缁€澶愭煛閸モ晛啸婵☆偒鍨抽幉鎼佸籍閸繆鎽曢悗骞垮劚椤︻垱瀵奸悩缁樼厱闁哄洢鍔屾禍鎰版煕鐎ｎ偅灏扮紒缁樼箓椤繈顢楅崒婊勭€梻鍌欑劍閹爼宕曞ú顏勭婵鍩栭崑鍌炴煛閸ャ儱鐏柣鎾卞劜缁绘繈妫冨☉娆樻！闂佺懓鍚嬮崝娆撳蓟濞戞鐔哥瑹椤栨碍顔嶉梻渚€鈧偛鑻晶鍙夈亜椤愩埄妲搁悡銈嗙節婵犲倻澧曠紒鈧崒娑楃箚妞ゆ牗绻嶉崬铏圭磼鐠囧弶顥㈤柡宀€鍠栧鑽も偓鐢殿焾婵′粙姊洪崫鍕櫤缂侇喗鎸搁～蹇涘传閸曘劍鐎婚梺璇″瀻閸涱剙鎽嬫繝鐢靛仜閻°劎鍒掓惔銊ョ；闁规崘顕ф闂佸憡娲﹂崹浼村礃閳ь剙顪冮妶鍡楀Е婵犫懇鍋撳┑鐐茬焾娴滎亜顫忛搹鍦＜婵☆垵娅ｉ悷銊ヮ渻閵堝骸骞橀柛蹇斆锝嗙節濮橆厽娅滈梺鍛婄☉閸婂宕伴弽褏鏆︽い鎰剁畱缁€瀣亜閹惧崬鐏€规洘绮撳濠氬磼濞嗘帒鍘″銈庡幖閻楁捇寮崘顔芥櫇闁稿本纰嶉悗顒佺節閻㈤潧校闁煎綊绠栭幏鎴︽偄閸忚偐鍙嗛梺缁樻煥閹碱偄鐡梻浣虹帛閸旀洟鏁冮鍫濊摕闁哄洨鍠撶粻楣冩煕椤垵鏋涘┑顔肩埣濮婃椽骞栭悙娴嬪亾閺囥埄鏁勫鑸靛姇缁犳牗淇婇妶鍛殲闁哥姴妫濋弻娑㈠即閵娿儱顫銈忚礋閸旀垵顫忛搹鍦＜婵☆垳绮崕鎾剁磽娴ｈ櫣甯涚紒璇茬墦楠炲啯瀵奸幖顓熸櫔闂侀€炲苯澧撮柣娑卞櫍楠炴帒螖閳ь剟宕￠幎鑺ョ厪濠电偑鍊愰崑鎾绘煃閸濆嫭鍣洪柍閿嬪笒闇夐柨婵嗙墛椤忕娀鏌曢崱妤嬭含闁哄矉绻濆畷銊╊敊閸撗呭帨闂備線娼уΛ妤呭疮椤栨粍宕叉繝闈涱儏绾惧吋绻濇繝鍌氼仾妞ゆ梹娲熷缁樻媴缁涘缍堥梺绋挎唉婢瑰牓銆傛ィ鍐┾拺闂侇偆鍋涢懟顖涙櫠閸撗呯＜闁绘娅曞畷宀勬煟濞戝崬娅嶆鐐村笒铻栭柍褜鍓涚划缁樼節濮橆厾鍘垫俊顐︻暒閻掞箓藝妞嬪海纾?
        this.moveControl = this.createMoveControl();
        this.refreshMobilityProfileFromTier();
        // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缁炬儳娼￠弻锝夊閵忊晝鍔搁梺姹囧€楅崑鎾舵崲濠靛洨绡€闁稿本绮岄。娲⒑閹肩偛濡奸柛濠傛健瀵鏁愭径濠庢綂闂侀潧绻嗛弲婵嬪礉閸濄儳纾藉ù锝呮惈鏍￠梺鐓庣秺缁犳牠鍨鹃敃鍌氶敜婵°倓绀佸▓婵嬫⒒閸屾氨澧涚紒瀣灴閿濈偛顓兼径瀣ф嫼闂佺鍋愰崑娑㈠焵椤掍焦绀堥柍褜鍓氶惌顕€宕￠幎鐣屽祦闁告劦鐓堝銊╂煃瑜滈崜鐔肩嵁閸愩劉鏋庨柟鐐綑濞堟繂鈹戦悙鑼閻庣瑳鍥佸寰勯幇顓涙嫽婵炶揪缍侀ˉ鎾寸▔閼碱剛纾奸柣妯哄暱閻忔挳鏌熼鍝勫姕缂佽櫣鏅划娆撴嚄椤栨稒鍟哄┑鐘垫暩閸嬬偤宕归幆鏉跨稊闂備礁鎼鍛存煀閿濆钃熼柣鏃傗拡閺佸秵鎱ㄥΟ鍝勬倯闁汇倕娲︾换娑氣偓娑欘焽閻矂鏌涚€ｃ劌鈧繂鐣峰ú顏勭劦妞ゆ帊闄嶆禍婊堟煙閸濆嫭顥滃ù婊堢畺濮婅櫣鎷犻懠顒傤唹閻庡厜鍋撻柟闂寸缁犳牠鏌ㄩ悢鍝勑ｉ柡鍛倐閺岋絽螣閸濆嫮楠囬梺璇插瘨閸撶喖骞冨Δ鍛祦闁割煈鍠栨慨搴♀攽閻愰鍤嬬紒韫矙閸┿垺绂掔€ｅ灚鏅滈梺绯曞墲閻熝囨晬濠靛洨绠鹃弶鍫濆⒔缁夘喗绻涙担鍐叉处閸婅埖銇勮箛鎾跺闁绘挸鍟村娲垂椤曞懎鍓辩紓浣插亾闁逞屽墴濮婅櫣鈧湱濯鎰版煕閵娿儲鍋ユ鐐插暙閳诲酣骞嬮弬澶稿濠电偞鍨堕悷顖炴倿閻ｅ瞼纾奸悗锝庝簼閹兼劖銇勯鍕殻濠碘€崇埣瀹曞崬螖閸愌勬▕闂備浇顕х€涒晠宕欒ぐ鎺戠獥闁哄诞鍐偒闂傚倷绀佸﹢杈ㄦ櫠濡も偓椤灝顫滈埀顒勫蓟鐎ｎ喖鐐婃い鎺嶈兌閸樻悂姊洪幖鐐插姉闁哄懏鐩鎼佸籍閸喓鍘遍梺鍝勫€藉▔鏇熺濞戞氨纾肩紓浣诡焽閳洘绻涢悡搴ｇ鐎规洘绮忛ˇ瀵告偖閿斿墽纾介柛灞剧懅閸斿秹鏌涢悙宸吋婵﹣绮欏畷鐔碱敇閻樼數鏆ラ梻浣虹帛濮婂宕㈣閹偤宕归鐘辩盎闂佸湱鍎ら崹鐢割敂閳哄懏鐓?
        this.inventory.addListener(new ContainerListener() {
            @Override
            public void containerChanged(Container container) {
                checkTeleportModule();
            }
        });
    }

    private void checkTeleportModule() {
        if (this.level().isClientSide) return;
        int bestTeleportLevel = 0;
        int bestMultiShotLevel = 0;
        // 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴濐潟閳ь剙鍊块幐濠冪珶閳哄绉€规洏鍔戝鍫曞箣閻欏懐骞㈤梻鍌欑窔閳ь剛鍋涢懟顖涙櫠閹绢喗鐓涢悘鐐插⒔閵嗘帡鏌嶈閸撱劎绱為崱娑樼；闁告侗鍘鹃弳锔锯偓鍏夊亾闁告洦鍓涢崢鎼佹倵閸忓浜鹃柣搴秵閸撴盯鏁嶉悢鍝ョ閻庣數顭堥鎾斥攽閳ヨ櫕鍠樻鐐茬箻閹晝鎷犻懠顒夊斀闂備礁婀遍崕銈夊春閸繍鐒芥繛鎴欏灪閳锋垿鎮归崶褍绾ч柛鐐差槹閵囧嫰顢曢姀鈺傂﹂柣鎾卞€濋弻鈥愁吋鎼粹€崇闂佺瀛╅弻銊╁煘閹达箑纾兼慨姗嗗幖閺嗗牓姊虹粙鍧楊€楁い锔垮嵆婵＄敻宕熼鍓ф澑闂佽鍎抽顓㈠Χ閳轰讲鏀介柍鈺佸暙缁插鏌曢崼鐔稿€愮€殿喗妲掗ˇ褰掓煛娴ｇ鏆ｉ柛鈹惧亾濡炪倖甯掔€氼參鎮￠埀顒勬⒑閹稿海绠撴い锔诲灦閹?(5-9)
        for (int i = 5; i < 10; i++) {
            ItemStack stack = this.inventory.getItem(i);
            if (stack.getItem() instanceof GenericTurretModuleItem item) {
                String moduleId = item.getModuleId(stack);
                int level = item.getModuleLevel(stack);
                if ("teleport".equals(moduleId)) {
                    bestTeleportLevel = Math.max(bestTeleportLevel, level);
                } else if ("multi_shot".equals(moduleId)) {
                    bestMultiShotLevel = Math.max(bestMultiShotLevel, level);
                }
            } else if (stack.getItem() == ExampleMod.TELEPORT_UPGRADE_MODULE.get()) {
                bestTeleportLevel = Math.max(bestTeleportLevel, TeleportUpgradeItem.getLevel(stack));
            } else if (stack.getItem() == ExampleMod.MULTI_SHOT_UPGRADE_MODULE.get()) {
                bestMultiShotLevel = Math.max(bestMultiShotLevel, MultiShotUpgradeModuleItem.getLevel(stack));
            }
        }

        this.teleportModuleLevel = bestTeleportLevel;
        this.multiShotLevel = bestMultiShotLevel;
        boolean hasModule = bestTeleportLevel > 0;
        boolean current = this.hasTeleportModule();
        if (hasModule != current) {
            this.setHasTeleportModule(hasModule);
            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗霉閿濆浜ら柤鏉挎健濮婃椽顢楅埀顒傜矓閻㈢绠氶柣鎰惈缁犺绻涢敐搴″濠碘€炽偢閺屾稓浠︾拠鎻掝瀳闂傚洤顦甸弻锝呂熼悜妯锋灆闂佺楠哥换鎴炵┍婵犲浂鏁冮柨娑崇秵娴滎亝淇婇幘顔肩闁规惌鍘介崓鐢告⒑閹稿海绠撻柟鍐茬У缁旂喖寮撮悢铏圭槇缂佸墽澧楄摫妞ゎ偄锕弻娑氣偓锝庝簻椤忣厽顨ラ悙璇у伐妞ゎ偅绮撻崺鈧い鎺戝瀹撲線鏌″搴″幍濞存粌缍婇弻鐔兼倻濡偐鐣洪梺鍝勬噺缁诲牆顫忓ú顏勭閹艰揪绲块悾闈涒攽閳藉棗浜濈紒瀣墵婵?(婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾剧粯绻涢幋娆忕労闁轰礁顑嗛妵鍕箻鐠虹儤鐎鹃梺鍛婄懃缁绘﹢寮婚悢铏圭＜闁靛繒濮甸悘鍫㈢磽娴ｅ搫啸濠电偐鍋撳Δ鐘靛仦閻楁粓宕氶幒鏃€鍠嗛柛鏇炵仛缂嶅牓姊绘担钘変汗濠⒀勵殘閳ь剛鐟抽崶顬箓鏌涢弴銊ユ灓闁汇倐鍋撻梻浣告贡閸嬫捇骞嗙仦杞挎稖绠涘☉娆屾嫼缂備礁顑嗛娆撳磿閹扮増鐓欓柣鐔哄閸犳ɑ顨ラ悙鎻掓殻闁诡喗绮撻幊鐐哄Ψ瑜嶆慨娲⒒娴ｇ懓顕滈柡灞诲姀閵囨劙濡搁埡濠冩櫆闂佸憡娲栭悘姘扁偓闈涚焸濮婃椽妫冨☉姘暫闂佸摜鍣ラ崑濠傜暦濠靛棭娼╅柤鍝ユ暩閸欏棝姊洪崫鍕偍闁告柨顑夐弻鍥敍濠ф儳浜?
            if (hasModule) {
                this.playSound(SoundEvents.EXPERIENCE_ORB_PICKUP, 1.0f, 1.0f);
            }
        }
    }

    private int findFirstEmptyModuleSlot() {
        for (int i = 5; i < 10; i++) {
            if (this.inventory.getItem(i).isEmpty()) {
                return i;
            }
        }
        return -1;
    }

    // ==========================================
    // 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰鍐€妞ゆ劦婢€濞岊亪姊虹粙鍖″伐闁绘牕銈稿濠氭偄閾忓湱锛滈梺闈涚箳婵敻鎮樺澶嬧拺?3D 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缂佺姷濞€閺岀喖宕滆鐢盯鏌涙繝鍛厫闁逛究鍔岃灒闁圭娴烽妴鎰磽娴ｅ搫校濠㈢懓妫涘Σ鎰板箳閺傚搫浜鹃柨婵嗛楠炴鐥鐐靛煟闁哄矉绻濆畷閬嶅箛椤戣棄浜炬繝闈涱儏閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰閻楁挸顫忓ú顏勫窛濠电姴鍊搁～鍛存⒑缁嬫鍎愰柟绋垮⒔濡叉劙骞樼拠鑼紲濠电偛妫欓崺鍫澪ｉ纰辨富闁靛牆妫楅悘銉╂煟濡も偓濡繈宕洪姀銈呯睄闁割偅绻傚畵鍡涙⒑缂佹ɑ鐓ュ褍娴风划璇差潩閼哥鎷洪梺纭呭亹閸嬫盯宕濋幘顔界厱闁圭偓娼欓崫娲煙椤斿厜鍋撻弬銉︻潔濠碘槅鍨扮换鎰礊婵犲洤鏋侀柟鐗堟緲瀹告繃銇勯弮鍥棄闁告挸鐏氭穱濠囨倷椤忓嫧鍋撹缁辩偤鍩€椤掑嫭鐓曢悗锝庡亜婵秹鏌涢埞鎯т壕?(Phase 1)
    // ==========================================
    // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缂佺姷濞€閺岀喖宕滆鐢盯鏌涙繝鍛厫闁逛究鍔岃灒闁圭娴烽妴鎰磽娴ｅ搫校濠㈢懓妫涘Σ鎰板箳閺傚搫浜鹃柨婵嗛楠炴鐥鐐靛煟闁哄矉绻濆畷閬嶅箛椤戣棄浜炬繝闈涱儏閽冪喐绻涢幋娆忕仼缂佺姵鐩弻鏇熺節韫囨稒顎嶉梺缁樼箖濞叉鎹㈠☉姘ｅ亾濞戞顏勨枔閻樼粯鐓曞┑鐘插暟婢ч亶鏌熼獮鍨仼闁宠棄顦垫慨鈧柣妯活問閸氬懘姊绘担绛嬪殭缂佺粯鍨甸—鍐箰鎼达綆娲稿銈呯箰閻楀嫰鍩€椤戣法顦﹂柍璇查叄楠炲洭顢欓崜褎顫岄梻鍌欑劍閹爼宕曢鐐茬閹兼番鍔岄惌?.0 (闂? -> 1.0 (闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑鏅悷婊冪Ч濠€渚€姊虹紒妯虹伇婵☆偄瀚划濠氭偐缂佹鍘甸梺纭咁潐閸旓箓宕靛▎鎾村€垫慨姗嗗墻濡插綊鏌曢崶褍顏鐐村浮楠炲鈹戦幇顏呭亝闂?
    private static final EntityDataAccessor<Float> PRINT_PROGRESS = SynchedEntityData.defineId(SkeletonTurret.class, EntityDataSerializers.FLOAT);

    // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缂佺姷濞€閺岀喖宕滆鐢盯鏌涙繝鍛厫闁逛究鍔岃灒闁圭娴烽妴鎰磽娴ｅ搫校濠㈢懓妫涘Σ鎰板箳閺傚搫浜鹃柨婵嗛楠炴鐥鐐靛煟闁哄矉绻濆畷閬嶅箛椤戣棄浜炬繝闈涱儏閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忛搹鍦煓婵炲棙鍎抽崜閬嶆⒑閸涘﹥鈷愰柣鐔叉櫅椤曪絾绻濆顑┭冾熆鐠虹尨姊楃紒鍗炵埣濮婃椽妫冨☉杈ㄢ枔闂佸摜濮甸〃鍛邦暰閻庡厜鍋撻柛鏇ㄥ厴閹疯櫣绱撴担鍓插剱妞ゆ垶鐟╁畷鏇㈠箛閻楀牏鍘电紓浣割儐椤戞瑩鎮￠崗纰辨闁绘劘灏欑粻鑽も偓瑙勬磸閸旀垿銆佸☉妯锋婵☆垵宕甸埀顒夊弮濮婄粯鎷呴崨濠傛殘濠电偠顕滅粻鎾崇暦閵忋倕绠氭い顒夊枟鐢繝寮幇顓炵窞閻庯急鍕伜?=濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣銏犲閺佸﹪鏌″搴″箹缂佹劖顨嗘穱濠囧Χ閸涱厽娈查悗瑙勬礃閻擄繝寮婚悢鍏肩劷闁挎洍鍋撻柡瀣〒缁辨帡鐓幓鎺嗗亾閺囥垺绠掗梻浣虹帛閿氭俊顖氾躬瀹曟洟骞囬悧鍫㈠幈? 1=闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缂佺姷濞€閺岀喖宕滆鐢盯鏌涙繝鍛厫闁逛究鍔岃灒闁圭娴烽妴鎰磽娴ｅ搫校濠㈢懓妫涘Σ鎰板箳閺傚搫浜鹃柨婵嗛楠炴鐥鐐靛煟闁哄矉绻濆畷閬嶅箛椤戣棄浜炬繝闈涱儏閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫? 2=闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゎ剦鍓氶惄顖氱暦閻旂⒈鏁嶆慨妯块哺閻掔偓淇婇悙顏勨偓鏍偋濡ゅ啫鍨濈€广儱鎳愰弳锕傛煛鐏炶鍔滈柣鎾存礈閳ь剙鍘滈崑鎾绘煃瑜滈崜鐔风暦閹达附鍊烽柛婵嗗閿涚喖姊洪悷鏉库挃缂侇噮鍨堕幃锟犲即閵忥紕鍘撻梺瀹犳〃缁€渚€寮搁妶鍡欑闁割偅绋戦悘顏嗙磼缂佹娲寸€规洘顨婇幃鈩冩償椤旂瓔妫嗙紓鍌氬€峰ù鍥ㄣ仈閹间礁绠板┑鐘宠壘缁狀垶鏌涘☉妯兼憼闁搞倕鍟撮弻宥夊煛娴ｅ憡娈梺璇茬箚閺呯娀寮? 3=闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亜顒㈡い鎰矙閺屻劑鎮㈤崫鍕戙垻鐥幆褜鐓奸柡灞剧洴瀵挳濡搁妷銏犱壕闁绘ɑ绁村Σ鍫熶繆椤栨稓鐭嬫俊顐㈠暙閻ｇ兘濡搁埡濠冩櫍闂佺粯锚閻忔艾袙閸パ€鏀介柣妯虹仛閺嗏晛鈹戦鑺ュ唉闁轰礁鍟存俊鑸靛緞鐎ｎ亙缃曢梻浣虹《閸撴繄绮欓幒妤€纾圭€瑰嫭澹嬮弨浠嬫煟濡搫绾у璺哄閺岋綁骞樼捄鐑樼亪闂佸搫鐬奸崰鏍蓟閸ヮ剚鏅濋柍褜鍓氶弲鑸靛鐎涙鍘甸梺浼欑到閼活垶鍩㈤崼銉︾厸?
    private static final EntityDataAccessor<Integer> PRINT_STATE = SynchedEntityData.defineId(SkeletonTurret.class, EntityDataSerializers.INT);



    @Override
    protected void defineSynchedData() {
        super.defineSynchedData();
        this.entityData.define(TIER, 0);
        // RANGE_LEVEL removed

        this.entityData.define(FOLLOW_MODE, false);
        this.entityData.define(IS_FOLLOWING, false);
        this.entityData.define(KILL_COUNT, 0);

        this.entityData.define(IS_BRUTAL, false);
        this.entityData.define(UPGRADE_PROGRESS, 0);
        this.entityData.define(IS_CAPTAIN, false);
        this.entityData.define(IS_SQUAD_MEMBER, false);
        this.entityData.define(OWNER_UUID_SYNC, Optional.empty());
        this.entityData.define(IS_PURGE_ACTIVE, false);
        this.entityData.define(IS_SCAVENGING, false);
        this.entityData.define(UNIT_ID, 0);
        this.entityData.define(DEATH_PLAQUE_FATAL_HIT_COUNT, 0);
        this.entityData.define(SYNC_BASE_NAME, DEFAULT_BASE_NAME_TOKEN);
        this.entityData.define(PRINT_PROGRESS, 0.0f);
        this.entityData.define(PRINT_STATE, 0);
        this.entityData.define(DATA_HEAT, 0);
        this.entityData.define(DATA_STATUS_OVERLAY, "");
        // DATA_LEVEL removed
        this.entityData.define(DATA_XP, 0);
        this.entityData.define(HAS_TELEPORT_MODULE, false);

    }



    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱樈閸犳顕欏ú顏呪拺缂侇垱娲栨晶鍙夈亜閵娿儲鍤囬柨婵堝仱閸╋繝宕橀鍡闯濠电偠鎻徊鍧楁偤閺冨牆鑸归柧蹇撴贡绾惧ジ鏌ら幖浣规锭闁告繆娅ｉ埀顒侇問閸犳盯顢氳閸┿儲寰勯幇顒夋綂闂佺粯蓱椤旀牠宕ú顏呪拻濞达絽鎲￠幆鍫熺箾鐏炲倸濮傜€规洘鍨块幃銏ゆ偂鎼粹€充憾婵＄偑鍊栭崝褔姊介崟顖涘亗闁绘梻鍘х粻褰掓煙绾板崬骞栭柣蹇ョ悼閳ь剙鍘滈崑鎾寸箾閹存瑥鐏柣鎾存礋閹鏁愭惔鈥茬凹閻庤娲栭張顒勫箞閵婏妇绡€闁告劏鏂傛禒銏ゆ⒑绾懏鐝紒璇茬墕椤曪綁宕奸弴鐐垫焾闂佸憡鍔忛弲婊冪暦瀹€鍕厵妞ゆ棁宕甸惌娆愩亜閵忥紕鈽夐柍钘夘槹濞煎繘濡歌濮ｅ矂姊婚崒娆戭槮闁硅姤绮撳畷鎶藉Ψ閳轰礁鐎梺鍓插亝濞叉牜绮婚弽銊ょ箚闁靛牆鍊告禍楣冩⒑瀹曞洨甯涢柟鐟版搐閻ｇ柉銇愰幒婵囨櫓闂佷紮绲芥總鏃堟焽椤栨粎纾介柛灞捐壘閳ь剛鍏橀幊妤呭礈娴ｇ鐏婂銈嗙墬缁秹寮冲鍕箚闁靛牆鎳忛崳鍦磼閻橀潧浠遍柡灞炬礃缁绘盯鎮欓浣哄絽缂傚倷鑳舵慨鐑藉箠閹剧粯绠掗梻浣瑰缁诲倿鎮у鍐剧劷闁归偊鍘剧粻?

    public void setCommandScavenging(boolean scavenging) {
        this.entityData.set(IS_SCAVENGING, scavenging); // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑鏅悷婊冪箻閸┾偓妞ゆ帊鑳堕埢鎾绘煛閸涱喚绠橀柛鎺撳笒閳诲酣骞樺畷鍥跺敽婵犲痉鏉库偓鎾绘倿閿曗偓閳诲秹寮崼鐔叉嫽闂佺鏈悷褔藝閿曞倹鐓欓悹鍥囧懐鐦堥梺璇″枤閸忔ɑ淇婇悜钘壩ㄩ幖娣灮閳藉鏌嶇憴鍕伌鐎规洖宕埢搴ㄥ箛椤撗冩櫗闂傚倸鍊风欢姘焽瑜旈弫宥堢疀濞戞锛滃┑鐐村灦閿氭い搴＄箳缁辨捇宕掑顑藉亾閹间礁纾归柣鎴ｅГ閳锋梻鈧箍鍎遍ˇ顖炲垂閸岀偞鍋℃繛鍡楃箰椤徰呯磼鐠囧弶顥㈡慨濠冩そ椤㈡鍩€椤掑倻鐭撻柣銏㈩焾閻撴洟鏌熸潏鍓х暠缂佺嫏鍥ㄧ厽闁归偊鍘界紞鎴炪亜鎼淬垻鐭掗柡灞剧缁犳盯骞橀悷閭︿純婵＄偑鍊ら崣鈧柛搴☆煼钘濋柧蹇ｅ亖娴滄粓鏌曟繛鍨姕闁搞倕娲弻?
        if (scavenging) {
            this.playSound(SoundEvents.UI_BUTTON_CLICK.get(), 1.0f, 1.0f);
        }
    }

    public boolean isCommandScavenging() {
        return this.entityData.get(IS_SCAVENGING);
    }

    // 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰鍐€妞ゆ劦婢€缁爼姊?2. 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕閻庤娲忛崕鎶藉焵椤掑﹦绉甸柛鐘崇墱婢规洟宕稿Δ浣哄幍闂佽鍨虫晶妤吽夋径鎰闁哄鍩婇煬顒勬煛鐏炶鈧繈骞婂┑瀣妞ゆ棁鍋愭晶顖氣攽閻愯尙鎽犵紒顔肩灱缁辩偞绻濋崶褑鎽曞┑鐐村灟閸ㄧ懓鏁俊鐐€栧Λ浣哥暦閻㈢姹叉俊銈勮兌缁犻箖鎮楀☉娆樼劷闁活厼锕︾槐鎾愁吋閸滃啳鍚悗娈垮枛椤兘骞冮姀銈嗗亗閹艰揪绲块弳浼存煟閻斿摜鐭婄紒澶屾嚀椤曪綁鎼归锝囩Ф闂侀潧顭徊鑲╄姳婵犳碍鈷戦梻鍫熺〒婢ф洟鏌熼崘鑼鐎规洘濞婂畷顐﹀礋閸曨偊鍙勭€规洘鍎奸¨鍌炴椤掑澧柕鍥у婵偓闁挎稑瀚уΣ鍫濐渻閵堝簼绨婚柛鐔跺嵆楠炲繘鎮╅懡銈呭絼濡炪倖鎸鹃崕鎰涘鍫熲拺閻犲洤寮堕崬澶嬨亜椤愩埄妲搁悡銈夋煛瀹ュ海浜规繛宸簻鎯熼梺宕囨嚀缁ㄩ亶宕?(true=闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箻閺岀喖顢涢崱蹇撲壕闂佸搫顑呯粔褰掑蓟閵娿儮鏀介柛鈾€鏅滅瑧缂傚倷鐒﹂崝鏍€冩繝鍥ц摕闁炽儱纾弳銈嗐亜閺冨倹鍤€濞存粓绠栧? false=闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑鏅悷婊冪Ч濠€渚€姊虹紒妯虹伇婵☆偄瀚划濠氭偐缂佹鍘甸梺鍛婃寙閸涱厾顐奸梻浣侯焾椤戝懘顢栨径鎰摕婵炴垯鍨归悞娲煕閹邦喖浜鹃柣锝呫偢濮?
    public boolean isFollowMode() {
        return this.entityData.get(FOLLOW_MODE);
    }

    // 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰鍐€妞ゆ劦婢€缁爼姊?3. 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎺嶇劍椤斿洭姊绘担鍛婅础闁稿簺鍊濆畷闈涱潩椤戠偞妞介、鏃堝川椤旂晫褰囬梻鍌欑窔閳ь剛鍋涢懟顖涙櫠閹绢喗鐓欐い鏇楀亾缂佺姵鐗犻獮鍐煥閸喎鐧勬繝銏ｆ硾閻牓宕禒瀣拻濞达絿鍎ら崵鈧紓浣哄Т缁夌懓鐣峰┑鍥ㄥ劅闁靛鍎抽悰銉╂⒑閸濆嫮鈻夐柛妯恒偢瀹曞綊宕掗悙瀵稿幍濡炪倖鐗曞Λ妤呭箠韫囨挴鏋斿Δ锝呭暞閳锋垿鏌熼懖鈺佷粶闁告梹顨婇弻锟犲川椤忓懏鐝氶悗?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弴鐐测偓褰掑磿閹寸姵鍠愰柣妤€鐗嗙粭鎺楁煕閵娿儱鈧潡寮诲☉婊呯杸闁哄洢鍔岄崝鍡樼箾鐎电孝闁绘鎹囧濠氭偄閸忓皷鎷婚柣搴ㄦ涧婢瑰﹤危椤斿皷鏀芥い鏃€顑欏鎰版煟閹垮嫮绡€鐎殿喖顭烽弫鎰緞婵犲嫮娼夐梻浣侯焾閺堫剟鎳濋悙顒傤浄婵☆垵鍋愮壕钘壝归敐鍛儓鐎涙繈鎮楀▓鍨灈闁绘牕鍚嬫穱濠囨偨缁嬭法顦板銈嗙墬濮樸劑鎯堥崟顖涒拺缂佸瀵у﹢浼存煠閸︻厼浜剧紒鍌涘笒椤粓鍩€椤掆偓椤繘鎮滃Ο渚殼濠电偛妫欓崹褰掑汲閻樼粯鈷戠紓浣诡焽婢ь亪鏌曢崼鐔稿€愰柣娑卞櫍瀹曟﹢顢欓崗鐓庣ザ婵＄偑鍊栭幐鑽ょ矙閹寸偟顩插Δ锝呭暞閻撱儲绻濋棃娑欘棤闁告垵婀辩槐鎺楀Ω閵夘喚鍚嬮梺鍝勭焿缁绘繂鐣烽崡鐐╂瀻闊洦姊绘禍顏堟⒒?
    public void setFollowMode(boolean shouldFollow) {
        // Follow mode is authoritative; keep AI/state/UI flags fully synchronized.
        boolean wasFollowing = this.entityData.get(FOLLOW_MODE);
        boolean changed = this.entityData.get(FOLLOW_MODE) != shouldFollow
                || this.entityData.get(IS_FOLLOWING) != shouldFollow;
        this.entityData.set(FOLLOW_MODE, shouldFollow);
        this.entityData.set(IS_FOLLOWING, shouldFollow);
        refreshModeBuffs();

        // Guard mode should clear movement immediately to prevent stale behavior.
        if (!shouldFollow) {
            this.getNavigation().stop();
            this.setDeltaMovement(0.0, 0.0, 0.0);
        } else if (!wasFollowing) {
            this.getNavigation().stop();
            this.setTarget(null);
            this.setDeltaMovement(0.0, 0.0, 0.0);
            this.hurtMarked = true;
        }

        // Overhead squad badge visibility is tied to follow state.
        if (changed && !this.level().isClientSide) {
            updateCustomName();
            LivingEntity owner = this.getOwner();
            if (owner instanceof Player player) {
                if (shouldFollow) {
                    player.displayClientMessage(
                            Component.translatable("message.examplemod.mode.follow_active").withStyle(ChatFormatting.GREEN),
                            true
                    );
                } else {
                    player.displayClientMessage(
                            Component.translatable("message.examplemod.mode.guard_active").withStyle(ChatFormatting.GOLD),
                            true
                    );
                }
            }
        }
    }

    private void refreshModeBuffs() {
        var speedAttr = this.getAttribute(Attributes.MOVEMENT_SPEED);
        if (speedAttr == null) return;
        speedAttr.removeModifier(FOLLOW_SPEED_BOOST_UUID);
        if (this.entityData.get(IS_FOLLOWING)) {
            speedAttr.addTransientModifier(new net.minecraft.world.entity.ai.attributes.AttributeModifier(
                    FOLLOW_SPEED_BOOST_UUID,
                    "Follow mode speed boost",
                    FOLLOW_SPEED_BOOST_MULTIPLIER,
                    net.minecraft.world.entity.ai.attributes.AttributeModifier.Operation.MULTIPLY_TOTAL
            ));
        }
    }

    public static AttributeSupplier.Builder createAttributes() {
        return Monster.createMonsterAttributes()
                .add(Attributes.MAX_HEALTH, 20.0)
                .add(Attributes.MOVEMENT_SPEED, 0.3)
                .add(Attributes.KNOCKBACK_RESISTANCE, 1.0)
                .add(Attributes.ATTACK_DAMAGE, 1.0)
                .add(Attributes.ATTACK_SPEED, 1.0) // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱樈閸犳顕欏ú顏呪拺缂侇垱娲栨晶鍙夈亜閵娿儲鍤囬柨婵堝仱椤㈡洟鏁傜憴锝嗗闂備礁鎲＄缓鍧楀磿鏉堛劎顩插┑鍌氭啞閻撴洟鏌￠崒姘仴闁告瑥瀚伴弻鐔碱敍濡も偓娴滅偓淇婇悙顏勨偓鏇犳崲閹扮増鍋嬫繝濠傜墕閺嬩線鏌涢妷锝呭缂佺娀绠栭弻鐔衡偓鐢告櫜缁辨娊鏌涜箛姘汗闁绘繂鐖奸弻锟犲炊閵夈儳浠鹃梺鎶芥敱鐢帡婀侀梺鎸庣箓閹峰顭囬悢鍏肩厓鐟滄粓宕楀鈧畷鎴﹀箻缂佹ǚ鎷虹紓浣割儐椤戞瑩宕曢幇鐗堢厵闁告稑锕ラ崐鎰版煕閳哄啫浠辨鐐差儔閺佸倿鎸婃径澶嬬潖闂傚倷绀侀幉锟犲礉濡棿鐒婃繛鍡樻尭缁€澶娒归悡搴ｆ憼闁抽攱鍨圭槐鎺斺偓锝庡亽閸庛儵鏌涙惔銏犲闁哄瞼鍠栭幃鐑芥偋閸繃鐏庢俊銈囧Х閸嬫盯宕€涙ɑ鍙忛柍褜鍓熼弻宥夋寠婢跺妫￠柡浣哥墦濮婃椽鎮烽弶鎸庡€梺浼欑秵娴滎亜鐣烽崷顓熷枂闁告洦鍓氶悵鐑芥⒑闂堟稓澧曟い锔垮嵆閸?(婵犵數濮烽弫鍛婃叏閻㈠壊鏁婇柡宥庡幖缁愭淇婇妶鍛殲闁哄棙绮嶆穱濠囧Χ閸涱厽娈堕梺娲诲幗閻熲晠寮婚悢鍏煎€绘俊顖炴櫜缁爼姊洪柅鐐茶嫰婢у墽绱掗悩铏碍闁伙綁鏀辩缓鐣岀矙鐠囦勘鍔嶉妵鍕籍閸ヮ灝鎾寸箾閸涱厾孝闁宠鍨块幃鈺呭垂椤愶絾鐦庡┑鐘愁問閸犳岸寮幖浣哥獥濠电姴鍋嗛崥瀣熆鐠虹尨鍔熼柡?.0闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弮鍫熸殰闁稿鎸剧划顓炩槈濡娅ч梺娲诲幗閻熲晠寮婚悢鍛婄秶濡わ絽鍟宥夋⒑閹肩偛鈧牠宕濋弽顓炍﹂柛鏇ㄥ灠閸愨偓闂侀潧顭俊鍥р枔閵堝鈷戦柛婵嗗椤ユ捇鏌涙繝鍐疄鐎殿喛顕ч埥澶愬閻橀潧濮堕梻浣告啞閸旀宕戦幘娲绘晣闁荤喐澹嬮弨浠嬫煟閹邦喖鍔嬮柨娑氬枛閺屾稑螖娴ｇ硶鏋欓悗娈垮枛椤攱淇婇幖浣肝ㄩ柕蹇婂墲閺夋悂姊绘担铏广€婇柛鎾寸箞閺佸鈹戦悙鍙夊暁闁搞儯鍔夐幏铏圭磽娓氬洤鐏℃繛鍙壝埢宥夊幢濡晲绨婚梺闈涱焾閸庡鐓鍌楀亾濞堝灝鏋︽い鏇嗗洤鐓″璺号堥弸搴ㄦ煙鐎电啸婵℃彃娲缁樻媴娓氼垳鍔搁梺鍝勭墱閸撴盯鎳炴潏銊ь浄閻庯綆鈧厞鍥ㄧ厱闁靛鍨抽崚鏉棵?
                // Step-height boost avoids stair/slab bunny-hopping and allows clean 1-block walk-up.
                .add(net.minecraftforge.common.ForgeMod.STEP_HEIGHT_ADDITION.get(), TurretMobilityProfile.SCOUT_BOT.stepHeight())
                .add(Attributes.JUMP_STRENGTH, TurretMobilityProfile.SCOUT_BOT.jumpStrength())
                .add(Attributes.FOLLOW_RANGE, 256.0); // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱樈閸犳顕欏ú顏呪拺缂侇垱娲栨晶鍙夈亜閵娿儲鍣界紒顔芥閵囨劙骞掗幘璺哄箥婵＄偑鍊栭悧妤冨垝瀹€鍕嚑婵炴垯鍨洪悡娑氣偓鍏夊亾閻庯綆鍓涜摫闂備浇顕栭崹閬嶅蓟閵娾晛鐓橀柟杈剧畱闁卞洦銇勯顐㈠濞寸媭鍘界换婵嬫偨闂堟刀鐐烘煕閵娿儺鐓兼鐐诧躬楠炴绱掑Ο杞扮綍闂備浇顫夐崕宕囧椤撱垹姹查柨鏃傛櫕缁犲墽鈧懓澹婇崰鏇犺姳閼姐倐鍋撻悷鐗堝暈缂佽鍟存俊鐢稿礋椤栨艾鍞ㄩ梺闈浤涢埀顒€危閸儲鈷戦柛婵嗗閸庡繘鏌涙繝鍌滀虎妞ゎ偄绻橀幖褰掓偡閺夋鍤欓梻浣告惈濞层劑宕戝☉銏犵厱濠㈣泛鐬肩壕钘壝归敐鍛棌闁稿孩鍔欓弻娑㈠Ω瑜庨弳顒勬煕閳瑰灝鐏╂い鎾冲悑瀵板嫮鈧綆鍋呴悵鍐测攽閻橆喖鐏辨繛澶嬬洴椤㈡牠宕堕鈧崒銊╂煟閵忋垺鏆╃痪鎯с偢閺屾盯骞樺Δ鈧崰姘跺汲椤撱垺鐓㈤柛鎰靛弮閸濊櫣绱掔紒妯兼创鐎规洏鍔戦、姗€鎮㈤柨瀣毈闂傚倷绀侀幖顐﹀嫉椤掆偓鐓ら柣鏃堫棑閺嗭箓鏌熼鐐蹭喊婵℃彃銈稿娲传閵夈儛锝夋煥閺囨ê鐏茬€?256 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犖ч柛銉㈡櫇閸樼娀姊绘担绋款棌闁稿鎳庣叅闁哄稁鍓涚粻浠嬫⒒娴ｇ瓔鍤欓柛鎴犳櫕缁辩偤宕卞☉妯碱槶濠殿喗顭堥鎰礊?
    }


    @Override
    protected net.minecraft.world.entity.ai.navigation.PathNavigation createNavigation(Level level) {
        // Replace vanilla navigator with smart gap-aware navigation.
        return new SmartGroundPathNavigation(this, level, this::getMobilityProfile);
    }

    protected net.minecraft.world.entity.ai.control.MoveControl createMoveControl() {
        // 1.20.1 has no createMoveControl override in Mob; constructor injects this control.
        return new SmartMoveControl(this, this::getMobilityProfile);
    }


    @Override
    @Nullable
    public SpawnGroupData finalizeSpawn(ServerLevelAccessor level, DifficultyInstance difficulty, MobSpawnType reason, @Nullable SpawnGroupData spawnData, @Nullable CompoundTag dataTag) {
        SpawnGroupData result = super.finalizeSpawn(level, difficulty, reason, spawnData, dataTag);
        this.updateStatsAndEquip();
        this.checkTeleportModule();
        // 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰鍐€妞ゆ劦婢€缁爼姊?闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箳閳ь剝顫夊ú鏍洪妸鈺傚剹闁糕剝顦鸿ぐ鎺撴櫜闁告粈鐒︾紞妤佺箾鐎涙鐭婄紓宥咃躬瀵鏁愭径濠勭杸濡炪倖甯掗崐椋庡垝閻㈠憡鐓熼幖娣灱婢规ɑ銇勯鐘插幋鐎殿喖顭烽弫鎰緞婵犲嫮娼夐梻浣侯焾閺堫剟鎳濋悙顒傤浄婵☆垵鍋愮壕钘壝归敐鍛儓鐞氥劑姊虹粙鎸庢崳闁轰浇顕ч锝嗙節濮橆厼浜滈梺缁樻尭濞寸兘鎮炬ィ鍐╁仭婵犲﹤鍟版晥閻庢鍠涘▍鏇烆焽韫囨稑鐓涢柛鎰典悍缁辨彃鈹戦悙瀛樺鞍闁艰鍎崇叅闁挎繂顦伴悞鑺ャ亜閺嶎偄浠﹂柣鎾寸〒閳ь剙鍘滈崑鎾绘倵閿濆骸澧柛鈺佺焸閺屟勫濞嗘垹袦闂佸搫鏈惄顖炲灳閿曞倸绠ｆ繝闈涙川娴滈箖姊绘担鍛婂暈闁挎洍鏅犲畷鎴炵節閸屻倖缍庡┑鐐叉▕娴滄繈鎮炴繝姘厽闁归偊鍨伴拕濂告倵濮橆偄宓嗛柡灞剧☉铻ｉ柣鎴炆戦崰鎰磽娴ｄ粙鍝洪悽顖ょ節閹繝顢楅崟顐ゎ唽闂佺懓鎼Λ妤佺閻愵兛绻嗛柕鍫濆€告禍楣冩煕濡ゅ懍鎲鹃柡宀€鍠栭弻鍥晝閳ь剟宕㈤幘顔界厸闁逞屽墯缁傛帞鈧綆鍋嗛崢閬嶆⒑闂堟侗妾х紒鑼跺Г娣囧﹪鎮滃Ο璇插伎濠殿喗顨呴悧蹇涙偩闁秵鐓冮悷娆忓閻忔挳鏌熼鐣屾噰鐎殿喖鐖奸獮瀣偐鏉堫煈鏁囬梻鍌氬€烽悞锔锯偓绗涘懎鏋堢€广儱顦闂佸憡娲﹂崹鏉课涘鈧弻娑㈠冀閵堝倸浜鹃柛鎰▕濞碱剟姊婚崒娆掑厡闁硅櫕鎸搁锝夊醇閺囩偟鐣洪梺绋跨灱閸嬫稓绮婚弽顐ｅ枑闁哄倽娉曢弳锕傛煟閹惧磭宀搁柡鈧禒瀣厱闁靛鍠曠花鑺ヤ繆娣囧崬濡奸柍?
        setPrintState(1);
        this.entityData.set(PRINT_PROGRESS, 0.0f);
        this.spawnX = this.getX();
        this.spawnY = this.getY();
        this.spawnZ = this.getZ();
        return result;
    }
    // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛濠傛健閺屻劑寮村鑸殿€栨繛瀛樼矊缂嶅﹪寮诲☉銏犵疀闁稿繐鎽滈弫鏍⒑濞茶骞楅柟鐟版喘瀵鎮㈤搹鍦紲闂侀潧绻掓慨鐢告倶閸儲鈷戞慨鐟版搐閳ь兙鍊濆畷鎶芥晲婢跺﹨鎽曢梺缁樻⒒閸樠呯不濮樿鲸鍠愰煫鍥ㄧ☉缁犳椽鏌ｅΟ娆炬⒖闁荤喐澹嬮弨锕傛煕椤垵鏋撻柛瀣崌瀵粙顢曢敐鍛哎婵犵數濞€濞佳兠洪妸褍濮柍褜鍓熷铏圭矙閹稿孩鎷辩紓浣割儐閸ㄧ敻鍩㈠鍛斀閻庯綆鍋€閹锋椽姊洪崨濠勭畵閻庢凹鍨堕敐鐐烘晝閸屾稓鍘辨繝鐢靛Т閸熸壆绮婚悙纰樺亾濞堝灝鏋涙い顓犲厴瀵偊骞樼紒妯轰汗闂佽偐鈷堥崜娆愭叏閿旀垝绻嗛柣鎰典簻閳ь剚鐗滈弫顕€骞掑Δ鈧壕褰掓煕閿旇骞愰柛瀣尭椤繈顢橀悙鍙夋嚈闂備礁鎼惉濂稿窗閹捐埖顫曢柟鐑樺殾閻斿吋鎯為柛锔诲幗閸ゅ啴姊婚崒娆愵樂缂侀硸鍣ｅ浠嬪礋椤栨稑浜遍梺缁樏Ο濠傤焽閺嶃劎绠剧€瑰壊鍠曠花璇裁归懖鈺佲枅闁哄本鐩鎾Ω閵夈倗鐖遍梻浣侯焾椤戝棝骞愰懡銈囩焿闁圭儤鏌￠崑鎾绘晲閸涱収鏆㈢紓浣割儏缁绘垹鎹㈠┑瀣潊闁挎繂妫涢妴鎰版⒑閸濆嫮澧遍柛鎾跺枎閻ｅ嘲螖閳ь剟鈥﹂妸鈺侀唶闁绘柨鎼獮鍫熶繆閻愵亜鈧牠宕濊瀵板﹪宕滆閻棝鏌涢幇闈涙灍闁绘挻鐩弻娑橆煥閳ь剛绮堟担瑙勬珷濞寸厧鐡ㄩ悡鍐喐濠婂牆绀堟繛鍡樻尭閸屻劍绻濇繝鍌滃缁炬儳顭烽弻鐔煎礈瑜忕敮娑㈡煟閹惧瓨绀嬮柡宀€鍠栭弻鍥晝閳ь剟鐛弽顓熺厱闁哄倽顕ч埀顒佺箞瀵鍩勯崘鈺侇€撻梺鍛婄缚閸庤櫕顨欓梻鍌欐祰椤曟牠宕伴弽顓炲簥闁哄被鍎埀顒婄畵婵℃悂鍩℃担鍝ョ崺婵＄偑鍊栭幐鍡涘礋椤掑倹顫濆┑鐘垫暩婵兘寮幖浣哥；婵炴垶锕╅崵鏇㈡煕椤愶絾绀冮柛瀣儔閺岋絽螣濞嗘儳娈紓浣哄У瀹€鎼佸蓟濞戙垹绠涢梻鍫熺⊕閻忓秹姊虹粙娆惧剱闁告梹鐟╅獮鍐亹閹烘垹鍊炲銈呯箰鐎氼喖袙閵忕媭娓婚柕鍫濈箺閸氬倿鏌￠崨顔剧畼婵″弶鍔欓獮妯兼嫚閼碱剨绱叉繝鐢靛仜濡瑩宕归崹顐＄箚濞寸姴顑嗛埛鎴︽煙缁嬪灝顒㈢痪鍓ф暬閺岋繝宕ㄩ姣裤垽鏌ｉ敐鍥у幋妤犵偛顑夐弫鎰償閳垛晜鐎搁梻?
    @Override
    public void performRangedAttack(LivingEntity target, float distanceFactor) {
        // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎺嶇劍椤斿洭姊绘担铏瑰笡闁告梹娲熼、姘额敇閻樺吀绗夋俊銈忕到閸燁垶鎮￠崘顏呭枑婵犲﹤鐗嗙粈鍫熸叏濡潡鍝虹€规洖寮剁换娑㈠箣濞嗗繒浠奸悗鐟版啞缁诲啴濡甸崟顖氱閻犲搫鎼竟澶愭⒑閸涘﹥鐓ユい锔诲灦閸╃偤骞嬮敂钘夆偓鐑芥偣鏉炴媽顒熸俊顐㈢墕椤啴濡堕崱妯垮亖闂佹悶鍎滈崨顓炵闂備胶鎳撻崥瀣偩椤忓牆绀夌€光偓閳ь剛鍒掓繝姘優妞ゆ劑鍊楅惁鍫ユ⒒閸屾氨澧涚紒瀣笚瀵板嫰宕熼娑氬幐婵犮垼娉涢鍡涘磹閹邦厽鍙忓┑鐘插鐢盯鏌熷畡鐗堝殗闁诡喚鍏橀弻鍥晝閳ь剙鈻撳┑鍫㈢＝闁稿本鐟чˇ锔姐亜閹存繃顥犻柡渚囧櫍閺佹捇鎮╅鐟颁壕濞达綀鍊介弮鍫濆窛妞ゆ棃妫块崠鏍磽閸屾瑦绁版繛澶嬬洴閹澘銆?performRangedAttack(target, distanceFactor);
        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愭い鎰枎娴滈箖鏌ㄩ弴鐐测偓鎼佹倷婵犲啨浜滈柟鍝勬娴滃墽绱撴担鐟板妞ゃ劌锕濠氭偄閻撳海鐣鹃悷婊冪箻楠炴鎮╁畷鍥╊啎闂佸憡渚楅崹鐗堢墡濠电儑绲藉ú銈夋晝椤忓懍绻嗛柛顐ｆ礀瀹告繃銇勯弬鍨倯妞ゅ繒濮电换婵堝枈濡椿娼戦梺绋款儏閹虫﹢寮崘顔碱潊闁靛牆鎳愰悾娲倵閻熸澘顏鐟邦儔瀵憡鎯旈妸褍褰勯梺鎼炲劘閸斿秹骞嗛崟顐€鍦焊閺嵮傚闂傚倸鍊搁崐椋庢濮橆剦鐒界憸宥堢亱濠德板€曢幊蹇涘疾濠靛洢浜滈煫鍥ㄦ尵婢ф洜绱掗悩宕囧濞ｅ洤锕、娑樷攽閸モ斂鈧﹪姊哄Ч鍥р偓鎰板磻閹剧粯鈷掑ù锝呮啞鐠愶繝鏌涚€ｎ偅宕岀€规洘绮岄～婵嬵敇閻欌偓濞村嫭绻濋棃娑樷偓鎼佸箟閿熺姴鐓曢柟杈鹃檮閻撴瑩鏌ゅù瀣珔濞寸姵绮撻弻宥堫檨闁稿繑鐟╁畷鎰攽閸℃瑦娈鹃梺鎸庣箓椤︻垳绮堥崘鈹夸簻闁哄啫娲ゆ禍褰掓煟閿濆鐣烘慨濠冩そ瀹曘劍绻濋崒姣挎洟姊洪崫銉バｉ柣妤佺矌閸掓帡宕奸埗鈺佷壕闁挎繂楠告禍鏍瑰鍕煉闁哄瞼鍠栧畷顐﹀礋椤撳鍊濋弻鐔碱敊缁楀搫浠梺鍝勮閸旀垵顕ｉ鈧畷鎺戔槈濞嗘垵娑х紓鍌氬€烽懗鑸电箾閳ь剛绱掗悩宕囧⒌妤犵偛鍟～婊堝焵椤掑嫬绠栨繛鍡楃箚閺嬫棃鎮归幁鎺戝濠殿喚鍘ч埞鎴︽偐椤愶絽顎忛梺鍛婂姂閸斿孩顨ラ崶鈺冪＝濞达綀娅ｇ敮娑氱磼鐠囪尙澧︾€规洘妞介崺鈧?NBT 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犖ч柛銉㈡櫇閸樼娀姊绘担鍛婃儓妞わ缚鍗冲畷闈涱潩椤戠偞妞介、鏃堝礋鎼存ɑ娅婇柡灞界Ч瀹曨偊宕熼懜鍨毎闂備礁鎼幊宀勫垂閽樺娼栭柧蹇撴贡绾惧吋淇婇婵囶仩濞寸厧娲︾换婵嗏枔閸喗鐏侀梺绋匡攻缁诲倿鎮鹃悜钘夊嵆闁绘垵妫楅幃鎴炵節閵忥絾纭炬い鎴濇喘瀹曘垽鏌嗗鍡忔嫼闂佸憡绻傜€氼參宕掗妸鈺傜厱闁哄倹瀵у﹢浼存煛閸涱厾鍩ｆい銏＄洴閹瑧鈧數顭堥獮妤佺節閻㈤潧孝闁诲繑宀稿畷婵嬪即閻愨晜鐎洪悗骞垮劚濡瑩宕ｈ箛鎾斀闁绘ɑ褰冮弳鐐烘煏閸ャ劎绠栭柕鍥у婵偓闁斥晛鍟伴ˇ浼存⒑鏉炴壆鍔嶉柛鏃€鐟ラ悾鐑藉础閻愨晜鐎婚梺閫涘嵆濞佳囧箖鐎ｎ偆绡€缁炬澘顦辩壕鍧楁煕鐎ｎ偄鐏寸€规洘鍔欏浠嬵敇閻愯埖鎲伴梻渚€娼ц噹闁逞屽墴瀹曟垿骞橀幇浣瑰兊濡炪倖鍔戦崹鍦矈椤曗偓閹鈻撻崹顔界彯闂佺顑呯€氫即銆佸Ο鑽ら檮缂佸娉曢崐鐐烘⒑閹稿孩顥嗘俊顐㈠閸掑﹪骞嶉鍓э紳闂佺鏈悷褔宕濆鍥╃＜閻庯綆鍋勯悘瀛樸亜閵忥紕澧电€规洏鍔戦、妯衡槈濞嗘垳绨存繝鐢靛█濞佳囧磹閹间礁绠熼柨鐔哄Т閻撴洟鏌熺€涙濡囬柡鈧禒瀣厱閻忕偛澧介。鏌ユ煕閻斿搫浠遍柡灞稿墲閹峰懏绂掔€ｎ亝鎳欑紓鍌欒兌缁垶鎯勯姘辨殾婵°倕鎳忛崵鍐煃閸濆嫬鈧鈻嶉幋鐐扮箚闁绘劦浜滈埀顒佺墪鐓ら柍鍝勫暟缁€濠傘€掑锝呬壕闂佺粯渚楅崳锝咁嚕娴犲惟闁挎洍鍋撴い搴㈡崌濮婃椽宕ㄦ繝鍕窗闂佺楠搁幖顐㈠祫闂佺粯顨呴悧蹇曞姬閳ь剟姊哄Ч鍥х伈婵炰匠鍕浄闁挎洖鍊归悡鏇㈡煏婵炲灝鍔ら柛鈺嬬秮閺屾洟宕卞Δ鈧弳锝団偓瑙勬礀瀹曨剟鍩㈡惔銊ョ闁绘ê妯婂Σ鍗炩攽閻樺灚鏆╅柛瀣☉铻ｅ┑鐘插暟椤╁弶绻濋棃娑卞剰缁炬儳缍婇弻锝夊閻樺啿鏆堥梺缁樻尵閸犳牠寮婚敐澶婃闁圭楠搁弳鍫㈢磽娴ｈ棄鐓愰柣鎿勭節瀵鏁撻悩鎻掕€垮┑鐐村灦椤ㄥ棝宕板鑸碘拺闁告繂瀚﹢浼存煟閳哄﹤鐏″ǎ鍥э躬楠炴牗鎷呴懖婢洦鐓曢柕澶堝灪濞呭洭鏌涘鍡楃仸闁哄矉绲鹃幆鏃堝閳轰焦娅涢梻渚€娼荤紞鍡涘闯閿濆懐鏆︽繝濠傜墛閸嬪嫮绱掑Δ鍕┾偓鈧柛瀣尰閹峰懘宕滈崣澶婄紦闂備線鈧偛鑻晶瀛橆殽閻愭彃鏆欓柍璇查叄楠炴瑩宕橀埡鍌涚彆闂傚倷绀侀幉锟犲礉韫囨稑鐤炬繝濠傛噺椤愯姤鎱ㄥΟ鍨厫闁抽攱甯￠弻娑氫沪閸撗勫櫗缂備椒鑳舵晶妤佺┍婵犲偆娓婚柣鎾抽椤绱撴笟鍥ф灈闁绘锕︾划顓㈡偄閻撳海鍔﹀銈嗗笒鐎氼剛绮婚弽顐ｅ枑闁哄啫鐗嗙粻鏍ㄧ箾閸℃ɑ灏柛銊ュ€归妵鍕箛闂堟稐绨肩紓?

        // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ巻鍋撴潻婵嬫⒑闁偛鑻晶鎾煛鐏炲墽銆掗柍褜鍓ㄧ紞鍡涘磻閸涱厾鏆﹂悘鐐靛亾閸欏繐鈹戦悩鎻掓殲闁靛洦绻冮妵鍕閳╁啰顦伴梺杞扮劍閸旀瑥鐣烽崼鏇炵濞达綁顥撶粈鍐磽閸屾艾鈧悂宕愭搴㈠闁哄被鍎辩壕濠氭煙閸撗呭笡闁稿﹦鏁婚弻銊モ攽閸℃侗鈧鏌＄€ｎ剙鏋涢柡灞剧〒閳ь剨绲芥晶搴ｇ矓椤曗偓閺岀喖顢欑粵瀣杹闂佽桨鐒﹂崝鏍箚閺傚簱鏀介柛顐犲灪閺呫劑姊婚崒娆戭槮闁圭⒈鍋勮灋婵炴垯鍨圭粣妤呮煛瀹ュ骸骞栭柦鍐枛閺屽秹鍩℃担鍛婃婵犳鍨遍幐鍐差潖婵犳艾閱囬柣鏃囥€€閺嬫棃姊虹粙娆惧剱闁瑰憡鎮傞崺鐐哄箣閻橆偄浜鹃柨婵嗛婢ь喚绱掓笟濠勭暤闁哄矉绲鹃幆鏃堫敍濠婂憛锝夋⒑閸濄儱校闁绘绮庨崚鎺撶節濮橆厽娅滈梺绯曞墲閻熝囨儊閸喓绡€闁汇垽娼у瓭闂佺锕ラ幃鍌炪€侀弮鍫晝闁挎梻鏅崢鐢告⒑閸濆嫷鍎涢柛瀣閹便劑宕掑☉娆忓伎婵犵數濮撮崯顖炲Φ濠靛鐓欐い鏃傛嚀婢ф煡鏌熼娑欘棃妞ゃ垺鐟╅幃鍓т沪閸撗€鍋撻鐣岀瘈闁汇垽娼ф禒婊堟煟鎺抽崝搴ㄥ礆閹烘埈鍚嬮柛銉戝啰浜伴梻浣筋潐瀹曟﹢顢氳缁寮介‖顒佹閺佹劙宕ㄩ鐔割唹闂備胶顭堥敃顏堝绩闁秴桅闁告洦鍨扮粻鎶芥煙鐎涙濡囬柛瀣崌閹晫绮欓崹顔兼婵犵數鍋涘Λ娆撳礉濡ゅ啫濮柍褜鍓熷娲濞戙垻宕紓浣瑰絻婢ц棄鈽夐崹顐犲亝闁告劏鏅濋崢鎼佹⒑閸撴彃浜介柛瀣閺呭爼骞橀鐣屽幍濡炪倖娲嶉崑鎾剁磼閻樺磭澧电€殿喖顭峰畷鍗炍旀繝鍌涘€梻浣虹《閸撴繈濡靛☉銏犵；闁规崘顕ч柋鍥煛閸モ晛孝鐟滄澘瀚板娲箹閻愭彃濮岄梺鍛婃煥缁夎埖绂嶉幖渚囨晣闁绘梻绻濈花濠氭椤愩垺鎼愰柨鏇樺劚閳诲秵绻濋崶銊у幐闁诲繒鍋涙晶钘壝洪弶鎴旀斀闂勫洭宕洪弽顓炵畾闁哄啫鐗嗛悞娲煕閹板吀绨荤紓宥呮濮婅櫣鎷犻幓鎺濆妷濡炪倖姊归悧鐘茬暦閹剁瓔鏁嬮柍褜鍓欓悾宄邦煥閸愶絾顫嶉梺闈涚箳婵兘鎮块崨瀛樷拺闁革富鍙€濡炬悂鏌涢悩宕囧⒈缂侇喖鐗忛埀顒婄秵閸嬩焦绂嶅鍫熺厵闁绘劦鍓氱紞鎴炪亜閵夛箑鍝洪柡?(闂?NBT 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犖ч柛銉㈡櫇閸樼娀姊绘担鍛婃儓妞わ缚鍗冲畷闈涱潩椤戠偞妞介、鏃堝礋鎼存ɑ娅婇柡灞界Ч瀹曨偊宕熼懜鍨毎闂備礁鎼幊宀勫垂閽樺娼栭柧蹇撴贡绾惧吋淇婇婵囶仩濞寸厧娲ら埞鎴﹀煡閸℃ぞ绨婚柣搴㈠嚬閸ㄦ娊骞戦姀鐙€娼╂い鎴ｅГ閺傗偓闂備胶绮崝姗€宕洪弽顑句汗鐟滃繒妲愰幒妤冨彄妞ゆ挾濮烽悡鎾澄旈悩闈涗沪妞ゃ劌鎳橀垾锕傚Ω閳轰線鍞跺┑鐘绘涧濞层劑鍩€椤掑澧存慨濠冩そ濡啫霉閵夈儳澧︾€殿喗褰冮…銊╁醇閻旇渹绨甸梻浣虹帛濡啴寮查懠顒佸床闁糕剝绋掗悡蹇涙煕椤愶絿绠栭柛锝堫潐閵囧嫯绠涢幘鑸垫喖缂備胶绮惄顖氱暦濡ゅ懏鍋傞幖绮规濞兼岸姊绘担鍛婃儓闁活厼顦遍幑銏犫攽閸℃瑦娈鹃梺闈浥堥弲鈺呭极閸愵喗鐓忛煫鍥ㄦ礀瀛濋悶姘箖缁绘繈鎮介棃娴躲儲銇勯敐鍕煓闁糕斁鍋撳銈嗗坊閸嬫挾鐥紒銏犲籍妤犵偞顨婇幃鈺冪磼濡厧骞嶉柣搴ｆ嚀鐎氼喗鏅跺Δ鍛惞闁搞儮鏂侀崑鎾舵喆閸曨剙顦╅梺绋款儏閿曘儲绌辨繝鍥ㄥ€婚柤鎭掑劜濞呭棝姊洪崗闂磋埅闁稿孩妞藉畷銉ノ熼懖鈺冿紳闂佺鏈懝楣冨焵椤掍焦鍊愮€规洘鍔欓幃婊堟嚍閵夈儮鍋撻崸妤佺叆闁哄倸鐏濋埛鏃堟煟椤撶喓鎳囬柡宀€鍠庨埢搴ㄦ妞ゆ泦鍏犳椽鏁冮埀顒勨€﹂崶顏嗙杸婵炴垶宸婚崑鎾绘晝閸屾氨顓洪梺缁樺灥濡寮?
        this.shootLinearArrow(target, getTier());

        // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箻閺岀喖骞嗛弶鍟冩捇鏌涙繝鍌涘仴闁哄被鍔戝鏉懳旈埀顒佺閹屾富闁靛牆楠搁獮鏍煟韫囨梻绠氶柣蹇斿浮濮婃椽宕楅懖鈹垮仦闂佸搫鎳忕换鍫ｆ濡炪倖鐗滈崑鐐哄磹閸偒娈介柣鎰皺娴犮垽鏌涢弮鈧喊宥嗙┍婵犲浂鏁冮柨婵嗗閻ｇ厧鈹戦悙鍙夘棑闁搞劋绮欓獮鍐ㄢ枎閹惧厖绱堕梺鍛婃处閸欏啴鎮伴幘缁樷拻濞达絿顭堥ˉ蹇涙煕鐎ｎ偄娴€规洘鍨垮畷鐔碱敆閸屻倖閿ゅ┑鐐差嚟婵挳顢栭崱娑欏亗闁哄洢鍨洪悡蹇涙煕椤愶絿绠栨い銉уТ椤儻顧侀柛鎾寸〒濡叉劙骞掗弮鍌滐紲濠碘槅鍨伴崥瀣礆濞戙垺鍊甸悷娆忓缁€澶岀磼椤旂厧鈷旂紒顔款嚙閳藉濮€閻樻鍟嬮梻浣告惈閸婂爼宕曢懠顑藉亾濮樺崬鏋涙慨?(婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧潡鏌熺€电孝缂佽翰鍊濋弻锕€螣娓氼垱锛嗗┑鐐叉▕娴滄繈寮插鍫熺厽闁逛即娼ф晶顕€骞栭弶鎴含婵﹥妞藉畷銊︾節閸屾鏇熺箾鐎涙鐭嬮柣妤冨Т閻ｇ兘骞嬮敃鈧粻濠氭偣閸ャ劌绲婚柣搴幖椤啴濡堕崱妤€衼缂備礁寮跺浠嬬嵁韫囨哎浜归柟鐑樻尨閹锋椽姊洪懡銈呮瀾婵犮垺锚鍗卞┑鐘崇閻撴瑩鏌ц箛锝呬壕闁肩増瀵ч〃銉╂倷閹绘帗娈婚梺绯曟櫔缁绘繂鐣烽幒鎴旀婵ɑ鐦烽妶澶嬧拻濞达絿顭堥弳閬嶆煙绾板崬浜伴柡浣稿暣婵¤埖寰勬繝鍕毇闂備礁澹婇崑渚€宕曢弻銉ョ厱闁圭儤鍤氳ぐ鎺撴櫜闁告侗鍠栭弳鍫ユ⒑閸濄儱鏋旈柛瀣ㄥ€濆濠氭偄閾忓湱鐓撻梺鍦焾鐎涒晠宕伴幇顔剧＝濞撴艾娲ら弸鐔告叏婵犲偆鐓兼鐐村灴瀹曠喖顢橀悢铚傜钵闂備焦鏋奸弲娑㈠疮閻楀牏顩查柡宥庡幗閳锋帒霉閿濆嫯顒熼柡鈧导瀛樼厵婵炶尪顔婇柇顖涙叏婵犱胶鐭欑€规洜鍠栭、娑樷槈濡嘲浜鹃柛顭戝枓閺€浠嬫煟濡櫣锛嶆い锝嗙叀閺岋綁骞樼€靛憡鍒涢梺鍝勬湰閻╊垰顕ｉ幘顔嘉╅柕澶堝€楅弫鏍磽閸屾瑨鍏屽┑顔肩仛缁绘稒绻濋崶褏鐣?
        this.consecutiveMisses++;
        if (!this.getSensing().hasLineOfSight(target)) {
            this.consecutiveMisses++;
        }
    }

    public void shootModuleArrow(LivingEntity target, int tier, float speedMultiplier, double damageMultiplier, boolean bypassInvulnerability) {
        // Keep compatibility with module hooks while reusing existing turret projectile behavior.
        this.shootLinearArrow(target, tier);
    }

    private void shootLinearArrow(LivingEntity target, int tier) {
        ItemStack itemstack = this.getProjectile(this.getItemInHand(ProjectileUtil.getWeaponHoldingHand(this, item -> item instanceof net.minecraft.world.item.BowItem)));
        AbstractArrow arrow = ProjectileUtil.getMobArrow(this, itemstack, 1.0f);

        arrow.setOwner(this);
        arrow.getPersistentData().putBoolean("IsTurretArrow", true);
        arrow.getPersistentData().putInt("TurretTier", tier);
        arrow.getPersistentData().putInt("TurretID", this.getId());

        if (this.entityData.get(IS_BRUTAL)) {
            arrow.getPersistentData().putBoolean("IsBrutalArrow", true);
        }

        arrow.pickup = AbstractArrow.Pickup.DISALLOWED;
        arrow.setNoGravity(true);

        // 闂?[婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧潡鏌熺€电孝缂佽翰鍊濋弻锕€螣娓氼垱锛嗛悷婊呭鐢帞澹曟總鍛婄厽闁归偊鍨伴惃娲煟濞戞牕鍔氶柍瑙勫灦楠炲﹪鏌涙繝鍐╃妤犵偛锕ラ幆鏃堝Ω閵夈儱娈ゅ┑鐐舵彧缂嶁偓婵炲拑绲挎竟?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕閻庤娲忛崕鎶藉焵椤掑﹦绉甸柛鐘崇墱婢规洟宕稿Δ浣哄幍闂佽鍨虫晶妤吽夋径鎰闁哄鍩婇煬顒勬煛鐏炶鈧繈骞婂┑瀣妞ゆ棁鍋愭晶顖氣攽閻愯尙鎽犵紒顔肩灱缁辩偞绻濋崶褑鎽曞┑鐐村灟閸ㄧ懓鏁俊鐐€栧Λ浣哥暦閻㈢姹叉俊銈勮兌缁犻箖鎮楀☉娆樼劷闁活厼锕︾槐鎾愁吋閸滃啳鍚悗娈垮枛椤兘骞冮姀銈嗗亗閹艰揪绲块弳浼存煟閻斿摜鐭婄紒澶屾嚀椤曪綁鎼归锝囩Ф闂侀潧顭徊鑲╄姳婵犳碍鈷戦梻鍫熺〒婢ф洟鏌熼崘鑼鐎规洜鏁诲畷鍫曨敆娴ｅ搫骞愰柣搴″帨閸嬫捇鎮楅敐搴″鐞氾附淇婇妶鍥ラ柛瀣洴椤㈡牗寰勯幇鈹惧亾娴ｅ壊娼ㄩ柍褜鍓熼獮鍐ㄢ枎閹炬潙娈ゅ銈嗗笒椤︻垶寮查敐澶嬧拻?(闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愭い鏃傛嚀娴滈箖鏌涢幇銊︽珔缂佸墎鍋涢埞鎴︽倷闂堟稐澹曢梺璇插濡炶棄顫忓ú顏勪紶闁告洦鍓欓崑宥夋⒑閹肩偛濡肩紓宥咃工椤曪綁宕ㄦ繝鍐€撻梺鐓庡级缁诲啫螞閸愵喖鏋侀柟鐗堟緲瀹告繃銇勯幘璺烘瀾妞ゆ柨顦靛缁樻媴閾忕懓绗￠柣銏╁灡鐢繝鍨鹃敃鍌涘€婚柦妯侯槼閹芥洟姊洪幐搴ｇ畵妞わ富鍨抽悮鎯ь吋婢跺鍘卞銈嗗姦閸嬪嫭绂嶅┑鍥ヤ簻闁靛濡囨晶顏堟煃鐟欏嫬鐏撮柟顔规櫊椤㈡洟锝為鐑嗘闂傚倸鍊风粈浣革耿闁秵鎯為幖娣妼缁愭淇婇妶鍛櫤闁? -> 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈠鏌ｉ悢鍝ョ煀闂佸府缍侀悰顕€宕奸妷銉庘晝鎲告径鎰；闁圭偓鏋煎Σ鍫熺箾閸涚増鐝柛銊ョ仢閻?-> 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧潡鏌熺€电孝缂佽翰鍊濋弻锕€螣娓氼垱锛嗗┑鐐叉▕娴滄繈寮插鍫熺厽闁逛即娼ф晶顕€骞栭弶鎴含婵﹨娅ｇ划娆戞崉閵娧傜礃闂備胶顭堥鍥磻閵堝懐鏆?
        int currentHeat = this.entityData.get(DATA_HEAT);
        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ巻鍋撴潻婵嬫⒑闁偛鑻晶鎾煛鐏炲墽銆掗柍褜鍓ㄧ紞鍡涘磻閸涱垯鐒婃い鎾卞灪閻撳啴鎮峰▎蹇擃仼闁诲繑鎸抽弻鐔碱敊鐟欏嫭鐝氶悗瑙勬礃閿曘垽骞婇悩娲绘晢闁逞屽墯閹便劑寮婚妷锔规嫽婵炶揪绲肩拃锕傛倿閻愵兙浜滈柟瀛樼箖椤ャ垺顨ラ悙鏉戠伌鐎规洖鐖奸、妤呭焵椤掑倻涓嶉柡宥庡幗閻撳繘鐓崶銊︾閸熸悂姊洪崫鍕棞妞ゆ垵顦靛濠氭偄鐏忎焦鐏侀梺鍓茬厛閸犳鎮橀幘缁樷拻濠㈣泛顭崕鏃€鎱ㄦ繝鍌ょ吋鐎规洘甯掗埢搴ㄥ箣椤撶啘婊堟⒒娴ｇ瓔娼愮紒浣规尦閸┾偓妞ゆ帊绀佹晶顖涚箾閸忚偐澧辩紒杈ㄦ尰閹峰懐鎷犻敍鍕Ш缂傚倷鑳舵繛鈧紒鐘崇墵瀵顓奸崼顐ｎ€囬梻浣告啞閹搁箖宕伴弽褜鍤曢悹鍥ф▕閸氬鏌涢顐簼妞ゅ骸娲缁樻媴閸涘﹤鏆堥梺鍦焾椤兘骞婂┑瀣畾鐟滃秶绮婇锔解拻濞达絽鎲＄拹锟犳煕鎼存稑鈧洟锝炶箛姘ヤ汗闁圭儤绻冮弲婵嬫⒑閸忛棿鑸柛搴灡缁傚秴顭ㄩ崼鐔哄幍闂佸搫顦冲▔鏇㈠春閿濆棔绻嗙紓浣靛灩濞呭秹鏌?
        // Tier 0: 0% Boost (Max 0)
        // Tier 1: 225% Boost (Max 30)
        // ...
        // Tier 4: 900% Boost (Max 120) -> Total 1000%
        int maxHeat = getTier() * 30;

        // 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣銏犲閺佸﹪鏌″搴″箹闂傚偆鍨遍妵鍕冀閵娧呯厐缂備浇缈伴崐婵嬪蓟閿濆鏅查柛娑卞枟閹烽亶鎮楃憴鍕闁绘搫绻濆濠氭偄閸涘﹦绉堕梺璇″瀻閸涱啩鎺楁⒒娴ｈ姤銆冪紒鈧笟鈧畷顖烆敃閿曗偓閻撴﹢鏌熸潏鍓х暠缁炬儳鍚嬬换婵囩節閸屾稒宕抽梺鍛婃⒐閹倿骞冨Δ鍛仭闁绘鐗嗛弳鍫㈢磽娴ｇ瓔鍤欓柣妤佹尭椤曪絾绻濆顓炰簻闁荤偞绋堥埀顒€鍘栨竟鏇炩攽閻愭潙鐏︽い蹇ｄ邯椤㈡棃宕卞▎鎴犳殽闂備礁鍟块幖顐﹀箠韫囨稒鍋傞柡鍥╁枑閸欏繑淇婇妶鍌氫壕濠碘槅鍋呴〃鍡涘疾閸洖绠绘い鏃傛櫕閸樻悂鏌ｈ箛鏇炰粶濠⒀傜矙閸┿儲寰勯幇顓犲帗闁荤姴娲﹂悡锟犲矗閸曨剦娈介柣鎰▕閸庡繑銇勯鐐村仴妞ゃ垺鐗犻獮鍡氼槾濞寸姴銈稿?1 闂?(clamp 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙闁稿被鍔庨幉鎼佸棘鐠恒劍娈鹃梺鍝勮閸庨亶鎷戦悢鍏肩厪濠㈣泛鐗嗛崝姘舵煕鐎ｎ亞效婵﹥妞藉畷顐﹀礋椤撴稒鐎遍梻浣侯焾椤戝懎螞濞戞艾鍨濆┑鐘宠壘缁秹鏌涢銈呮灁闁告﹢浜堕幃妤呭礂婢跺﹣澹曢梻渚€鈧偛鑻晶瀵糕偓瑙勬礃閸ㄥ潡骞冨▎鎾充紶闁告洦鍘介悡?
        // 闂?[婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧潡鏌熺€电孝缂佽翰鍊濋弻锕€螣娓氼垱锛嗛悷婊呭鐢帞澹曟總鍛婄厽闁归偊鍨伴惃娲煟濞戞牕鍔氶柍瑙勫灦楠炲﹪鏌涙繝鍐╃妤犵偛绻掗埀顒婄秵閸犳牠寮告笟鈧弻娑㈠焺閸愬墽鍔风紓?闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ巻鍋撴潻婵嬫⒑闁偛鑻晶鎾煛鐏炲墽銆掗柍褜鍓ㄧ紞鍡涘磻閸涱垯鐒婃い鎾卞灪閻撳啴鎮峰▎蹇擃仼闁诲繑鎸抽弻鐔碱敊鐟欏嫭鐝氶悗瑙勬礃閿曘垽骞婇悩娲绘晢闁逞屽墯閹便劑寮婚妷锔规嫽婵炶揪绲肩拃锕傛倿閻愵兙浜滈柟瀛樼箖椤ャ垺顨ラ悙鏉戠伌鐎规洖鐖奸、妤呭焵椤掑倻涓嶉柡宥庡幗閻撳繘鐓崶銊︾閸熸悂姊洪崫鍕棞妞ゆ垵顦靛濠氭偄鐏忎焦鐏侀梺鍓茬厛閸犳鎮橀幘缁樷拻濠㈣泛顭崕鏃€鎱ㄦ繝鍌ょ吋鐎规洘甯掗埢搴ㄥ箣椤撶啘婊堟⒒娴ｇ瓔娼愮紒浣规尦閸┾偓妞ゆ帊绀佹晶顖涚箾閸忚偐澧辩紒杈ㄦ尰閹峰懐鎷犻敍鍕Ш缂傚倷鑳舵繛鈧紒鐘崇墵瀵顓奸崼顐ｎ€囬梻浣告啞閹歌崵鍠婂鍥╃煔閺夊牄鍔庣弧鈧梺鎼炲劥閸╂牠寮插┑瀣拺闂傚牊绋撶粻姘舵煃瑜滈崜娆撳储閺嶎灔搴敊閻ｅ瞼鐦堝┑鐐茬墕閻忔繈寮稿☉銏＄叆闁哄洢鍔嬬花鐣岀磼椤旂⒈鐓肩€殿喖鈧噥妾ㄩ梺鎼炲€栧ú姗€濡甸崟顖氬嵆婵°倐鍋撳ù婊堢畺濮婅櫣鍖栭弴鐔告緬闂佺顑嗛幐鎼佲€旈崘顔嘉ч柛鈩冾殘閻熴劑姊虹粙鍖″伐缂傚秴锕ら锝夊礃瀹割喚鍙嗛梺鍓插亞閸犳捇宕㈤崡鐑嗘富闁靛牆妫楁慨褏绱掗幓鎺戔挃缂侇喖鐗撳畷姗€顢欓悾灞藉箰?(<= 50ms)
        if (currentHeat < maxHeat) {
            long now = System.currentTimeMillis();
            if (now - this.lastHeatStackTime >= 50) {
                this.entityData.set(DATA_HEAT, currentHeat + 1);
                currentHeat++;
                this.lastHeatStackTime = now;
            }
        }

        // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箻閺岀喖骞嗛弶鍟冩捇鏌涙繝鍌涘仴闁哄被鍔戝鏉懳旈埀顒佺閹屾富闁靛牆楠搁獮鏍煟韫囨梻绠氶柣蹇斿浮濮婃椽宕楅懖鈹垮仦闂佸搫鎳忕换鍫ｆ濡炪倖鐗滈崑鐐哄磹閸偒娈介柣鎰皺娴犮垽鏌涢弮鈧喊宥夊Φ閸曨垱鏅滈悹鍥皺娴狀垶姊洪柅鐐茶嫰婢ь垶鏌よぐ鎺旂暫閽樻繈鏌ｉ姀銏╃劸闁藉啰鍠撻埀顒€绠嶉崕閬嶆偋濠婂喚鐎堕柕濞炬櫆閳锋垿鏌涘☉姗堟敾閻忓繒鏁婚弻娑㈡偐閺屻儱寮伴梺璇″櫍缁犳牠骞冨鍫熷癄濠㈠厜鏂傞崝鎴﹀蓟閵娾晛绫嶉柛銉厛濡嫰姊洪崨濠冪叆闁瑰啿閰ｉ崺鐐哄箣閿旇棄浜圭紓鍌欑劍钃遍梺娆惧弮濮婅櫣绱掑鍡樼暦缂備緡鍠栫粔鍫曞焵椤掑嫭娑ч柕鍫㈩焾閻ｇ兘骞嗛柇锔叫ラ梻浣姐€€閸嬫挸霉閻樺樊鍎愰柣鎾跺枛閺岀喖鏌囬敃鈧晶顔剧磼閻欐瑥瀚ㄦ禍婊堟煏婢舵稓鐣遍柣蹇旀尦閺岋紕浠﹂悾灞濄儲銇勮缁舵岸寮诲☉銏犵閻庨潧鎲￠崳顔界節閵忥綆娼愭繛鑼枛閵嗕礁顫滈埀顒勫箖濞嗘挸鐓涢柛灞剧矆缁ㄦ挳姊婚崒娆戭槮缂傚秴锕よ灋闁秆勵殕閸婂潡鏌ㄩ弴鐐测偓褰掑磻閸岀偞鐓涢柛銉ｅ劚閻忣亪鏌ｉ幘瀵告噰闁诡喗顨婇幃钘夆枔鐠恒劌濮奸梺鍝ュ枑閹倿寮婚敐澶婎潊闁宠桨鑳舵禒顓犵磽娴ｅ壊鍎愰悽顖涱殘缁碍娼忛妸褏鐦堥梺鎼炲劘閸斿矂鍩€椤掑倸鍘撮柡宀€鍠撶槐鎺懳熼崫鍕秹闂備胶顭堥鍡涘箲閸パ呮殾缂佸顕抽弮鍫濈劦妞ゆ帒瀚崙?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弴妤€浜惧銈庝簻閸熸潙鐣疯ぐ鎺濇晪闁告侗鍨版慨娲⒒娴ｄ警娼掗柛鏇炵仛閻ｅ墎绱撴担鎻掍壕婵犮垼鍩栭崝鏍磹閻㈠憡鐓ユ繝闈涙椤庢顭胯瑜板啴鍩為幋锔绘晩闁圭娴疯ぐ褔姊洪棃娑欐悙閻庢矮鍗抽悰顕€骞掑Δ鈧粻锝嗙節閸偄濮冮柣銉邯濮婄粯鎷呯憴鍕哗闂佺锕ュú鏍弲濡炪倖鎸鹃崕鎰板吹閺囥垺鐓曟い鎰剁稻缁€鈧梻浣稿船濞诧妇鎹㈠☉銏犵闁诲繑妞挎禍顏堝灳閺嶎厼閱囬柕澶涜吂閹锋椽鏌ｉ悩鍙夌┛閻忓繑鐟х划濠氬蓟閵夛妇鍘介梺鍐叉惈閿曘倝鎮橀敂绛嬫闁绘劖褰冮弳鐔兼煙閻熸澘顏柟顔诲嵆閸╁嫰宕橀悙顒傜Ь婵犵數濮烽弫鎼佸磻濞戞娑樷枎閹惧磭顦┑掳鍊曢幊搴ｇ矆閸曨垱鐓ラ柣鏂挎惈鏍￠梺?
        this.lastDamageTimestamp = this.tickCount;


        double d0 = target.getX() - this.getX();
        double d1 = target.getEyeY() - arrow.getY();
        double d2 = target.getZ() - this.getZ();

        double spread = 0.2;
        double rX = (this.random.nextDouble() - 0.5) * spread;
        double rY = (this.random.nextDouble() - 0.5) * spread;
        double rZ = (this.random.nextDouble() - 0.5) * spread;

        // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犖ч柛銉㈡櫇閸樼娀姊绘担铏瑰笡闁搞劌鐖煎鎼佹嚒閵堝洨顦梺鍝勮癁瀹€鈧崬鐢告煟閻樼儤顏犻悘蹇嬪姂瀹曟繈鎮㈤崗鑲╁幐闂佺硶鍓濋崝鏇㈠焵椤掍焦绀嬫繝鈧笟鈧娲箰鎼达絿鐣甸梺缁橆殔閿曨亝淇婇幘顔肩妞ゆ梻鏅崢浠嬫⒑閸︻厼鍔嬮柛鈺侊躬閻擃剟顢楅崟顒傚幐闁诲繒鍋涙晶钘壝虹€电硶鍋撳▓鍨灍闁规瓕娅曟穱濠囧箹娴ｈ倽銊╂煏婢诡垰鑻弫褰掓⒒閸屾艾鈧绮堟笟鈧獮鏍敃閵堝棗浠忓銈嗗姧缁犳垹澹曠憴鍕箚闁靛牆鎳庨弳鐐淬亜椤愶絾绀嬮柡宀€鍠栭幃婊兾熼搹閫涙喚婵犵鍓濊ぐ鍐偋婵犲洤绠為柕濞垮剻閺冨牆鐒垫い鎺嗗亾閾荤偞绻涢崱妯哄Е婵炲牜鍘奸埞鎴︽偐閼碱剚顥夐梺鍝勵槸缁ㄩ亶宕戦幘婢勬梹鎷呴悷鏉夸紟闂備礁鎼ˇ浼村吹濮橆優娲敂閸曞簶鏅犻弻宥嗘姜閹峰苯鍘″銈嗘煥濡鈥旈崘顔嘉ч柛鈩冾殔琛肩紓鍌欒兌婵敻宕归崷顓炲灊闁割偁鍎辩粈鍐┿亜閺冨倹娅曢柛妯绘崌濮婃椽宕ㄦ繝鍕暤闁诲孩鍑归崜鐔煎春閳ь剚銇勯幒鍡椾壕缂傚倸绉撮敃顏堝Υ娴ｇ硶鏋庨柟鎯х－椤斿﹪姊洪崫鍕殭闁稿﹤顭烽弫宥呪攽閸モ晝顔曢柡澶婄墕婢т粙宕氭导瀛樼厵缁炬澘宕禍鐗堛亜閵忊剝灏柣锝嗙箞瀹曠喖顢楅崒姘疄濠电姵顔栭崰妤呭Φ濞戙垹纾婚柟鎯у绾惧ジ鏌ｅΟ铏癸紞濠⒀冪仛椤ㄣ儵鎮欓幓鎺撴闂佹悶鍔戠粻鏍ь嚕椤掑嫬唯闁挎棁濮ゅ鎴︽⒒娴ｇ瓔鍤欓柛鎴犳櫕缁辩偤宕卞☉妯硷紱闂佺硶鍓濈粙鎴犵矆婢舵劖鐓熼柕蹇曞У閸熺偤鏌嶉柨瀣仼缂佽鲸鎸婚幏鍛存嚃閳╁啫鐏撮柟顕嗙節婵＄兘鍩￠崒婊冨箞闂備線娼ф蹇曟閺囥垹鐭楅柍褜鍓欓—?(v^2 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣銏犲閺佸﹪鏌″搴″箹缂佹劖顨嗘穱濠囧Χ閸涱厽娈查悗瑙勬礃閻擄繝寮婚悢鍏肩劷闁挎洍鍋撻柡瀣〒缁辨帡鐓幓鎺嗗亾閺囷紕浜欓梻浣瑰缁诲倿骞婃惔銊ユ辈闁绘劗鍎ら悡鏇㈠箹缁顫夐柡鈧繝姘厪闁搞儜鍐句純閻庢鍣崳锝呯暦閹烘垟妲堟繛鍡樺灥濞懷冣攽閿涘嫬浜奸柛濠冨姍瀵彃顭ㄩ崼鐔蜂簵闂佽法鍠撴慨宄扮暤娓氣偓閺屸€愁吋閸愩劌顬夌紓鍌氱Т濞差參寮诲☉銏犵婵°倐鍋撻柟閿嬪灩濡叉劙宕归銈囩槇闂佹眹鍨藉褎绂掑鍫熺厽婵°倐鍋撻柨鏇ㄤ邯閻涱噣宕橀鑲╋紲闂佺粯鍔樼亸顏堝箺?
        // Level 1 (20m): ~1.6 (Vanilla 3.0 is ~64m) -> Vanilla default logic uses power based on charge time.
        // Let's scale base velocity:
        // L1(20m): 3.0 (Vanilla standard) - actually vanilla bow is 3.0 for full charge.
        // But for long range, we need more.
        // L2(32m): 3.5
        // L3(64m): 4.5
        // L4(128m): 6.0
        // L5(256m): 8.0
        float velocity = 3.0F;
        switch(getRangeLevel()) {
            case 2: velocity = 3.5F; break;
            case 3: velocity = 4.5F; break;
            case 4: velocity = 6.0F; break;
            case 5: velocity = 8.0F; break;
        }

        arrow.shoot(d0 + rX, d1 + rY, d2 + rZ, velocity, 0.0F);

        // 闂?[婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧潡鏌熺€电孝缂佽翰鍊濋弻锕€螣娓氼垱锛嗛悷婊呭鐢帞澹曟總鍛婄厽闁归偊鍨伴惃娲煟濞戞牕鍔氶柍瑙勫灦楠炲﹪鏌涙繝鍐╃妤犵偛锕ラ幆鏃堝Ω閵夈儱娈ゅ┑鐐舵彧缂嶁偓婵炲拑绲挎竟?缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋敐鍛闂佽姤蓱缁诲啴濡甸崟顖氬唨妞ゆ劦婢€濮规姊洪柅鐐茶嫰婢у墽绱掗悩鍐茬伌闁诡噣绠栭弫鎾绘偐閼碱剦鍚嬮梻浣瑰劤濞存岸宕戦崱娑樼劦妞ゆ帊鐒﹂妵婵嬫煛瀹€鈧崰鏍х暦濡ゅ懏鍤冮柍鍝勫€归鍐⒒娴ｅ憡鍟為柡灞诲妿缁棃鎮烽幍顔芥闂佸綊鍋婇崰姘卞閸忛棿绻嗘い鏍仦濞呮粎绱掗妸銉吋婵﹨娅ｉ幉鎾礋椤愩値妲版繝鐢靛仜椤︽壆绮欓幒鏃傜焿闁圭儤鍩堥悡銉╂煕閺囨娅冪紒銊ヮ煼濮婃椽宕崟顐熷亾閸濄儰鐒婇柛娑卞弾閸熷懘鏌曟径鍡樻珕妞ゃ儱妫楅…璺ㄦ崉閾忓湱浼囩紒鐐劤閸氬绌辨繝鍥ч柛灞剧煯婢规洟姊绘担鍛婅础闁冲嘲鐗撳畷鎴炵節閸パ勬К闂侀€炲苯澧柕鍥у楠炴帒顓奸崶褍顬夌紓鍌欒閸嬫捇鎮楅敐搴′簴濞存粍绮撻弻鏇＄疀閵壯咃紵闂佺懓鍟跨€氼喚妲愰幒鏃傜＜婵☆垵鍋愰悿鍕倵鐟欏嫭绀冮柛搴°偢钘濋悗娑櫱滄禍婊堟煥閺冨浂鍤欐繛鍛У閹便劍绻濋崨顕呬哗缂備浇椴哥敮鎺曠亽闂婎偄娴勭徊濂告焽椤栨壕鍋撶憴鍕闁搞劏娉涢悾椋庣矙鐠囩偓姊归幏鍛寲閺囩偘澹?(闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ巻鍋撴潻婵嬫⒑闁偛鑻晶鎾煛鐏炲墽銆掗柍褜鍓ㄧ紞鍡涘磻閸涱厾鏆︾€光偓閸曨剛鍘搁柣蹇曞仜婢ц棄煤閹绢喗鐓涘ù锝囶焾閳ь剙顭烽獮蹇涙偐鐠囪尙顔岄梺鍦劋濡繘宕崼銉︹拻闁稿本鐟чˇ锕傛煙绾板崬浜滈摶鐐翠繆閵堝懎鏆炵€规洖寮堕幈銊ヮ渻鐠囪弓澹曢柣搴㈩問閸犳牠鈥﹂悜钘夋瀬闁瑰墽绮崑鎰版煠绾板崬澧┑顕嗛檮娣囧﹪鎮欓鍕ㄥ亾閺嶎偅鏆滃┑鐘叉处閸ゅ嫰鏌涢幘鑼槮濠殿噮鍓熼弻宥堫檨闁告挻鐟╅崺鐐哄箣閿旂粯鏅╅梺鍝勫€堕崐鏇㈠矗閺囩姷纾藉ù锝堟閽勭厧鈹戦鍝勨偓妤冨垝鐎ｎ亶鍚嬮柛鈩冨姇娴滄繈姊洪崨濠傚闁哄懏绻堝畷銏＄鐎ｎ偀鎷洪梺鍛婄箓鐎氼剟鍩€椤掆偓濠€閬嶅焵椤掑倻鎳楅柛銉戝懐鏋€闂備礁缍婂Λ鍧楁倿閿曞倹鍋?
        // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾剧粯绻涢幋娆忕労闁轰礁顑嗛妵鍕箻閸楃偟鍔撮梺杞扮鐎氫即寮婚敓鐘茬倞闁靛鍎虫禒鑲╃磼閻愵剙鍔ょ紓宥咃躬瀵鏁撻悩鑼€為梺闈涱槶閸庢娊宕濋幘顔解拺閺夌偞澹嗛ˇ锕傛煥閺囨ê鈧繈宕洪悙鍝勭闁挎棁妫勬禍褰掓⒑閸涘﹦鎳冩い锔垮嵆楠炲啫鈻庨幋鐘碉紳婵炶揪绲捐ぐ鍐╃妤ｅ啯鈷戠紒瀣濠€鎵磼鐎ｎ亞绠茬紒鍌氱Т椤劑宕奸悢鍝勫箥闂備礁鎲＄换鍌溾偓姘煎弮钘熸繝濠傚幘閻熼偊鐓ラ柛鎰╁妷閹稿啰绱撴担浠嬪摵闁圭顭烽獮蹇涘川鐎涙ê浠梺缁橆殔閻楀﹤袙鎼达絿纾介柛灞剧懆閸忓瞼绱掗鍛仯闁瑰箍鍨藉畷鐓庘攽閹邦剚顓挎俊鐐€栭崝鎴﹀春閸曨垰瑙﹂悗锝庡枟閻撴洘绻濇繛鎯т壕闂佺粯甯粻鎾崇暦閹剧粯顥堟繛鎴ｉ哺鐎靛矂姊洪棃娑氬婵☆偅顨堢划顓㈠箳濡や胶鍘辨繝鐢靛Т閸燁垶宕愰幇顔瑰亾濞堝灝娅橀柛瀣攻娣囧﹪宕奸弴鐐靛€為梺鍐叉惈閸犳稓妲愰懠顒傜＝闁稿本鑹鹃埀顒傚厴濮婅棄顓兼径濠傜€悷婊呭鐢偛鐣垫笟鈧弻鐔煎箥椤旂⒈鏆梺? + 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛濠傛健閺屻劑寮崹顔规寖闂佹椿鍘介悷鈺呭蓟閻斿皝鏋庨梽鍥敋瑜嶇叅闁挎洍鍋撴い顓炴穿缁犳稑鈽夐幒鍡椾壕闁挎洖鍊哥粻锝夋煟閹存繃顥滈柡?5
        double dmg = getWeaponDamageForTier(tier);

        arrow.setBaseDamage(Math.min(dmg, 200.0));
        int pierce = (tier == 5) ? 10 : (tier + 1);
        arrow.setPierceLevel((byte) pierce);

        // 闂?[婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧潡鏌熺€电孝缂佽翰鍊濋弻锕€螣娓氼垱锛嗛悷婊呭鐢帞澹曟總鍛婄厽闁归偊鍨伴惃娲煟濞戞牕鍔氶柍瑙勫灦楠炲﹪鏌涙繝鍐╃妤犵偛锕ラ幆鏃堝Ω閵夈儱娈ゅ┑鐐舵彧缂嶁偓婵炲拑绲挎竟?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎电濡介梺鍝勬噺缁诲牓寮婚弴銏犻唶婵犲灚鍔栨晥闂備胶顭堥鎰椤忓牆钃熸繛鎴欏灩鍞銈嗘⒒閸樠囷綖椤忓牊鈷戠紒瀣健椤庢绱掓径濠勭Ш鐎殿喖顭烽弫鎰緞婵犲喚妫熼梻浣稿閻撳牓宕板Δ鍛９妞ゆ牜鍋為埛鎴︽煙閹澘袚闁轰浇椴哥换娑㈡嚑椤掆偓閺嬫盯鏌熼鍡欑瘈妞ゃ垺娲熼弫鍐焵椤掑嫭鍊峰┑鐘叉处閻撳繐鈹戦悩鑼妞も晩鍓氶妵鍕晜閸濆嫬濮﹀┑顔硷攻濡炶棄鐣烽妸锔剧瘈闁告劦浜滃浼存⒒娴ｅ憡鍟炴い銊ユ缁绘稒绻濋崶銊ヤ粧濡炪倖娲嶉崑鎾垛偓娈垮枙缁瑦淇婇幖浣规櫆闁告搩鐏濋妶澶嬧拻濞达絽鎲￠崯鐐烘煙缁嬫寧顥㈢€规洏鍔戦、娆戠驳鐎ｎ亝娅婇梻鍌氬€峰ù鍥х暦閻㈢绐楅柟閭﹀枛閸ㄦ繄鈧箍鍎遍幏瀣偄閸℃ɑ鍙忔俊鐐额嚙娴滈箖鏌﹀Ο鑽ょ疄闁哄矉缍佹慨鈧柕蹇婃櫇閸旀悂姊?(闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柤纰卞墻濡查亶鏌ｉ悢鍝ョ煂濠⒀勵殘閺侇噣骞掗弮鍌滅劶闂佸壊鍋嗛崰鎾跺姬閳ь剟姊婚崒姘卞濞撴碍顨婂畷鏇烆煥閸涱垳锛濋悗骞垮劚濡稒鏅堕崹顐闁绘劕顕晶顏堟嚕閹邦厹浜滈柟鍝勬娴滅偓绻濈喊妯峰亾閻愯棄浠梺鍝勭焿缂嶄線銆佸鈧幃銈嗘媴閸︻厽姣夐梻鍌欑窔閳ь剛鍋涢懟顖涙櫠椤斿墽纾奸柣妯垮皺鏁堥悗瑙勬礃濞茬喖寮婚崱妤冩殼闁靛鍎查崰姗€鏌熺粙鍖℃敾缂?
        this.playSound(SoundEvents.SKELETON_SHOOT, 1.0F, 1.0F + (currentHeat * 0.005f));
        this.level().addFreshEntity(arrow);
    }


    private void tickCaptainLogic() {
        if (this.level().isClientSide) return;
        if (this.tickCount % 1200 != 0) return; // 60s

        // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箻閺屸剝寰勭€ｎ亝顔呭┑鐐叉▕娴滄粌娲块梻浣规偠閸庤崵寰婇懞銉ь洸闁绘劦鍓氶崣蹇斾繆椤栨粌甯堕悽顖濇硾椤儻顦叉い鏇ㄥ弮閸┾偓? Level * 100 + SurvivalTime + GearScore
        int score = getTier() * 100 + (this.tickCount / 1200);
        for (ItemStack s : this.getArmorSlots()) {
            if (s.isEnchanted()) score += 20;
            if (s.getItem() instanceof net.minecraft.world.item.ArmorItem) score += 10;
        }

        // Scan nearby turrets
        List<SkeletonTurret> friends = this.level().getEntitiesOfClass(SkeletonTurret.class, this.getBoundingBox().inflate(30.0));
        SkeletonTurret currentCaptain = null;
        int maxScore = -1;

        for (SkeletonTurret t : friends) {
            if (t.entityData.get(IS_CAPTAIN)) {
                currentCaptain = t;
                break;
            }
        }

        if (currentCaptain == null) {
            if (score > 50 && !this.entityData.get(IS_CAPTAIN)) {
                this.entityData.set(IS_CAPTAIN, true);
                this.entityData.set(IS_SQUAD_MEMBER, false);
                this.playSound(SoundEvents.UI_TOAST_CHALLENGE_COMPLETE, 1.0f, 1.0f);
                if (this.ownerUUID != null) {
                     Player p = this.level().getPlayerByUUID(this.ownerUUID);
                     if (p != null) p.displayClientMessage(Component.literal("闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗ù锝堟缁€濠傗攽閻樿弓杩规繛鎴炵瀹曞鏌曟繝蹇曠暠閹兼潙锕ら埞鎴︽偐閾忣偆顦ㄩ梺鎼炲妼濠€鍗炍ｉ幇鏉跨閻犲洩灏欓敍婊冣攽閻愬弶顥為柛銊ㄥ亹缁絽螖閸涱喒鎷洪梺纭呭亹閸嬫稒鎱ㄩ崒娑氱濞达絽鍟垮ú锕傚磻閳哄懏鐓熼柟杈剧到琚氶梺绋款儍閸旀垵顫忔繝姘唶闁绘棁銆€濡插牓姊虹拠鑼闁挎洩濡囧Σ?" + this.getDisplayName().getString() + " 闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃酣銆冮妷褏鐭欓柛鏌倐鍋撻崸妤佲拺妞ゆ巻鍋撶紒澶樺櫍閸┾偓妞ゆ帒锕﹂悾鐢碘偓瑙勬礈閸樠囧煘閹达箑绠涙い鎺嶇贰閸氭瑩姊绘担钘夊惞濠殿喗鍎抽々濂稿Ω瑜庢刊浼存煥閺囩偛鈧綊宕愰悽鍛婄厱妞ゆ劧绲剧粈鍐煟閹捐泛鏋涢柡灞炬礉缁犳稓鈧綆浜為崝鎾⒑缂佹ê绗掑褌绮欓幆鈧い蹇撶墱閺佸洦绻涢幋鐏诲吋绔熼弴銏♀拻闁稿本鑹鹃埀顒傚厴閹偤鏁冮崒姘辩暫闂佸壊鍋呭ú鏍閸ф鐓犲┑顔藉姇閳ь剚顨嗙粙澶婎吋婢跺鍘甸梺缁樺灦钃遍柍閿嬪浮閺岋綁顢橀悙鎼＆闂佽鍠楅〃濠囧极閹邦厽鍎熼柍鈺佸暟娴滃爼姊绘担鐟扳枙闁衡偓鏉堚晜鏆滈柨鐔哄Т閽冪喐绻涢幋娆忕仼缂佺姵鐩弻娑滅疀閹惧瓨鍠愰梺鐑╂櫅闁帮絽顫忓ú顏勪紶闁告洟娼ч崜閬嶆⒑閻戔晜娅撻柛銊ㄦ硾椤?(闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箻閺屸剝寰勭€ｎ亝顔呭┑鐐叉▕娴滄粌娲块梻浣规偠閸庤崵寰婇懞銉ь洸闁绘劦鍓氶崣蹇斾繆椤栨粌甯堕悽顖濇硾椤儻顦叉い鏇ㄥ弮閸┾偓?" + score + ")"), true);
                }
            }
        } else {
            if (this.entityData.get(IS_CAPTAIN) && currentCaptain != this) {
                // Conflict: downgrade
                this.entityData.set(IS_CAPTAIN, false);
                this.entityData.set(IS_SQUAD_MEMBER, true);
            } else if (!this.entityData.get(IS_CAPTAIN)) {
                this.entityData.set(IS_SQUAD_MEMBER, true);
            }
        }
    }

    private void manageHeatDecay() {
        int currentHeat = this.entityData.get(DATA_HEAT);

        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ巻鍋撶痪鎯ь煼閺岀喖寮堕崹顔肩导婵犮垼鍩栭崝鏇犵不濞戞瑣浜滈柟鎯ь嚟閻棛绱掗鑺ュ磳婵﹪缂氶妵鎰板箳閹垮嫮鍚圭紓鍌欒閸嬫挸銆掑锝呬壕閻庤娲栫紞濠傜暦閹烘垟妲堥柡宥忓閻╁酣姊绘担鍛婅础闁稿簺鍊濆畷褰掓偨閸撳弶鏅滈梺鍐叉惈閸熸壆澹曟總鍛婄厓鐟滄粓宕滈悢椋庢殾闁告鍋愬Σ鍫熺箾閸℃ê鐏ラ悽顖炵畺濮婄粯鎷呯粙娆炬闂佺顑呴幊鎰板箲閵忋倕绀冩い鏂裤偢濡攱绻涚€电孝妞ゆ垵妫濋幃鈥斥槈閵忥紕鍘遍梺鏂ユ櫅閸燁垳绮堥埀顒勬倵鐟欏嫭灏俊顐ｇ箞瀵?闂?(100 tick) 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墴閹潡顢氶埀顒勫蓟閿濆憘鏃堝焵椤掑嫭鍋嬪┑鐘叉搐閻鐓崶銊р姇闁绘挻鐟х槐鎾存媴闂堟稓浠奸梺鍝勵儑閸犳牠寮诲☉娆愬劅闁挎稑瀚呰閺屸€崇暆鐎ｎ剙鍩岄柧浼欑秮閺屻倕霉鐎ｎ偅鐝旂紓浣诡殣缁绘繂顫?
        long timeSinceLast = this.tickCount - this.lastDamageTimestamp;

        if (timeSinceLast > 100 && currentHeat > 0) {
            // 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣銏犲閺佸﹪鏌″搴″箹闂傚偆鍨遍妵鍕冀閵娧呯厐缂備浇缈伴崐婵嬪蓟閿濆鏅查柛娑卞枟閹烽亶鎮楃憴鍕闁绘搫绻濆濠氭偄閸忕厧鈧粯鎱ㄥΔ鈧Λ娆擃敇閾忓湱纾?(20 tick) 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煟閵忋埄鐒剧痪鎯ь煼閺岋綁骞囬鑺ユ瘎闂佹椿鍘介悷鈺呭蓟閻斿吋鍊绘俊顖濇閸旀悂姊虹紒妯荤叆婵☆偅鐟╅獮鍫ュΩ閵夘喗瀵岄柣鐘叉穿瀵挻绔熼弴銏＄厽?20%
            if (this.tickCount % 20 == 0) {
                int decay = Math.max(1, (int)(currentHeat * 0.2)); // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙闁稿被鍔庨幉鎼佸棘鐠恒劍娈鹃梺鍝勮閸庨亶鎷戦悢鍏肩厪濠㈣泛鐗嗛崝銈夋煛鐏炵晫澧︽慨濠呮缁棃宕卞Δ鈧瀛樼箾閸喐绀嬮柡灞剧⊕閹棃鏁嶉崟鎴秮閺屾洟宕惰椤忣厾鈧鍠曠划娆撱€侀弴顫稏妞ゆ挾鍠庢刊浼存⒒?
                this.entityData.set(DATA_HEAT, Math.max(0, currentHeat - decay));
            }
        }
    }

    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱槸濞寸兘宕伴弽褏鏆︽い鎰剁畱缁€瀣亜閺冨洤浜归柛妯绘綑閳规垿鏁嶉崟顐℃澀闂佺锕ュú姗€銆冮妷鈺佺濞达絽婀遍崢鎰版⒑閹稿海绠撴い锔诲灦閹锋垿鎮㈤崗鑲╁弳闂佺粯鏌ㄩ幖顐㈢摥婵°倗濮烽崑鎴﹀垂閻戞鈹嶅┑鐘叉搐鍥撮梺鍛婁緱閸樿棄鈻撻弻銉︹拺閻熸瑥瀚徊濠氭煕濮橆剦鍎戦柟骞垮灩閳规垿宕煎┑鍥┾偓鍐测攽閳藉棗鐏熼悹鈧敃鈧…鍥ь潩閼哥鎷洪梺纭呭亹閸嬫盯宕濆鈧弻娑㈠棘閼愁垰顏梺宕囩帛閹瑰洭鐛€ｎ喗鏅滈悷娆欑稻鐎氱厧鈹戦悙瀛樼稇闁告艾顑夐幃鐤樄鐎规洘纰嶇€佃偐鈧稒顭囬崢钘夘渻閵堝棙灏甸柛瀣枑閺呭爼鏁傞柨顖氫壕閻熸瑥瀚壕鎼佹煕鎼达絾鏆€规洘妞介崺鈧い鎺嶉檷娴滄粓鏌熼悜妯虹仴妞ゅ浚浜弻宥夋煥鐎ｎ亞浼岄梺鍝勮閸婃牠骞堥妸鈺佺疀妞ゆ垼妫勬禍楣冩煛閸モ晛鏋旀い鈺呮敱缁绘繃绻濋崒姘间还缂備浇顕уΛ娆撳Φ閸曨垰绠涢柛鎾茬劍閸嬔冣攽閻愭彃绾ч柟鍛婂▕瀵鏁嶉崟顏呭媰闂佷紮绲介懟顖炲焻闂堟党鏃堟偐闂堟稐娌梺鎸庢磸閸ㄤ粙濡存担绯曟瀻闁圭偓娼欏▓鐔兼⒑闂堟侗妾ч悗闈涙湰缁?(5缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋敐鍛闂佽姤蓱缁诲牓寮婚悢灏佹灁闁割煈鍠楅悘宥夋⒑閸濆嫭顥炵紒顔芥崌瀵鏁愭径濠勭杸濡炪倖甯婇悞锕傚磿閹剧粯鈷戦柟鑲╁仜婵″ジ鏌涙繝鍌涘仴闁绘侗鍣ｅ浠嬧€栭妷銉╁弰妞ゃ垺顨婇崺鈧い鎺嶆缁诲棗霉閻樺樊鍎愰柣?+ 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柤鑹板煐閹蹭即姊绘担鐟邦嚋缂佽鍊胯棟妞ゆ牗绮庨惌鍡楊熆鐠哄搫顦柛瀣崌閻涱噣宕归鐓庮潛婵＄偑鍊х€靛矂宕归崼鏇炵畺闁绘劕鎼崹鍌涖亜閹邦喖小缂併劌顭峰铏规兜閸涱喖娑х紓浣瑰絻婢ц棄鈽夐悽鍛婂殝闁绘劙鈧稓鐩庨梻濠庡亜濞诧箑煤閿曞倸纾?
    private void manageBrutalityAbility() {
        if (this.level().isClientSide) return;

        // 1. 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴濐潟閳ь剙鍊块幐濠冪珶閳哄绉€规洏鍔戝鍫曞箣閻欏懐骞㈤梻鍌欑窔閳ь剛鍋涢懟顖涙櫠閹绢喗鐓涢悘鐐插⒔閵嗘帡鏌嶈閸撱劎绱為崱娑樼；闁告侗鍘鹃弳锔锯偓鍏夊亾闁告洦鍓涢崢鎼佹倵閸忓浜鹃柣搴秵閸撴盯鏁嶉悢鍝ョ閻庣數顭堥鎾斥攽閳ヨ櫕鍠樻鐐茬箻閹晝鎷犻懠顒夊斀闂備礁婀遍崕銈夊春閸繍鐒介柕澶堝劗閺€浠嬫煟濡椿鍟忛柡鍡╁灦閺屽秷顧侀柛鎾寸懇瀹曨垳鎹勯妸褎锛忛悷婊勬瀵鎮㈢喊杈ㄦ櫓闂佺粯鎸哥花鍫曞磻閹捐绠瑰ù锝囨嚀娴犲ジ姊虹紒妯虹伇婵☆偄瀚弫顕€姊绘担绋挎毐闁圭⒈鍋婂畷鎰版偡閹佃櫕鐎洪梺鎼炲労閸撴岸鍩涢幋锔解拺妞ゆ劑鍊曟禒婊堟煠濞茶鐏￠柡鍛閳ь剛鏁哥涵鍫曞磻閹捐埖鍠嗛柛鏇ㄥ墰閳规稓绱撻崒姘毙滈柛瀣尵缁辨挻鎷呴崫鍕戯絿绱掔€ｎ偄鐏撮柛鈹垮劜瀵板嫭绻濇惔銏犲厞婵＄偑鍊栧濠氬磻閹惧墎纾奸柤纰卞墮娴滄儳菐閸パ嶈含闁诡喗鐟╅、鏃堝礋閵娿儰澹曢梺鍝勭▉閸樿偐绮堟径灞惧枑闊洦鎼╅崵妤€鈹戦悩鍙夊闁搞倕绉归弻鏇熷緞濞戞氨鏆犻悗娈垮枛閻忔繈鈥旈崘顔嘉ч柛鈩冾殘閻熴劑鏌ｆ惔銏犲毈闁告瑥鍟村畷鍝勨槈閵忕姷顔婂┑掳鍊撻懗鍫曞储闁秵鈷戦柛婵嗗閸屻劑鏌涢弬鎸庢拱缂佸倸绉撮…銊╁礋閳衡偓缁ㄥ妫呴銏＄カ缂佽尪妫勯锝夘敋閳ь剟寮?
        boolean isFullEnchant = true;
        net.minecraft.world.entity.EquipmentSlot[] checkSlots = {
                net.minecraft.world.entity.EquipmentSlot.HEAD,
                net.minecraft.world.entity.EquipmentSlot.CHEST,
                net.minecraft.world.entity.EquipmentSlot.LEGS,
                net.minecraft.world.entity.EquipmentSlot.FEET,
                net.minecraft.world.entity.EquipmentSlot.MAINHAND
        };
        for (EquipmentSlot slot : checkSlots) {
            ItemStack s = this.getItemBySlot(slot);
            if (s.isEmpty() || !s.isEnchanted()) {
                isFullEnchant = false;
                break;
            }
        }

        if (!isFullEnchant) {
            if (this.entityData.get(IS_BRUTAL)) {
                this.entityData.set(IS_BRUTAL, false);
            }
            brutalityActiveTimer = 0;
            return;
        }

        // 2. 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼槮闁搞劍绻冮妵鍕冀椤愵澀姹楅梺閫炲苯澧剧紒鐘虫尭閻ｉ攱绺界粙璇俱劑鏌曟径娑㈡鐞氾綁姊婚崒娆戭槮闁圭⒈鍋嗙划娆愮瑹閳ь剙鐣烽姀锛勯檮闁告稑锕ら埀顒€娼￠弻娑⑩€﹂幋婵呯按婵炲瓨绮嶇划鎾诲蓟閻斿憡缍囬柛鎾楀惙鎴犵磼缂併垹骞栭柣鏍с偢瀵鈽夐姀鐘愁棟闁荤姵浜介崜閬嶆晲閸モ晝锛滅紓鍌欑劍椤洨绮诲顓滀簻闁挎棁顕у▍宥夋煛鐏炲墽銆掗柍褜鍓ㄧ紞鍡涘磻閸涱厾鏆﹂悘鐐靛亾閸欏繐鈹戦悩鎻掝伀閻㈩垱绋撶槐鎺懳旈崘銊︾亪閻庤娲橀崕濂杆囨潏鈺冪＜闁靛ě鍐ㄤ粯闂佸疇顫夐崹鍧楀垂妤ｅ啫绀冮柤纰卞墴閻涙捇姊哄Ч鍥х労闁搞劍濞婂畷鎴濃槈閵忕姷鍘?
        boolean isBrutalActive = this.entityData.get(IS_BRUTAL);

        if (isBrutalActive) {
            // [闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼槮闁搞劍绻冮妵鍕冀椤愵澀姹楅梺閫炲苯澧剧紒鐘虫尭閻ｉ攱绺界粙璇俱劍銇勯弮鍥撴繛鍛崌濮婄粯鎷呴崨濠呯婵犫拃鍕垫當妞ゎ厼鐏濊灒闁兼祴鏅欑粭?A]: 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣銏犲閺佸﹪鏌″搴″箹缂佹劖顨嗘穱濠囧Χ閸涱厽娈查悗瑙勬礃閻擄繝寮婚悢鍏肩劷闁挎洍鍋撻柡瀣〒缁辨帡鐓幓鎺嗗亾濠靛钃熼柨鏇楀亾閾伙絽銆掑鐓庣仭妞ゅ骸妫濆娲嚃閳轰緡鏆柣搴ｇ懗閸ヮ灛锕傛煕閺囥劌鏋ら柣銈傚亾闂備浇顫夊畷妯衡枖濞戔挋鐑藉焵椤掑嫭鈷掑ù锝勮閻掔偓銇勯幋婵囶棦鐎规洖缍婂畷绋课旈埀顒勬嫅閻斿摜绠鹃柟瀵稿仧閻擃垱绻涘畝濠侀偗闁哄本鐩獮妯侯渻鐠囪弓澹曞┑鐘愁問閸犳牕煤椤撶儐娼?(5闂?
            brutalityActiveTimer--;
            if (brutalityActiveTimer <= 0) {
                this.entityData.set(IS_BRUTAL, false);

                // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柤纰卞墻濡茬兘姊绘担鍛婃儓婵炲眰鍨藉畷鍦喆閸曨剙鍔呮繝鐢靛Т濞诧箓鎮″▎鎴犵＝濞达絽顫栭鍡欑當鐟滄棃寮婚敓鐘插耿闁归偊鍏橀崑鎾斥攽鐎ｎ亣鎽曞┑鐐村灟閸╁嫰寮崘顔界厽婵☆垵顕х徊璇测攽椤旇姤绀嬫慨濠冩そ瀹曨偊宕熼鈧娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱樈閸犳顕欏ú顏呪拺缂侇垱娲栨晶鍙夈亜閵娿儲鍤囬柨婵堝仱椤㈡洟鏁傜憴锝嗗闂備礁鎲＄缓鍧楀磿鏉堛劎顩插┑鍌氭啞閻撴洟鏌￠崒姘仴闁告瑥瀚伴弻鐔碱敍濡も偓娴滅偓淇婇悙顏勨偓鏇犳崲閹扮増鍋嬫繝濠傜墕閺嬩線鏌涢妷锝呭缂佺娀绠栭弻鐔衡偓鐢告櫜缁辨娊鏌涜箛姘汗闁?5闂?- 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣銏犲閺佸﹪鏌″搴″箹闂傚偆鍨遍妵鍕冀閵娧呯厐缂備浇缈伴崐婵嬪蓟閿濆鏅查柛娑卞枟閹烽亶鎮楃憴鍕闁绘搫绻濆濠氭偄閸忕厧鈧粯淇婇婊呭笡闁稿骸楠搁埞鎴︽倷閼碱剙顣圭紓渚囧枟閻熲晛顕ｇ拠娴嬫闁靛繒濮堥妸锔轰簻闁哄啫鍊哥敮鑸点亜椤愵偂閭慨?闂?
                int reduceSeconds = this.getTier() * 3;
                int cdSeconds = Math.max(5, 25 - reduceSeconds);
                brutalityCooldown = cdSeconds * 20;

                this.playSound(SoundEvents.LAVA_EXTINGUISH, 1.0f, 0.5f);
            }
        } else {
            // [闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼槮闁搞劍绻冮妵鍕冀椤愵澀姹楅梺閫炲苯澧剧紒鐘虫尭閻ｉ攱绺界粙璇俱劍銇勯弮鍥撴繛鍛崌濮婄粯鎷呴崨濠呯婵犫拃鍕垫當妞ゎ厼鐏濊灒闁兼祴鏅欑粭?B]: 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛濠傛健閺屻劑寮崹顔规寖闂佹椿鍘介悷鈺呭蓟閻斿皝鏋庨梽鍥敋瑜嶇叅妞ゆ搩娼块埀顑跨閳藉顫滈崱娆忓汲闂備礁鎲″ú鐔奉焽瑜庣粋鎺懨洪鍛嫽婵炶揪缍€濞咃絿鏁☉娆愬弿濠电姴鍋嗛悡鑲┾偓瑙勬磸閸ㄥジ藝鐎靛摜纾兼い鏃囧亹婢э妇鈧娲橀敃銏ゃ€侀弮鈧幏鍛存⒐閹邦剦妫滈梻鍌欐祰瀹曠敻宕伴幇顒夌唵婵せ鍋撴い銏℃椤㈡棃宕ㄩ婊呮闂備線娼х换鍡椢ｉ崨瀛樺€块柣锝呯灱绾?
            if (brutalityCooldown > 0) {
                brutalityCooldown--;
            } else {
                // 闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃繘鍩€椤掍胶鈻撻柡鍛█閵嗕礁鈻庨幘鍐插敤濡炪倖鎸鹃崑鐔兼偘閵夆晜鈷戦柛锔诲幖閸斿銇勯妸銉﹀櫧濠㈣娲樼换婵嗩潩椤撶姴骞嶉梻浣告啞閹稿棝宕ㄩ鐙€鍋ч梻鍌欒兌缁垶骞愮拠瑁佸搫顫滈埀顒勭嵁閸儱惟闁靛娴烽崰鏍箖閳╁啯鍎熼柍銉ㄥ皺鐢盯姊婚崒娆愮グ妞ゆ泦鍕垫闊洦娲栫欢銈吤归悩宸剰闁绘挻锕㈤弻鐔告綇閹呮В闂佽桨绀佺粔褰掑蓟閵娿儮鏀介柛鈩兠▍褎绻涚€电校闁诡喖鍊搁～?
                this.entityData.set(IS_BRUTAL, true);
                brutalityActiveTimer = 100; // 5闂?

                this.playSound(SoundEvents.ENDER_DRAGON_GROWL, 1.0f, 0.5f);
                if (this.level() instanceof ServerLevel sl) {
                    sl.players().forEach(p -> {
                        if (p.distanceToSqr(this) < 256) {
                            p.displayClientMessage(Component.literal("闂?闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼槮闁搞劍绻冮妵鍕冀椤愵澀绮剁紓浣插亾濠㈣埖鍔栭悡銉╂煛閸モ晛浠滈柍褜鍓欓幗婊呭垝閿濆憘鏃堝川椤旀儳骞愰柣搴＄畭閸庤鲸顨ラ幖浣稿偍闂傚牊鑰介悷閭︾叆闁告劦浜炴闂備浇顕栭崰妤呫€冮崨鏉戠叀濠㈣泛艌閺嬪秹鏌ц箛锝呬簻闁诲骏濡囩槐鎺楀磼濮樻瘷褍鈹戦垾宕囧煟鐎规洖宕埢搴ㄥ箣椤撶偞娅楅梻鍌氬€烽懗鍫曞箠閹炬椿鏁嬫い鎾跺枎椤曡鲸绻濋棃娑卞剾闁轰礁鍊块弻娑㈠即閵忊剝閿┑鐐茬墑閸旀垵顫忛搹瑙勫枂闁告洦鍋勬慨鍛婄節濞堝灝鏋旈柛濠冪箞楠炲啴鏁撻悩鍐蹭簻闂佸憡绺块崕鎶筋敊閺囥垺鈷戠紒顖涙礀婢у弶銇勯妸銉уⅱ缂侇喚绮€佃偐鈧稒顭囬崢鎾绘偡濠婂嫮鐭掔€规洘绮岄埥澶愬閻樼數鏋冮梻浣筋潐瀹曟﹢顢氶弽顓炴辈闁绘鐗忕弧鈧┑鐐茬墕閻忔繈寮搁悢鍏肩叆闁哄洦顨嗗▍濠勨偓瑙勬礃濞茬喖骞冩禒瀣窛濠电姴鍊风花濠氭⒒娴ｈ櫣甯涢柟鍝ヮ焾闇夐梺鍨儏椤曢亶鎮楅敐搴℃灍闁稿﹦鏁婚幃宄扳枎韫囨搩浠剧紓浣插亾闁逞屽墮閳规垿鎮欓懠顒佸嬀闂佸憡姊归崹鎸庝繆鐎涙鐟归柍褜鍓欓悾鐑藉Ω瑜夐崑鎾斥槈濞呰鲸宀搁獮?5s)"), true);
                        }
                    });
                }
            }
        }
    }
    // ==================== 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰鍐€妞ゆ劦婢€濞岊亪姊?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ弬娆炬祲濠㈣埖鍔曠粻娑㈡煛婢跺孩纭堕柨娑欑洴濮婇缚銇愰幒鎴滃枈闂佸憡锚婢х晫鍒掔紒妯稿亝闁告劏鏅濋崢鎾绘偡濠婂嫮鐭掔€规洘绮撻幃銏ゆ偂鎼淬倖鎲伴柣搴＄畭閸庨亶鎮у鍐剧€堕柕濞炬櫆閳锋垹绱掔€ｎ厽纭剁紒鐘崇叀閺岋綁鍩℃繝鍌滀桓濡ょ姷鍋涢崯鎾箖濞嗘挻鍊绘俊顖滅帛閻濇牕鈹戦悙鑸靛涧缂佽弓绮欓獮澶愬灳閺傘儲鐏侀梺鍝勮閸庢煡鍩涢幒妤佺厱閻忕偛澧介幊鍡涙煕韫囨挻婀伴柕鍥у椤㈡洟濮€閳轰礁澹庨柣搴ゎ潐濞叉粓宕伴弽褏鏆︾憸鐗堝俯閺佸啴鏌曢崼婵囶棡缂侀鍓熷濠氬磼濮橆兘鍋撴搴㈩偨婵娉涢悞鍨亜閹烘垵鈧憡绂掑鍫熺厾婵炶尪顕ч悘锟犳煛閸涱厾鍩ｆい銏＄☉閳藉螖閸愵亞鏆伴梻鍌欑閹诧繝鎮烽妷鈹у洭顢涘鍛暥閻熸粌娴烽幑?====================
    public boolean hasTeleportModule() { return this.entityData.get(HAS_TELEPORT_MODULE); }
    public void setHasTeleportModule(boolean has) { this.entityData.set(HAS_TELEPORT_MODULE, has); }

    public boolean canTeleport() {
        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂磋閳ь剨绠撻、妤呭礋椤愩倧绱遍梻浣告啞濞诧箓宕愮€ｎ€㈡椽顢旈崟骞喚鐔嗛悹铏瑰皑閸旂喖鏌ｉ妶鍛悙闁宠鍨块、娆愭叏閹邦亞鎹曢梻浣侯焾椤戝棝骞愰幖浣哥厴闁硅揪闄勯弲顒勬煕閺囩偟浠涙い銉︽尵缁辨挻鎷呴崫鍕戯綁鏌ｉ埡濠傜仩妞ゆ洩缍佸鍫曞箠閾忣偅顥堥柛鈹惧亾濡炪倖甯婇懗鍫曘€呴幓鎹ㄦ棃鏁愰崨顓熸闂佺粯鎸鹃崰鏍蓟閿濆绫嶉柛灞捐壘娴犳ɑ绻涚€涙鐭屽褎顨嗙粚杈ㄧ節閸パ咁唽闂佸湱鍎ら崹鍫曞磹椤栫偞鈷戦梻鍫熺⊕閹兼劙鎮楀鍗烆暭濞ｅ洤锕幃婊堟寠婢光斂鍔嶉妵鍕冀閵娧呭彎缂備焦鍞荤紞浣割潖濞差亜鐭楅柕澹倽顩紓鍌氬€哥粔宕囨濮橆剦鍤曢悹鍥ф▕閸氬顭跨捄濂斤繝濡搁埡鍌滃帾婵犵數濮寸换鎰般€呴鍌涘枑闁硅泛锕ゅú锕傚煕閹寸姷纾奸悗锝庡亽閸庛儵鏌涙惔锛勑ч柡灞剧⊕閹棃濡搁妶鍡楁灓闂備胶纭堕弬鍌炲磿閹绘帩鍤楅柛鏇ㄥ灠缁犳稒銇勯幒鎴濅簽闁哥喎顑夊铏规嫚閹绘帩鍔夌紓浣割儐鐢繝鍨鹃敃鍌氱倞妞ゆ巻鍋撻柣顓燁殜閺屾盯鍩勯崘顏佸闂佹娊鏀遍崹鍧楀蓟濞戞ǚ鏀介柛鏇ㄥ亜婵酣鎮楀☉娆戠疄婵﹦绮幏鍛矙鐠恒劎娉跨紓鍌欐祰瀵挾鍒掑▎鎾崇畺濡わ絽鍟崐濠氭煠閹帒鍔滄繛鍛灲濮婅櫣绱掑鍡欏姼闁诲繐绻戦悷锕傘€冮妷鈺佺倞妞ゆ帊璁查幏娲⒑閼姐倕鏋涢柛瀣躬瀹曠敻鎮㈢亸浣规杸濡炪倖娲嶉崑鎾寸箾娴ｅ啿娲ら悡婵嬫煙閻愵剚銇熼柡浣割儔閺屽秷顧侀柛鎾寸懇閿?
        return this.hasTeleportModule() && teleportCooldown <= 0;
    }
    public void setTeleportCooldown(int ticks) { this.teleportCooldown = ticks; }

    private void tickTeleportCooldown() {
        if (teleportCooldown > 0) teleportCooldown--;
        if (blackHoleCooldown > 0) blackHoleCooldown--;
    }

    // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕閻庤娲忛崕鎶藉焵椤掑﹦绉甸柛鐘崇墱婢规洟宕稿Δ浣哄幍闂佽鍨虫晶妤吽夋径鎰闁哄鍩婇煬顒勬煛鐏炶鈧繈骞婂┑瀣妞ゆ棁鍋愭晶顖氣攽閻愯尙鎽犵紒顔肩灱缁辩偞绻濋崶褑鎽曞┑鐐村灟閸ㄧ懓鏁俊鐐€栧Λ浣哥暦閻㈢姹叉俊銈勮兌缁犻箖鎮楀☉娆樼劷闁活厼锕︾槐鎾愁吋閸滃啳鍚悗娈垮枛椤兘骞冮姀銈嗗亗閹艰揪绲块弳浼存煟閻斿摜鐭婄紒澶屾嚀椤曪綁鎼归锝囩Ф闂侀潧顭徊鑲╄姳婵犳碍鈷戦梻鍫熺〒婢ф洟鏌熼崘鑼鐎规洘濞婇幃鎯х暆閳ь剛澹曟總绋跨骇闁割偅绋戞俊鑲╃磼濡や礁娴柡灞界Ч閹稿﹥寰勫Ο鎭嶏箑顪冮妶搴′簼缂侇喗鎸搁悾鐑藉础閻愬秶鍠栭幃娆擃敂閸曨偒鐎村┑鐑囩到濞层倝鏁冮鍛箚闁割偅娲栭悙濠冦亜椤掑鏋旈柛銊ㄦ閹广垹鈽夊顐ｅ媰闂佺鏈懝楣冿綖閸ヮ剚鈷戠紒顖涙礃閺夊綊鏌涚€ｎ偅灏い顏勫暣婵″爼宕卞Δ鍐噯闂備胶顭堥敃銈囩礊婵犲偆鍤曢柟鎯版閻撴盯鏌涘☉鍗炴灓闁告鏁诲娲箚瑜庣粋瀣煕鐎ｎ亝鍣藉ù婊勬倐閹粙宕ㄦ繝鍕箻婵犵數鍋涘Ο濠冪濞嗘挸绠熼柛鎾椻偓閸嬫挸鈻撻崹顔界亪濡炪値鍙冮弨杈ㄧ┍婵犲洦鍊婚柤鎭掑劜濞呭洭姊洪柅鐐茶嫰婢у鈧娲樼划鎾汇€佸鈧慨鈧柍閿亾闁归攱妞藉娲川婵犲嫧妲堥梺鎸庢磸閸庢彃顕ラ崟顖氱妞ゆ劏鍋撻柣鐔煎亰閻撱儵鏌涘☉鍗炲箳婵″弶鍔欏铏规嫚閳ヨ櫕鐏嶉梺鑽ゅ櫐婵″洭骞戦姀鐘斀閻庯綆浜為崐鐐烘⒑闂堟侗鐒鹃柛銊ㄦ閳ь剚鑹鹃崥瀣┍婵犲洦鍊锋い蹇撳閸嬫捇寮介鐐殿槷閻熸粌绻愬嵄闁圭増婢橀崡鎶芥煃鐠虹儤鎯堟繛宸弮瀵偊宕橀鑲╋紲濠电偞鍨堕懝楣冪嵁閸儲鈷掑ù锝堟鐢盯鎷戦柆宥嗙厽闁瑰灝瀚弧鈧悗瑙勬穿缂嶄礁鐣烽悢纰辨晬婵炴垶鑹鹃獮?(Tick)
    // Configurable via TurretConfig
    public int getMaxTeleportCooldown() {
        int tier = getTier();
        int base = TurretConfig.COMMON.teleportCooldownBase.get();
        int reduction = TurretConfig.COMMON.teleportCooldownReductionPerTier.get();
        int min = TurretConfig.COMMON.teleportCooldownMin.get();
        return Math.max(min, base - (tier * reduction));
    }

    private void tickBlackHoleEffect() {
        if (this.level().isClientSide || this.blackHoleActiveTicks <= 0) {
            return;
        }
        if (!(this.level() instanceof ServerLevel serverLevel)) {
            return;
        }

        int level = this.teleportModuleLevel;
        if (level < 3) {
            this.blackHoleActiveTicks = 0;
            return;
        }

        this.blackHoleActiveTicks--;
        double range = TeleportModuleRules.blackHoleRangeForLevel(level) * TurretConfig.COMMON.blackHoleRangeScale.get();
        if (range <= 0.0) {
            return;
        }

        final double rangeSqr = range * range;
        int scanCap = Math.max(8, TurretConfig.COMMON.blackHoleEntityScanCap.get());
        var area = new net.minecraft.world.phys.AABB(
                this.blackHoleCenter.x - range, this.blackHoleCenter.y - range, this.blackHoleCenter.z - range,
                this.blackHoleCenter.x + range, this.blackHoleCenter.y + range, this.blackHoleCenter.z + range
        );

        java.util.List<LivingEntity> targets = this.level().getEntitiesOfClass(
                LivingEntity.class,
                area,
                e -> isValidBlackHoleTarget(e, rangeSqr)
        );
        targets.sort(java.util.Comparator.comparingDouble(e -> e.distanceToSqr(this.blackHoleCenter)));
        if (targets.size() > scanCap) {
            targets = targets.subList(0, scanCap);
        }

        for (LivingEntity target : targets) {
            double dx = this.blackHoleCenter.x - target.getX();
            double dy = this.blackHoleCenter.y - target.getY();
            double dz = this.blackHoleCenter.z - target.getZ();
            double len = Math.sqrt(dx * dx + dy * dy + dz * dz);
            if (len < 1.0e-4) {
                continue;
            }
            double pull = 0.28 + Math.min(0.30, range / 120.0);
            target.setDeltaMovement(
                    target.getDeltaMovement().add(dx / len * pull, Math.min(0.18, dy / len * pull + 0.04), dz / len * pull)
            );
            target.addEffect(new MobEffectInstance(MobEffects.MOVEMENT_SLOWDOWN, 8, 1, false, false, true));
        }

        // Strong visual cue while black-hole pull is active.
        serverLevel.sendParticles(ParticleTypes.PORTAL, this.blackHoleCenter.x, this.blackHoleCenter.y + 0.25, this.blackHoleCenter.z,
                36, range * 0.22, 0.35, range * 0.22, 0.05);
        serverLevel.sendParticles(ParticleTypes.ENCHANT, this.blackHoleCenter.x, this.blackHoleCenter.y + 0.15, this.blackHoleCenter.z,
                24, range * 0.20, 0.28, range * 0.20, 0.02);
        serverLevel.sendParticles(ParticleTypes.SMOKE, this.blackHoleCenter.x, this.blackHoleCenter.y + 0.15, this.blackHoleCenter.z,
                18, range * 0.18, 0.20, range * 0.18, 0.01);
    }

    private boolean isValidBlackHoleTarget(LivingEntity target, double rangeSqr) {
        if (target == null || !target.isAlive()) return false;
        if (target == this || target instanceof Player || target instanceof SkeletonTurret) return false;
        if (target.getPersistentData().getBoolean("IsFriendlyZombie")) return false;
        if (target.getPersistentData().getBoolean("IsFriendlyCreeper")) return false;
        return target.distanceToSqr(this.blackHoleCenter) <= rangeSqr;
    }

    @Override
    public void tick() {
        super.tick();

        if (this.isDeadOrDying()) {
            return;
        }

        // 闂?Carry On 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛濠傛健閺屻劑寮崹顔规寖闂佹椿鍘介悷鈺呭蓟閻斿皝鏋庨梽鍥敋瑜嶇叅妞ゆ挶鍨诲畵渚€鐓崶銊︾；婵炲矈浜弻銈夊箒閹烘垵濮曞銈嗘煥椤﹁京妲愰幘璇茬＜婵﹩鍏橀崑鎾诲箹娴ｅ摜锛欓梺褰掓？缁€浣哄閻熼偊娓婚悗锝庝簼閹癸綁鏌ｉ鐐搭棞闂囧鏌ㄥ┑鍡欏闁逞屽厴閸嬫捇姊虹粙娆惧剱闁瑰憡鎮傞敐鐐测攽鐎ｎ偄浜楅柟鑹版彧缁辨洟鎯堥崟顑跨箚闁靛牆娲ゅ暩闂佺顑嗙粙鎴ｇ亱濠电偛妫楀ù姘跺吹濡ゅ懏鐓曢柡鍥ュ妼楠炴劙鏌涚€ｎ偅宕岄柡浣瑰姈閹棃鍨鹃懠顒佹濠电姵顔栭崰妤呮晝椤愩倗涓嶉柟鐐墯濞兼牕螖閿曚緤楠忓ù婊冪秺閺岀喖鎮滃Ο铏逛化闂佸摜濮撮敃顏勵潖濞差亜宸濆┑鐐村笩閸嬫劙宕氶幒鎴旀瀻闁圭儤鎼╁Λ銊╂⒑閼姐倕鏋戠紒顔肩Т铻為柛鎰电厛閸ゆ洖鈹戦悩瀹犲閹喖姊洪棃娑辨Ф闁搞劍妞介敐鐐差吋閸涱亝鏂€闂佸疇妫勫Λ妤呮倶閿濆洨纾兼い鏇炴噹閻忥附顨ラ悙鑼鐎规洩绻濋幃娆撳煛閸屾稒婢戦梻鍌欒兌缁垶宕濆Ο闂寸剨婵炲棙鍔栧▍鐘绘煛閸モ晛啸缁炬崘鍋愮槐鎾存媴閸忓锛堝銈呯箰閻楀﹪宕戦埡鍛厽闁硅揪绲鹃ˉ澶岀磼閻欏懐绋荤紒缁樼箞瀹曞綊顢曢姀鐙€娼曢梻浣告啞閻熴儱螞濠靛棭娼栨繛宸簼閻掑鏌ｉ幇顖氳敿閻庢碍婢橀…鑳槺闁告濞婂璇差吋閸偅顎囬梻浣告啞閹搁箖宕版惔銊⑩偓锕傚炊椤忓秵鈻岄梻浣筋嚃閸ㄤ即鎯岄崒姘辨殾闁圭儤鍩堝鈺呭级閸稑濡芥い鏃€娲樼换婵嬫偨闂堟稈鏋呭┑鐐板尃閸ヨ埖鏅為梺鍛婁緱閸犳牠宕濋弬搴撴斀闁挎稑瀚禍濂告煕婵炲灝鈧繂鐣烽姀锛勵浄閻庯綆浜滈悗顓㈡⒑閸撴彃浜濇繛鍙夌墪铻炴慨妞诲亾闁哄苯绉烽¨渚€鏌涢幘瀵告噰闁糕晝鍋ら獮瀣晜閽樺鍋撻悜鑺ョ厸濠㈣泛顑呴悘鈺伱归悩铏€愭慨濠囩細閵囨劙骞掗崱妞惧濠电偞鍨堕崙鐟拔ｉ纰辨富闁靛牆鍊瑰▍鍛存煏閸繃鍟炲ǎ鍥э工椤垹鐣濇繝鍐冾剛绱撻崒娆掑厡濠殿噣娼ч～蹇旂節濮橆剛鍔﹀銈嗗坊閸嬫捇鏌涘Ο鑽ょ煉鐎规洘鍨块獮妯肩磼濡厧骞堥梻浣告惈濞层垽宕濈仦鍓ь洸闁绘劖鐣禍婊堟煙閹规劖鐝柟顖氱墦閺屽秶鎲撮崟顐や紝闂佺硶鏂傞崕闈涚暦閸楃倣鏃堝礃瑜嶇€佃尙绱撻崒姘偓椋庢閿熺姴闂い鏇楀亾鐎规洖缍婂畷濂稿即閻愮數鏆繝纰樻閸垳鎷冮敃鍌氳Е閻庯綆浜堕悢鍡涙偣鏉炴媽顒熼柛搴＄焸閺岀喐顦版惔锝呯缂備胶绮换鍫ュ箖娴犲顥堟繛纾嬬堪閸ㄤ粙寮婚悢鐓庣闁肩⒈鍓涢鎺楁⒑鐠団€虫灓闁轰礁顭烽妴渚€寮崼婵嬪敹闂佺粯鏌ㄩ幖顐︾嵁閹扮増鈷掑ù锝呮啞閸熺偛銆掑顓ф疁鐎规洘鍨垮畷鐔碱敍濮橀硸妲烽梻浣瑰濞叉牠宕愯ぐ鎺撳亗婵炴垶鈼よぐ鎺撴櫜闁告侗鍠楅崰鎰版倵濞戞瑧绠炴慨濠勫劋鐎电厧鈻庨幋鐘愭垹绱撴担绛嬪殭闁绘妫濋幃楣冩倻閼恒儱浜滅紒鐐妞存悂寮插鍫熲拺缂侇垱娲栨晶鏌ユ煟閻旀繂娉氶崶顒夋晝闁挎棁袙閹峰姊虹粙鎸庢拱闁荤喆鍔戝畷妤冧沪娣囧彉绨诲銈嗘尵閸嬬喐鏅堕姀銈嗙厵妤犵偛鐏濋悘鍙夘殽閻愬弶鍠樻い銏＄懇瀹曟粏顦撮柛妯煎█濮婄粯鎷呴崨濠傛殘闂佸憡姊瑰ú鏍亽婵犵數濮撮崑鍡涙倿娴犲鐓冮柛婵嗗閸ｆ椽鏌ｉ幘鍗炲姦闁哄矉绻濆畷姗€濡搁妷銏犱壕闁荤喐澹嬮弸宥夋煛閸モ晛鏋傚ù婊勭矒閺屽秹宕崟顐熷亾婵犳艾鐭楅柍褜鍓熷娲传閸曨厾浼囬梺鍝ュУ閻楃娀鐛崘顭戠叆闁稿繐澧介崰鎾诲箯閻樿钃熼柕澹偓閸嬫挸煤椤忓應鎷绘繛杈剧秬濞咃綁濡存繝鍥ㄧ厸闁告侗鍠氬ú瀵糕偓瑙勬礃閸旀瑥鐣风粙璇炬棃鍩€椤掑嫭瀚呴柣鏂挎憸缁犻箖鏌熺€涙鎳冮柣蹇ｄ邯閺岋繝宕ㄩ鎯у绩濡ょ姷鍋為悧婊堝焵椤掍胶鈯曟い顓炴川缁鎮欓悜妯煎幈闁诲函缍嗛崑鎺戔枔濠婂嫭鍙忓┑鐘叉噺椤忕姷绱掓潏銊ョ瑨閾伙綁鎮归崶顏勭毢妞わ絾鐓″缁樻媴閾忕懓绗￠梺缁橆殕缁挸鐣烽姀锝庢▌闂佽鍣ｇ粻鏍箖濠婂懐椹抽悗锝庡亝濞呭棝姊绘担鍛婂暈婵炶绠撳畷銏ゆ寠婢跺棙鐏侀梺鍝勬储閸ㄦ椽鍩涢幋锔解拺妞ゆ劑鍊曟禒婊堟煠濞茶鐏￠柡鍛埣椤㈡盯鎮欑€电骞嶅┑鐐存尰閼归箖鎮樺┑鍥ㄥ弿闁稿本渚楀▓浠嬫煟閹邦剦鍤熷褜鍓熼弻鐔风暋閻楀牆娈楅悗瑙勬处閸嬪﹥淇婇悿顖ｆЪ濠电偛鐗嗛幉锛勬崲濠靛鍋ㄩ梻鍫熺◥閸濇姊虹憴鍕仧濞存粎鍋涢銉︾節閸パ囨暅濠碉紕鍋熼崕鐢稿磻閹剧粯鏅濋柛灞惧哺閸炲爼姊洪棃娑辨Ф闁稿孩濞婇幃锟犲箣閿旇В鎷洪柣鐘充航閸斿矂寮搁弬搴撴斀妞ゆ梻鍋撻弳顒勬煙椤斿厜鍋撻弬銉︾€婚梺鐟板⒔鐞涖儵骞忔繝姘拺闁告挻褰冩禍鐐烘煕閻樿櫕宕岄柛鈹垮劜瀵板嫬鐣濋埀顒傚婵傚憡鐓忓┑鐐茬仢閸旀挳鏌ｉ幘鐐藉仮闁?
        if (!this.level().isClientSide && this.isPassenger()) {
            this.getNavigation().stop();
            this.setDeltaMovement(0.0, 0.0, 0.0);
            this.setTarget(null);
            this.guardLockValid = false;
            return;
        }

        tickTeleportCooldown();
        tickBlackHoleEffect();

        // 闂?[Fix] 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箻閺岀喖骞嗛弶鍟冩捇鏌涙繝鍌涘仴闁哄被鍔戝鏉懳旈埀顒佺閹屾富闁靛牆楠搁獮鏍煟韫囨梻绠氶柣蹇斿浮濮婃椽宕楅懖鈹垮仦闂佸搫鎳忕换鍫ｆ濡炪倖鐗滈崑鐐哄磹閸偒娈介柣鎰皺娴犮垽鏌涢弮鈧喊宥夊Φ閸曨垱鏅滈悹鍥皺娴狀垰鈹戦悙鏉戠仼闁轰礁顭峰畷娲焵椤掍降浜滈柟鐑樺灥椤忣亪鏌嶉柨瀣伌闁哄矉缍侀獮鍥敍濞戣鲸顥夐梻浣告啞濮婄懓鐣濋幖浣歌摕婵炴垯鍨洪崑鍕磽娴ｈ鐒介柕鍡楋攻缁绘稓鈧稒顭囬惌瀣煙椤旂厧鈧悂鎮鹃悜钘夌闁绘劏鏅滈～宥呪攽閻愬弶顥為柛銊ф暬閻涱噣宕奸妷锔规嫽婵炶揪缍€濞咃絿鏁☉銏＄厱闁哄啯鎹囧顔剧磼閸屾氨孝妞ゎ厹鍔戝畷鐓庘攽閸繂袝濠碉紕鍋戦崐鏍暜婵犲洦鍊块柨鏂垮⒔閻棝鎮楅敐搴℃灍闁绘挻鐟﹂妵鍕棘閸喗鍊梺绋款儍閸庢娊鍩€椤掑喚娼愭繛鍙夌矒瀹曚即寮介婧惧亾娴ｈ倽鏃€鎷呴悷閭︹偓鎾绘⒑閸涘﹥灏扮紒浣规尦瀹曟垿骞樼拠鑼啋缂傚倷鐒﹁彜闁归攱妞介弻锝夋偄閸濄儲鍣ч柣搴㈠嚬閸撴稓鍒掗崼銉ョ妞ゆ梻鏅崢閬嶆⒑閸愬弶鎯堥柛濠勭帛閺呭爼鎮介崨濠勫幍濡炪倖娲嶉崑鎾剁磼閻樺磭澧电€殿喖顭峰畷鍗炍旀繝鍌涘€梻浣虹《閸撴繈鎮烽妷鈺冨祦婵°倓鑳剁弧鈧紒鐐緲椤﹁京澹曢崸妤佺厱閻庯綆鍓欓弸鏃堟煕閹烘挸娴い銏＄☉椤繈鏁愰崱娆屽亾濞差亝鈷戦柟鑲╁仜閸旀挳鏌涢幘鏉戝摵闁诡喒鈧枼鏋庨柟鎵虫櫃缁ㄥ姊洪崫鍕殭闁稿﹤鐖奸崺鈧い鎺嗗亾妞ゆ垵顦锝夊Ω閳哄倸娈ラ梺闈涚墕濞层劑鏁嶅鍫熺厽閹兼惌鍨崇粔闈浢瑰鍡樼【閸楄京鎲搁悧鍫濈瑲闁绘挻鐟﹂妵鍕冀閵娧€濮囧銈冨劚閻楁捇寮婚埄鍐╁闁荤喐婢橀～鎺楁倵鐟欏嫭纾搁柛鏃€鍨甸悾鐑筋敂閸繄顦ㄥ銈呯箰濡瑥鈻撴總鍛娾拻濞达絽鎲￠幆鍫ユ煟椤掆偓閵堢鐣锋导鏉戝唨妞ゆ挻澹曢崑鎾寸瑹閳ь剙顕ｆ禒瀣垫晣闁绘劖顔栭崬鍫曟⒑閻熸澘鎮戦柟顖氱焸瀹曟澘螖閸涱厾鍘烘繝鐢靛Т濞诧箓鍩涢幒鎴欌偓鎺戭潩閿濆懍澹曢梻渚€鈧偛鑻晶顖滅磼鐎ｎ偅宕岄柛鈺冨仱楠炴帒螖娴ｅ搫骞堥梻浣告惈閸熺娀宕戦幘缁樼厱闁靛鍎虫禒銏°亜?
        if (!this.level().isClientSide && this.getPersistentData().getBoolean("RecordSummoned") && this.isFollowing()) {
            // 1. 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼槮闁搞劍绻冮妵鍕冀椤愵澀绮舵俊妤€鎳庨埞鎴︽倷閺夋垹浠ч梺鎼炲妼缂嶅﹪骞冮崸妤佸€锋い鎺戝€婚惁鍫ユ⒒閸屾氨澧涘〒姘殜瀹曟洝绠涢弴鐘碉紲闂佺粯锚绾绢厽鏅堕鍫熺厓閻熸瑥瀚悘鎾煙椤旇娅婃鐐存崌楠炴帡骞橀幖顓炴櫃闂傚倸鍊风粈浣哄椤撱垹绠犻柟鎯у閻捇鏌ｉ姀銏╃劸濡楀懘姊洪崨濠冨闁搞劍澹嗛悮鎯ь吋婢跺鍘遍柣蹇曞仜婢т粙鎯岀€ｎ喗鐓欓柛娆忣檧閼版寧鎱ㄦ繝鍐┿仢鐎规洏鍔嶇换婵嬪礃椤忓嫬绠伴梻?(婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾剧粯绻涢幋娆忕労闁轰礁顑嗛妵鍕箻鐠虹儤鐎鹃梺鍛婄懃缁绘﹢寮婚悢铏圭＜闁靛繒濮甸悘鍫㈢磽娴ｅ搫啸濠电偐鍋撳Δ鐘靛仦閻楁粓宕氶幒鏃€鍠嗛柛鏇炵仛缂嶅牓姊绘担钘変汗濠⒀勵殘閳ь剛鐟抽崶顬箓鏌涢弴銊ユ灓闁汇倐鍋撻梻浣筋潐瀹曟ê鈻斿☉鈷欑兘鍩€椤掍椒绻嗛柣鎰典簻閳ь剚鍨垮畷鏇㈡焼瀹ュ棗浜遍梺瑙勫礃椤曆囨嫅閻斿吋鐓ユ繝闈涙－濡插摜绱掗悩宕団姇闁靛洤瀚伴獮妯兼崉閸濆嫬顥庢繝纰樻閸嬪嫬螞濡ゅ應鈧棃宕橀鍢壯囨煕閳╁叇姘跺箯瑜版帗鐓熼柕蹇婃櫅閻忥繝鎮介婊冩灈闁诡喗锕㈠畷姗€顢欑憴锝嗗缂傚倸鍊烽悞锕傚煟閵堝鏁傞柛顐ｇ箘閺屽牓姊虹粔鍡楀濞堟洟鏌涙繝鍌滃煟闁哄矉缍佸顒勫垂椤旇棄鈧垶姊虹紒妯诲碍闁哥喍鍗抽獮澶岀矙濞嗗墽鍙嗛梺鍓插亝缁诲嫰藝瑜嶉埞鎴︽倷閺夋垹浠哥紒鐐緲缁夊綊銆侀弴銏″殟闁靛绠戝鍨攽椤旂瓔娈旀俊顐ｎ殕閺呰埖绻濆顓犲幗闂佸湱鍎ゅú鏍暱闂備線娼уú銈団偓姘煎灣缁鈽夐姀鐘殿啋闂佸綊顣﹀鎺旀濠靛洨绡€闁汇垽娼ф禒婊堟煟閵娧冨幋鐎殿喗褰冮埞鎴﹀醇閻曚焦缍楅梻浣筋潐瀹曟﹢顢氳閺屽宕堕浣哄帾闂婎偄娲﹀ú鏍綖閹达附鐓忓璺烘濞呭棝鏌ｉ幘璺烘灈闁哄矉缍佸顒勫箰鎼粹剝娈橀柣搴ゎ潐濞叉牠鎯岄崒鐐茶摕闁挎稑瀚▽顏堟煟閹伴潧澧版い锔垮嵆閹鎲撮崟顒傤槹婵炲瓨绮忓▔娑㈩敋閿濆绠绘い鏃囨娴滃綊姊哄Ч鍥х伈婵炰匠鍕劅濠电姴鍊甸弨浠嬫煟濡櫣浠涢柡鍡忔櫊閺屾稓鈧綆鍓欓弸娑㈡煕閳哄倻娲寸€规洖銈搁幃銏＄瑹椤栨盯鏁滃┑鐘垫暩婵炩偓婵炰匠鍥ㄥ仭闁靛牆顦悙濠囨煏婵炲灝鍔撮柛銈冨€濋弻锝嗘償閵忊懇濮囬梺鎸庡哺閺屽秷顧侀柛鎾寸懇瀹曟煡鎳犻崜浣风綍闂傚倷鑳剁划顖炪€冮崨瀛樺亱闊洦娲滄稉宥夋煛瀹ュ骸骞楅柣鎾寸洴閺屾稓浠︾紒銏＄暥婵炲瓨绮撶粻鏍ь潖?
            if (!this.isInWater() && !this.isPassenger() && !this.isNoGravity()) {
                // 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴濐潟閳ь剙鍊块幐濠冪珶閳哄绉€规洏鍔戝鍫曞箣閻欏懐骞㈤梻鍌欑窔閳ь剛鍋涢懟顖涙櫠閹绢喗鐓涢悘鐐插⒔閵嗘帡鏌嶈閸撱劎绱為崱娑樼；闁告侗鍨悞濠囨煙濞堝灝鏋ょ痪鎹愬亹缁辨挻鎷呯拠锛勫姺濠电偞褰冮顓㈠焵椤掍緡鍟忛柛鐘崇墵閹儲绺介崫銉ョウ闁诲函缍嗛崳顕€寮崶顒佺厽闁归偊鍘肩徊缁樸亜閵夈儵鍙勬慨濠傤煼瀹曟帒鈻庨幒鎴濆腐婵＄偑鍊ら崢濂告偋閹炬眹鈧線寮介鐐茶€垮┑鐐村灦椤洭顢欐径鎰拺闁硅偐鍋涢崝鎾煕閹惧鎳囩€?
                if (!this.onGround()) {
                    // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺弮濠碘槅鍨崇亸銊ф濮橆厾绠鹃柟瀛樼懃閻忊晝绱掗埀顒傗偓锝庡亖娴滄粓鏌熼崫鍕ゆい锔煎閳ь剚顔栭崰鏍ь焽閳ユ剚娼栭柧蹇撴贡绾惧吋淇婇姘儓妞ゎ偅鍨垮铏规喆閸曨兙浠ф繛瀛樼矌閸嬫稑宓勯梺瑙勫婢ф寮查弻銉︾厱闁斥晛鍟伴幊鍛存煟閿曗偓閻楁挸顫忔繝姘＜婵ê宕·鈧紓鍌欑椤戝棛鏁敓鐘叉瀬鐎广儱鎷嬮崥瀣煕閳╁啯绀堢紒鐘宠壘椤啴濡堕崱娆忣潷缂佺偓婢樼粔纭呮＂闂侀潧绻嗛崜婵嬪矗韫囨挴鏀介柣妯诲絻閺嗙偤鏌曢崶銊х畺妞ゃ劊鍎甸幃娆戔偓娑櫭壕鍐参旈悩闈涗沪閻㈩垪鈧剚鍤曟い鎺嗗亾闁宠鍨垮畷鐔碱敃閵堝嫭鍋呴梻?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲梺姹囧€ら崰妤呭Φ閸曨垰绠涢柍杞拌兌閸旀挳姊洪幖鐐测偓鏍洪悢鐓庤摕婵炴垯鍩勯弫鍐煥濠靛棙顥滄い锔规櫊濮婄儤娼幍顕呮М濠碘槅鍋呴悷褔骞戦姀鐘闁靛繒濮烽娲⒑缂佹ê鐏ユ繛璇х悼濞嗐垽鎮介崨濞炬嫼缂傚倷鐒﹁摫閻忓浚鍙冮弻锝夊冀瑜嬮崑銏⑩偓娈垮枦椤曆囧煡婢跺娼╂い鎰剁到婵即姊绘担鍛婂暈闁圭妫楅悾婵嬪焵椤掍礁顕遍柛銉墯閳?
                    this.setDeltaMovement(this.getDeltaMovement().add(0, -0.08, 0));

                    // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓闁搞劌鍊块弻娑㈩敃閿濆棛顦ョ紓浣哄С閸楁娊寮诲☉銏╂晝闁挎繂妫涢ˇ銉х磼閻愵剙鍔ゆ繛纭风節瀵鏁愭径濠庢綂闂侀潧绻嗛弲婵嬪礉閹间焦鈷掗柛灞捐壘娴滅偤鏌涢妸銉у煟鐎殿喖顭烽幃銏ゅ礂鐏忔牗瀚介梺璇查叄濞佳勭珶婵犲伣锝夘敊閸撗咃紲闂佺粯鍔﹂崜娆撳礉閵堝棎浜滄い鎾跺Т閸樻挳鏌熼鍡欑瘈妞ゃ垺娲熼弫鍐焵椤掑嫭鍊峰┑鐘叉处閻撳繐鈹戦悩鑼闁伙絿鏁婚弻锟犲幢濞戞鍠氬┑顔硷龚濞咃綁鍩€椤掆偓濠€杈ㄦ叏閻㈢违闁告劦浜炵壕濂告煠绾板崬澧悽顖氱埣閺屽秹鎸婃径妯烩枅婵犳鍠掗崑鎾绘⒑缂佹﹫鑰挎繛浣冲嫭鍙忛柨鏃€鍨濈换鍡涙煟閹板吀绨婚柍褜鍓氶悧婊堝极椤曗偓楠炴帡寮崫鍕濠殿喗顭囬崢褍顕ｉ閿亾?(婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓闁搞劌鍊块弻娑㈩敃閿濆棛顦ョ紓浣哄С閸楁娊寮诲☉妯锋斀闁告洦鍋勬慨銈嗙節濞堝灝鏋熷┑鐐诧躬瀵濡堕崥銈呮贡閳ь剨缍嗛崑鍛存偟閺嶎偆纾藉ù锝呮惈鏍″┑鈽嗗亜閸熸潙顕ｇ拠娴嬫婵☆垶鏀遍～宥呪攽閻愬弶顥為柛鏃€顨堢划娆撳炊瑜夐弨浠嬫煃閽樺顥滃ù婊勭箞閺屻劑寮村Ο铏逛紙濡ょ姷鍋涢崯顐︽偩閿熺姴绠ラ柧蹇ｅ亞閳ь剙顭峰Λ鍛搭敃閵忊€愁槱闂佺懓鐨烽弲婊呯矉閹烘挶鍋呴柛鎰ㄦ杹閹疯櫣绱撻崒娆戝妽閽冮亶鎮樿箛搴″祮闁哄矉缍侀幃銏ゅ矗婢跺褰嬮柣搴㈩問閸犳盯顢氳閸┿儲寰勬繝搴ｅ弳闁硅偐琛ラ幊锝夘敂閸涱剛绠氶梺缁樺姦娴滄粓鍩€椤掍礁鐏寸€规洘绻傞悾婵嬪礋婵犲倹澶勬繛鐓庣箻閸┾剝鎷呴崫銉ゅ枈闂傚倷鐒︾€笛呮崲閸岀偛绠犲璺好￠敐澶婇唶闁靛濡囬崢顏堟椤愩垺鎼愰柨鏇樺€栭弲鍫曞矗婢跺瞼顔?
                    // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈢粯淇婇悙顏勨偓鏍偋濡ゅ啰鐭欓柟鐐湽閳ь剙鎳樺畷锝嗗緞瀹€鈧惁鍫熺節閻㈤潧孝闁稿﹥鎮傚鎼佹晝閸屾稓鍘鹃梺缁橆殔閻楀棝顢氬鍫熺厪闁搞儜鍐句紓缂備胶濮甸惄顖炵嵁濡吋宕夊〒姘煎灡濠㈡垵鈹戦敍鍕杭闁稿﹥鍨垮畷鏇㈡焼瀹ュ棗浜遍梺瑙勫礃椤曆囨嫅閻斿吋鐓ユ繝闈涙－濡插摜绱掗悩宕団姇闁靛洤瀚伴獮妯兼崉閸濆嫬顥庢繝纰樻閸嬪嫬螞濠靛棭娼栨繛宸簼閸ゆ帡鏌曢崼婵囧櫤闁诲酣绠栧娲川婵犲啠鎷归梺鑽ゅ暱閺呮盯顢氶敐鍥ㄥ珰婵炴潙顑嗛～宥呪攽閳藉棗鐏＄紒顔肩Т铻為柛鎰靛枛閺勩儵鏌嶈閸撴岸濡甸崟顖氱闁糕剝銇炴竟鏇㈡⒑缂佹ɑ灏柛濠冪箞瀵寮撮悢铏圭槇闂婎偄娲︾粙鎺楊敁瀹ュ鈷戦柛娑橈功閹冲啰绱掔紒姗堣€跨€殿喖顭烽幃銏ゅ礂鐏忔牗瀚介梺璇查叄濞佳勭珶婵犲伣锝夘敊閸撗咃紳婵炶揪绲介幖顐ｇ墡闂備焦鎮堕崝搴ㄥ极鐠囪鑰垮〒姘ｅ亾婵﹥妞介獮鎰償閿濆洨鏆ゆ俊鐐€х粻鎺懳涢崟顔句罕闂備胶顢婇幓顏堟⒔閸曨垱鍋傞柣鏂垮悑閻撶喖鏌￠崒娑橆嚋闁哥喓鍋ら幃妯跨疀閿濆懎绫嶉梺鍦劜缂嶄線鐛崶顒佸亱闁割偁鍨归獮鍫ユ⒒娓氣偓濞佳囁囬銏犵鐎广儱娲﹂崗婊兾旈敐鍛殲闁绘挻鐩幃妤呮晲鎼粹€愁潻闂佸搫顑嗛崹鍧楀蓟?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲梺姹囧€ら崰妤呭Φ閸曨垰绠涢柍杞拌兌閸旀挳姊洪幖鐐测偓鏍洪悢鐓庤摕婵炴垯鍩勯弫鍐煥濠靛棙顥滄い锔规櫊濮婄儤娼幍顕呮М濠碘槅鍋呴悷褔骞戦姀鐘闁靛繒濮烽鍝勨攽閻愬弶顥滅紒缁樺笚缁傛帡鎳栭埡鍐紳婵炶揪绲介幖顐モ叿闂備胶顭堝ù鐑藉极鐠囧樊鍤曞┑鐘崇閸嬪嫰鏌ｉ幘铏崳闁伙綁绠栭幃宄邦煥閸愵亞顔掑Δ鐘靛仦椤ㄥ﹪骞冮埡鍐＜婵☆垳鍘ч獮妤呮⒒娴ｇ儤鍤€闁圭⒈鍋嗙划鏃堝醇閺囩喎鍓瑰┑鐐叉閹稿鎮″▎鎰╀簻闁哄啫娲ゆ禍鍦磼婢跺孩顏犻柍褜鍓濋～澶娒洪敃鍌氱；濠电姴鍊婚弳锕傛煟閺冨倵鎷￠柡浣告喘閺岋綁寮崶銉㈠亾閳ь剟鏌涚€ｎ偅宕屾い銏＄懇瀹曟粏顦撮柨?
                    if (this.getDeltaMovement().y <= 0.01) {
                        BlockPos pos = this.blockPosition();
                        int groundY = pos.getY();
                        boolean foundGround = false;

                        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎰剁悼閳ь剚濞婇幃妤呯嵁閸喖濮庡銈忓瘜閸ㄨ泛鐣疯ぐ鎺戠＜婵犙勫劤娴滈箖鎮峰▎蹇擃仾缂佲偓閳ь剙鈹戦悙鑼勾闁告柨娴烽崚鎺撶節濮橆剛鐫勯梺鍓插亞閸犳捇宕㈤崡鐐╂斀闁绘劖娼欓悘锕傛煟閻曞倸顩紒杈╁仱楠炲鎮╅悽纰夌床闂備胶绮敋闁哥喎娼￠崺銏ゅ即閵忥紕鍘搁柣蹇曞仧閸嬫挾绮堟径宀€纾奸柣妯虹－濞叉潙鈹戦敍鍕効妞わ附鎸抽弻銊モ槈濮橆剚鐏堝┑?5 闂?
                        for (int i = 0; i < 5; i++) {
                            BlockPos p = pos.below(i);
                            if (!this.level().isEmptyBlock(p)) {
                                groundY = p.getY() + 1; // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣椤愯姤鎱ㄥ鍡楀⒒闁绘帊绮欓弻銈嗘叏閹邦兘鍋撳Δ鍐棜闁兼亽鍎查崣蹇斾繆椤栨稑顕滅痪顓炲⒔閻ヮ亪顢樺☉妯瑰闂傚倸鍊风粈渚€骞夐敓鐘茬闁哄洨鍊ｉ悢鍝ョ瘈闁搞儯鍔岄埀顒€鐏濋湁闁绘ê妯婇崕鎰版煟閹捐泛鏋戝ǎ鍥э躬婵″爼宕掑顐㈩棜闂傚倷鑳剁划顖炪€冮崨顖涘床婵せ鍋撶€规洘妞芥慨鈧柕鍫濇噹瀹撳棝姊洪棃娑氱畾闁逞屽墯閺嬪ジ宕戦幘缁樺仺闁告稑锕﹂崣鍡椻攽閻樼粯娑ф俊顐ｎ殜閸┾偓妞ゆ帒鍊归崵鈧梺瀹狀嚙缁夌懓鐣烽崼鏇ㄦ晢濞达絽鎼獮?
                                foundGround = true;
                                break;
                            }
                        }

                        if (foundGround) {
                            double diff = this.getY() - groundY;
                            // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯锋嫼閻熸粎澧楃敮鎺撶娴煎瓨鐓曢柟鎯ь嚟濞叉挳鏌熼鈧粻鏍х暦椤愶箑绀嬮柛顭戝亜閻︽粓姊绘笟鈧褔鎮ч崱妞㈡稑螖閸愵亞鐣堕梺鍦劋椤ㄥ棝鎮￠弴鐐╂斀闁绘ɑ褰冮顏堟煛閸♀晛澧伴柍褜鍓氶鏍闯椤曗偓瀹曟垶绻濋崒婊勬闂佺粯姊婚埛鍫ュ极閸愵喗鍊甸柨婵嗛娴滄繃銇勯妷銉уⅱ闁逞屽墲椤煤濡吋鏆滈柟鐑橆殕缁犳帡姊绘笟鈧褏鎹㈤崱娑樼柧婵炲棙鍨兼慨鍐裁归悩宸剱闁绘挸鍟伴幉绋款煥閸繄顦┑鐘绘涧椤戞垹绱為弽褜鐔嗛悹杞拌閸庢垹绱掗悩鍐插姢闁宠鍨块幃鈺呭矗婢跺鍊烽梻?0.5 闂?3.0 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓闁搞劌鍊块弻娑㈩敃閿濆棛顦ラ梺钘夊暟閸犳牠寮婚弴鐔虹闁绘劦鍓氶悵锕傛⒑鏉炴壆顦﹂悗姘煎墴閳ワ妇鎹勯妸锕€纾繝闈涘€借闁逞屽墯閺嬬厧危閸儲鐓忛煫鍥ㄦ礀閳诲牓鏌℃担鍦煀闁宠鍨堕獮濠囨煕婵犲啯宕岄柟顔惧仱閺佸啴鍩€椤掑嫬鐓濈€广儱顦崘鈧銈嗘尵閸犳捇宕㈡禒瀣棅妞ゆ劑鍨烘径鍕箾閸欏澧紒鍌涘浮閸╋繝宕ㄩ鎯у箞闂佽鍑界紞鍡涘磻閸曨剚鍙忕€广儱顦伴悡娆愩亜閺冣偓閸庢娊宕㈢€涙ǜ浜滈柕蹇婃濞堟粓鏌涢埞鎯т壕婵＄偑鍊栫敮鎺斺偓姘煎墴閹繝鍨鹃幇浣哄數闂佸吋鎮傚褎鎱ㄩ崶鈺冪＜闁绘ê鎼崥褰掓煃瑜滈崜婵嬶綖婢跺⊕娲冀瑜夐弸鏍煥閺囩偛鈧綊寮查弻銉︾厱闁斥晛鍟粈鍫㈢磼閻樺啿鍝烘慨濠冩そ瀹曘劍绻濋崟顒€娅戞俊鐐€х紓姘跺础閸愯尙鏆﹂柟鐗堟緲缁犳稒銇勯弮鍌涘殌濞存粓绠栭幃宄扳枎韫囨搩浠剧紓浣插亾闁割偁鍎查悡鏇㈢叓閸ャ劍鐎奸柟瀵稿仧閳瑰秴鈹戦悩鍙夋悙缂佺姷鎳撻湁闁挎繂鐗嗛埀顑跨矙閸╋繝宕橀埡浣圭€鹃柣搴＄畭閸庨亶藝椤栨粎鐭嗗璺侯儑缁♀偓婵犵數濮撮崐缁樻櫠濞戙垺鐓熼柟鎹愭硾閺嬫盯鏌″畝瀣埌閾伙綁鏌涘┑鍡楊伀濡ょ姴娲铏规嫚閳ュ磭浠╅梺缁橆殕閹瑰洤顕ｇ拠娴嬫闁靛繆鈧厖姹楅柣搴ゎ潐濞叉牕煤閵忋倕鐒垫い鎺嶇缁楁艾菐閸パ嶈含鐎规洩绲惧鍕節閸屻倖缍嬮梻鍌欑閻ゅ洭锝炴径鎰瀭闁割煈鍠氶弳锕傛⒑椤掆偓缁夋挳鎮″☉妯忓綊鏁愰崼顐㈡異闂佸憡纰嶉悷鈺侇潖婵犳艾纾兼繛鍡樺焾濡差噣姊虹涵鍜佸殝缂佽鲸娲熼獮鎴﹀閵堝懐锛滃┑鐘欏嫬鍔ゅù婊呭亾閹便劌螣閻撳骸浠樻繝鈷€鍕唉闁哄瞼鍠栭、姘跺幢濞嗘垹妲囨俊銈囧Х閸嬫盯顢栨径鎰瀬闁稿瞼鍋為崑鈺呮倶閻愯埖顥夌紒鐘靛仜閳规垿鎮╅幇浣告櫛闂佸摜濮甸〃濠囧极閸愵喖鐓涢柛娑卞幖閸嬪秵绻涚€电孝妞ゆ垵鎳愭竟鏇°亹閹烘挾鍘甸梻渚囧弿缁犳垿鐛幒鏃傜＜?
                            if (diff > 0.5 && diff < 3.0) {
                                this.setPos(this.getX(), groundY, this.getZ());
                                this.setDeltaMovement(this.getDeltaMovement().multiply(1, 0, 1)); // 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌熼梻瀵割槮缁炬儳顭烽弻锝夊箛椤掍焦鍎撶紓浣哄С閸楁娊寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磽娴ｅ搫啸濠电偐鍋撻梺鍝勭灱閸犳牠骞冭瀹曞ジ鎮㈤崫鍕闂傚倷鑳剁划顖炲箰婵犳碍鏅濋柕蹇嬪€曢拑鐔兼煃閵夛箑澧柛姘儔楠炴牜鍒掗崗澶婁壕鐎规洖娴傞崯鍥⒒閸屾瑧鍔嶉柟顔肩埣瀹曟繂鐣濋崟顐わ紮闂佺鍕垫當闁藉啰鍠愮换娑㈠箣閻愮數鍙濆┑鐐茬焾娴滎亪寮诲☉銏犵婵°倐鍋撻柟铏姍瀹曘垽骞嬮悩鐢碉紳闂佺鏈悷銊╁礂瀹€鍕叄闊洦鎹囬崣鍕偓瑙勬礀濠€閬嶅箲閸曨剛鐟规い鏍ㄧ〒缁嬩焦绻濋悽闈涗粶婵☆垰锕ョ粋宥夊醇閺囩偞鐎梺鍛婂姦閸犳鎮¤箛娑欑厱妞ゆ劧绲跨粻鏍煕閿濆棙銇濋柡宀嬬稻閹棃鍩ラ崱娆忔倯闂?
                                this.setOnGround(true);
                            }
                        }
                    }
                }
            }
        }

        // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犵厱婵﹩鍘介妵婵嗏攽闄囬崺鏍ь嚗閸曨厸鍋撻敐搴濈胺婵″弶鍔欏缁樼瑹閳ь剙顭囪婢ф繈姊洪崫鍕櫤闁烩晩鍨堕獮蹇涘箣閿旇棄浜滈柣蹇撶箣閻掞箓寮埀顒勬⒒娴ｈ櫣甯涢拑杈╂喐閺夊灝鏆ｆい銏℃椤㈡棃宕熼妸锔芥澑婵＄偑鍊栭悧妤呭传鎼淬劌纾婚柕蹇嬪€栭悡娑㈡倶閻愬灚娅曢弫鍫ユ⒑缁洘鏉归柛鎾寸箞楠炲繘宕ㄩ弶鎴濈獩婵犵數濮撮崰姘跺船閻熸壋鏀介柨娑樺娴滅厧霉閻撳孩鍣洪柟宄版嚇瀹曘劍绻濋崒銈喰熼梻?
        if (this.invincibilityTimer > 0) this.invincibilityTimer--;
        if (this.guardDamageCooldown > 0) this.guardDamageCooldown--;
        if (this.postTeleportAttackDelay > 0) this.postTeleportAttackDelay--;

        if (!this.level().isClientSide && GUARD_STUTTER_DEBUG && !this.isFollowing()) {
            if (this.hurtTime != this.debugLastGuardHurtTime
                    || this.guardDamageCooldown != this.debugLastGuardDamageCooldown
                    || this.invincibilityTimer != this.debugLastGuardInvuln
                    || this.invulnerableTime != this.debugLastVanillaInvuln) {
                TurretModuleLog.info(
                        "[GuardDebug] state unit=#{} tick={} hurtTime={} guardCd={} invul={} vanillaInvul={} health={}/{} target={}",
                        this.entityData.get(UNIT_ID),
                        this.tickCount,
                        this.hurtTime,
                        this.guardDamageCooldown,
                        this.invincibilityTimer,
                        this.invulnerableTime,
                        String.format(java.util.Locale.ROOT, "%.2f", this.getHealth()),
                        String.format(java.util.Locale.ROOT, "%.2f", this.getMaxHealth()),
                        this.getTarget() == null ? "null" : this.getTarget().getType().toShortString()
                );
                this.debugLastGuardHurtTime = this.hurtTime;
                this.debugLastGuardDamageCooldown = this.guardDamageCooldown;
                this.debugLastGuardInvuln = this.invincibilityTimer;
                this.debugLastVanillaInvuln = this.invulnerableTime;
            }

            // Detect non-decaying hurtTime loops in guard mode.
            if (this.hurtTime > 0) {
                if (this.hurtTime > this.debugGuardPrevHurtTime) {
                    TurretModuleLog.info(
                            "[GuardDebug] hurt-rise unit=#{} tick={} prevHurt={} nowHurt={} guardCd={} vanillaInvul={}",
                            this.entityData.get(UNIT_ID),
                            this.tickCount,
                            this.debugGuardPrevHurtTime,
                            this.hurtTime,
                            this.guardDamageCooldown,
                            this.invulnerableTime
                    );
                    this.debugGuardHurtStuckTicks = 0;
                } else if (this.hurtTime == this.debugGuardPrevHurtTime) {
                    this.debugGuardHurtStuckTicks++;
                    if (this.debugGuardHurtStuckTicks == 10 || this.debugGuardHurtStuckTicks % 20 == 0) {
                        TurretModuleLog.info(
                                "[GuardDebug] hurt-stuck unit=#{} tick={} hurtTime={} stuckTicks={} guardCd={} vanillaInvul={}",
                                this.entityData.get(UNIT_ID),
                                this.tickCount,
                                this.hurtTime,
                                this.debugGuardHurtStuckTicks,
                                this.guardDamageCooldown,
                                this.invulnerableTime
                        );
                    }
                } else {
                    this.debugGuardHurtStuckTicks = 0;
                }
            } else {
                this.debugGuardHurtStuckTicks = 0;
            }
            this.debugGuardPrevHurtTime = this.hurtTime;
        }

        // 闂?缂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙闁诡垳鍋ら獮鏍庨鈧俊濂告煟椤撶噥娈滄鐐寸墪鑿愭い鎺嗗亾濠德ゅ亹缁辨帡骞囬褎鐤侀梺鍝勭焿缁绘繂鐣烽崼鏇炵厸濞达絽娴勭徊鍧楀焵椤掑喚娼愭繛鍙夌墪椤曪綁宕奸弴鐐电杽闂侀潧顭堥崕鍝勵焽閵娾晜鐓曢柍鈺佸枤濞堟柨鈹戦璇插祮婵﹥妞藉畷鐑筋敇閻愭彃顬嗘繝鐢靛仜瀵墎鍒掗幘璇茬畺闁秆勵殔閻掑灚銇勯幒鎴濐仾闁绘挻鐟╅弻銈夊捶椤撶儐鏆悷婊勫Ω閸涱垳锛濋悗骞垮劚閹冲繘藟閻愮儤鍊甸梻鍫熺◤閸嬨垻鈧娲栭悥濂搞€佸Δ浣瑰闁告繂瀚粻娲⒒閸屾瑧绐旀繛浣冲懏宕查柛鈩冪☉閻ょ偓绻涢幋娆忕仾闁稿﹪娼ч埞鎴︽偐瀹曞浂鏆￠梺缁樻尰濞茬喖寮婚弴鐔风窞閻庯綆浜炴禒鎾⒑閸濄儱娅忛柛瀣閸掓帗绻濆顓熸珳闂佺硶鍓濋悷褔鎯侀崼銏㈢＜闁告挆鍐炬毉闁藉啳椴搁妵鍕敃椤喛鍚梺鍝勬湰缁嬫捇鍩€椤掑﹥鈧儵宕樿椤ユ岸姊婚崒姘偓鐑芥嚄閸洍鈧箓宕奸妷顔芥櫈闂佺硶鍓濈粙鎴犵不閺屻儲鐓曢柕澶樺枛婢ь噣鏌﹂崘顏勬灈闁哄被鍔岄埥澶娢熸笟顖欒繕婵犵數鍋涢惌鍫熺椤忓牆绠栫憸鐗堝笒閻愬﹪鏌曟繛鍨姢缂佷線鏀辩换婵嗏枔閸喗鐏侀梺鎼炲姀濡嫰锝炶箛娑欐優闁革富鍘鹃悡鎾绘⒑閸︻収鐒惧Δ鐘虫倐瀵劑顢橀悜鍡樺瘜闂侀潧鐗嗘鍛婄濠婂嫨浜滈柨鏃傚亾閺嗩剟鏌ｅ☉鍗炴珝鐎规洖宕埥澶娢熼懖鈺傜秮闂傚倷绀佹竟濠囧磻閸℃稑绐楅柟閭﹀厴閺嬪秹鏌涢妷锝呭缂佺娀绠栧鍫曞醇濠靛棌鎸冪紓浣割儓瀹曠數妲愰幒鎾村閻熸瑥瀚崬澶愭倵鐟欏嫭绀冮柛銊ユ健閻涱喖顫滈埀顒勭嵁閸ャ劍濯撮柛婵嗗濮规煡姊婚崒娆戭槮濠㈢懓锕畷鎴﹀幢濞戞鐛ラ梺褰掑亰閸忔﹢寮?
        manageHeatDecay();

        // 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴濐潟閳ь剙鍊块幐濠冪珶閳哄绉€规洏鍔戝鍫曞箣閻欏懐骞㈤梻鍌欑窔閳ь剛鍋涢懟顖涙櫠閹绢喗鐓涢悘鐐插⒔閵嗘帡鏌嶈閸撱劎绱為崱娑樼；闁告侗鍘鹃弳锔锯偓鍏夊亾闁告洦鍓涢崢鎼佹倵閸忓浜鹃柣搴秵閸撴盯鏁嶉悢鍝ョ閻庣數顭堥鎾斥攽閳ヨ櫕鍠樻鐐茬箻閹晝鎷犻懠顒夊斀闂備礁婀遍崕銈夊春閸繍鐒芥繛鎴欏灪閳锋帡鏌涚仦鍓ф噭缂佷焦婢橀…鍧楁偡閹殿喖顣洪梺浼欑悼閸忔﹢骞冮悾宀€鐭欓悹鎭掑妿瀹曞爼姊绘担鍛婃儓閻犲洨鍋ゅ畷銊╊敊缁涘鏅繝鐢靛У椤旀牠宕板Δ鍛櫇闁冲搫鎳庣粈鍌涙叏濡炶浜鹃悗娈垮枔閸斿秶绮嬮幒鏂哄亾閿濆骸浜為柛姗€浜跺娲箮閼恒儲娈伴梺绋款儐閹瑰洭寮婚敓鐘插窛妞ゆ柨澧介悡鍌滅磽娴ｆ垝鍚柛瀣Х缁鈽夊Ο閿嬵潔濠电偛妫楅張顒傗偓姘偢濮婄粯鎷呴崨濠傛殘缂備礁顑嗛崹鍧楀极閸愵喗鏅滈柤鎭掑劜閻濆嘲顪冮妶鍡楃瑨閻庢凹鍙冮幃锟犳偄闂€鎰畾闂侀潧鐗嗙€氼垶宕楀畝鍕厽妞ゆ挾鍋炲﹢鏉壳庨崶褝韬€规洩绲惧鍕節閸屻倖缍掑┑锛勫亼閸婃垿宕归崫鍕庢盯宕橀妸褎娈炬繝闈涘€搁幉锟犲磻閸曨垱鐓曟繛鎴烇供閻擃剙霉?
        if (!this.level().isClientSide && this.entityData.get(UNIT_ID) == 0) {
            this.entityData.set(UNIT_ID, this.random.nextInt(999) + 1);
            updateCustomName(); // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弴鐐测偓褰掑磿閹寸姵鍠愰柣妤€鐗嗙粭鎺楁煕閵娿儱鈧悂鍩為幋锔藉亹閻庡湱濮撮ˉ婵堢磽娴ｇ懓濮堟い銊ワ躬瀵鎮㈤崗鐓庝罕闂佸壊鍋嗛崰鎾诲礄閿熺姵鈷戦柟鑲╁仜婵″ジ鏌涙繝鍌滅Ш妤犵偛鐗撴俊鎼佸Ψ鎼达絽鏋涙鐐村姈閹棃鏁愰崘锝呬壕闁规壆澧楅悡鐔兼煟閺傛寧鎲搁柟铏礈缁辨帡鎮╅搹顐㈢３闂佺粯渚楅崳锝咁嚕娴犲惟闁挎柨澧借倴闂傚倷绀侀幉锟犲箰閸℃稑绀嬫い鎯点倗绠烽梻鍌欐祰瀹曠敻宕伴幇顔煎灊鐎广儱鎷嬮悢鍡樻叏濡炶浜鹃梺璇″灠閻倸鐣烽幒妤佸€烽柤鑹板煐閹茬増绻濋悽闈涗沪闁割煈鍨跺畷褰掑捶椤撶姳绗夐梺瑙勫劶婵倝鎮″☉銏＄厱闁靛绲介崝姘攽閳ュ啿鎮戠紒缁樼洴瀹曞ジ顢曢姀鐘电潉婵犳鍠栭敃銊モ枍閿濆绀岄柡宥庡幖閸楁娊鏌ｉ弬鎸庢喐鐟滄澘妫濆缁樻媴閸濆嫬濮﹂梺鍝勬噳閺呯姴鐣风憴鍕嚤闁圭⒈鍘介弲顏堟⒑閹稿海绠撴い锔跨矙瀵偊宕卞☉娆戝幈闂佸搫娲㈤崝灞剧閻愬弬鏃堟偐閸欏鏋犲┑顔硷攻濡炶棄鐣烽悜绛嬫晣鐟滃繘宕濋崨濠佺箚闁靛牆娲ゆ牎闂佽鍠栭崐鍨暦濞差亜鐒垫い鎺嶉檷娴滄粓鏌熼崫鍕ゆい锔肩畵閺屽秶绱掑Ο鑽ゎ槹闂?
        }
        // ==================== 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰鍐€妞ゆ劦婢€缁墎绱?闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞鐟滄粌霉閺嶎厽鐓忓┑鐐靛亾濞呭棝鏌涢妶鍛伃闁哄被鍊楃划娆戞崉閵娿倗椹虫繝鐢靛仜閹虫劖鎱ㄩ崹顐も攳濠电姴娲ゅ洿闂佺鏈惌顔界珶閺囥垺鈷掑ù锝夘棑娑撹尙绱掗煫顓犵煓闁诡喗锚椤繃娼忛埡鍐殽闂備胶绮濠氬储瑜旈幃鐐哄垂椤愮姳绨婚梺鐟版惈濡绂嶆ィ鍐┾拺濞村吋鐟ч幃濂告煕韫囨枏鎴炵┍婵犲洦鍋い鏍电稻妤斿┑鐘垫暩閸嬫盯鎯岄崼鐔侯洸闁绘劕鐏氶～鏇㈡煙閹呮憼濠殿垱鎸冲濠氬醇閻旀亽鈧帒霉閻樻彃鎮戠紒缁樼箘閸犲﹥寰勫畝鈧惁鍫熺箾鐎涙鐭婇柣鏍帶椤曪絾绻濆顓熸珳婵犮垼娉涢鍛村焵椤掑倸鍘撮柟顔筋殜閹粙鎮介悙鍏夊亾婵犲啩绻嗘い鎰Т婵倹鎱ㄦ繝鍛仩缂侇喗鐟╁畷褰掝敋閸涱厼唯婵犵數濮伴崹濠氬箠閹炬緞娑樷槈閵忕姷顦?====================
        if (!this.level().isClientSide) {// ==================== 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰鍐€闁靛ě鍛姸闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洟鎮烽幊濠傜秺閹晛顔忛鐓庡Η缂傚倸鍊哥粔鐢告偋閺団懇鈧箓宕稿Δ浣告疂闂傚倸鐗婄粙鎴︼綖閸ヮ剚鈷戦梺顐ゅ仜閼活垶宕㈤崫銉х＜闁逞屽墯缁楃喖鍩€椤掑嫨鈧礁螣閼姐倝妾紓浣割儏閻忔繈鎳撻崹顔规斀闁绘劕寮堕ˉ婊堟煛閸偄澧撮柟顔斤耿瀹曟﹢顢欑憴锝嗗濠电偞鎸婚崺鍐磻閹剧粯鐓冪憸婊堝礈濞戙垹纾绘繛鎴欏灪閸ゆ劖銇勯弽銊р姇婵炲懐濞€閺岀喓绱掗姀鐘崇亶闂佺粯鎸荤粙鎴︽箒闂佹寧绻傞幊蹇涘箟閸濄儮鍋撳☉娆戠畵妞ゎ亜鍟存俊鑸垫償閳ヨ尙鍑圭紓鍌欐祰椤曆囨偋閹剧粯鍋樻い鏃囧Г閸庣喖鏌曟繝蹇曠暠濞寸姴銈搁弻锝堢疀閺囩偘鍝楀┑鈽嗗亜鐎氼喖顕ユ繝鍕枂闁告洦鍘鹃惁鍫ユ⒑濮瑰洤鐏叉繛浣冲嫮顩锋繝濠傚娴滄粓鏌￠崶銉ュ妤犵偞顨婇弻鐔哥瑹閸喖顫囧Δ鐘靛仜濡繈鍨鹃弽顓ф晢濞达絿鍎ら崚娑㈡倵鐟欏嫭绀堥柛鐘崇墵閵嗕線寮撮姀鐘栄囨煕閳╁喛渚涢柛鐔烽叄濮婄粯鎷呴崨濠冨創濡炪倧瀵岄崹鍫曞箖瑜斿畷姗€顢欓懖鈺傜叄婵犵數鍋為崹鍫曞春閸愵喖纾婚柟鎹愵嚙閸ㄥ倹銇勯幇鈺佲偓鏇烆嚕閵娾晜鈷戦柛婵嗗椤箓鏌涙繝鍐⒌妤犵偛鐗撴俊鎼佸煛娴ｈ櫣鏉告俊鐐€栭崹鐓幬涢崟顒傤洸闁绘劦鍏涚换鍡涙煏閸繃鍣洪柛锝呯秺閺?(Slot 25) ====================
            // 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣銏犲閺佸﹪鏌″搴″箹闂傚偆鍨遍妵鍕冀閵娧呯厐缂備浇缈伴崐婵嬪蓟閿濆鏅查柛娑卞枟閹烽亶鎮楃憴鍕闁绘搫绻濆濠氭偄閸忕厧鈧粯鎱ㄥΔ鈧Λ娆擃敇閾忓湱纾介柛灞炬皑鏍￠梺缁橆殕椤ㄥ棛绮氭潏銊х瘈闁搞儺鐏涜閺屾稓浠﹂崜褏鍙濇繝銏ｎ潐濞茬喎顫忓ú顏勭闁归偊鍓欓幆鐐烘⒑缁嬫鍎嶉柛濠冪箓椤曪絿鎷犲顔兼倯闂佸壊鍋掗崑鍛搭敁閸ヮ剚鈷掑ù锝呮啞閸熺偤鏌熼幖浣虹暫鐎规洜澧楅幆鏃堚€﹂幋鐐存珨闂備焦瀵х换鍌毼涘☉姘К闁逞屽墮閳规垿顢欓弬銈勭返闂佺娴烽弫缁樹繆閹间礁鐓涢柛灞剧矊鐢箖姊绘担绋款棌闁稿鎳愰幑銏ゅ礃椤忓棛鐒鹃梺瀹犳〃閹儴銇愰幒鎾充簵闁瑰吋鐣崹褰掑几閻樻祴鏀?(20 tick)
            if (this.tickCount % 20 == 0) {
                // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕閻庤娲忛崕鎶藉焵椤掑﹦绉甸柛鐘崇墱婢规洟宕稿Δ浣哄幍闂佽鍨虫晶妤吽夋径鎰闁哄鍩婇煬顒勬煛鐏炶鈧繈骞婂┑瀣妞ゆ棁鍋愭晶顖氣攽閻愯尙鎽犵紒顔肩灱缁辩偞绻濋崶褑鎽曞┑鐐村灟閸ㄧ懓鏁俊鐐€栧濠氬储瑜旈敐鐐侯敂閸啿鎷?25 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犖ч柛銉㈡櫇閸樼娀姊绘担铏瑰笡闁搞劎鍘ц灋闁告洦鍘奸ˉ姘攽閻樺磭顣查柣鎾寸懇濮婃椽顢橀妸褏鏆犻梺鍛娚戦幐鎶藉蓟閿涘嫧鍋撻敐搴′簼妞ゃ儱鐗撻弻鈥崇暆閳ь剟宕伴幇顒夌劷闊洦鏌ｉ崑鍛存煕閹般劍娅撻柍褜鍓欑粔鐟邦潖閾忓湱鐭欐繛鍡樺劤閸撴澘顪冮妶鍡楃仴妞わ箓娼ч锝囨嫚瀹割喖鎮戦梺绯曞墲閿氭い顐節濮婅櫣鎲撮崟闈涙櫛闂佸摜濮甸悧妤佺┍婵犲啰顩烽悗锝庡亐閹?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁逞屽墾缁犳挸鐣锋總绋课ㄩ柨鏃囧Г閻濇牠姊绘笟鈧褔鏁嶈箛娑樼妞ゆ帊绶￠崬璺衡攽閻樿尙妫勯柡澶婄氨閸嬫捇寮撮姀鐘电枃闁硅偐琛ョ€殿剝顦圭€殿喖顭锋俊鐑芥晜閹冪闂傚倷绀侀幖顐﹀疮椤愨挌娲晝閸屻倖鏅滈梺缁橆焽閺佸摜澹曟總鍛婄厽婵☆垱瀵ч悵顏堟煃闁垮濮嶉柡灞炬礋瀹曟儼顦叉い蹇ｅ幗椤ㄣ儵鎮欏顔煎壎闂佽桨鐒﹂崝娆忕暦閸楃偐鏋庣€广儰绀佹禍鎯р攽閻樺弶澶勯柍閿嬪灴閹湱鈧綆浜妤呮煕閻旇泛宓嗛柟顔惧仱楠炴牗鎷呴崷顓炲箰闂佽绻掗崑鐔烘兜閸洖纾婚柟鎹愵嚙缁犳稑霉閿濆懏鍟為柛濠庡灦濮婄粯鎷呯憴鍕哗闂佺瀵掗崹璺虹暦閺囥埄鏁嬮柍褜鍓欓悾鐑藉箣閿曗偓缁犲鏌涢妸锔锯槈濞存粓绠栭弻銊モ攽閸℃侗鈧顭胯閸ㄩ亶濡甸崟顖ｆ晝闁挎繂妫涢ˇ銊х磽娴ｈ櫣甯涚紒璇茬墕铻為柛鎰╁妷濡插牓鏌涘Δ鍐ㄤ粶濠㈢懓鐗撳缁樻媴閾忕懓绗￠梺鍛婃⒐濞茬喖寮崘顕呮晜闁割偅绻嗛幗鏇㈡⒑閹稿海绠撻柟鍙夛耿閹垽鎮滃Ο铏癸紡闂備線娼ц噹闁告侗鍘奸悵鐔虹磽閸屾艾鈧悂宕愭搴㈠闁哄被鍎辩壕?26 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犖ч柛灞剧煯婢规洖鈹戦鐭亜鐣烽鍕偍閻庣數纭堕崑鎾舵喆閸曨剛顦銈庡亜椤﹂亶鍩€椤戣法绁烽柛瀣姍閸┾偓妞ゆ帊鑳堕埊鏇㈡煥濮樿埖鐓曢柟鍓х帛濞懷囨煃鐟欏嫬鐏存い銏＄懄閹便劑骞囬鍡樺礋闂傚倷鑳堕…鍫ヮ敄閸℃稑绠板┑鐘冲搸閳ь剙鍟存俊鐑藉煛閸屾埃鍋撻悜鑺ョ厓閺夌偟澧楅ˇ宄邦熆鐟欏嫭绀嬫慨濠冩そ閹筹繝濡堕崨顔锯偓鍓х磽娓氬洤鏋涢柣顓炲€块獮鍡楃暆閸曨偆锛滃┑顔筋焾妞寸鈻?
                ItemStack idCard = this.inventory.getItem(39);

                // 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ帒顦伴弲顏堟⒑閸濆嫮鈻夐柛妯恒偢瀹曞綊宕掑В顓炵秺瀹曟宕楅懖鈺冣枏缂傚倷鑳舵慨閿嬬箾閳ь剚顨ラ悙瀵稿ⅹ閼挎劖銇勯幒鍡椾壕婵犲痉銈呬汗缂?A: 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗霉閿濆浜ら柤鏉挎健瀵爼宕煎顓熺彅闂佹悶鍔嶇换鍐Φ閸曨垰鍐€闁靛ě鍛帒闂備礁鎼Λ娆戝垝瀹ュ棛鈹嶅┑鐘叉搐鍥撮梺鍛婁緱閸欏孩绂掗崜褏纾介柛灞炬皑瀛濈紓浣割槺閹虫捇锝炶箛鏃傜瘈婵﹩鍓涢敍婊冣攽閻愬弶顥為柛銊ョ仛娣囧﹥绂掔€ｎ偄浠┑鐘诧工鐎氼厾娆㈤弻銉︾厱闁绘柨鎲＄紞鎴炪亜閺囶亞绉柟顔荤矙瀹曟粓宕ｆ径瀣彍闂傚倷绶氶埀顒傚仜閼活垱鏅堕幘顔界厸濞达絿顭堥弳锝呪攽椤旂懓浜鹃梻浣规灱閺呮盯宕锔绘晛闁瑰墽绮埛鎴犵磽娴ｅ顏堟倶閿曞倹瀚呴弶鍫涘妿缁犻箖鏌涢锝囩煀鐎规挸妫欓幈銊︾節閸愨斂浠㈠Δ鐘靛仦閸旀牠骞嗛弮鍫濐潊妞ゎ偒鍠氱粚鍧楁⒒閸屾瑨鍏屾い顓炵墦椤㈡牠宕卞☉妯碱唹闂佹悶鍎洪崜娆撴嫅閻斿吋鐓熼柡鍐ㄥ€甸幏锟犳煛娴ｉ潻韬柡灞诲€濋獮渚€骞掗幋婵喰戞俊鐐€х€靛矂宕ｉ崘顭戞綎婵炲樊浜濋悞濠氭煟閹邦垰钄奸悗姘緲椤儻顧侀柛銊ョ－濡叉劙骞掗弬鍝勪壕闁挎繂楠告禍婊勭箾閹碱厼娅嶉柡灞炬礋瀹曞崬螖閳ь剟寮抽敐鍥ｅ亾鐟欏嫭绀堥柛妯犲洤鐓橀柟杈剧畱缁€鍐煃閸濆嫬鏆曠紒銊︽尦濮婂宕掑▎鎺戝帯濡炪們鍨归敃顏堢嵁閹炬椿鏁傞柛顐ゅ暱閹稿啴姊洪崨濠冨闁搞劍澹嗘竟鏇熺節濮橆厼鈧敻鏌ㄥ┑鍡涱€楅柡瀣枛閺岋綁骞橀崘鍙夋閻庢鍠栭悥濂稿箖濞嗘挸绾ч柟鎼幗椤ュ姊绘担鍛婂暈闁哄被鍔庣划鏃囥亹閹烘垼鎽?(闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎾跺Х閸橆垶姊绘担鍛婃儓缂佸绶氶幃妯衡槈濡攱顫嶉梺闈涚箳婵兘藝閺夋娓婚柕鍫濇婢ь剚鎱ㄥΟ绋垮闁诡喗鍎崇叅妞ゅ繐鎳夐幏娲⒑閸涘﹦绠撻悗姘煎弮瀹曟帡濡搁埡鍌滃幈闂侀潧顭梽鍕Φ濠靛牃鍋撶憴鍕闁搞劌缍婇崺鈧い鎺戯功缁夌敻鏌涢悩鎰佹疁鐎规洘鍔欏畷濂稿即閻斿搫骞楅梻浣筋潐婢瑰棙鏅跺Δ鈧埥澶庮樄闁哄本鐩顕€骞橀崜浣规闂備礁鎼張顒傜矙閹捐鐒垫い鎺戯功缁夌敻鏌涚€ｎ亝鍣藉ù婊冩啞鐎佃偐鈧稒顭囬崢鐢告倵閻熸澘顏褎顨婂畷鐢稿炊椤掍胶鍘甸梺缁樻尭濞撮绮斿ú顏呯厵妞ゆ梹鍎抽崢瀵糕偓娈垮枦閸╂牠骞嗛弮鍫濈闁哄鍨瑰Σ濠氭⒒閸屾艾鈧悂宕愰幖浣哥９濡炲瀛╅鑺ユ叏濮楀棗澧婚柣鎺旀櫕閹茬顓奸崼顫綍闂傚倷绀侀幖顐﹀疮椤愶箑纾瑰┑鐘崇閸庢鏌涢埄鍐炬▍鐟滅増甯楅弲鏌ユ煕椤愵偄浜濈紓宥呯墕閳?..闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亜顒㈡い鎰矙閺屻劑鎮㈤崫鍕戙垻绱掗幇顓ф畷缂佺粯鐩獮瀣倻閸℃瑥濮辨繝鐢靛仦閸垶宕归崷顓犵焼閻庯綆鍋佹禍婊堟煛閸愩劍澶勯柕鍡楀暞閹便劎鎲撮崟鍨杹濠殿喖锕ュ钘夌暦椤愶箑绀嬫い鏇炴噺閽戝姊绘担渚劸閻庢稈鏅犻幃锟犲灳閹颁礁娈?
                if (!idCard.isEmpty() && idCard.hasCustomHoverName()) {
                    String cardName = idCard.getHoverName().getString();
                    applyBaseNameFromIdCard(cardName);
                }
                // 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ帒顦伴弲顏堟⒑閸濆嫮鈻夐柛妯恒偢瀹曞綊宕掑В顓炵秺瀹曟宕楅懖鈺冣枏缂傚倷鑳舵慨閿嬬箾閳ь剚顨ラ悙瀵稿ⅹ閼挎劖銇勯幒鍡椾壕婵犲痉銈呬汗缂?B: 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗霉閿濆浜ら柤鏉挎健瀵爼宕煎顓熺彅闂佹悶鍔嶇换鍐Φ閸曨垰鍐€闁靛ě鍛帒闂備礁鎼Λ娆戝垝瀹ュ棛鈹嶅┑鐘叉搐鍥撮梺鍛婁緱閸欏孩绂掗崜褏纾介柛灞炬皑瀛濈紓浣割槺閹虫捇锝炶箛鏇犵＜婵☆垵顕ч鎾绘⒑閸涘﹦鈽夐柨鏇樺劦瀹曟洟骞樼紒妯煎幗闁瑰吋鐣崹娲儍閹达附鐓曢煫鍥ㄦ瀭椤忓牊鍋╅柣銈庡灛娴滃綊鏌熼悜妯虹仼妞ゆ柨鎳樺娲嚍閵夊喚浜棟闂侇剙绉撮崒銊╂煙缂併垹鏋熼柍閿嬪灴閺屾稑鈹戦崱妤婁紑闂佸疇顕чˇ鐢稿蓟濞戞鐔煎捶椤撶姷鍘柣?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缂佺姷濞€閺岀喖宕滆鐢盯鏌涚€ｃ劌鈧繈寮婚弴鐔虹闁绘劦鍓氶悵鏇㈡⒑缁嬫鍎忔い鎴濐樀瀵鏁愭径濠勭杸濡炪倖甯婇悞锕傚磿閹剧粯鈷戠紓浣姑粭鎺楁煟韫囨柨鍝哄┑锛勬暬瀹曠喖顢涘槌栧敽闂備胶纭堕崜婵嬪Φ閻愬鐝堕柡鍥ュ灪閳锋帒霉閿濆嫯顒熼柡鈧悧鍫㈢闁告侗鍠楃粈瀣偓瑙勬礃缁诲牆顕ｆ禒瀣垫晣闁绘劕鐏氶悡锝夋⒒娴ｇ顥忛柛瀣噹鐓ら柡宥庡幗閻撱儵鏌曢崼婵囶棛缂佽妫濋弻鏇㈠醇濠靛棌鍋撻崨濠勵洸闁绘劦鍓涚粻鍓х棯閹屽剰濞存粎鎳撻埞鎴︻敊閼恒儱鍞夊┑鐘亾濞撴埃鍋撴慨濠冩そ楠炴劖鎯旈敐鍥╂殼闂備胶鎳撻崯璺ㄦ崲閹烘绠憸鐗堝笒閻掓椽鏌涢幇銊︽珔鐎殿喗瀵х换婵嬫偨闂堟刀銏＄箾鐏炲倸濮傞柟顔藉劤鐓ゆい蹇撴噽閸樻悂鏌ｈ箛鏇炰粶濠⒀傜矙閸┿儲寰勭€ｃ劋绨诲銈嗗姧缁茶法绮婚悙娣簻闁靛繆妲呭▓婊呪偓瑙勬礃鐢€崇暦閹烘嚦鐔兼惞闁稓绀勯梻? -> 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ帒顦伴弲顏堟⒑閸濆嫮鈻夐柛妯恒偢瀹曟帡濡歌閸犳劙鏌ｅΔ鈧悧鍡欑箔閹烘鐓曢柕濞垮劚閳ь剙顭烽獮澶愬箹娴ｇ懓浜遍梺鍓插亝缁诲倿骞嗛悙鐑樷拺闁硅偐鍋涢崝鎾煕閹惧鎳囬柟顖氳嫰铻栭柍褜鍓熼垾锕傚锤濡や礁娈濋梺娲诲墻娴滄繈宕归崜浣虹焿闁圭儤鍤﹂悢鐑樺仒闁斥晛鍟弶鎼佹⒒娴ｅ摜鏋冩俊顐㈠铻炴俊銈呮噺閸婂爼鏌嶉埡浣告殧濞存粍绮撻弻鐔衡偓鐢殿焾娴犙囨煙閸愬弶宸濋柍?
                else {
                    restoreDefaultBaseNameFromIdCardRule();
                }
            }
            // ===================================================================
            // [闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫆闁芥ê顦純鏇㈡⒒娴ｈ櫣銆婇柛鎾寸箞閹柉顦归柟顖氱焸楠炴绱掑Ο琛″亾閸偆绠鹃柟瀵稿剱娴煎棝鏌熸潏鍓х暠闁活厽顨婇悡顐﹀炊閵娧€濮囬梺缁樻尵閸犳牠寮婚敓鐘茬闁靛绠戦ˇ鈺侇渻閵堝懐绠冲┑鐐╁亾闂佸搫鏈粙鎴ｇ亙婵炶揪绲块…鍫ュ箺閻㈠憡鈷? 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯锋嫼閻熸粎澧楃敮鎺撶娴煎瓨鐓曢柟鎯ь嚟濞插瓨銇勯姀鈭额亞鍙呭銈呯箰閹冲骞忓ú顏呪拺闁煎鍊曢弸娑㈡煕鐎ｎ亷韬€规洜鏁婚幃銏ゅ礂閼测晛骞堥梺璇插嚱缂嶅棝宕滃▎鎰浄鐟滃繒妲愰幒妤婃晩缁炬媽浜崥瀣旈悩闈涗沪閻㈩垽绻濋悰顔锯偓锝庡枛缁秹鏌嶈閸撶喖鏁愰悙宸悑濠㈣泛顑傞幏娲煟閻斿摜鎳冮悗姘煎墰缁牓宕橀埞澶哥盎闂佸搫娲ㄩ崰鎾存櫠閻㈢鍋撶憴鍕闁告挾鍠栭獮鍐煥閸忓墽鍠撻幏鐘诲箵閹哄秶绀嬮梻鍌氬€峰ù鍥х暦閻㈢绐楅柡宥庡幖绾捐鈹戦悩韫抗闁绘梻鍘ч悞鍨亜閹烘垵顏柍閿嬪灴瀵爼鎮欓弶鎴濡炪倧璁ｆ俊鍥╂閹烘挸绶為幖杈剧磿閸橆偆绱撴担绋库偓鍦暜閿熺姴鏋侀柛鎰靛枛绾惧吋绻涢幋鐐嗘垿鎮炬导瀛樷拻濞达絿顭堥弳閬嶆煙绾板崬浜扮€规洩缍侀獮鍥级鐠侯煈鍚呴梻浣瑰濡浇顣鹃梺褰掓敱濡炶棄顫忓ú顏勫窛濠电姴瀚уΣ鍫ユ⒑閹稿孩纾搁柛鏂跨Ф缁晠鎮㈡總澶嬪缓闂侀€炲苯澧寸€殿喖顭烽弫鎾绘偐閺屻儱鏁规俊鐐€栭崝鎴﹀垂瑜版帒鐓曢悗锝庝憾濞撳鏌曢崼婵嗘殭闁诲浚浜濋妵鍕Ω閵夘垵鍚Δ鐘靛仜閸燁偊鍩㈡惔銊ョ闁哄鍨熼崑鎾剁磼濡湱绠氬銈嗙墬缁瞼鏁捄琛℃斀妞ゆ洍鍋撻柡鈧潏鈺傚床婵犻潧妫岄弸鏃堟煕椤垵鏋熼柣蹇撶Ч閺岋箓宕橀銏犳懙缂備胶绮换鍫ュ春閳ь剚銇勯幒鎴濃偓褰掑窗閸℃稒鐓曢柡鍥ュ妼楠炴鎲告导瀵哥暫婵﹥妞藉畷顐﹀礋椤掆偓閸嬪秹姊洪幖鐐插婵＄偘绮欏畷鍝勨槈閵忕姷顓洪梺鎸庢⒒閺咁偊宕㈤悽鐢电＝闁稿本鐟ч崝宥夋煥濮樿京纾兼俊銈勮兌椤ｈ尙绱掔紒妯肩疄闁糕斁鍋撳銈嗗笒鐎氼參宕戠€ｎ喗鐓曟い鎰剁悼閻瞼绱掗悩鍐插摵婵﹥妞藉畷鐑筋敇閻樿尙顐奸梺姹囧焺閸ㄩ亶銆冩繝鍥╁祦濠㈣埖鍔曟导鐘绘煏婢诡垰鎷戠槐鍙変繆閻愵亜鈧牕螞娴ｈ倽娑㈠礋椤栨矮绱跺┑鐐叉▕娴滄繈鎮″▎鎾寸厽闁规儳鍟块銏ゆ偣閹板墎绡€闁哄瞼鍠栧畷锝嗗緞鐎ｎ亜鏀柣搴ゎ潐濞叉粓宕伴弽顓溾偓浣割潨閳ь剟骞冮姀銈呯闁圭粯甯楀▍濠囨⒒閸屾艾鈧悂宕愰幖浣哥９闁绘垼濮ら崐鍧楁煥閺冨牊鏆滈柛瀣尵缁厼鈽夊Ο璇叉闂佹椿鍘介悷鈺呭蓟閻斿憡缍囬柛鎾楀懏娈搁梺璇插閼归箖藝娴兼潙桅闁告洦鍨扮粻鎶芥煙鐎涙绠ュù鐘层偢濮婃椽骞栭悙鎻掝瀳闂佺锕ゅ鈥愁嚕婵犳艾鍗抽柣鏃囨椤旀洟姊虹紒妯哄Е闁告挻宀搁幃鐢稿即閵忊檧鎷洪梺纭呭亹閸嬫盯鍩€椤掍礁濮嶇€规洘鍨块獮妯肩磼濡攱瀚藉┑鐐舵彧缁蹭粙骞夐敓鐘茬柈闁绘劕鐪伴埀顒佸笒椤繈顢樿閻や線鎮楃憴鍕缂侇喖鐭傞崺銉﹀緞閹邦剦娼婇梺鐐藉劚閸樻牠鎮界紒妯肩瘈闁汇垽娼ч埢鍫熺箾娴ｅ啿娴傞弫鍕煕閳╁啰鈽夌痪鎯х秺閺岋綁濮€閻樺啿鏆堥梺缁樻尵閸犳牠寮婚弴锛勭杸闁哄洨鍊妷銉冨綊鎮╁畷鍥ｅ闂侀潧娲ょ€氼垳绮诲☉銏犲嵆闁绘劕顕禍鏍磽閸屾瑦绁板鏉戞憸閺侇喖螖閳ь剟鈥﹂崶顏嗙杸婵炴垶顭傞埡鍐╁枑闊洦绋掗崑鈺呮煕韫囨艾浜圭紒鐘荤畺閹鈽夊▎妯煎姺闂佹椿鍘奸敃顏堝蓟閻旇鍦偓锛卞啩澹曢梺褰掝暒閼冲爼宕濋悜鑺ヮ棅妞ゆ劑鍨烘径鍕€掑顓ф疁鐎殿噮鍋婂畷姗€顢欓悾灞藉妇闂傚鍋勫ú锕€煤閺嵮勬瘎闂傚倷绶氶埀顒傚仜閼活垱鏅舵繝姘厱闁规儳顕妴鎺撲繆閸欏濮嶆鐐搭焽閳ь剚绋掗敋妞ゅ孩鎹囧娲閳轰胶妲ｉ梺鍛婎焾婵倝銆冨▎鎾粹拻闁稿本鐟чˇ锕傛煙濞村鍋撶搾浣规そ閺佸啴宕掑槌栨Ф婵犵數鍋為崹顖炲垂閸︻厾鐭嗛柛鏇ㄥ€嬭ぐ鎺撳亹鐎瑰壊鍠栭崜閬嶆⒑閹惰姤鏁遍柛銊ユ健瀵鈽夊Ο閿嬫杸闂佺硶鍓濋〃蹇旂婵傚憡鈷戦梺顐ゅ仜閼活垱鏅舵导瀛樼厱闊洦鏋傞鍫熷仼闁绘垼濮ら弲鎼佹煟濡灝鐨烘い鏂挎嚇濮婃椽鎳為妷鍐句邯钘濋梺顒€绉寸粈澶愭煥閺囨浜惧銈庝簻閸熷瓨淇婇崼鏇炲耿婵°倕鍟伴幉顏嗙磽閸屾瑨顔夐柛瀣尭閵嗘帒顫濋敐鍛闁诲氦顫夊ú锕傚磻婵犲倻鏆︽い鎰剁畱缁€?
        if (this.ownerUUID != null) {
                UUID syncedId = this.entityData.get(OWNER_UUID_SYNC).orElse(null);
                if (!this.ownerUUID.equals(syncedId)) {
                    this.entityData.set(OWNER_UUID_SYNC, Optional.of(this.ownerUUID));
                }
            }
        } else {
            // [闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑鏅悷婊冮叄閵嗗啴濡烽埡浣风炊闂侀潧锛忛崒婊呮喒闂佽楠哥粻宥夊磿闁单鍥敍閻愭彃鐎梺绋挎湰缁嬫挾绮婚崜褉鍋撻悷鏉款棌闁哥姵娲滈懞杈ㄧ節濮橆厾鍘搁梺鍛婃磵閺呮盯宕濆鍛＜缂備焦顭囧ú瀛橆殽閻愬樊鍎旈柟顔界懅閳ь剟娼ч幉锟狀敇婵犳碍鈷掑ù锝呮啞閸熺偞銇勯妸銉︻棞闁伙絾绻堥獮鏍ㄦ媴濮濆本鎲? 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墴閹潡顢氶埀顒勫蓟濞戙垹绠涙い鎾跺О閸嬬偤姊洪崫鍕靛剱闁绘顨堥幑銏犫槈閵忕姷顓哄┑鐐叉缁绘帗绂掓總鍛娾拺闁告繂瀚銉╂煕鎼达絾鏆€殿喖顭峰鎾晬閸曨厽婢戦梻渚€娼ч敍蹇涘椽閸愵亜鎯炴繝纰夌磿閸嬫垿宕愰幇鏉跨柧婵犻潧顑呯粈鍌涙叏濡炶浜鹃梺缁樹緱閸ｏ絽顕ｆ禒瀣р偓鏍Ψ閵夆晛寮板銈冨灪椤ㄥ﹪宕洪埀顒併亜閹哄秵顦风紒璇叉閺岋綁骞嬮敐鍛呮捇鏌ｉ幘瀛樼闁诡喗顨婇弫鎰償閳ヨ尙鍑归梺璇茬箰濞存岸宕㈡禒瀣﹂柛鏇ㄥ灱閺佸啴鏌ㄥ┑鍡樺窛闁汇倕瀚伴幃妤€鈻撻崹顔界亾闂佽桨娴囬褑鐏嬮梺鍛婂姂閸斿危閸儱绾ч柛顐亞閸樻稒淇婇鐘插姦婵﹤顭峰畷鎺戭潩椤戣棄浜鹃柟闂寸绾惧綊鏌ｉ幋锝呅撻柛濠傛健閺屻劑寮村鑸殿€栨繛瀛樼矊缂嶅﹪寮诲☉銏犵疀闂傚牊绋掗悘宥夋⒑缁嬪灝顒㈡い銊ユ嚇婵℃挳骞掗幋顓熷兊闂佹寧绻傞幊宥嗙珶閺囩喍绻嗛柣鎰典簻閳ь剚鍨垮畷褰掓惞閻熺増鐎抽悗骞垮劚濞茬娀宕戦幘缁橆棃婵炴垶鐗曟禒顕€鎮楀▓鍨灈闁绘牕銈搁悰顔锯偓锝庡枟閸嬫劙姊婚崼鐔衡槈缂佺姵鍨垮濠氬磼濮橆兘鍋撴搴ｇ焼濞撴埃鍋撴鐐寸墵椤㈡洟濡堕崶鈺冨帬闂備礁鎼悮顐﹀磿鏉堚晝鐭嗗璺哄閸嬫捇鐛崹顔煎濠碘槅鍋呴惄顖炲Υ閸涘瓨鐓ラ悗锝庡亜瀵灝鈹戦敍鍕哗妞ゆ泦鍕洸濡わ絽鍟埛鎴︽煕濠靛棗顏柣鎺曟硶缁辨帞绱掑Ο鑲╃暤闂佷紮绲块崗姗€鐛幒妤€绠ｉ柡鍐ｅ亾妞ゎ偄绉撮埞鎴︻敊缁涘鐣跺┑鈽嗗亝閻熲晞妫㈤柣搴秵閸嬪棛寮ч埀顒勬⒑濮瑰洤鐏叉繛浣冲嫮顩锋繝濠傜墛閻撶喐淇婇妶鍌氫壕闂佹寧娲︽禍婊堟偩閻ゎ垬浜归柟鐑樺灩椤︻厽绻涙潏鍓хК婵炲拑缍侀幃锟犲箻鐎靛摜鐦堥梺闈涢獜缁插墽娑垫ィ鍐╃厸闁割偒鍋勬晶顖炴煕閹烘埊鏀荤紒杞扮矙瀹曘劍绻濋崟顐㈠強闂傚倸顭崑鍕归崟顓炵筏闁兼亽鍎抽々鏌ユ煟閹邦剦鍤熺紒鈾€鍋撻柣鐔哥矊缁夊爼鍩€椤掍胶顣叉繝銏★耿閿濈偠绠涢幘浣规そ椤㈡棃宕熼鍡欏€為梻鍌欑閹测€趁洪敃鍌氱；闁圭儤鎸搁杈┾偓鍏夊亾闁告洦鍏橀幏娲⒑绾懎浜归柛瀣⊕娣囧﹪宕稿Δ浣哄幐婵炶揪绲芥竟濠囨偂閸忕⒈娈介柣鎰级椤ャ垻鈧娲橀敃銏′繆閹间礁顫呴柍鈺佸暞濠㈡垿姊绘担绛嬪殭闁告垹鏅槐鐐哄幢濞戞锛涢梺鍛婁緱閸樻悂寮稿澶嬬厸鐎广儱楠搁獮妤呮煕婵犲嫭鏆柡灞剧缁犳盯骞欓崘鈹附绻涚€涙鐭掔紒鐘崇墪椤繐煤椤忓嫬绐涙繝鐢靛Т閸婃瓕顤傛繝鐢靛仜閻°劎鍒掑澶堚偓鍐╃節閸屾粍娈鹃梺纭呮彧闂勫嫰宕愰悜鑺ョ厽闁瑰鍊戝璺虹闁惧繐婀辩壕钘壝归敐鍛棌闁稿骸绻橀幃妯跨疀閹炬潙娅ら柧鑽ゅ仦閹便劌螣閸喚鍘梺缁樻尰濞茬喖骞冨Δ鍛櫜閹肩补鈧尙鐩庡┑鐘愁問閸犳牠藝閻㈢钃熸繛鎴欏灩缁犳娊鏌熼幆褏锛嶉柣鐔哥叀閺岋絾鎯旈妸锔介敪闂侀潧鐗忛…鍫ヮ敋閿濆閱囬柡鍥╁仧椤撳搫鈹戦悩缁樻锭闁绘妫涚槐鐐存媴缁洘鏂€闂佹寧绋戠€氼剚绂嶆總鍛婄厱濠电姴鍟版晶顏呫亜閺傝法绠茬紒缁樼箓椤繈顢楅崒锔惧耿闂傚倷娴囬～澶愬磿閹剁瓔鏁嬫い鎾跺Т婵剟鏌嶈閸撶喎顫忓ú顏呯劵闁绘劘灏€氭澘顭胯閻°劑銆冮妷鈺傚€烽弶鍫熷礃閳ь剚瀵ч妵鍕閿涘嫭鍣伴梺纭呮珪閻楃娀宕洪敓鐘茬闁靛鍎抽悾鍗炩攽閻樺灚鏆╁┑顔炬暬椤㈡瑩寮介鐐电崶濠德板€曢幊搴㈩攰婵犵數鍋為崹顖炲垂閸︻厼顥氬┑鐘崇閻撴瑩鏌涢幘妤€鎳庣粭锟犳⒑?
            // 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫鍐煥閺囨浜鹃梺姹囧€楅崑鎾舵崲濠靛洨绡€闁稿本绮岄·鈧梻浣侯焾椤戞垹鎹㈠┑瀣摕闁靛ň鏅涢崡鎶芥煟閹邦厾銈撮柛瀣崄閵囨劙骞掗幋鐙呯幢?HUD 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑鏅悷婊冪箻楠炴垿濮€閵堝懐鐤€濡炪倖妫佸Λ鍕償婵犲倵鏀介幒鎶藉磹閺囥垹鐤い鎰剁畱閸ㄥ倹绻濋棃娑欑劸闁哄啫鐗婇弲鏌ユ煕濞戝崬骞楁繛鍫幘缁辨挻鎷呴幓鎺嶅闂備胶顭堥張顒傜矙閹邦喗宕查柛鈩兦滄禍婊堟煛瀹ュ啫濮€濠㈣锕㈤弻鐔碱敊閽樺浼岄梺璇″枟椤ㄥ懘锝炲┑瀣垫晣闁绘劕寮堕幊娆撴⒒娴ｇ瓔鍤冮柛鐘崇墱缁辩偞绻濋崒婊勬闂佸壊鍋呭ú鏍ㄥ劔闂備線娼ч敍蹇涘川椤愵澀鐢婚梻?ownerUUID 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾剧粯绻涢幋娆忕仾闁稿鍊濋弻鏇熺箾瑜嶉崯顐︽倶婵犲洦鐓熼煫鍥ㄦ礀娴犫晛鈹戦悙鍙夋悙闁宠棄顦～婵嬫晲閸涱剙顥氶梻鍌氬€搁悧濠勭矙閹烘鐤柣鎰暘娴?
            this.ownerUUID = this.entityData.get(OWNER_UUID_SYNC).orElse(null);
        }
        // =======================================================

        this.updateOverheadStatus();

        if (!this.level().isClientSide) {
            // ==================== 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰鍐€妞ゆ劦婢€缁泛鈹?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犖ч柛銉㈡櫇閸樼娀姊绘担绋款棌闁稿鎳庣叅鐎广儱顦悞鍨亜閹烘埊鍔熼柣锝囨暩閳ь剝顫夊ú鏍Χ閸涘﹥鍙忛柍褜鍓熼弻鏇＄疀鐎ｎ亞浠煎銈忚吂閺呮盯鍩為幋鐐茬疇闂佺臎閸涱厾绛忔繛瀵稿Т椤戝懘鎮块濮愪簻闁哄稁鍋勬禒婊堟煟閵堝洤浜鹃柕鍥у楠炴帒顓奸崶褍顬夐梻浣告啞閻熴儳鎹㈤幋锕€绠為柕濞垮剻閺冨牆鐒垫い鎺嗗亾閾荤偞淇婇妶鍛櫧鐎规挷鐒︽穱濠囶敍濠靛棔姹楃紒鐐劤閵堟悂寮婚敐鍛瀻閻忕偞鍨濇竟鏇㈡⒒娴ｈ鍋犻柛鏃€鍨剁粋宥夊醇閺囩姴绁﹂梺鍓插亖閸庤鲸鍎梻渚€娼чˇ顓㈠垂濞差亜妫橀柍褜鍓欓埞鎴︽偐閸偅姣勬繝娈垮枛閻°劑銆冮妷褏鐭欓幖瀛樻尰閻忎礁顪冮妶鍡樺蔼闁搞劍妞介崺娑㈠箣閿旇В鎷哄銈嗗姂閸婃洘绂掑鍫熺厾婵炶尪顕ч悘锟犳煛閸涱厾鍩ｆい銏＄洴閹瑩寮堕幋婊呯处濠碉紕鍋戦崐鏍偋濡ゅ啫鍨濈€光偓閸曨偄鍤戝┑鐐村灦閻燂絾绂嶅鍫熺厪闊洤锕ラ～澶愭煠閻楀牆顕滄い銊ｅ劦閹瑧鈧數顭堥～褔姊洪悷鏉挎Щ闁硅櫕锚閻ｇ兘顢曢敃鈧敮閻熸粌娴风槐鐐寸瑹閳ь剙顫忔繝姘＜婵炲棙鍩堝Σ顔界節閵忋垺鍤€闁挎洦浜滈悾鐑藉箣閿曗偓瀹告繃銇勯幒鏂垮付闁圭⒈鍋婇、姗€宕楅悡搴ｇ獮婵犵數濮寸€氬摜妲愰柆宥嗏拻濞达絿鐡斿鎰偓瑙勬礃閿曘垽銆佸鎰佹▌閻庤娲╃徊鍓ф崲濠靛鐐婇柍杞扮缁插ジ姊绘担瑙勫仩闁稿寒鍨跺畷婵嗩吋閸モ晝鐒奸梺閫炲苯澧扮紒?====================

            // ===============================================================

            // ==================== 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰鍐€闁靛ě鍛帓闂備焦妞块崢鐓幬涘Δ鍛偓锕傚锤濡や礁娈濋梻鍌氱墛缁嬫垿锝炲澶嬧拺?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰缁鎮╅崗鍛畾濡炪倖鐗楃换鍌涚閸︻厾妫柟瑙勫姇琚氶梺閫涚┒閸斿矁鐏掗梺鍦焾濞寸兘濡撮幇顔剧＝濞达絾褰冩禍楣冩⒑缁嬫寧婀扮紒瀣浮瀹曪綀绠涢弬鍓х畾闂佺粯鍔欓·鍌炲吹濞嗗緷鐟邦煥閸曨偄濮㈤柧缁樼墵閺岋絽顫滈埀顒€顭囪缁傛帒顭ㄩ崟鈺€绨婚梺鐟扮摠缁诲啴宕甸埀顒勬⒑鐠囪尙绠查悽顖滃仧濡叉劙骞樼拠鑼紲濠电偛妫欓崹鍨繆閽樺娓婚柕鍫濋楠炴牗绻涚拠褍顩紒顔碱儏椤撳吋寰勬繝鍥ф暪闂備礁鎼ú銊╁疮閸ф绠繛宸簼閳锋垹绱撴担濮戭亪鎮樺澶嬬厸闁告侗鍠氶惌濠囨煃鐠囪尙效鐎规洖宕埥澶娾枎閹存繂绠為梻鍌欑窔濞佳団€﹂崼銉ョ？闂侇剙绉查埀顒€鍊块獮搴ㄦ嚍閵壯冨箰?====================
            LivingEntity target = this.getTarget();
            if (target != null && target.isAlive()) {
                if (target.getLastHurtByMob() == this) {
                    if (this.tickCount - target.getLastHurtByMobTimestamp() < 10) {
                        this.consecutiveMisses = 0;
                        this.lastDamageTimestamp = this.tickCount;
                    }
                }

                if (this.consecutiveMisses >= 5) {
                    this.setTarget(null);
                    this.consecutiveMisses = 0;
                    this.playSound(SoundEvents.DISPENSER_FAIL, 1.0f, 1.5f);

                    // 闂?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧潡鏌熺€电孝缂佽翰鍊濋弻锕€螣娓氼垱锛嗛悷婊呭鐢帞澹曟總鍛婄厽闁归偊鍨伴惃娲煟濞戞牕鍔︽慨濠冩そ瀹曨偊宕熼娑欑€遍梻浣告啞钃辨俊顐㈠暙閻ｇ兘宕奸弴銊︽櫌闂侀€炲苯澧撮柟閿嬪灴閹垽宕楅懖鈺佸妇濠电姰鍨奸崺鏍儎椤栨凹鐎舵い鏃傛櫕缁犻箖鏌涘☉鍗炴灓濠⒀屼邯閺屽秶鎲撮崟顐や紝濡炪們鍨洪悷鈺侇嚕椤掑嫬围闁告洦鍙€缁绘垿姊婚崒娆戭槮闁硅绻濋獮鎰版嚒閵堝洨鐓撻梺瑙勫礃濞夋盯宕瑰┑鍡忔斀闁绘ê鐤囨竟妯肩磼閻欏懐绋荤紒缁樼箞瀹曞綊顢曢姀鐙€娼旈梺璇查叄濞佳囨儗閸屾凹娼栨繛宸簼椤ュ牊绻涢幋鐐跺妞わ絽鎼埞鎴︽倷閼碱剚鍕鹃梺鍛婃煥闁帮絽顕ｉ锔绘晩閻忓繑鐗楅～宥呪攽閻愬弶顥滄繛鎾棑缁?[闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箻閺岀喖顢涢崱蹇撲壕闂佸搫顑呯粔褰掑蓟閵娿儮鏀介柛鈾€鏅滅瑧缂傚倷鐒﹂崝鏍€冩繝鍥ц摕闁炽儱纾弳銈嗐亜閺冨倹鍤€濞存粓绠栧娲传閸曢潧鍓卞┑鈽嗗亜閸熸潙顕ｆ繝姘嵆闁挎稑瀚弶鎼佹⒑閸濆嫭宸濋柛搴㈠姇椤洭寮崼鐔叉嫼缂傚倷鐒﹁摫闁抽攱甯￠弻娑樜熼悩鍙夊闁稿﹤澧庨埀顒冾潐濞叉牕煤閻樿纾婚柟鎹愬煐閸犲棝鏌涢弴銊ュ妞わ负鍎遍埞鎴︽倷閼碱剚鍕鹃梺鍛婃⒐閸ㄦ寧淇婄€涙鐟归柍褜鍓欓悾?闂?[婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓闁搞劌鍊块弻娑㈩敃閿濆棛顦ョ紓浣哄С閸楁娊寮诲☉妯锋斀闁告洦鍋勬慨銏ゆ⒑濞茶骞楅柟鐟版喘瀵鍩勯崘銊х獮闁诲函缍嗘禍鐐哄储閹扮増鈷戦柤娴嬫櫅椤ｅジ鎮楃粭娑樻搐妗呴梺鍛婃处閸犳岸鎮块埀顒勬⒑鐟欏嫬绀冩繛澶嬬洴閵嗗倸煤椤忓應鎷绘繛杈剧稻閺嬬粯顨ヨ箛娑欑厱濠电姴鍟版晶鍨殽閻愯尙澧﹀┑鈩冩倐婵＄兘顢欓挊澶岀处闂傚倷鑳剁涵鍫曞礈濠靛鈧啴宕ㄦ潏鍓х◤濡炪倖鍔ч梽鍕煕閹达附鐓曟繝闈涙椤忣亝銇勯妷褍浠ч柟?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墴閹潡顢氶埀顒勫蓟閻旂厧绀堝ù锝囧劋閹叉﹢姊烘潪鎵槮闁挎洦浜濠氭偄閸忚偐鍔烽梺鎸庢磵閸嬫捇鏌＄€ｎ剙鏋戦柕鍥у椤㈡洟鏁愰崱娆樻О缂傚倷鑳剁划顖滄崲閸惊娑㈠礃閵娿垺顫嶉梺鍛婎殘閸嬫稒绔熼崼銏㈢＝闁稿本鐟ㄩ崗灞解攽椤旇宓嗙€规洘娲熼獮搴ㄦ寠婢跺苯濮︽俊鐐€栧濠氬磻閹惧墎纾奸柣妯垮皺鏁堥悗瑙勬礃濞茬喖寮婚崱妤婂悑闁告侗鍨抽弸鍐⒑绾懎顥嶉柟娲讳簽瀵板﹥銈ｉ崘銊﹁緢濠电姴锕ら悧濠囨偂濞嗘挻鐓熼柟瀵稿剳娓氭稒绻涢崼鐔哥闁哄本绋撻埀顒婄到婢у酣宕氭导瀛橆梿濠㈣埖鍔栭悡銉︾節闂堟稒顥為柛锝嗘そ閹綊骞囬崜浣虹槇闂佸搫鐬奸崰鏍箰婵犲啫绶炲┑鐘插暞椤斿秶绱撻崒娆愮グ濡炴潙鎽滈弫顕€鏁撻悩闈涚ウ闂佹悶鍎洪崜锕傚极閸℃褰掓晲閸涱喖鏆堥梺璇茬箰闁帮綁寮婚敐鍡樺劅闁靛牆瀛╃紞鍫濃攽閻愭潙绲荤紒缁樏悾鐑藉即閵忊€充缓闂佸憡绺块崕杈╃矈閿曞倹鐓熼幖鎼灣缁夐潧霉濠婂啰鍩ｉ柟顕嗙節婵＄兘鍩￠崒婊冨箞闂備浇顫夊姗€宕ラ埀顒傜磼閵娿劌浜归柟顕呭枛閳诲酣骞囬鍓ф闂備焦鐪归崹钘夘焽瑜庣粋鎺戭煥閸喓鍘介柟鐑樺▕瀹曟繃鎯旈妸銉ь槴闂佸湱鍎ら幐濠氬磿閻斿吋鐓ユ繝闈涙椤忣偊鏌涢幘鍗炲婵﹥妞藉Λ鍐归妶鍡欐创鐎规洜鍠栧畷褰掝敃閵堝洠妫?
                    if (this.ownerUUID != null && this.isFollowing()) {
                        LivingEntity owner = this.level().getPlayerByUUID(this.ownerUUID);
                        if (owner != null) this.getNavigation().moveTo(owner, 1.0);
                    }
                }

                boolean canSee = this.getSensing().hasLineOfSight(target);
                if (!canSee) {
                    this.blockedSightTime++;
                    if (this.isFollowing() && this.blockedSightTime > 20 && this.blockedSightTime % 10 == 0) {
                        this.getNavigation().moveTo(target, 1.2);
                    }
                    if (this.blockedSightTime > 60) {
                        this.setTarget(null);
                        this.blockedSightTime = 0;
                    }
                } else {
                    this.blockedSightTime = 0;
                }
            } else {
                this.consecutiveMisses = 0;
                this.blockedSightTime = 0;
            }

            // ==================== 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰鍐€妞ゆ劑鍨规竟澶愭⒑?缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛濠傛健閺屻劑寮撮悙娴嬪亾瑜版帒纾垮┑鐘叉处閳锋垶銇勯幒鍡椾壕缂備礁顦顓犲垝閸懇鍋撻敐搴℃灍闁绘挸绻愰埞鎴︽倷閼碱兛铏庨梺鍛婃⒐閻熴儵鈥︾捄銊﹀枂闁告洦鍓涢ˇ鏉库攽椤旂》鏀绘俊鐐舵铻為柛鎰╁妷濡插牓寮堕崼娑樺闁靛牆顦伴埛鎴犵磼鐎ｎ偄顕滈柛鐐差樀閹绠涢弮鍌涘櫘闂佸憡甯楃敮鈥崇暦婵傜唯闁靛／鍐ㄐ曞┑锛勫亼閸婃牜鏁幒鏂哄亾濮樼厧寮柛?====================
            if (this.isCommandScavenging() && this.ownerUUID != null) {
                Player owner = this.level().getPlayerByUUID(this.ownerUUID);
                if (owner != null && owner.hurtTime > 0) {
                    this.setCommandScavenging(false);
                    this.teleportToSafeSpot(owner, true);
                    this.playSound(SoundEvents.ENDERMAN_TELEPORT, 1.0f, 1.0f);
                }
            }

            // ==================== 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墴閹潡顢氶埀顒勫蓟閺囩喓绠鹃柣鎰靛墯閻濇梻绱掗悙顒€鍔ゆ繛灏栤偓鎰佹綎婵炲樊浜堕弫鍡涙煃瑜滈崜娑氬垝閺冨牊鍋ㄧ紒瀣硶閿涙稒绻濋姀锝呯厫闁告梹鐗犻幃锟犲即閻旂繝绨婚梺瑙勬緲婢у海绮欓懡銈囩＜闁逞屽墴閸┾偓妞ゆ帒鍊荤壕钘壝归敐鍡楃祷濞存粎鍋撶换婵嬪閿濆懐鍘梺鍛婃⒐閻楃娀骞冮敓鐘冲亜闁稿繗鍋愰崢鎼佹⒑閸涘﹤濮傞柛鏂跨Ф缁﹪鍩￠崨顔惧幈闂侀潧鐗嗗Λ娑㈠箠閸ヮ剚鐓?====================
            autoEat();
            if (this.tickCount % 20 == 0) updateInfoBookAndSlots();
            // --- 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰鍐€妞ゆ劦婢€濞岊亪姊洪崫鍕闁告挾鍠栧璇测槈閵忕姈銊︺亜閺冨倸甯舵い顐邯濮?闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箻閺屸剝寰勭€ｎ亝顔呴悷婊呭鐢帞澹曟總鍛婄厽闁归偊鍨伴惃娲煟閹炬潙鐏存慨濠冩そ瀹曘劍绻濋崒姣挎洟姊洪崫銉バｆい銊ワ工閻ｇ兘骞嬮敃鈧壕濂告煟閹邦剦鍤熼柛姗€浜跺铏规喆閸曨偆顦ㄩ柣蹇撶箲閻熲晞妫熼梺鎸庢礀閸婂綊宕愰悽鍛婄厱妞ゎ厽鍨垫禍鐐烘煕濞嗗苯浜鹃梻鍌欑閹碱偆鎮锕€纾归柡宥庡幖缁犵偤鏌曟繛鐐珔缂佺姵绋掗妵鍕箣閿濆棭妫勬繛瀛樼矌閸嬫挻绌辨繝鍥ч柛娑卞枛濞咃綁姊洪崫鍕仴闁稿海鏁诲濠氭晲閸涘倻鍠栭幊鏍煛娴ｄ警鍋ч梻鍌欒兌缁垶骞愭繝姘仭鐟滃繐危閹版澘绠抽柡鍌氭惈娴滈箖鏌ㄥ┑鍡欏嚬缂併劏妫勯湁闁绘﹩鍠栭悘鏌ユ煛鐏炵晫啸妞ぱ傜窔閺屾盯骞樼€靛摜鐣甸柧鑽ゅ仱閺屾盯寮撮妸銉т画缂? 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚敐澶嬫櫜闁告侗鍙庡▓顓㈡⒑缂佹ê绗掗柨鏇樺劦婵＄敻宕熼鍓ф澑闂佸湱鍋撳娆忊枍瑜嶉—?& 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼槮闁搞劍绻冮妵鍕冀椤愵澀姹楅梺閫炲苯澧剧紒鐘虫尭閻ｉ攱绺界粙璇俱劍銇勯弮鍥撴繛鍛崌濮婄粯鎷呴崨濠呯婵犫拃鍕垫當妞ゎ厼鐏濊灒闁兼祴鏅欑粭?---

            // 1. 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚敐澶嬫櫜闁告侗鍙庡▓顓㈡⒑缂佹ê绗掗柨鏇樺劦婵＄敻宕熼鍓ф澑闂佸湱鍋撳娆忊枍瑜嶉—?(闂?0缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋敐鍛闂佽姤蓱缁诲牓寮婚悢灏佹灁闁割煈鍠楅悘宥夋⒑閸濆嫭顥炵紒顔芥崌瀵鎮㈤崗鐓庘偓缁樻叏濡も偓濡瑩鎮鹃悜鑺モ拺缂佸娼￠妤冪磼婢跺﹦绉虹€殿喛顕ч埥澶愬閻樻鍟嬫繝寰锋澘鈧劙宕戦幘缁樺€垫慨妯煎帶婢ф挳鏌熼鑲╀粵閻庝絻鍋愰埀顒佺⊕鑿ら柟閿嬫そ濮婃椽宕ㄦ繝鍕暤闁诲孩鍑归崢钘夘嚗閸曨垰绀嬫い鎺嶇瀵灝鈹戦埥鍡楃仯妞ゎ厼鐗婇幈銊╁磼濞戞牔绨婚梺闈涚箚閸撴繈藟閸儲鐓涢悘鐐跺Г椤ユ粍銇勯幘鐐藉仮鐎规洖宕埢搴ょ疀閹剧绶?
            if (this.tickCount % 200 == 0) {
}

            // 2. 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｅΟ娆惧殭缂佺姴鐏氶妵鍕疀閹炬惌妫炵紓浣界堪閸婃繈寮婚敃鈧灒濞撴凹鍨遍埢鎾斥攽閻愯尙姣為柡鍛█瀵濡搁埡浣稿祮闂佺粯鍔栫粊鎾磻閹捐閱囬柡鍥╁仧閸旓箑顪冮妶鍡楃伇婵炲娲滅划锝夊籍閸屾浜鹃悷娆忓绾炬悂鏌涢弬鍧楀弰闁糕斁鍋撳銈嗗笂閼冲爼鍩婇弴鐔翠簻妞ゆ挾鍋為崰妯尖偓瑙勬磸閸ㄤ粙鐛幒鎳虫梹绗熼崶顭戞濠碉紕鍋戦崐鏍礉閹达箑鍨傞柣鎴灻欢鐐烘煕閺囥劌鍘哥紒璇叉閵囧嫰骞囬埡浣轰紕缂備胶濮锋晶妤呭Φ閸曨垼鏁冮柕蹇嬪灮椤斿姊洪棃娑氬⒊缂傚秳绀侀悾宄邦潨閳ь剟宕洪敓鐘茬闁靛鍎叉潏?(濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣銏犲閺佸﹪鏌″搴″箹闂傚偆鍨遍妵鍕冀閵娧呯厐缂備浇缈伴崐婵嬪蓟閿濆鏅查柛娑卞枟閹烽亶鎮楃憴鍕闁绘搫绻濆濠氭偄閸忕厧鈧粯鎱ㄥΔ鈧Λ娆擃敇閾忓湱纾介柛灞炬皑鏍￠梺缁橆殕椤ㄥ棛绮氭潏銊х瘈闁搞儺鐏涜閺屾稓浠﹂崜褏鍙濇繝銏ｎ潐濞茬喎顫忓ú顏勭闁归偊鍓欓幆鐐烘⒑缁嬫鍎嶉柛濠冪箓椤曪絿鎷犲顔兼倯闂佸壊鍋掗崑鍛搭敁閸ヮ剚鈷掑ù锝呮啞閸熺偤鏌熼幖浣虹暫鐎规洑鍗冲鍊燁檨闁?
            if (this.tickCount % 20 == 0) {
                float hp = this.getHealth();
                float max = this.getMaxHealth();
                if (hp < max * 0.2f) {
} else if (hp < max * 0.5f) {
}
            }
            lockInfoBook();
            if (this.tickCount % 10 == 0) tauntNearbyMonsters();

            manageBrutalityAbility();
            manageTorchBehavior();
            handlePickupAndXp();
            checkOwnerDistanceAndTeleport();
            tickPrintLogic();
            tickCaptainLogic();
            // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欑€靛摜鐦堥梺姹囧灲濞佳冪摥闂佽瀛╃粙鍫ュ疾濞戭潿鈧懏绺界粙璇锯晠鏌嶉崫鍕偓鐢稿箯濞差亝鈷戦柛锔诲弾閻掔偓绻涢幘顕呮缂侇喖顭烽獮妯肩磼濡厧骞嶉梻浣告啞閸旀浜稿▎鎴犱笉濠电姵纰嶉悡鐔兼煙閸喖鏆欏褍鐡ㄩ妵鍕閳藉棙鐤侀悗瑙勬礈閸犳牠銆佸Δ鍛＜婵﹩鍓涢濂告⒒閸屾艾鈧绮堟担鍦彾濠电姴娲﹂崑鍌炴煕椤愮姴鍔氱痪鎯ь煼閺屾稑鈽夐崡鐐典户闂佺粯甯掗敃銉╁Φ閸曨垰绠婚悹铏规磪濞戙垺鐓曢悗锝庡亝鐏忕敻鏌熼崣澶嬪唉鐎规洜鍠栭、妤呭焵椤掑倸鏋堢€广儱顦伴埛鎴︽煕濠靛嫬鍔氶柡瀣灴閺岀喖宕ㄦ繝鍌楁灆闂佽鍠曢崡鎶姐€佸▎鎾寸叆妞ゆ牗鐭竟鏇㈡⒑閹稿海绠撳Δ鐘虫倐瀵鈽夐姀锛勫幈闂佺鍩囬崝灞剧妤ｅ啯鈷戦柤濮愬€曢弸鎴犵磼椤旇壈瀚伴棁澶婎渻鐎ｎ亪顎楅柛銊︾箞閺屾盯顢曢悩鎻掑闂佺粯甯掗悘姘跺Φ閸曨垰绠抽柟瀛樼箥娴犻箖姊洪幎鑺ユ暠闁搞劌娼￠獮鍐崉鐞涒剝顫嶉梺鐟版惈濡绂嶆ィ鍐╃厱闊洦鎸婚崳瑙勩亜閵夛箑鍝烘慨濠勭帛閹峰懘鎸婃径濠冨劒濠电姵顔栭崰鏍椤撶姴鍨濋柛顐ゅ枑婵挳姊婚崼姘珗闁逞屽墮濞尖€愁嚕閸洖閱囨慨姗嗗幗閻濇牠姊哄ú璇插箹婵☆偅顨婇垾锔炬崉閵婏箑纾梺鎯х箰濠€杈ㄥ閸モ晝纾奸柣鎰靛墮閸斻倝鏌曢崼鐔稿€愮€殿喛顕ч埥澶婎潩椤愶絽濯伴梻浣告啞閹稿棝宕熼锝囧蒋闂傚倸鍊风粈渚€骞夐敓鐘茶摕闁靛ě鍛厠闂佹眹鍨婚…鍫燁攰闂備礁鎲″ú锕傚垂閹殿喚涓嶉柟鎯板Г閻撴瑩鏌熺憴鍕闁绘挻鍔欓弻娑㈠箳閹惧灈妲堥柧缁樼墵閺岋絽顫滈埀顒€顭囪缁傛帒顭ㄩ崨顖滐紲婵犮垼娉涢懟顖炲储閹绢喗瀵犳繝闈涱儐閻撶娀鏌涘┑鍕姎濞寸媭鍨伴湁婵犲﹤瀚惌鎺楁煛鐏炵偓绀夌紒鐘崇⊕缁绘盯骞嗚婢规洟鎮楃憴鍕婵炶绲垮Σ鎰攽鐎ｎ偆鍘介柟鍏肩暘閸娿倕顭囬幇顓犵闁圭粯甯炵粻鑽も偓瑙勬礃濞茬喎顕ｆ繝姘ㄩ柕澹懏姣庨梻鍌欑閹碱偊宕锔藉亱濠电姴娲ら悿楣冩煛鐏炶鍔滈柣鎾存礋閺屾洘寰勫☉姘煂婵犲痉銈呅撻柟渚垮姂閺佹劙宕ㄩ弶鎴濆強婵犳鍠栭敃锔惧垝椤栫偛绠柛娑欐綑閹硅埖銇勯幘璺烘灆鐎殿喗鎸冲缁樻媴閸涘﹤鏆堥梺鍝勮閸旀垿骞嗘径瀣檮缂佸娉曢崝锕€顪冮妶鍡楃瑐缂佲偓娓氣偓瀹曠敻顢楅崟顒傚幈濠碘槅鍨板﹢閬嶆儗濞嗘垟鍋撳▓鍨灍闁绘挴鈧磭鏆﹀┑鍌滎焾閸楁娊鏌ｉ弬鎸庡暈闁绘繃鐗犲缁樻媴娓氼垳鍔搁梺鍝勭墱閸撴稓鍒掑▎鎾崇闁瑰瓨姊归悗?缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋敐鍛闂佽姤蓱缁诲牓寮婚悢鐓庣濞达絿鍎ら幉姗€姊烘潪鎵槮妞ゆ垵娲獮澶愬川婵犲啫鍔呴梺闈涱焾閸庢娊鎮?AI
            if (getPrintState() != 0) {
                // 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰鍐€闁靛ě鍛帎婵?缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻锝夊箣閿濆憛鎾绘煕婵犲倹鍋ラ柡灞诲姂瀵噣宕掑顐㈩棜闁诲氦顫夊ú姗€鎮￠敓鐘茶摕婵炴垶顭囬弳鍡涙煃瑜滈崜鐔风暦閺囥垹绠涢柡澶嬪閻庮剟鏌ｆ惔顖滅У闁稿鐒︾粋宥咁煥閸喓鍘搁梺鎼炲労閻撳牆鈻撻弬妫电懓顭ㄩ崼銏㈡毇濠殿喖锕ュ钘夌暦椤愶箑绀嬫い鏇炴噺閽戝姊绘担鍛婂暈闁哄被鍔戦幆宀勫磼閻愬瓨娅滈梺缁樺姈缁佹挳寮ㄦ禒瀣€甸柨婵嗘噽娴犳盯鏌￠崨顐㈢伈婵﹨娅ｇ划娆撳箰鎼淬垺瀚崇紓鍌欑椤戝棛鏁敓鐘茬畾濞撴埃鍋撻柟顔界懇閹粌螣闁垮顏烘繝鐢靛仩閹活亞寰婇崸妤€绠犻柟鐐た閺佸绻濇繝鍌涘櫧缁炬儳銈搁幃妤呮晲鎼粹€茬盎濠电偞鎯岄崳锝夊蓟? Y, Z 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亜顒㈡い鎰矙閺屻劑鎮㈤崫鍕戙垻鐥幆褜鐓奸柡灞剧洴閸╁嫰宕橀浣诡潔缂傚倷鐒﹂崝鏍€冩繝鍥╁祦闁哄秲鍔嶇紞鍥煕閹炬鍟伴悡妤呮⒒娴ｄ警鐒炬い鎴濇楠炴劖銈ｉ崘銊х枀闂佸湱铏庨崰鏍矆鐎ｎ偁浜滈柟閭﹀枛閺嬫垿鏌ｈ箛鎾搭棦闁哄矉绲鹃幆鏃堝Χ鎼淬垻绉锋繝鐢靛仜瀵爼鏁冮姀銈呂ラ柛鎰ㄦ櫇缁♀偓闂佸憡鍓崨顖滄毎闂傚倷绀佺紞濠偽涚捄銊х焼濞撴埃鍋撻柟顔光偓鏂ユ婵☆垰绻愮紞濠囧极閹版澘鐐婇柛鎾茬婵ジ鏌ｉ悙瀵割暡鐎光偓缁嬫娼栨繛宸簼閸ゆ帡鏌曢崼婵囧櫤闁诲骸澧界槐鎾寸瑹閸パ勭亪闁诲孩绋堥弲鐘差嚕閼碱剚宕夊ù锝嗘礃濡啫鐣峰鈧崺锟犲磼濞戝崬鏁归梻鍌氬€烽懗鍫曞磻閵娾晛纾块悗闈涙憸閻挻銇勯弮鍥烽獜濞存粌缍婇弻鐔兼倻濡櫣浠奸梺鎸庣⊕缁挸顫忛搹鍦＜婵☆垰鎼～宀勬⒑鐎癸附婢樻俊濂告煃?
                // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓闁搞劌鍊块弻娑㈩敃閿濆棛顦ラ梺钘夊暟閸犳牠寮婚弴鐔虹闁绘劦鍓氶悵锕傛⒑鏉炴壆顦﹂悗姘嵆瀵鈽夊Ο閿嬵潔闂佸憡顨堥崑鐐烘倶瀹ュ應鏀介柣鎰级閸ｈ棄鈹戦悙鈺佷壕闂備礁鎼惌澶屽緤閸婄喓浜介梻浣稿悑缁佹挳寮插☉姘辩當闁跨喓濮甸埛?this.getDeltaMovement().y闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弮鍫熸殰闁稿鎸剧划顓炩槈濡娅ч梺娲诲幗閻熲晠寮婚悢鍛婄秶濡わ絽鍟宥夋⒑缁嬪灝顒㈡い銊ユ嚇濠€渚€姊洪幐搴ｇ畵婵炲眰鍊濆畷婵堚偓锝庡厴閸嬫挾鎲撮崟顒傤槰闂佺粯鎼换婵嗩嚕婵犳艾鐏抽柟棰佺閹垿姊洪崨濠傚闁告柨鐭傞垾鏍醇濠垫劖瀵岄梺闈涚墕濡瑧绮堟径濠庢富閻庢稒蓱閸婃劖顨ラ悙鑼ⅵ濠碘剝鎮傛俊鐑筋敊閽樺绱﹂梻鍌欒兌绾爼宕滃┑瀣ㄢ偓鍐川閺夋垹鍘遍梺鍦劋椤ㄥ棝鍩涢幋锔界厵闁兼祴鏅涙禒婊堟煃瑜滈崜姘跺垂閸喚鏆﹂柟閭﹀厴閺€浠嬫倵閿濆簼娴烽柟鑺ユ礋濮婃椽妫冨☉姘暫濡炪倧缂氶崡鎶藉箖閿熺姴唯闁冲搫鍊搁埀顒傛暬閺屻劌鈹戦崱娑扁偓妤€霉濠婂懎浠х紒杈ㄥ笧閳ь剨缍嗘禍婵嬪窗濡粯鍙忓┑鐘插閸斿鎮楅悽闈涘付闁宠閰ｉ獮瀣倷闊叀绻曞┑鐘垫暩婵兘寮幖浣哥；闁圭増婢樼壕濠氭煙閸撗呭笡闁抽攱鍨归惀顏堫敇閻愭潙娅ら梺缁樼箥娴滄繈濡甸崟顖毼╅柕澶樺灠娴兼劙姊烘导娆戞偧闁稿繑锕㈤悰顕€宕堕浣镐罕闂佸壊鍋呯换鈧紒銊ㄦ閳规垿鎮欓懜闈涙锭缂備焦褰冨锟犲Υ娴ｅ湱绡€闁搞儜鍛叄闁荤喐绮嶉弻銊╋綖韫囨洜纾兼俊顖濐嚙椤庢挾绱撴担鍦槈妞ゆ垵妫涚槐鐐哄醇閻旇櫣顔曢柣搴㈢⊕椤洭鎯岄崱娆戠＜妞ゆ梻鏅幊鍐煟閿濆懎妲婚柍瑙勫灴瀹曠厧顫濋鍨棜闂備焦瀵х换鍌涱殽閸涘﹥娅犻柟娈垮枤绾惧ジ鏌ｅΟ鎸庣彧妞ゃ儱鐗撻弻锛勪沪閸撗佲偓鎺懨归悪鍛暤鐎规洘绮忛ˇ顔戒繆閹绘帞澧㈢紒杈ㄦ尰閹峰懐绮欏▎鐐闂備胶顭堥鍐磹濠靛棭鍤曢悹鍥ф▕閸氬顭跨捄鐚存缂佸崬鐖煎娲川婵犲啰顦板┑鐐板尃閸パ咁槶闂備緡鍓欑粔鐢告偂?
                // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼槮闁搞劍绻冮妵鍕冀閵娧呯厐闂佹悶鍔嶇换鍕焵椤掆偓缁犲秹宕曢柆宥呯閻庯綆鍠楅崑鍕煕閳╁厾鑲╂崲閸℃ǜ浜滈柡宥冨妿閻﹪鏌ｉ妸锕€鐏撮柡灞诲€濋幃褔宕煎┑鎰疂闂備線娼уú銈団偓姘煎灣缁鈽夐姀鐘殿啋闁荤姾妗ㄧ拃锕傚汲椤愩倗纾介柛灞捐壘閳ь剟顥撻幏瀣蓟閵夈儳鏌ч梺缁橆焾椤曆呯不閺嶎偀鍋撻悷鏉款仾濠㈢懓顑夊鍛婃償閵娧冨絼闂佹悶鍎崝宥夊箚閸曨個褰掓偐鐏炲倸浠┑?0闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弮鍫熸殰闁稿鎸剧划顓炩槈濡娅ч梺娲诲幗閻熲晠寮婚悢鍛婄秶濡わ絽鍟宥夋⒑閹肩偛鈧牠宕濋弽顓炍﹂柛鏇ㄥ灠閸愨偓濡炪倖鍔﹀鈧繛宀婁邯濮婅櫣绮欏▎鎯у壃闂佸搫鎳愭繛鈧€殿喖顭烽弫鎰板川閸屾粌鏋涚€规洦鍋婂畷鐔碱敆閳ь剟鍩€椤掆偓闁帮絽顫忛搹鍦＜婵☆垵娅ｉ悷銊╂⒑閹稿孩澶勫ù婊庝簻椤曪絿鎷犲ù瀣潔濠碘槅鍨辩划宥呂涢崘銊ф殾婵せ鍋撳┑鈩冩倐婵″爼宕堕妸銉ь槹闂傚倸鍊搁崐椋庣矆娓氣偓楠炲鏁撻悩鑼唶闂佸綊妫跨粈浣告纯缂傚倷绀侀鍡涱敄濞嗗浚鐒介柡宥冨妿缁犲墽鈧懓澹婇崰鏇犺姳婵傚憡鍊甸柣銏ゆ涧瀛濆銈庡幖濞硷繝骞婂鍫熷剶妞ゅ繐鎳庨悘鈺呮煟閻旀繂鍟犻弨浠嬫煟濡櫣浠涢柡鍡忔櫅閳规垿顢氶崨顓炵睄閻庤娲橀崹鍧楃嵁濡懙搴敄鐠恒劎娉块梻鍌氼煬閸嬪嫬煤閿曞倸绠伴柣鎰靛墯濞呯娀鏌￠崶銉ョ仾闁绘挻鐟ч惀顏堫敇閻愭潙娅ょ紒缁㈠弮缁犳牠骞楅崼鏇熷€烽柛娆忓€圭粙鎺楁晬閹邦厽濯撮柛锔诲幑閸嬫﹢姊绘担渚劸缂佺粯鍔欓幆宀勫磼閻愯尪鎽曢梺鎸庣箓椤︿即宕戦崟顓犵＜閻庯綆浜炴禒銏°亜椤愩垻鐒告慨濠呮閳ь剙婀辨慨鐢杆夋径瀣ㄤ簻闁挎梻鍋撻弳顒勬煟濞戝崬鏋涙い顐ｇ矒閸┾偓妞ゆ帒瀚ㄩ埀顑跨閳藉顫滈崱妯哄厞婵＄偑鍊栭崝鎴﹀春閸曨倠娑橆煥閸啿鎷婚梺绋挎湰閼归箖鍩€椤掑嫷妫戠紒顔肩墛缁楃喖鍩€椤掑嫮宓侀柡宥庡弾閺佸啴鏌曢崼婵囧窛闁绘挸顑夊娲捶椤撯剝顎楅梺鍝ュУ閻楃姴鐣烽妷銊ｄ汗闁圭儤鎸鹃崢鎼佹倵楠炲灝鍔氬Δ鐘虫倐閻涱噣寮介銈囷紲?
                this.setDeltaMovement(0, 0, 0);

                // 婵犵數濮烽弫鍛婃叏閻戝鈧倿鎸婃竟鈺嬬秮瀹曘劑寮堕幋鐙呯幢闂備胶纭堕崜婵婃懌濠电偛鎳愭慨鍨┍婵犲洤围闁告侗鍘藉▓鏌ユ倵鐟欏嫭绀冮柣鎿勭節瀵鈽夊Ο鍏兼畷闂侀€炲苯澧寸€规洘鍔曢埥澶愬閻橀潧鈧偤姊洪崘鍙夋儓闁哥喍鍗抽弫宥咁煥閸愶絾鏂€闂佸疇妫勫Λ妤呮倶閻樼粯鐓熼柕濞у啫骞嬮悗娈垮枔閸旀垵鐣峰Ο濂藉湱鈧綆鍋呴弶鎼佹⒒娴ｈ櫣甯涙い顓炴川閸掓帡顢涘锝嗩潔閻熸粌閰ｆ俊鐢稿礋椤栨氨顓哄┑鐘绘涧濞村倸螞閿曞倹鈷戦悹鍥ｂ偓铏亾闂佽桨绀侀…宄邦嚕椤愶箑绀冩い鏃囧亹閿涙粌鈹戦悙鏉戠仸闁艰鍎抽锝夋惞椤愩倗鐦堥梺姹囧灲濞佳勭閿曞倹鐓曢柕濞垮劤閸╋綁鏌熼鎯у幋濠碘剝鎮傞弫鍌炲礈瑜嶆鍕節绾版ɑ顫婇柛銊ゅ嵆閹啴鎮滈挊澶岋紱闂佽宕橀崺鏍窗閸℃稒鐓曢柡鍥ュ妼婢ь噣鏌嶈閸撴岸宕濋弴銏＄畳婵犵數濮撮敃銈呂涘▎鎴炲厹濡わ絽鍟悡鐔兼煥濠靛棙鍣规俊鑼帛閵囧嫰顢曢敐鍥╃暭闂佸湱鎳撶€氼剛鍙呭銈呯箰鐎氼參寮抽鍫熲拻闁稿本鐟чˇ锕傛煙绾板崬浜滈悡銈夋煏婵炵偓娅呯痪鎯ь煼閺岋綁骞囬鍥跺妳闂佽桨绀侀崐鍧楀蓟閿濆绫嶉柛銉厛娴犫晝绱掗幆褍缍栫紒顔界懇瀵鈽夊顐ｅ媰闂佺顫夐崝鏇⑺夊┑瀣拺闁告繂瀚烽崕宥夋煕婵犲啰绠炵€殿喛顕ч埥澶愬閳ュ厖姹楅梻浣瑰劤濞存岸宕戦崱娴板洭顢橀悩鐢碉紳婵炶揪绲鹃崹婵嬪触椤愶附鐓曢悗锝冨妼閳ь剚娲熼幃楣冩倻閽樺）鈺呮煃閸濆嫸鏀婚柡鍜佸墮閳规垿鎮╃拠褍浼愰梺褰掓敱閸ㄧ懓危閹邦喒鍋撳☉娅偐鎹㈤崱娑欑厽闁规澘鍚€缁ㄥ鏌嶈閸撴岸鎮ч弴顫稏闊洦姊荤弧鈧┑顔斤供閸撴瑩宕戝澶嬪仭婵犲﹤瀚ˉ鍫燁殽閻愭彃鏆ｉ柡浣规崌閹晠鎳犻濠勫簥闂傚倷鑳剁划顖炲礉閺囥埄鏁嬫い鎾卞灩閸屻劌霉閻樺樊鍎愰柍閿嬪灴濮婂宕奸悢鎭掆偓鎺旂磼閻橀潧浠遍柡灞剧洴婵℃悂濡疯妤旈柣搴㈩問閸犳骞冮崒鐐靛祦閻庯綆鍠楅弲婊堟煟閿濆懓瀚版鐐茬墦濮婄粯绗熼埀顒€顭囪閳ワ箓顢橀悩鍏哥瑝闂佺鎻粻鎴炲閻樺磭绠剧€瑰壊鍠曠花濂告煟?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲梺姹囧€ら崰妤呭Φ閸曨垰绠涢柍杞拌兌閸旀挳姊洪幖鐐测偓鏍洪悢鐓庤摕婵炴垯鍩勯弫鍐煥濠靛棙顥滄い锔规櫊濮婄儤娼幍顕呮М濠碘槅鍋呴悷褔骞戦姀鐘闁靛繒濮烽娲⒑缂佹ê濮堟い鏃€鐗犲鎶芥晸閻樻枼鎷虹紓浣割儐椤戞瑩宕曢幇鐗堢厽婵°倓绶″▓婊冣攽閿涘嫭鏆€规洜鍠栭、娑橆潩鏉堚晜婢戦梻鍌欑閹诧繝骞愭搴ｇ焼濞撴埃鍋撶€规洖鎼悾婵嬪礋椤戣姤瀚兼繝娈垮枤閹虫挸煤閵堝棔绻嗛柟闂寸劍閻撴洟鏌￠崘锝呬壕闂佹悶鍔岄悘婵嬵敋?
                // (spawnX, spawnY, spawnZ 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犖ч柛灞剧煯婢规洖鈹戦鐭亜鐣烽鍕偍閻庣數纭堕崑鎾舵喆閸曨剛顦ョ紓鍌氱Т閿曨亜顕ｆ繝姘耿婵°倕锕ら幃鎴︽⒑閸涘﹣绶遍柛姗€绠栭崺鈧い鎺戭槸楠炴牠鏌嶇憴鍕伌闁诡喒鏅濋幏鐘侯槻濞村吋鍔欓弻锝嗘償閵忕姴姣堥梺闈╃秶缂嶄焦淇婇幘顔煎窛閻庢稒顭囬崣鍡涙煟鎼搭垳绁烽柛鏂款儑閼鸿鲸绻濆顓涙嫼闂佽崵鍠撴晶妤呭箚閸喍绻嗘い鎰剁秵濞堟洜绱掗崒姘毙ф鐐叉椤︻噣鏌￠埀顒佺鐎ｎ偆鍘藉┑顔筋殔濡绂嶅鍏?finalizeSpawn 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛濠傛健閺屻劑寮村鑸殿€栨繛瀛樼矊缂嶅﹪寮诲☉銏犵疀闂傚牊绋掗悘宥夋⒑缁嬪灝顒㈡い銊ユ嚇婵℃挳骞掗幋顓熷兊闂佹寧绻傞幊宥嗙珶閺囩喍绻嗛柣鎰典簻閳ь剚鍨垮畷鐟懊洪鍛画闂佸疇妗ㄩ懗鍫曞汲閿曞倹鐓曟い鎰剁稻婢跺嫰鏌℃担绋库偓鍧楀蓟濞戞矮娌柛鎾楀嫬娅楅梻浣规た閸嬪嫮鎹㈠Ο渚綎缂備焦蓱婵挳鏌涘☉姗堟敾闁稿孩鎸搁埞鎴︽倷閼碱剚鍕鹃梺鍛婃煥缁夊綊鐛崼銉ノ╅柍鍝勫€告禒娲⒑閸涘﹦鈽夐柨鏇樺€栫粋?
                if (this.spawnY != 0) { // 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙闁诡垳鍋ら獮鏍庨鈧俊濂告煟椤撶噥娈滄鐐寸墪鑿愭い鎺嗗亾濠德ゅ亹缁辨帡骞囬褎鐤侀梺鍝勭焿缁绘繂鐣烽崼鏇炵厸濞达絽娴勭徊鍧楀焵?spawnY 闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃秹锝炲┑瀣櫇闁稿矉濡囩粙蹇旂節閵忥絽鐓愰柛鏃€鐗犲畷鎴﹀Χ婢跺鍘搁梺鎼炲劗閺呮稑鐨梻浣虹帛鐢帡鏁冮妷鈺佄﹂柛鏇ㄥ枤閻も偓闂佽宕樺▔娑㈠煕婵犲嫮纾介柛灞炬皑鏍￠梺缁橆殘婵炩偓鐎殿喖顭锋俊鎼佸煛娴ｈ櫣娼夐梻浣侯焾閺堫剟鎯岄鐣岀彾闁哄洢鍨洪悡鐔肩叓閸ャ劍灏电紒鐘卞嵆濮婅櫣鏁鍓滃Δ鐘靛仜閸燁偉鐏冮梺鍛婁緱閸犳鈻嶅鍫熲拺闁告挻褰冩禍婵堢磼鐠囨彃顏€规洏鍨介、鏇㈡晜閻ｅ苯骞?
                    // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈢粯淇婇悙顏勨偓鏍偋濡ゅ啰鐭欓柟鐐湽閳ь剙鎳樺畷锝嗗緞閸粎鐩庨梻濠庡亜濞诧箓骞愰悙顒佹珷闁哄洨濮风壕?Y 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓氶悞鑲┾偓骞垮劚閹虫劙鏁嶅☉銏♀拺缂備焦锕╅悞鐐亜閺囧棗鎳愭稉宥夋煕椤垵浜栧ù婊勭矒閻擃偊宕堕妸锕€闉嶅銈冨劤閸嬬偤濡甸崟顖ｆ晝闁挎繂妫涢ˇ銊х磽娴ｈ櫣甯涚紒璇茬墕铻為柛鎰╁妷濡插牓鏌涘Δ鍐ㄤ粶濠㈢懓鐗忕槐鎾诲磼濞嗘帩鍞归梺绋款儐閹瑰洭寮诲☉姘勃缂備降鍨瑰▓褔鎮峰鍛暭閻㈩垱顨婂鏌ュ蓟閵夛妇鍘遍梺闈涱槶閸ㄥ搫鈻嶉崱娑欑厵闁告瑥顧€閼版寧鎱ㄦ繝鍐┿仢鐎规洦鍋婃俊鐑藉Ψ閿旈敮鍋撴繝姘拺闁荤喐婢橀弳杈╃磼缂佹﹫鑰块柣娑卞櫍瀹曞ジ濡烽妷搴樻櫊閺屾洘寰勬繝鍐╁闯闂佸摜濮甸幐鎯ｉ幇鏉跨闁瑰啿纾崰鏍箠閺嶎厼鐓橀柣鎰靛墰閳ь剙銈稿濠氬磼濮橆兘鍋撻幖浣哥９鐎瑰嫭鍣磋ぐ鎺戠倞妞ゅ繐绉靛В搴ㄦ⒒閸屾瑧顦﹂柟纰卞亰楠炲﹨绠涘☉娆忓壆濡炪倖鐗滈崑鎴﹀焵椤戣法顦︽い顐ｇ箘閹瑰嫭鎷呴弴妯哄闁哄苯绉瑰畷顐﹀礋閼稿灚鏆伴梻浣告惈閹峰绂嶉鍕垫綎婵炲樊浜濋悞濠氭煟閹邦垰钄奸悗姘緲椤儻顦叉い鏇ㄥ弮閸┾偓妞ゆ帒鍠氬鎰箾閸欏澧电€规洦鍨抽幑鍕Ω閵夈儳鏌ф繝纰夌磿閸嬫垿宕愰弴鐘冲床闁归偊鍠掗崑鎾愁潩閻撳孩鐝濆銈冨灪閻熲晛鐣烽崼鏇ㄦ晢濞达絽寮剁€氬ジ姊婚崒姘偓鎼佹偋婵犲嫮鐭欓柟鎯х摠濞呯娀鏌￠崶銉ョ仾闁绘挻鐟╅弻娑㈠箛椤掆偓缁狙囨煙閻у摜鎮肩紒杈ㄥ浮椤㈡瑧鎲撮崟顒傚絾闂備線娼ч悧鐐电礊娴ｅ摜鏆︽慨妞诲亾闁糕晪绻濆畷姗€濡搁妷锕佺发濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌熼婊冾暭闁瑰啿鏈换婵嬫偨闂堟刀娑㈡煕鐎ｎ偅灏棁澶愭煟閹捐櫕鎹ｉ柟鐣屽█閺岋綁骞樼€涙顦伴梺鍝勬湰濞叉鎹㈠┑濠勭杸闁哄洨鍋涢悡鍌氣攽閻樻剚鍟忛柛鐘崇墵瀹曟劙宕稿Δ鈧拑鐔兼煟閺傚灝鎮戦柟顖滃仦閵囧嫰骞囬崜浣稿煂缂佸墽鍋撴繛濠囧箖濡ゅ啯鍠嗛柛鏇ㄥ墰閿涙﹢姊洪崨濠冣拹闁搞劌娼℃俊瀛樻媴閸撳弶寤洪梺閫炲苯澧存鐐插暙閳诲酣骞樼捄鍝勭导婵＄偑鍊栭幐鐐叏閻戝壙鍥ㄥ鐎涙ǚ鎷?
                    this.setPos(this.getX(), this.spawnY, this.getZ());
                }
                return;
            }

            this.updateOverheadStatus();

        } // 闂傚倸鍊搁崐鎼佸磹閻戣姤鍤勯柛鎾茬閸ㄦ繃銇勯弽顐粶缂佲偓閸曨厽鍠愰柣妤€鐗嗙粭鎺旂磼閳ь剟宕奸悢铏诡啎闂佺硶鍓濊摫閻忓浚鍘剧槐鎺楁偑閳ь剟宕归崼鏇炶摕闁绘棁銆€閸嬫捇鎮藉▓璺ㄥ姼闁哥喎鎽滅槐?缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻锝夊箣閿濆憛鎾绘煕婵犲倹鍋ラ柡灞诲姂瀵挳鎮欏ù瀣壕闁告縿鍎虫稉宥吤归悡搴ｆ憼闁稿缍侀弻娑㈠Ψ閹存繂顏ら柡瀣懇濮?if (!isClientSide)
    } // 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰鏍箒闂佺绻愰崥瀣礊閹达附鐓?缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻锝夊箣閿濆憛鎾绘煕婵犲倹鍋ラ柡灞诲姂瀵挳鎮欏ù瀣壕闁告縿鍎虫稉宥吤归悡搴ｆ憼闁稿缍侀弻娑㈠Ψ閹存繂顏ら柡瀣懇濮?tick() 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洟鎮烽幊濠傜秺閹晛顔忛鐓庡Η缂傚倸鍊哥粔鐢告偋閺団懇鈧妇鎹勯妸锕€纾梺缁樺灦钃遍柟鐑戒憾濮?


    private void updateOverheadStatus() {
        String status = "";

        // 闂?1. 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柤鑹板煐閹蹭即姊绘担鐟邦嚋缂佽鍊胯棟妞ゆ牗绮庨惌鍡楊熆鐠哄搫顦柛瀣崌閻涱噣宕归鐓庮潛婵＄偑鍊х€靛矂宕归崼鏇炵畺闁绘劕鎼崹鍌涖亜閹邦喖小缂併劌顭峰铏规兜閸涱喖娑х紓浣瑰絻婢ц棄鈽夐悽鍛婂殝闁绘劙鈧稓鐩庨梻浣瑰濡線宕戦幇鐗堝仼闁汇垹鎲￠悡娑氣偓鍏夊亾闁逞屽墴瀹曠増鎯旈妸锕€浠奸梺缁樺灱濡嫰鎮欐繝鍕枑濠㈣埖鍔曢崙鐘绘煕濞戞鎽犻柛濠勬暬閹嘲鈻庤箛鎿冧痪缂佸墽鍋撻幃鍌炲蓟濞戞瑦鍎熼柕濠忛檮闁款參姊烘导娆戞偧闁稿繑锕㈤妴渚€寮撮姀鈩冩珖闂侀€炲苯澧柡渚囧櫍濮婄粯绗熼埀顒€顭囪钘濇い鎾卞灩绾惧綊鏌￠崶鈺佇涢柛瀣尰閹峰懘宕橀妸褎顕楃紓鍌欐祰妞存悂骞戦崶褏鏆﹂柟鐑樺灍閺嬪酣鏌熼悜妯虹仴閻㈩垼鍨伴埞鎴︽偐閹颁礁鏅遍梺鍝ュУ瀹€绋款嚕椤愶絿绡€婵﹩鍎甸妷鈺傜厱闁逛即娼ч弸娑欘殽閻愵亜鐏紒缁樼洴瀹曞崬螣閸濆嫷娼撻梻?(闂?0.5闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈠姊绘担鐟邦嚋婵﹤顭峰畷鎴﹀箻閸撲椒绗夐梺鍦劋濮婅崵澹曟禒瀣厱閻忕偛澧介幊鍛存煕閺傝法校闁逛究鍔嶇换婵嬪磼濠婂憛銊ノ旈悩闈涗沪闁告梹鐟╅悰顔芥償閵婏箑鐧勬繝銏ｆ硾椤戝洭鍩€?
        // 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫鍐煥閺囨浜鹃梺姹囧€楅崑鎾舵崲濠靛洨绡€闁稿本绮岄·鈧梻浣侯焾椤戞垹鎹㈠┑瀣摕鐎广儱顦导鐘绘煕閺囥劌澧繛鍜冪秮濮婂宕掑顑跨敖闂佹悶鍔岄悥鐓庮嚕婵犳碍鏅插璺猴功椤撴椽姊洪幐搴ｇ畵闁瑰弶鐩獮妯肩磼濡厧骞堥梺纭呭閹活亞妲愰弴鐔告珡闂傚倷绀侀幖顐﹀嫉椤掑嫭鍎庢い鏍ㄥ嚬閸ゆ洟鏌熺紒銏犳灈閹喖姊洪棃娑崇础闁稿本绮嶇涵锕傛⒒閸屾艾鈧兘鎳楅崼鏇椻偓锕傚醇閵夘喗鏅為梺绯曞墲缁嬫垹绮婚弻銉︾厱闁靛鍨甸懟顖氣枔閵娾晜鈷戦柣鐔告緲濡插鏌ｉ鈧妶鎼佸箖閸ф鐒垫い鎺戝閳锋垿鏌涘┑鍡楊仾鐎瑰憡绻堥弻娑氣偓锝庡墮閺嬫稒銇勯姀鈩冾梿闁靛洦鍔欓獮鎺楀箻椤栨稑顏烘繝鐢靛仩閹活亞寰婃禒瀣疅闁跨喓濮寸粻姘舵煕椤愮姴鍔滈柛濠傜仛閹便劌螣閸濆嫯鍩為梺鍛娒顓㈠焵椤掑喚娼愭繛鍙夌墱缁辩偞绻濋崶褏鐣洪梺鍛婃寙閸屾稑濯扮紓鍌氬€烽梽宥夊垂閾忓湱绀婃俊銈傚亾闁宠鍨块幃娆忣啅椤斿吋顔嶉梻浣告啞椤棝宕堕妸銉ゆ闂備線娼ц墝闁哄懏绋撴竟鏇熺節濮橆厾鍘繝鐢靛仧閸嬫挸鈻嶉崱娑欑厽闁规儳纾粻浼存煃鐟欏嫬鐏撮柟顔规櫊閹崇娀顢楅崒銈呮櫏闂傚倷绀侀幉锟犳嚌妤ｅ啫纾归柛褎顨呴拑鐔哥箾閹寸偛鐒归柛瀣崌閺佹劖鎯旈垾鑼嚬闂佽绻愮换鎺楀极閸濄儲顫曢柟鐑樻尰缂嶅洭鏌曟繛鍨姢闁荤喆鍔戦弻褎瀵煎▎鎴犐戠紓浣虹帛閻╊垶骞婇悩娲绘晢闁稿本姘ㄩ濂告煟閻愬娈伴柛銉ｅ妷閹峰姊虹粙鎸庢拱闁煎綊绠栭崺鈧い鎺嶇劍閸婃劗鈧娲橀崝娆撶嵁閺嶃劍濯撮柛婵勫劵缁鳖噣鏌ｉ悢鍝ョ煂濠⒀勵殘閺侇噣骞掗弮鍌欑瑝婵炲鍘ч悺銊╂偂閺囥垺鐓欓梺顓ㄧ畱楠炴﹢鏌曢崼鐔稿唉闁哄矉绱曢埀顒婄秵娴滅偞鏅ユ俊銈囧Х閸嬬偤鎮ч弴鈥崇倒婵＄偑鍊栧濠氬磻閹炬枼鏀介柍銉ㄥ皺閻瑩鏌?10闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弮鍫熸殰闁稿鎸剧划顓炩槈濡娅ч梺娲诲幗閻熲晠寮婚悢鍛婄秶濡わ絽鍟宥夋⒑缁嬪灝顒㈤柡灞诲姂閸╃偤骞嬮敃鈧壕鍏肩節婵犲倹鎹ｉ柛鏂挎憸缁辨挻鎷呴幓鎺嶅濠电姰鍨煎▔娑㈠嫉椤掑嫬绐楅柟鎵閻撴盯鏌涚仦鍓х畺缁绢厼鐖奸弻锟犲幢椤撶姷鏆ら梺鍝勬湰濞叉ê顕ラ崟顐熸闁靛繆妲呴埀顒€绉瑰铏圭矙閹稿孩宕抽梺鍝ュУ閻楃姴顕ｇ拠宸悑濠㈣泛顑呴惂鍕節閵忥絾纭炬い鎴炲姇铻為柣鎰ゴ閺€?4 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈠姊绘担鐟邦嚋婵炲弶鐗犲畷鎰亹閹烘垹锛涢柣搴秵閸犳鎮″☉銏＄厱闁规壋鏅涙俊濂告煃瑜滈崜婵嗙暦閻㈤潧鍨濋柛顐ゅ枔缁♀偓闂佹悶鍎崝搴ㄥ储閻㈠憡鐓涘璺猴功婢ф洖顭胯缁瑩骞冩ィ鍐╃劶鐎广儱妫涢崢鎼佹煟鎼搭垳宀涢柡鍛箘缁綁寮崼鐔哄幍濡炪倖妫佸畷鐢告儗濞嗘劑浜滈柕蹇ョ磿濞叉挳鏌℃担鐟板鐎规洏鍔戦、娆撳矗閵夈儺妫滅紓鍌氬€搁崐鎼佸磹妞嬪孩濯奸柡灞诲劚绾惧鏌熼悙顒€澧柣鏂挎閹綊宕崟顒佸創濡炪倧瀵岄崜鐔煎蓟濞戞埃鍋撻敐搴′簼鐎规洖鐭傞弻鐔碱敊閼姐倗鐓撳┑鈽嗗亜閸燁偊鍩ユ径瀣秶闁靛濡囧Σ妯荤節绾板纾块柛瀣灴瀹曟劙骞嬮敃鈧粈澶屸偓鍏夊亾闁告洦鍋嗛悿鍥р攽閳藉棗鐏ユ繛鍜冪秮瀵?0, 1, 2, 3 闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃秹婀侀梺缁樺灱濡嫰寮告担绯曟斀闁绘ê鐤囨竟妯肩棯閹规劦鍤欓柍瑙勫灴閹晠骞撻幒鎾搭啀婵＄偑鍊愰弲婊堟偂閿熺姴钃熼柨婵嗩槸缁犳稒銇勯弽銊ょ繁濞寸姭鏅犻幃?
        int step = (this.tickCount / 10) % 4;
        String dots = switch (step) {
            case 0 -> ".";
            case 1 -> "..";
            case 2 -> "...";
            default -> ""; // 闂?4 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缂佺姷濞€閺岀喖骞戦幇闈涙闁瑰吋娼欓敃顏堝蓟閵堝洤鏋堥柛妤冨仜椤偊姊哄ú璇插箺闁圭懓娲璇测槈閵忊晜鏅濋梺鎸庣箓濡盯藝閵夈儮鏀芥い鏃€顑欏鎰版煟閹垮嫮绡€鐎殿喛顕ч濂稿醇椤愶綆鈧洭姊绘担鍛婂暈闁规瓕宕电划娆撳箻濠㈠嫸缍侀獮鍥级鐠侯煈鍞洪梻浣烘嚀椤曨厽鎱ㄩ棃娑掓灁闁哄洢鍨洪埛鎴︽⒑椤愩倕浠滈柤娲诲灡閺呭爼寮跺Λ鐢垫嚀椤劑宕熼鈧埀顒佸姇閳规垿鍩勯崘顏呮啓濡炪倧绠掑▍鏇㈠Φ閸曨垼鏁冮柨婵嗘椤︺劎绱撴担铏瑰笡缂佽鐗嗚灋闁告劑鍔夊Σ鍫熺箾閸℃绠抽柣娑掓櫆娣囧﹪鎮欓鍕ㄥ亾閹版澘鐤鹃柣鎰悁閻掑﹥绻涢崱妯诲碍缂佺姷鍠愰幈銊モ攽閸℃瑧浼囬梺姹囧€愰崑鎾寸節閻㈤潧浠﹂柛銊﹀劶閹筋偊姊虹拠鎻掔槰闁告挾鍠庨～蹇撁洪鍛画闂佸搫顦花閬嶅箰閸愵亞纾藉〒姘搐濞呮﹢鏌涢妸銉у煟鐎规洖鎼埥澶愬閻樻鍞洪梻浣筋潐閸庡疇銇愭径宀冨С濠电姵纰嶉ˉ濠冦亜閹扳晛鐏璺哄閺岀喓绮欏▎鍓у悑闁芥鍠愮换婵囩節閸屾粌顤€闂佺粯鎸诲ú鐔煎蓟閻旂厧绠氱憸宥夋嚋閻熸壋鏀芥い鏃傚帶閳ь剙娼″?
        };
        int dotsCount = dots.length();

        // ==========================================
        // 闂傚倸鍊搁崐鎼佸磹閻戣姤鍤勯柛鎾茬閸ㄦ繃銇勯弽顐粶缂佲偓閸曨厽鍠愰柣妤€鐗嗙粭鎺旂磼閳ь剟宕奸悢铏诡啎闂佺硶鍓濋〃鍫㈡嫻閳哄啯鍠愰柣妤€鐗嗙粭鎺旂磼閳ь剛鈧綆鍋佹禍婊堟煙閹规劖纭鹃崯鎼佹⒑?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼槮闁搞劍绻冮妵鍕冀椤愵澀姹楅梺閫炲苯澧剧紒鐘虫尭閻ｉ攱绺界粙璇俱劑鏌曟径娑㈡鐞氾綁姊婚崒娆戭槮闁圭⒈鍋嗙划娆愮瑹閳ь剙鐣烽姀锛勯檮闁告稑锕ら埀顒€娼￠弻娑⑩€﹂幋婵呯按婵炲瓨绮嶇划鎾诲蓟閻斿憡缍囬柛鎾楀惙鎴犵磼缂併垹寮ㄩ柛鈺傜墵婵＄敻宕熼娑欐珕闂佸吋绁撮弲婵嬪汲閵堝鈷戦柛婵嗗濠€浼存煟閳哄﹤鐏″ǎ鍥э躬楠炴牗鎷呴懖婢洦鐓曢柕澶堝灪濞呭洭鏌涘鍡楃仸闁哄矉绲鹃幆鏃堝閳轰焦娅涢梻渚€娼荤紞鍡涘闯閿濆懐鏆︽繝濠傜墛閸嬪嫮绱掑Δ鍕┾偓鈧柛瀣尰閹峰懘宕滈崣澶婄紦闂備線鈧偛鑻晶瀵糕偓瑙勬礀閹碱偉鐏冮梺鍛婁緱閸橀箖宕㈤崨濠勭閺夊牆澧介崚浼存煕閵忥紕鍙€閽樼喐鎱ㄥΟ鍨厫闁抽攱甯掗湁闁挎繂鎳忛崯鐐烘煙椤栨氨澧﹂柟顔筋殔椤繈鎮℃惔鈽嗘骄闂備胶鎳撶粻宥夊垂娴犲宓侀柟鐑橆殔缁秹鏌嶈閸撶喎顕?闂傚倸鍊搁崐鎼佸磹閻戣姤鍤勯柛鎾茬閸ㄦ繃銇勯弽顐粶缂佲偓閸曨厽鍠愰柣妤€鐗嗙粭鎺旂磼閳ь剟宕奸悢铏诡啎闂佺硶鍓濋〃鍫㈡嫻閳哄啯鍠愰柣妤€鐗嗙粭鎺旂磼閳ь剛鈧綆鍋佹禍婊堟煙閹规劖纭鹃崯鎼佹⒑?
        // ==========================================

        // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佲枙闁绘帟濮ょ换娑㈠幢濡纰嶉柣鐔哥懕缁犳捇骞冨Δ鍛櫜閹肩补鍓濋悘宥夋⒑閸濆嫭濯煎ù婊庝簻椤繒绱掑Ο璇差€撻梺鍛婄☉閿曘倝寮抽崼銉︾參闁告劦鍠曢幉楣冩煛瀹€瀣М闁糕斁鍓濈换婵嬪磼濠娾偓濡楁捇鏌?2: 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼槮闁搞劍绻冮妵鍕冀椤愵澀娌梺绋款儜缁绘繈寮婚弴鐔风窞闁糕剝蓱閻濇梻绱掗悙顒€鍔ょ紓宥咃躬瀵鏁愭径瀣簻闂佺绻楅崑鎰版偟閹扮増鈷戦柛锔诲幖閸斿鏌涢埡浣哄妞ゎ厼娲崺锟犲川椤旈棿鍖栧┑掳鍊ч梽鍕偓绗涘浂鏁傞柣妯肩帛閻撱儲绻涢幋鐐垫噮闁瑰啿娲﹂幈銊︾節閸愨斂浠㈤悗瑙勬礈閸忔﹢銆佸鈧幃娆撳箵閹烘繄鈧崬鈹戦悩鍨毄闁稿濞€椤㈡艾顭ㄩ崨顖欑瑝闂佽鍎崇壕顓㈠汲閿曞倹鐓忓璺烘濞呭懘鏌ｉ幒鎴犱粵闁靛洤瀚伴獮鎺楀箣濠垫劒鐥梻?
        if (this.entityData.get(IS_BRUTAL)) {
            int sec = this.brutalityActiveTimer / 20;
            status = "status.brutal:" + sec;
        }
        // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佲枙闁绘帟濮ょ换娑㈠幢濡纰嶉柣鐔哥懕缁犳捇骞冨Δ鍛櫜閹肩补鍓濋悘宥夋⒑閸濆嫭濯煎ù婊庝簻椤繒绱掑Ο璇差€撻梺鍛婄☉閿曘倝寮抽崼銉︾參闁告劦鍠曢幉楣冩煛瀹€瀣М闁糕斁鍓濈换婵嬪磼濠娾偓濡楁捇鏌?3: 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缂佺姷濞€閺岀喖宕滆鐢盯鏌涙繝鍛厫闁逛究鍔岃灒闁圭娴烽妴鎰磽娴ｅ搫校濠㈢懓妫涘Σ鎰板箳閺傚搫浜鹃柨婵嗛楠炴鐥鐐靛煟闁?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弴鐐测偓鍝ョ不閺嶎厽鐓曟い鎰剁稻缁€鈧紒鐐劤濞硷繝寮婚悢鐓庣畾闁绘鐗滃Λ鍕磼閻愵剙鍔ゆい顓犲厴瀵鏁愭径濠勭杸濡炪倖甯婇悞锕傚磿閹剧粯鈷戦柛婵嗗閸庡酣鏌ら崘鑼煟妤犵偛顦甸獮鏍ㄦ媴閻熼缃曢梻浣稿閸嬪懐鎹㈤崟顖涘仭闁哄被鍎查埛?
        else if (getPrintState() != 0) {
            int percent = (int)(getPrintProgress() * 100);
            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墴閹潡顢氶埀顒勫蓟閺囩喓绠鹃柣鎰靛墯閻濇棃姊洪幖鐐插闁稿﹥鎮傞崺鐐哄箣閿旇棄浜归柣搴℃贡婵挳藟濠靛牏纾藉ù锝嗗絻娴滅偓绻濋姀锝嗙【闁哄牜鍓熷畷浼村箛閺夎法顔愰柡澶婄墕婢т粙骞冩總鍛婄厽妞ゆ挾鍠撻幊鍐煃鐟欏嫬鐏撮柟顔规櫊瀹曪絾寰勬繝搴⑿熼梻鍌欒兌椤牓顢栭崨顖楀亾濮橆偄宓嗙€殿喛顕ч埥澶娢熼柨瀣垫綌婵犵妲呴崹鎵崲閸℃稑鐤鹃柣妯款嚙閺嬩線鏌涢幇闈涙灈缁炬儳鍚嬮幈銊ヮ潨閳ь剚绂嶉崼鏇熷仒闁瑰墽绮埛鎺懨归敐鍥剁劸闁哄棝浜堕弻鐔哄枈閸楃偘鍠婇悗瑙勬礃閸旀牜鎹㈠┑鍡╂僵闁挎繂鍊告禍楣冩煛瀹ュ骸骞栫紒鈧崒婊呯＜婵°倕瀚妴鍐磼閵娿儺鐓兼慨濠冩そ濡啫鈽夊杈╂毎闂備線鈧偛鑻晶顔剧棯缂併垹骞楃紒鍌涘浮瀹曨偊濡疯閿涙繃绻涙潏鍓у埌濠㈢懓锕畷鏇＄疀閺傝绨婚梺鎸庢⒒閸嬫捇寮抽鍕厪闁糕剝娲滈ˇ锔姐亜椤愶絿鐭掗柛鈹惧亾濡炪倖甯婂鎺旀崲閸℃ɑ鍙忔繝闈涙閻掔偓淇婇崣澶婂姢妞ゎ亜鍟存俊鎯扮疀閹捐埖袙闂備線娼荤紞鍥╁緤娴犲缍栭煫鍥ㄦ媼濞差亶鏁傞柛娑卞幒閻㈠姊绘担绛嬫綈妞ゆ梹鐗犲畷鏉课旈崨顓犵枀婵犻潧鍊搁幉锟犲煕閹达附鐓欓柤娴嬫櫅娴犳粌鈹戦垾鐐藉仮闁哄本鐩幃銏ゆ煥鐎ｎ亙娣梻浣哄仺閸庤崵绮婚幘缈犵箚闁归棿绀侀悡娑樏归敐鍕劅闁告艾鎳樺缁樻媴閾忕懓绗￠梺鍛婃闂勫嫮绮嬪鍛瀻闁硅揪绲藉皬濠电姷鏁告慨鐢靛枈瀹ュ鐓曢柟瀵稿Х绾捐棄霉閿濆拋娼犳い蹇撶墛閸婂爼鏌ㄩ弴鐐测偓褰掓偂閵夛附鍙忔慨妤€妫楅獮鎴澝瑰鍕煉闁哄本娲熷畷鐓庘攽閸♀晙绱戞俊鐐€х拋锝囩不閹捐钃熺€广儱顦扮€电姴顭块懜鐬垿鍩㈤崼銉﹀€垫繛鍫濈仢濞呮﹢鏌涢敐蹇曞埌闁伙絿鍏橀獮鎺楀箣椤撶喎鍏婃俊鐐€栭幐鐐叏椤撱垹纾婚柟鎯у绾惧吋淇婇婵嗕汗闁伙箑鐗嗛埞鎴︽倷閼碱剙顣洪梺璇茬箲缁诲牆顕ｉ幖浣肝у璺侯儑閸橀亶鏌ｆ惔顖滅У闁告挻鐟︾粋鎺曨槾缂佽鲸甯￠、娆撴偩鐏炴儳娅楅柣搴＄仛濠㈡鈧凹鍣ｉ崺鈧い鎺戯功缁夌敻鏌涢幘瀵告创闁诡垯绶氬畷濂稿Ψ閿旇瀚奸梻浣告啞缁嬫垿鏁冮妷锕€绶為柛鏇ㄥ灡閻撴洟鎮楅敐搴濈盎闁逞屽墮閻忔繈鎮鹃悜鑺ュ亹閻犲洦褰冮崬銊ヮ渻閵堝棙灏甸柛鐔锋健楠炲繐煤椤忓應鎷洪梺闈╁瘜閸欏酣鎮為悙顒傜閻庣數顭堥崢鎾煕閳瑰灝鍔滅€垫澘瀚伴獮鍥敇閻樻彃绠哄┑锛勫亼閸婃牜鏁幒妤€纾归柛婵勫劜閺嗘粓鏌涢锝嗙闁绘挶鍎甸弻锟犲炊椤浜幃姗€鎳犻钘変壕閻熸瑥瀚壕鎼佹煕閺傚潡鍙勯柛鈹惧亾濡炪倖甯婇懗鍫曞煀閺囥垺鐓ユ慨妯垮煐閻撴洟鏌熼幑鎰厫闁哄棭鍓氶幈銊︾節閸愨斂浠㈤梺鍝勮嫰閹虫﹢骞冨▎鎾村殤閻犺桨璀︽导鍐ㄢ攽閻橆偅濯伴柛鎰劤濞堝爼姊洪柅鐐茶嫰婢ь垱銇勯弮鈧悧鐘茬暦娴兼潙鍐€妞ゆ挆鍕珨婵＄偑鍊栭幐楣冨窗閹剧粯鍋熼柛顐ｆ礃閻撴盯鏌涢妷銏℃珔鐞氥儵姊虹粙娆惧剱闁圭懓娲顐﹀箛椤撶喎鍔呭┑鐘绘涧閻楀﹪寮查悡搴樻斀闁绘劘灏欓幗鐘电磼椤旇偐澧︾€规洩绻濆畷妯侯啅椤旂晫绋佹繝鐢靛仜濡﹥绂嶅鍕嚤闁绘绮悡鏇㈡煛閸ャ儱濡兼鐐寸墬閵囧嫰鏁愰崼鐕佷哗缂備浇椴搁幐濠氬箯閸涙潙绀堥柟缁樺笒婢瑰牓姊虹拠鎻掝劉闁告垵缍婂畷浼村冀瑜嶇粊?
            status = (getPrintState() == 3)
                    ? "status.recycle:" + percent + ":" + dotsCount
                    : "status.build:" + percent + ":" + dotsCount;
        }
        // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佲枙闁绘帟濮ょ换娑㈠幢濡纰嶉柣鐔哥懕缁犳捇骞冨Δ鍛櫜閹肩补鍓濋悘宥夋⒑閸濆嫭濯煎ù婊庝簻椤繒绱掑Ο璇差€撻梺鍛婄☉閿曘倝寮抽崼銉︾參闁告劦鍠曢幉楣冩煛瀹€瀣М闁糕斁鍓濈换婵嬪磼濠娾偓濡楁捇鏌?4: 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙闁稿被鍔庨幉鎼佸棘鐠恒劍娈惧銈嗙墱閸嬫盯鏌ㄩ妶鍡曠箚闁靛牆瀚ˇ锔界箾閸剛鍒版い顏勫暣婵″爼宕卞▎蹇ｆ椒濠电姰鍨奸～澶娒洪悢椋庢殾闁硅揪绠戠粻濠氭偣閸ャ劌绲婚柣搴幖椤啴濡堕崱妤€顫呴梺绋款儐閹稿濡甸崟顔剧杸闁规崘娉涢埛鍫ユ⒑鏉炴壆顦﹂柨鏇ㄤ邯閹繝顢曢敃鈧悙濠囨煏婵炑€鍋撴俊鎻掔墦濮婂搫煤鐠囨彃绠哄銈冨妼閹虫﹢鍨鹃敂鐐磯闁靛绠戠壕顖炴⒑缂佹顣叉繛鍏肩懄鐎靛ジ骞囬悧鍫濅哗?(闂傚倸鍊搁崐宄懊归崶褏鏆﹂柣銏㈩焾缁愭鏌熼柇锕€鏋涢柛銊︾箞楠炴牕菐椤掆偓閻忣亝绻涢崨顖毿ｅǎ鍥э躬婵″爼宕ㄩ鍏碱仩缂傚倷鑳舵慨鎶藉础閹惰棄钃熼柣鏂垮悑閳锋帡鎮楅崹顐ゆ憙缂佺姷鍋ゅ娲箹閻愭彃濮堕梺鍛婃尰閻熲晠骞冮垾鏂ユ闁靛骏绱曢崢閬嶆煟韫囨洖浠滃褌绮欓幆宀勫Χ閸℃瑧顔曢梺鍛婄懃椤︿即宕愰幇鐗堢厸鐎光偓閳ь剟宕伴弽褏鏆︽俊銈呮噺閸ゅ啴鏌嶉崫鍕偓褰掝敊閸愵喗鈷掑ù锝堫潐閸嬬娀鏌涢弬璺ㄧ伇缂佽京鍋炵换婵嬪炊瑜忛悾娲⒒娴ｅ摜浠㈡い鎴濇瀹曟洟鎮㈤崗鑲╁帾婵犵數濮寸换鎰般€呴鍕厱婵せ鍋撶紒鐘崇墪椤繐煤椤忓嫮顦ч梻鍌氬€婚ˉ鎰板春閸涘瓨鈷戠紒瀣閸炲霉濠婂骸澧伴柛鎺撳浮椤㈡﹢鎮滈崱妯哄厞闂備礁鍚嬮幃鍌氼焽瑜嶉埢鎾斥枎閹剧补鎷洪梺鍛婂姇瀵爼骞嗛崼銉︾厱闁绘柨鎼埢鍫⑩偓瑙勬礃閸ㄥ潡鐛鈧顒勫Ψ閿斿彞绨撮梻鍌欑婢瑰﹪鎮￠崼銉ョ獥婵°倕鎳忛崐鍫曟煕椤愮姴鐏痪鎹愭闇夐柨婵嗙墛椤忕娀鎮介娑氭创闁哄本鐩俊姝岊槼闁哄棭鍓熼弻?
        else if (this.isCommandScavenging() && isInventoryFull()) {
            status = "status.inventory_full:" + this.entityData.get(UNIT_ID);
        }
        // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佲枙闁绘帟濮ょ换娑㈠幢濡纰嶉柣鐔哥懕缁犳捇骞冨Δ鍛櫜閹肩补鍓濋悘宥夋⒑閸濆嫭濯煎ù婊庝簻椤繒绱掑Ο璇差€撻梺鍛婄☉閿曘倝寮抽崼銉︾參闁告劦鍠曢幉楣冩煛瀹€瀣М闁糕斁鍓濈换婵嬪磼濠娾偓濡楁捇鏌?4.5: 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋敐鍛闁诲孩顔栭崰姘跺极婵犳哎鈧礁螖閸涱厾鍔﹀銈嗗笒鐎氀囧焵椤掍焦顥堢€规洘锕㈤、娆撴寠婢跺本顎嶆繝鐢靛О閸ㄥ綊宕㈠鍫濈柧婵犲﹤鐗婇崕搴亜閺嶎偄浠х€规挷绶氶弻鐔兼焽閿曗偓楠炴鏌涙惔锝呮灈闁哄被鍔岄埞鎴﹀幢濡炶浜剧憸鐗堝笚閸婂爼鏌涢幇闈涙灍闁绘挾鍠栭獮鏍ㄦ綇閸撗咃紵闂佷紮缍嗛崣鍐蓟濞戞瑦鍎熼柕濞垮€栭崰姘舵⒑鐠団€虫殭闁搞儜鍐偓鍨攽閻愭潙鐏︽い顓炴喘閹?(<10%)
        else if (this.isCommandScavenging() && getFreeSlotCount() < 5) {
            status = "status.low_space:" + this.entityData.get(UNIT_ID);
        }
        // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佲枙闁绘帟濮ょ换娑㈠幢濡纰嶉柣鐔哥懕缁犳捇骞冨Δ鍛櫜閹肩补鍓濋悘宥夋⒑閸濆嫭濯煎ù婊庝簻椤繒绱掑Ο璇差€撻梺鍛婄☉閿曘倝寮抽崼銉︾參闁告劦鍠曢幉楣冩煛瀹€瀣М闁糕斁鍓濈换婵嬪磼濠娾偓濡楁捇鏌?5: 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗霉閿濆牊顏犵紒鈧繝鍌楁斀闁绘ê寮堕幖鎰磽娴ｅ弶娅婇柡灞剧☉铻栭柛鎰╁妺閹寸兘姊洪崫鍕紨闂傚嫬瀚粚杈ㄧ節閸ヨ埖鏅┑鐘绘涧濞村倹绂掗埡鍛拺闁告繂瀚敍鏃堟⒒閸曨偄顏鐐茬墦婵℃悂濡锋惔锝呮灈鐎规洖缍婇、娆撳箚瑜嶇紓姘舵⒒?(闂?闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗ù锝夋交閼板潡姊洪鈧粔鎾磼閵娧勫枑闁哄啫鐗嗙粻鏍ㄧ箾瀹割喕绨婚幆鐔兼⒑闂堟侗妯堥柛鐘愁殘缁辩偞鎯旈姀銏㈢槇闂佹眹鍨藉褎鐗庨梻浣哄帶缂嶅﹦绮婚弽褜鍤曢柛娑橈功閻熷綊鏌嶈閸撶喎顕ｆ繝姘嵆闁靛繒濞€閸炶泛鈹戦悩鑼粵闁告梹鐗滈悷褏绱撻崒姘偓椋庢媼閺屻儱纾婚柟鐐墯閻斿棝鏌ら幖浣规锭濠殿喖鐗撻弻锝夊箻瀹曞洨顔囬梺瀹狀潐閸ㄥ潡骞冨▎鎾崇婵犻潧妫欏▓顓烆渻閵堝懏绂嬪ù婊勭箞楠?
        else if (this.isCommandScavenging()) {
            status = "status.scavenge:" + dotsCount;
        }
        // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佲枙闁绘帟濮ょ换娑㈠幢濡纰嶉柣鐔哥懕缁犳捇骞冨Δ鍛櫜閹肩补鍓濋悘宥夋⒑閸濆嫭濯煎ù婊庝簻椤繒绱掑Ο璇差€撻梺鍛婄☉閿曘倝寮抽崼銉︾參闁告劦鍠曢幉楣冩煛瀹€瀣М闁糕斁鍓濈换婵嬪磼濠娾偓濡楁捇鏌?6: 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌熼梻瀵割槮缁炬儳顭烽弻锝夊箛椤掍焦鍎撶紓浣哄С閸楁娊寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磽娴ｅ搫啸濠电偐鍋撳Δ鐘靛仦閻楁洝褰佸銈嗗坊閸嬫捇鏌ｈ箛锝呮珝闁哄矉绲介埞鎴炵節閸屾粌甯跨紓鍌欒兌缁垶鎯勯姘辨殾闁告鍊ｉ悢鐑樺珰闁哄被鍎抽埀顒佹そ濮?(闂?闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗ù锝夋交閼板潡姊洪鈧粔鎾磼閵娧勫枑闁哄啫鐗嗙粻鏍ㄧ箾瀹割喕绨婚幆鐔兼⒑闂堟侗妯堥柛鐘愁殘缁辩偞鎯旈姀銏㈢槇闂佹眹鍨藉褎鐗庨梻浣哄帶缂嶅﹦绮婚弽褜鍤曢柛娑橈功閻熷綊鏌嶈閸撶喎顕ｆ繝姘嵆闁靛繒濞€閸炶泛鈹戦悩鑼粵闁告梹鐗滈悷褏绱撻崒姘偓椋庢媼閺屻儱纾婚柟鐐墯閻斿棝鏌ら幖浣规锭濠殿喖鐗撻弻锝夊箻瀹曞洨顔囬梺瀹狀潐閸ㄥ潡骞冨▎鎾崇婵犻潧妫欏▓顓烆渻閵堝懏绂嬪ù婊勭箞楠?
        else if (this.isPurgeActive()) {
            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿垂妤ｅ啫绠涘ù锝呮贡缁嬩胶绱撻崒姘偓鐑芥倿閿曚焦鎳岄梻浣告啞閻熴儳鎹㈤幒妤€鐒垫い鎺戝枤濞兼劖绻涢崣澶屽ⅹ閻撱倝鏌曟繛褍鎳嶇粭澶愭⒑閸濆嫬鏆欓柣妤€锕幃锟犲即閻橆偄浜鹃柛蹇擃槸娴滈箖姊洪柅鐐茶嫰婢у鈧娲橀崹鐢稿煡婢跺娼╅弶鍫厜缁憋繝鏌ｉ悢鍝ョ煁婵☆偄鍟锝囨嫚瀹割喖鎮戦梺鍓插亽閸嬪懘顢撻崶顒佲拻濞达絽鎲￠崯鐐烘煙閹间胶鐣虹€规洜澧楅幆鏃堚€﹂幋鐐存珨闂備焦瀵х换鍌炈囨禒瀣瀬闁告劦鍠楅悡蹇涙煕椤愶絿绠撴い蹇ｄ邯閺屾盯寮撮悙鍙夋濠殿喖锕ㄥ▍锝囨閹烘嚦鐔煎传閸曟垶娲熷娲川婵犲啫闉嶉悗鍏夊亾闁归棿闄嶉埀顑跨閳诲氦绠涢敐鍛€梻浣规偠閸庮噣寮插┑瀣櫖婵犻潧顑嗛埛鎴犵磼鐎ｎ偄顕滄繝鈧导瀛樼厽闁绘梹娼欐慨鍌溾偓瑙勬礃椤ㄥ懘鎮惧┑瀣妞ゆ帒鍊搁獮鍫ユ⒒娴ｈ櫣甯涙い顓炵墕閳诲秹寮撮悩鐢电劶闁诲函缍嗛崑浣圭濠婂牊鐓忛煫鍥э攻椤鏌ら悧鍫濐嚋妞ゃ劊鍎甸幃娆戔偓鐢殿焾椤囨⒑閻熸澘妲婚柟铏姍楠炲骞橀鑲╊槹濡炪倖甯掗崐绋款嚈濞差亝鈷掑ù锝囩摂閸ゆ瑥螖閻樿櫕鍊愮€规洏鍨归…銊╁醇濠靛牞绱遍梻浣烘嚀婢х晫鍒掗鐐村亗闁哄洢鍨洪悡娑㈡煕閵夛絽鍔氬┑锛勫帶闇夋繝濠傚閻帡鏌熼缁㈡敯妞わ箑寮堕妵鍕箣濠垫劖笑濡炪値鍋勭换鎰弲濡炪倕绻愮€氼剛绮ｅ☉娆戠瘈闁汇垽娼у瓭闂佺懓鍟块柊锝堟＂濠电娀娼ч鍡涘煕閹寸姷纾藉ù锝囨娓氭稒绻涢崼鐔糕拹濞ｅ洤锕、鏇㈡晲閸モ晝鏉介梻浣虹帛娓氭宕板Δ鍐╁床婵犻潧顑呴悙濠囨煏婵炲灝鍔欐慨瑙勵殜濮婃椽鎳￠妶鍛呫垺绻涘ù瀣珖濞存粍鎮傞、鏃堝炊閼稿灚绶梻鍌氬€搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偛顦甸弫宥夊礋椤撶姴顦╅梻浣侯潒閸曞灚鐣剁紒鐐劤濞尖€愁嚕閸洖閱囨繛鎴灻‖瀣渻閵堝倹娅婇柡鈧柆宥呂﹂柛鏇ㄥ灠閸愨偓濡炪倖鍔﹀鈧繛宀婁邯濮婅櫣绱掑Ο璇茶敿闂佺姘︾亸娆撳箲閵忕姭妲堥柕蹇曞Х椤撴椽姊虹紒妯哄婵☆偅鐟╁畷褰掓偨閸涘﹥娅囬梺闈涚箞閸婃牠宕戠€ｎ喗鐓曟い鎰Т閻忣喗銇勯弮鈧ú鐔奉潖濞差亜鎹舵い鎾跺Т缁楋繝鏌ｉ姀鈺佺仭妞ゃ劌锕ら悾鐑藉箣閿曗偓鍞悷婊冾樀瀹曟垿骞橀弬銉︾亖闂佸壊鐓堥崰妤呮倶閸儲鈷戦悹鍥皺缁犳煡鏌よぐ鎺旂暫妞ゃ垺宀告俊鐑藉煛娴ｄ警妲规俊鐐€栭幐鑽ょ矙閹寸偟顩插Δ锝呭暞閻撱儲绻濋棃娑欘棤闁告垵婀辩槐鎺楀Ω閵婏富妫勯梻鍥ь樀閺岋絽螣閾忕櫢绱為梺娲诲幗鐢骞堥妸锔剧瘈闁告劏鏂傛禒銏ゆ倵鐟欏嫭澶勯柛瀣工閻ｇ兘鎮㈢喊杈ㄦ櫍闂佺粯鍔忛弲婊呪偓姘洴濮婂宕掑▎鎴濆闂佽鍠栭悥鐓庣暦濠靛绠ｉ柣鎰問濞叉悂鏌ｉ悩鑽ょ窗婵炲拑缍佸?
            status = "status.purge:" + this.purgeKillCount + ":" + dotsCount;
        }

        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犵厱婵﹩鍘介妵婵嗏攽闄囬崺鏍ь嚗閸曨厸鍋撻敐搴濈胺婵″弶鍔欏缁樼瑹閳ь剙顭囪婢ф繈姊洪崫鍕櫤闁烩晩鍨堕獮蹇涘箣閿旇棄浜滈柣蹇撶箣閻掞箓寮埀顒勬⒒娴ｈ櫣甯涢柨姘扁偓娈垮枛閻栧ジ鐛弽顓炵疀闁绘鐗忛崢鎼佹煟鎼搭垳宀涢柡鍛箘缁綁寮崼鐔哄幐閻庡厜鍋撻悗锝庡墮閸╁矂鏌х紒妯煎⒌闁哄苯绉烽¨渚€鏌涢幘璺烘灈妤犵偛鍟抽ˇ鍦偓瑙勬礀瀹曨剟鍩㈡惔銊ョ闁绘﹢娼ф慨?(闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈢粯淇婇悙顏勨偓鏍偋濡ゅ啰鐭欓柟鐐湽閳ь剙鎳樺畷锝嗗緞瀹€鈧惁鍫ユ⒒閸屾氨澧涚紒瀣浮閺佸秹寮崼鐔哄幘闂佸搫顦冲▔鏇熺閵忋倖鐓忛柛鈩兠粭鎺撱亜椤愶絿绠為柡浣瑰姍瀹曘劑顢楅埀顒勊夊鑸碘拺閻犲洤寮堕崬澶嬨亜椤愩埄妲搁悡銈夋煃閸濆嫬鏆欑紒韬插€濋弻娑欑節閸曨偅鐏佹繛瀛樼矆缁瑥顫忕紒妯诲闁告稑锕ら弳鍫㈢磽娴ｇ瓔鍤欓柛濠傤煼閸┾偓妞ゆ帊鐒﹂惃鎴︽煕韫囨枂顏堟偩閻戣姤顥堟繛鎴炲笚閻庡姊洪悷鏉库挃閻炴稏鍎甸獮蹇撁洪鍛嫼闂佸憡绋戦敃锔剧不閹剧粯鍊垫慨妯煎帶婢у鈧鍠楁繛濠冩叏閳ь剟鏌曢崼婵囶棤闁告﹢浜跺娲礃閸欏鍎撻梺绋匡功缁垶寮查崼鏇ㄦ晢闁告洦鍓涢崢鎼佹⒑閸涘﹣绶遍柛姗€绠栧畷娲晲婢跺鍘靛銈嗘椤鈻嶉崶顒佺厵濡炲楠搁埢鍫ユ煙瀹曞洤鈻堟い銏☆殜瀹曟帒顫濋鍌滄殸闂傚倸鍊搁崐鎼佸磹閻戣姤鍤勯柛顐ｆ礀缁犵娀鏌熼崜褏甯涢柛瀣ㄥ€濋弻鏇熺箾瑜嶇€氼剚鎯旀繝鍥ㄢ拺缂佸娉曢悘閬嶆煕鐎ｎ剙浠辩€规洘娲樼换婵嬪炊閵娧冨箞婵＄偑鍊栭崝褏寰婇崜褏鐭嗛柛鎰靛枟閻撶喖鏌熼幆褍鑸归柛鏃€绮庣槐鎺旂磼濡吋鍒涘Δ鐘靛仜椤戝骞冨鍫濆耿婵炲棗绻愭闂傚倸鍊烽懗鍓佸垝椤栨粍鏆滈柟鐑橆殔鎼村﹪鏌＄仦璇插姎闁绘挻锕㈤弻鐔告綇閸撗呮殸闂佺粯鎼换婵嬪蓟濞戙垹鐒洪柛鎰亾閻ｅ墎绱撴笟鍥т簻缂佸鎳撻～蹇涙惞鐟欏嫬鐝伴梺鐐藉劚绾绢厽绂掗埡浣叉斀闁绘劙顤傞崵瀣磼閻樿櫕宕岄柣娑卞枦缁犳稑鈽夊Ο铏圭崺闂備礁鎼ˇ浼村垂鐠鸿櫣鏆ょ€广儱鎷嬪〒濠氭煏閸繃顥為悘蹇斿缁辨帡顢欓崗鍏兼嫳缂備礁鍊哥粔鐢碘偓浣冨亹閳ь剚绋掕彜闁?
        if (!status.equals(this.entityData.get(DATA_STATUS_OVERLAY))) {
            this.entityData.set(DATA_STATUS_OVERLAY, status);
        }
    }

    // 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫宥夋煟閹邦厽缍戝ù婊堜憾濮婅櫣鍖栭弴鐐测拤缂備礁顑嗛崹鍦垝婵犳碍鍋愰悹鍥皺椤旀劕鈹戦悜鍥╃У闁告挻鐟╅幃姗€顢旈崼鐔哄幈濠电偛妫楃换鎺旂不閺屻儲鐓忛柛銉戝喚浼傜紓浣哄У閻╊垶鐛Ο鍏煎磯濞撴凹鍨卞鎴︽⒒閸屾瑧顦﹂柟纰卞亰楠炲繒鈧綆鍠栫粈鍫熸叏濡寧纭剧紒鐘靛仱閺屾洘绻涢崹顔煎Ф濠电偟顑曢崝鎴﹀蓟濞戙垹鐒洪柛鎰亾閻ｅ爼鏌ｆ惔銏犲枙缂佽弓绮欓崺鐐哄箣閿旂粯鏅╃紒缁㈠幘閺屽宕ラ銈囩＝濞达絽鎼牎闂佺粯顨堟慨鎾敋閿濆棛绡€婵﹩鍘藉▍鏍⒑閸涘﹥澶勫ù婊勭箞瀹曠喖宕橀鐣屽幗闂佺粯锚瀵埖寰勯崟顓熷枑闁哄鐏濋弳鐐烘煙娓氬灝濮傚┑陇鍩栧鍕偓锛卞嫬顏圭紓鍌氬€风粈渚€顢栭崨瀛樺€舵繝闈涱儛閺佸棝鏌曞娑㈩暒缁ㄥ姊洪棃娑辩劸闁稿氦顕ч蹇涘Ψ閳哄倻鍘介梺鎸庣箓濞层倝宕㈤幘顔界厵妞ゆ棁顫夊▍鍥煙妞嬪骸鈻堟鐐存崌楠炴帡寮崒姘К濠电姷顣槐鏇㈠磻閹达箑纾归柡宥庡幖閽冪喖鏌曟繛鍨Ω濞存粌缍婇弻鏇熺箾閻愵剚鐝曢梺鍝勬噺缁诲牓寮诲☉姘勃闁告挆浣插亾閹烘鐓曟俊顖氭惈閼稿綊鏌嶇憴鍕伌妞ゃ垺鐟╁顒勫Χ閸艾浜鹃悹鎭掑妿绾惧ジ鏌ｅΟ铏癸紞濠⒀屼簼閵囧嫰顢楅埀顒勬晝椤忓牄鈧礁鈻庨幘瀵稿弳濡炪倖鐗楅惌顔界珶閺囩偐鏀介柣鎰皺婢ф洟鏌ｈ箛鏃傜疄鐎殿喖鍟块埢搴ㄥ箻鐎电骞堥梻渚€娼ч¨鈧紒鑼跺Г娣囧﹪鎳為妷褏顔?(闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈢粯淇婇悙顏勨偓鏍偋濡ゅ啰鐭欓柟鐐湽閳ь剙鎳樺畷锝嗗緞瀹€鈧惁鍫ユ⒒閸屾氨澧涚紒瀣崌楠炲﹥鎷呴崜鑼數闂佸吋鎮傚褎鎱ㄩ崶鈹惧亾閻熺増鍟炵紒璇茬墦瀵鍩勯崘銊х獮闁诲函缍嗘禍鐐村閸ヮ剚鈷戠痪顓炴噹琚氬┑鐐跺皺閸犲酣锝炶箛鎾佹椽顢旈崪浣诡棃婵犵數鍋為崹鍏笺仈濮濆苯鈧挳姊婚崒娆掑厡妞ゎ厼鐗嗛～婵嬫晜婵劒绮撻梺鍛婄缚閸庢娊鎯屾径灞稿亾楠炲灝鍔氭い锔诲灦閺屽宕堕浣哄幐闂佹悶鍎弲娑㈠几閺冨牊鐓曟俊顖涘椤ュ鏌嶇憴鍕伌闁轰礁绉瑰畷鐔碱敃閳╁啫鐓曠紓鍌氬€风欢锟犲闯椤曗偓瀹曡瀵奸弶鎴犲幒閻庡箍鍎遍ˇ顖炵嵁閵忥紕绠鹃柟瀵稿仧閹冲懘鏌?12-26)
    private boolean isInventoryFull() {
        for (int i = 12; i < 37; i++) {
            if (this.inventory.getItem(i).isEmpty()) return false;
        }
        return true;
    }

    private int getFreeSlotCount() {
        int free = 0;
        for (int i = 12; i < 37; i++) {
            if (this.inventory.getItem(i).isEmpty()) free++;
        }
        return free;
    }

    // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙闁稿被鍔庨幉鎼佸籍閸惊銉╂煕閹般劍娅嗛柛搴ｅ枛閺屾洝绠涚€ｎ亞鍔村┑鐐跺皺椤牓鍩為幋锔藉亹閻犲泧鍐х矗闂佽瀛╅崙褰掑矗閸愩劎鏆﹂柨婵嗙墢閻も偓濠电偞鍨堕悷褔宕㈤幘缁樷拺闁告稑锕︾粻鎾绘倵濮樼厧寮€规洖鐤囬妵鎰板箳閹捐泛骞愰梺璇插嚱缁叉椽寮插┑鍫㈢幓闁哄啫鐗婇悡娆愩亜閺冨倻鎽傛繛鍫熺矋娣囧﹪顢曢姀鐘虫闂佸疇妫勯ˇ顖炲煝鎼淬倗鐤€闁哄啠鍋撻柣锝呫偢濮?
    public void sortInventory() {
        // 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛銈呭閺屻倗绮欑捄銊ょ驳闂佸憡鐟ョ换鎴﹀Φ閸曨垰绠婚柛妤冨仧娴犺偐绱掗悙顒€鍔ゆい顓犲厴瀵鎮㈤悡搴ｎ槶閻熸粌绻掗弫顔尖槈閵忥紕鍘介梺瑙勫劤閻°劎绮堥崘銊囧酣宕惰闊剙鈹戦垾宕囧煟鐎规洜鍠栭、姗€鎮欏顔锯偓瀵哥磽閸屾艾鈧鎷嬮弻銉ョ；闁瑰墽绮悡鏇㈡煙娴煎瓨娑ч柡瀣枛閺屾稓鈧絻鍔屾俊浠嬫煏閸パ冾伃鐎殿喕绮欐俊姝岊槷濠殿喖娲弻锝堢疀閹惧墎顓洪梺鍛婎殕婵炲﹤顕ｆ繝姘亜缁炬媽椴搁弲顒€鈹戦悙鏉戠仸闁荤噥鍨伴～蹇曟崉閵娧咃紳婵炶揪绲介幖顐ｇ墡闂備胶鍎甸弲鈺呭垂鏉堛劎鈹嶅┑鐘叉处閸嬵亝銇勯弽鐢电ɑ闂夊姊婚崒娆掑厡缂侇噮鍨崇划娆掔疀濞戞锛熼梺姹囧灮椤牓鎷戦悢鍏肩叆婵犻潧妫涙晶銏ゆ煟閵堝倸浜鹃梻鍌欐祰椤宕曢搹顐ｆ珷閹兼惌鐓堥弫濠囨煕閵夋垟鍋撻柡鈧禒瀣厓闁芥ê顦伴ˉ婊兠瑰鍕畼缂佽鲸甯為幏鐘绘嚑椤掆偓閳潧螖閻橀潧浠滈柛鐔告尦楠炲啯绂掔€ｎ亞顦梺鍛婄懃椤︽澘鈻嶉幘缁樷拻濞达綁顥撴稉鑼磼闊厾鐭欓柟顖氱焸瀹曠厧顭垮┑鍡欑Ш鐎规洜鍠栭、娑樷槈濡嘲浜鹃柣銏犳啞閻撶喖鏌ｉ弬鎸庡暈缂佽泛寮堕妵鍕疀閿濆嫮鐩庡銈庡幖濞硷繝骞冮悜鑺ョ劷闁挎洍鍋撻柛鎾崇埣閹鎲撮崟顒傤槰闂佹悶鍔屽锟犳偘椤斿槈鐔兼嚃閳哄喛绱叉繝纰樻閸ㄦ娊宕曢妶澶嬪仼濞寸厧鐡ㄩ埛鎺懨归敐鍛喐闁哄鍟穱濠傤渻閻撳骸顬嬮梺鐟板槻椤戝顕ｆ繝姘ㄩ柕澹苯鏁归梻鍌欑閹诧紕绮欓幋锔藉仱闁靛ň鏅涢悡鏇㈡煙鏉堥箖妾柣鎾存礃缁绘盯骞嬮悜鍥у彆闂佸憡姊婚崰鎾舵閹烘鍋愰柛鎰皺娴煎矂姊洪崫鍕潶闁稿﹥绻堥獮鏍亹閹烘繃鏅濋梺鎸庣箓濡盯鍩€椤掑鐏ｇ紒杈ㄦ尰閹峰懘妫冨☉姗嗙€存繝纰夌磿閸嬬姴螞閸曨垽缍栭煫鍥ㄦ媼濞差亶鏁傞柛鏇ㄥ亞閻涒晛鈹戦悩鍨毄濠殿喗鎸冲畷鎰節濮橆厼浠梺鍦帛瀹稿寮ㄦ禒瀣厽婵妫楅弸娑㈡煟韫囷絼閭柟閿嬪灴閺屽棗顓奸崱娆忓箰闂備礁鎲℃笟妤呭储妤ｅ啫鏄ラ柨婵嗩槹閻撴瑦銇勯弮鍥舵綈婵炲懎娲ㄧ槐鎺撴綇閵娿儳鐟ㄩ柧浼欑悼缁辨挻鎷呴惂闀愮返婵?(12-36)
        List<ItemStack> stacks = new ArrayList<>();
        for (int i = 12; i < 37; i++) {
            ItemStack s = this.inventory.getItem(i);
            if (!s.isEmpty()) {
                stacks.add(s);
                this.inventory.setItem(i, ItemStack.EMPTY);
            }
        }

        stacks.sort((a, b) -> Integer.compare(getItemValue(b), getItemValue(a))); // Descending

        for (int i = 0; i < stacks.size(); i++) {
            if (i + 12 < 37) {
                this.inventory.setItem(i + 12, stacks.get(i));
            }
        }
    }

    private int getItemValue(ItemStack stack) {
        if (stack.isEmpty()) return -1;
        Item item = stack.getItem();
        if (item == Items.NETHERITE_INGOT) return 100;
        if (item == Items.DIAMOND) return 90;
        if (item == Items.EMERALD) return 80;
        if (item == Items.GOLD_INGOT) return 70;
        if (item == Items.IRON_INGOT) return 60;
        return 0;
    }

    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱樈閸犳顕欏ú顏呪拺缂侇垱娲栨晶鏌ユ煏閸モ晛浠ч柤楦块哺缁傛帞鈧綆鍋嗛崢鍛婄節閵忥絾纭炬俊顐ｇ懃閳诲秹宕卞☉娆戝幐闁诲繒鍋犻褎鎱ㄩ崒鐐寸厓闁靛鍨抽悾鐢碘偓瑙勬礈椤牐鐏冩繛杈剧到閹诧繝鎮块崒鐐粹拻濞达絽婀卞﹢浠嬫煕閵娿劍顥夋い顓炴穿椤﹀綊鏌涢埡鍌溾槈闁伙絾绻堝畷鐔碱敄閼恒儱顏圭紓鍌氬€风粈渚€顢栭崨顓х劷闁跨喓濯弫浣逛繆閵堝嫰妾峰ù婊勭矒閺岋繝宕堕妷銉ヮ瀳閻庢鍣崰妤呫€冮妷鈺傚€烽柤纰卞墰椤旀帒顪冮妶鍐ㄧ仾婵炶尙鍠栧顐﹀礃椤旇偐鍔﹀銈嗗笒閸婂鎯岄崱娑欑厱闁硅埇鍔嶉弶鍝劽瑰鍕煉闁绘搩鍋婂畷鍫曞Ω閿曗偓闂夊秹姊洪棃鈺冩偧闁稿簺鍊楅幑銏犫槈閵忕娀鍞跺┑鐐村灦椤洦瀵奸崼婵冩斀妞ゆ梻銆嬪銉╂煙绾板崬浜濋柡鍛劦濮婃椽骞栭悙鎻掑Η闂佸憡鍔曟晶浠嬪焵椤掍礁鈻曟慨濠呮閹风娀骞撻幒婵嗗Ψ闂備焦鐪归崝宥囧垝閹惧磭鏆﹂柟顖炲亰濡查箖姊洪崨濠冾棖缂佺姵鍨块垾鏃堝礃椤斿槈褔鏌涢埄鍐炬畼闁荤喐鍔欏娲偂鎼粹剝姣愰梺缁樼墪閵堟悂鐛崱娆庢勃闁绘劦鍓欓崝鍛渻閵堝骸浜介柛蹇旂〒閼鸿鲸绻濆顓涙嫼闂佸憡绻傜€氼厽寰勯崟顑句簻闁靛鍎查ˉ婊堟煃鐠囪尙效鐎规洖鐖奸、妤佹媴閸濆嫬绠ユ繝纰夌磿閸嬫盯顢栭崨顕呮缂佸娉曢幗銉╂⒒閸屾瑧顦﹂柣銈呮喘閿濈偞寰勯幇顒€鐎梺鍓茬厛閸犳岸寮抽敂鑺ュ弿婵＄偠顕ф禍楣冩⒑鏉炴壆鍔嶉柛鏃€鐟ラ悾鐑藉Ω閳哄﹥鏅㈤梺閫炲苯澧撮挊鐔告叏濮楀棗骞樼紒鈾€鍋撻梻浣圭湽閸ㄨ棄顭囪閸┿垽宕奸悢铏诡啎婵炶揪绲介崯鍧楀储閹灐娲敂閸曞汞鍥ㄧ厱闁斥晛鍠氬▓妯肩磼閹邦喖浠遍柟顔筋殜閻涱噣宕归鐓庮潛婵＄偑鍊х紓姘跺础閹惰棄绠?

    // Getter 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓缂佺姳鍗抽弻銈嗘叏閹邦兘鍋撻弴銏犲嚑闁割偀鎳囬崑鎾荤嵁閸喖濮庡┑鐐茬湴閸旀垿骞嗙仦瑙ｆ瀻闁规儳顕崢鐢告⒑缂佹ê鐏﹂拑閬嶆煃闁垮濮嶉柡灞剧洴閹垽宕ㄦ繛澶歌檸闂備礁鎼張顒勬儎椤栫偛鏄ラ柛鏇ㄥ灠缁€鍐┿亜韫囧海鍔嶆い顐㈢Ч濮婄粯鎷呴懞銉闂佸摜鍠嶉崡鍐茬暦娴兼潙鍐€妞ゆ挾鍋犻幗鏇㈡⒑缂佹ɑ鈷掗柛妯犲懐涓嶉柡灞诲劜閻撴瑩姊洪銊х暠妤犵偞顭囬幉鎼佸箮婵犲倹澶勯柍閿嬪灩缁辨挻鎷呯拠锛勫姺缂傚倸鍊瑰畝鎼佸蓟濞戞瑧绡€闁告劏鏅濋ˇ鏉库攽閻橆偄浜炬繛鎾村焹閸嬫挻鎱ㄦ繝鍐┿仢妤犵偞鍔栭幆鏃堟晲閸モ晜娈奸梻鍌欒兌缁垶銆冮崨瀛樻櫇闁挎洍鍋撻柍钘夘樀閹晫绮欓崸妤€鏁归梻浣告惈濞层劑宕伴幘璇插偍?
    public String getOverheadStatus() { return this.entityData.get(DATA_STATUS_OVERLAY); }





    // ==========================================
    // 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰鍐€妞ゆ劦婢€濞岊亪姊虹粙鍖″伐闁绘牕銈稿濠氭偄閾忓湱锛滈梺闈涚箳婵敻鎮樺澶嬧拺?3D 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缂佺姷濞€閺岀喖宕滆鐢盯鏌涙繝鍛厫闁逛究鍔岃灒闁圭娴烽妴鎰磽娴ｅ搫校濠㈢懓妫涘Σ鎰板箳閺傚搫浜鹃柨婵嗛楠炴鐥鐐靛煟闁哄矉绻濆畷閬嶅箛椤戣棄浜炬繝闈涱儏閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忛搹鍦＜婵☆垵娅ｉ悷銊ヮ渻閵堝骸骞橀柛蹇斆锝嗙節濮橆厽娅㈤梺缁橆焾鐏忔瑩藝閺夋娓婚柕鍫濇婵倿鏌涙繝鍐炬疁妞ゃ垺鐟︾换婵嬪炊閵娧冨箺闂備線娼х换鍡涘疾濞戙垺鍊堕柣妯哄帠缁诲棙銇勯幇鍓佹偧缂佺姷鍋熼埀顒侇問閸犳牠鈥﹂悜钘夊瀭濡わ絽鍟粻娑樏归敐鍛暈闁稿鍨跺缁樻媴鐟欏嫬浠╅梺绋挎唉妞存悂寮查懜鍨劅闁靛鍎抽ˇ顕€姊洪崨濠勭細闁稿骸纾竟?
    // ==========================================
    private int summonRetryCount = 0;

    private void tickPrintLogic() {
        int state = this.entityData.get(PRINT_STATE);
        float progress = this.entityData.get(PRINT_PROGRESS);

        // [闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼槮闁搞劍绻冮妵鍕冀椤愵澀姹楅梺閫炲苯澧剧紒鐘虫尭閻ｉ攱绺界粙璇俱劍銇勯弮鍥撴繛鍛崌濮婄粯鎷呴崨濠呯婵犫拃鍕垫當妞ゎ厼鐏濊灒闁兼祴鏅欑粭?0] 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣銏犲閺佸﹪鏌″搴″箹缂佹劖顨嗘穱濠囧Χ閸涱厽娈查悗瑙勬礃閻擄繝寮婚悢鍏肩劷闁挎洍鍋撻柡瀣〒缁辨帡鐓幓鎺嗗亾閺囥垺绠掗梻浣虹帛閿氭俊顖氾躬瀹曟洟骞囬悧鍫㈠幈闁诲函缍嗘禍璺何熼埀顒勬⒑閸濆嫭婀伴柣鈺婂灦閵嗕線寮撮姀鈩冩珳闂佺硶鍓濋悷顖毼ｆ导瀛樷拻濞达絼璀﹂悞鐐亜閹存繃顥㈢€规洘绻傞埢搴ㄥ箻鐎圭姵鎲伴梻渚€娼ч悧鍡浰囬娑橆嚤闁绘绮悡蹇擃熆閼稿緱顏堝几閻斿憡鍙忛柨婵嗘噽閻掑憡鎱ㄦ繝鍛仩缂侇喗鐟ラ埢搴ㄥ箚瑜嶆竟澶愭⒒娴ｇ瓔娼愰柣鈩冩礀閻ｇ兘鎮介棃娑樼亰濡炪倖鎸堕崹娲磻閸曨垱鐓曟繝闈涘閸斻倝鏌ｉ敃鈧悧鎾愁潖濞差亜宸濆┑鐘插暙椤︹晠姊洪崨濞氭垿宕曢幎鑺ュ仼濡炲瀛╁畷澶愭偠濞戞帒澧查柡鍌楀亾闂傚倷鑳剁划顖炲礉閺囩倣鐔哥節閸パ冩優闂佺粯鏌ㄩ惃婵嬪绩閼恒儯浜滈柡鍥╁仦閸ｅ湱鈧鍣崰姘跺焵椤掑喚娼愭繛鍙夛耿瀹曞綊宕稿Δ鍐ㄧウ濠殿喗銇涢崑鎾垛偓娈垮櫘閸撶喐淇婇悜鑺ユ櫆缂備焦顭囩粔楣冩⒒閸屾艾鈧绮堟笟鈧獮鏍敃閿曗偓绾惧綊鏌﹀Ο渚Т闁哄鐗犻弻锟犲炊閳轰焦鐎惧┑鐐叉噽婵炩偓闁哄被鍔戝鎾倷濞村浜剧憸鐗堝笚閸嬪倿鏌￠崶銉ョ伄闁告瑦鎹囬弻娑㈠Ψ閿濆懎顬夐梺璇查閵堟悂寮婚悢琛″亾閻㈡鐒鹃崯鎼佹⒑濞茶骞楅柣鐔村劦閳ワ妇鎹勯妸锕€纾繛鎾村嚬閸ㄦ娊宕ｉ弴銏♀拺闁告稑锕ㄦ竟妯汇亜閹存繍妯€鐎殿喛顕ч埥澶娢熼柨瀣垫綌闂備礁鎲￠〃鍫ュ磻濞戭澁缍栨い鎰剁导缁?
        if (state == 0) return;

        // [闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼槮闁搞劍绻冮妵鍕冀椤愵澀姹楅梺閫炲苯澧剧紒鐘虫尭閻ｉ攱绺界粙璇俱劍銇勯弮鍥撴繛鍛崌濮婄粯鎷呴崨濠呯婵犫拃鍕垫當妞ゎ厼鐏濊灒闁兼祴鏅欑粭?1] 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣銏犲閺佸﹪鏌″搴″箹缂佹劖顨嗘穱濠囧Χ閸涱厽娈查悗瑙勬礃閻擄繝寮婚悢鍏肩劷闁挎洍鍋撻柡瀣〒缁辨帡鐓幓鎺嗗亾濠靛钃熼柨鏇楀亾閾伙絽銆掑鐓庣仭妞ゅ骸妫濆娲嚃閳轰緡鏆柣搴ｇ懗閸ヮ灛锕傛煕閺囥劌鏋ら柣銈傚亾闂備浇顫夊畷妯衡枖濞戭潿鈧倿鎼归崷顓狅紳婵炶揪绲介幖顐モ叿闂備胶顭堝ù鐑藉极鐠囧樊鍤曞┑鐘崇閸嬪嫰鏌ｉ幘铏崳闁伙綁绠栭幃宄邦煥閸愵€呪偓娈垮枦濞呮洖顭囪箛娑樼厸闁告劦浜风槐?(Printing)
        if (state == 1) {
            // 1. 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫鍐煥閺囨浜鹃梺姹囧€楅崑鎾舵崲濠靛洨绡€闁稿本绋戝▍褔姊哄ú璇插箺闁荤啿鏅犲濠氭偄鐞涒€充壕闁汇垺顔栭悞鍓ф偖閵夆晜鈷戠紒瀣儥閸庢劙鏌熼崨濠傚姢闁宠棄顦甸幃鐣岀矙閸喚鐛╂俊鐐€栧褰掑磿閸愭祴妲堢憸鏂款潖缂佹ɑ濯撮柛娑橈攻閸庢捇姊洪悷鏉挎毐闂佸府缍侀獮鍐Ψ閿旈箖妾紓浣割儓濞夋洟鎮鹃崫鍕ㄦ斀闁绘劕寮堕ˉ鐐烘煙缁嬫寧鎲哥紒顔碱煼閹粙宕ㄦ繝鍕箥闂備胶绮崹鍫曗€﹂崶鈺冧笉闁哄诞鈧弨?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亜顒㈡い鎰矙閺屻劑鎮㈤崫鍕戙垻鐥幆褜鐓奸柡灞剧洴閸╁嫰宕橀浣诡潔缂傚倷鐒﹂崝鏍€冩繝鍥╁祦闁哄秲鍔嶇紞鍥煕閹炬鍟伴悡妤呮⒒娴ｄ警鐒炬い鎴濇楠炴劖銈ｉ崘銊х枀闂佸湱铏庨崰鏍矆鐎ｎ偁浜滈柟閭﹀枛閺嬫垿鏌ｈ箛鎾搭棦婵﹦绮幏鍛存嚍閵夛絺鍋撻崘顏嗙＜闁逞屽墯閹峰懘鎼归崷顓犲帬闂備礁婀遍搹搴ㄥ闯椤栨粎绀婇柡宥冨妿缁♀偓闂傚倸鐗婃笟妤呭磿濞戙垺鐓涘ù锝囶焾椤忣參鏌＄仦鍓р槈闁宠楠搁濂稿川椤撶儐娼ラ梻鍌欑濠€鍗炩枍閵忋垻绀婂ù锝呭濞?5 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋敐鍛闂佽姤蓱缁诲牓寮婚悢灏佹灁闁割煈鍠楅悘宥夋⒑閸濆嫭顥炵紒顔芥崌瀵鎮㈤崗鐓庘偓缁樻叏濡も偓濡瑩鎮鹃悜鑺モ拺缂佸顑欓崕宀勬煛閸涱喚鐭掑┑锛勬暬瀹曠喖顢涘槌栧敽闂備胶鎳撻悺銊ф崲瀹ュ棛顩峰Δ锝呭暞閳?
            // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯煎幗闁瑰吋鎯岄崹宕囩矓閻㈠憡鐓曢悗锝庝簻椤忣厽銇勯姀鈩冨磳妤犵偞顭囩槐鎺懳熼柨瀣伖缂傚倸鍊搁崐鐑芥倿閿曞倸鐓熼柕鍫濐樈閺佸倿鏌涢锝囩畼闁哄苯鐗撳铏圭矓閸℃顏存繛鍫熸閺屾稓浠︾拠鎻掝潎闂佸搫鐬奸崰鏍箖濠婂喚娼ㄩ柛鈩冾焽閺嗩參姊绘担鍛婂暈闁荤噦绠撻獮鎴﹀炊椤掆偓閽冪喐绻涢幋娆忕仼閸烆垶姊洪棃娑辩叚濠碘€虫喘婵℃挳骞囬鐘殿啎闁诲孩绋掗…鍥儗瀹€鍕厱閻庯絻鍔岄埀顒佺箓椤曪絿鎷犲ù瀣潔濠殿喗锕徊鑺ョ妤ｅ啯鐓ユ繝闈涙閸ｈ銇勯敐鍛紞缂佽鲸甯楀鍕熼悜妯煎綆闂備礁鎼径鍥礈濠靛绠柛娑欐綑娴肩娀鏌曟径瀣闁稿﹥娲熷﹢渚€姊虹紒妯兼噧闁硅櫕鍔欓幃楣冨垂椤愵偅顔旈梺缁樺姇瀵爼藟閵忋倖鐓?0.01f 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ巻鍋撴潻婵嬫⒑闁偛鑻晶鎾煛鐏炲墽銆掗柍褜鍓ㄧ紞鍡涘磻閸涱厾鏆︾€光偓閸曨剛鍘搁悗鍏夊亾閻庯綆鍓涜ⅵ闂備浇顕栭崰鎾诲垂婵犳艾绠柣妯肩帛閸ゆ垶銇勯幒鍡椾壕婵犳鍠栭幖顐﹀煘閹达附鍊烽柤纰卞墯閹茶偐绱撴笟鍥ф珯缂佽尪娉曞Σ鎰版倷鐎靛摜鎳濋梺閫炲苯澧い鏇稻缁绘繂顫濋鈹炬櫊閺屾洘寰勯崼婵堜痪濡炪値鍋勭粔鎾煘閹达箑鐓￠柛鈩冾殘娴狀垳绱撴笟鍥ф珮闁搞劌鐖奸悰顔跨疀濞戞瑧鍔堕悗骞垮劚濡矂骞忛悜妯肩闁哄鍨甸幃鎴︽煟閻旀潙鍔﹂柟顖欑椤劑宕奸悢鍝勫箞闂備焦瀵х换鍌滄崲閹烘梻鐭撴い鏃堟暜閸?0.02f
            if (progress > 0.0f && progress < 0.02f) {
                // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎电濡介梺鍝勬噺缁诲牓寮婚弴鐔风窞婵炴垶锕╁ú顓犵磽娴ｅ搫校闁稿孩濞婇崺鐐哄箣閿旇棄浜归梺鍛婄懃椤︿即骞冨▎鎾粹拻?1.0, 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎电濡介梺鍝勬噺缁诲牓寮婚弴銏犻唶婵犲灚鍔栨晥闂備胶顭堥鎰椤忓牆钃熸繛鎴欏灩鍞銈嗘⒒閸樠囷綖椤忓牊鈷?1.0
                this.playSound(ModSounds.PRINT_LOOP.get(), 0.5f, 1.0f);
            }

            progress += 0.01f;

            // 2. 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゎ剦鍓氶惄顖氱暦閻旂⒈鏁嶆慨妯块哺閻掔偓淇婇悙顏勨偓鏍偋濡ゅ啫鍨濈€广儱鎳愰弳锕傛煛鐏炶鍔滈柣鎾存礈閳ь剙鍘滈崑鎾绘煃瑜滈崜鐔风暦閹达附鍊烽柛婵嗗閿涚喖姊洪悷鏉库挃缂侇噮鍨堕幃锟犲即閵忥紕鍘撻梺瀹犳〃缁€渚€寮抽悢鍏肩厓闁芥ê顦藉Σ铏圭磼鏉堛劌娴柛鈹惧亾濡炪倖甯掔€氼剟鐛姀锛勭闁瑰鍋熼幊鍛存煕濮楀棔閭慨濠冩そ瀹曟粓骞撻幒宥囧嚬缂傚倷娴囬褔宕弶鎴犳殾闁惧浚鍋嗛々鐑芥倵閿濆骸浜為柛?(BSOD) - 闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃秹锝炲┑瀣櫇闁稿矉濡囩粙蹇旂節閵忥絽鐓愰柛鏃€鐗犲畷鎴﹀Χ婢跺鍘搁梺鎼炲劗閺呮稑鐨梻浣虹帛鐢帡鏁冮妷褎宕叉繛鎴欏灩楠炪垺淇婇妶鍕妽鐎规洘濞婂娲传閸曨偒浠奸梺绋匡工閻忔繈锝?
            // if (!this.level().isClientSide && progress > 0.6f && progress < 0.8f) { ... }

            // 3. 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼槮闁搞劍绻冮妵鍕冀閵娧呯厐闂佹悶鍔嶇换鍫ュ蓟閿濆憘鐔封枎閹勵唲闂備焦鎮堕崝宀勫磹閹间焦绠掗梻浣侯焾缁绘宕戦幇鏉挎辈婵せ鍋撻柡灞界Х椤т線鏌涢幘瀵告噰鐎规洘鍔欓獮鎰償濠靛牏鐣鹃梻浣哥秺濡潡鎮為敃鍌氱柧婵犲﹤鎳愮壕钘壝归敐澶嬫锭闁诲浚浜铏规啑閵堝應鍋撳┑鍡╂綎缂備焦蓱婵挳鏌涘☉姗堥練缁绢厸鍋撻梻鍌欒兌椤牏鑺卞ú顏勭９婵犻潧妫涢弳锕傛偡濞嗗繐顏┑顖涙尦閺屾盯骞囬闂村濠电姰鍨洪悧鐘差潖婵犳艾纾兼慨姗嗗厴閸嬫捇鎮滈懞銉モ偓鍧楁煥閺冨牊鏆滈柛瀣尵缁厼鈽夊Ο璇叉闂佹椿鍘介悷鈺呭蓟閻斿吋鍊绘俊顖濇閸旂鈹戦悙鑼癁闁哄懐濞€瀵寮撮悢铏诡啎闂佺粯鍔﹂崜姘舵偟閺冨倻纾奸柣鎰靛墮閸斻倖绻涚涵椋庣瘈鐎殿喖顭烽幃銏ゆ偂鎼达絿鏆伴梻浣告惈椤︻垶寮插┑瀣缂備焦顭囬崢杈ㄧ節閻㈤潧孝闁稿﹤顭峰畷娲晲婢跺鍘搁悗鍏夊亾閻庯綆鍓涜ⅵ婵°倗濮烽崑鐐烘晝閵忕姷鏆︽俊顖欒閸熷懏銇勯弮鍌氬付閸烆垶姊婚崒姘偓椋庣矆娓氣偓楠炲鍨剧搾浣规そ閹垽鎼归柅娑氱憹闂備礁鎼粙渚€宕㈡總鍛婂珔?(缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亜顒㈡い鎰矙閺屻劑鎮㈤崫鍕戙垻绱掗幇顓ф畷濞ｅ洤锕俊鍫曞川椤撶喐顔夐梻浣告惈濡瑧鍒掗幘璇茶摕闁绘柨鍚嬮崐缁樻叏濡も偓濡瑩鎮鹃悜鑺モ拺缂佸顑欓崕宥夋煕婵犲啰澧遍柟骞垮灩閳藉濮€閻樿尪鈧灝鈹戦埥鍡楃仴妞ゆ泦鍥棄鐎广儱顦伴埛鎴犵磼鐎ｎ偒鍎ラ柛搴＄箲閵囧嫰骞嬪┑鎰枅濡ょ姷鍋涢崯顐︽偩閿熺姴绠ラ柧蹇ｅ亞閳ь剙顭峰Λ鍛搭敃閵忊€愁槱闂佺懓鐨烽弲婊呯矉閹烘绠氱憸澶愬绩?
            if (this.level().isClientSide) {
                // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣椤愯姤鎱ㄥ鍡楀⒒闁绘帊绮欓弻銈嗘叏閹邦兘鍋撻弽顐熷亾濮橆剦鐓奸柡宀嬬秮瀵噣宕掑顑跨帛缂傚倷璁查崑鎾愁熆鐠哄搫顦柛瀣崌瀹曟寰勬繝浣割棜闂傚倷绶氶埀顒傚仜閼活垱鏅堕悧鍫滅箚闁告瑥顦慨宥夋煙椤旂晫鎳呴柛鐘诧工铻ｉ弶鐐存緲椤ユ岸姊绘担鐟邦嚋缂佽鍊归〃銉╁箹娴ｇ鍤戝┑鐐村灦濮樸劎澹曟總鍛婄厓鐟滄粓宕滈悢椋庢殾濠靛倻顭堥悡鎴︽煃鏉炵増顦峰瑙勬礀铻栭柣姗€娼ф禒婊堟煟韫囨梻绠炵€规洘绻傞～婵嬵敇濠靛牏鐣炬俊鐐€栭崝褏绱為崱妞绘灁婵犲﹤鐗婇悡鏇㈡煃鏉炴壆鍔嶉柛銈呮喘閺岀喖顢欓懡銈囩厯閻庤娲忛崝宥囨崲濠靛绀嬫い鎰╁灮閻ゅ嫭绻濋悽闈浶ユい锝庡枤濡叉劙寮撮姀鐘碉紱闂佺粯鍔曢幖顐ゅ閸ф鐓曢柟閭﹀灠閻ㄦ椽鏌￠崱鎰偓婵嬪蓟濞戙垹鐒洪柛鎰典簴婵洭姊虹紒妯诲暗闁哥姵鍔楅幑銏犫攽鐎ｎ亜鐎銈嗗姂閸ㄥ綊锝炲畝鍕拺闁告繂瀚烽崕鎴︽煕閻樺磭澧电€殿喖顭烽幃銏㈠枈鏉堛劍娅栨繝鐢靛仦閸ㄥ爼鎮烽姣兼盯宕橀瑙ｆ嫼闁哄鍋炴竟鍡浰囬敃鍌涚厱濠电姴鍊归崑銉︻殽閻愭彃鏆欓柍璇查叄楠炴瑩宕橀埡鍌涚彍婵犵數鍋犻幓顏嗙礊閳ь剚銇勯弴鐔哄缂佸倹甯熼ˇ瑙勬叏婵犲偆鐓肩€规洘甯掗埢搴ㄥ箳閹存繂鑵愰梻鍌欒兌椤㈠﹤鈻嶉弴銏犵闁搞儺鍓欑粻鏍ㄧ箾瀹割喕绨婚幆鐔兼⒑鐎圭姵銆冮柤鍐茬埣钘濇い鏂跨毞閺€浠嬪箳閹惰棄纾归柟鎯у閻棗銆掑锝呬壕濡炪們鍨哄畝鎼佸蓟閸℃鍚嬮柛鈩冪懃鐢鏌ｉ悢鍝ョ煁缂侇喗鎸搁悾宄邦煥閸喎浜滈梺缁樻尭濮橈箓骞?
                double y = this.getY() + (this.getBbHeight() * progress);
                if (this.random.nextFloat() < 0.3f) {
                    this.level().addParticle(ParticleTypes.SMOKE, this.getX(), this.getY(), this.getZ(), 0, 0.05, 0);
                    this.level().addParticle(ParticleTypes.FLAME, this.getX() + (random.nextDouble()-0.5), this.getY(), this.getZ() + (random.nextDouble()-0.5), 0, 0.01, 0);
                }
// ... (婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓闁搞劌鍊块弻娑㈩敃閿濆棛顦ョ紓浣哄С閸楁娊寮婚悢鍏尖拻閻庣數顭堟俊浠嬫⒑閸濆嫭鍣虹紒璇插暣婵＄敻宕熼鍓ф澑闂佸湱鍋撻崜姘瀹€鍕拺缂備焦锚缁椻晜淇婇銏狀伃婵犫偓娓氣偓濮婅櫣绱掑Ο璇茬濠电偛顕崗姗€鐛Δ鍛亹缂備焦顭囬崢閬嶆煙閼圭増褰х紒杈ㄦ礃閺呫儵姊绘担鍛婃儓闁哄牜鍓熼幆鍕敍濮樼厧娈ㄩ梺鍦檸閸犳牗鍎梻渚€娼ч悧鍡椕洪妸銉㈡灃闁秆勵殕閳锋帒霉閿濆牆袚闁靛棗鍟撮幃瑙勬媴閸︻厼寮ㄩ悗娈垮枟閻擄繝骞冮埡鍐╁珰闁艰壈鍩栭幉浼存⒒娴ｇ懓顕滅紒璇插€胯棟濞寸姴顑呴弸浣糕攽閻樻彃顏痪鎹愭闇夐柨婵嗘处椤忕喎銆掑顓犫姇濞ｅ洤锕、娑橆潩椤戣棄浜鹃柤濮愬€栭～鏇㈡煙閹呮憼濠殿垱鎸抽幃褰掑炊閿濆懎鈷夐梺浼欑秬濞夋盯鈥旈崘顔嘉ч煫鍥ㄦ惄濞差參姊烘潪鐗堢グ妞ゆ泦鍥舵晪?

// ... (tickPrintLogic 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洟鎮烽幊濠傜秺閹晛顔忛鐓庡Η缂傚倸鍊哥粔鐢告偋閺団懇鈧妇鎹勯妸锕€纾梺缁樺灦钃遍柟鐑戒憾濮婅櫣绮欑捄銊ь唹缂備緡鍠楅幑鍥ь嚕鐠囨祴妲堥柕蹇婃櫆閺呮繈姊洪幐搴ｇ畵婵☆偅鐩棟闁靛／鍛紳婵炶揪绲捐ぐ鍐╃妤ｅ啯鈷戦柛娑橈工婵箓鏌涢悩鎰佹疁闁诡噯绻濆鎾偄閾忚鍟庨梻浣烘嚀椤曨參宕戦悢鐓庣疇闁告洦鍘剧壕鐣屸偓骞垮劚濡鎮橀幘顔界厸? ...

            } else {
                // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫆闁芥ê顦純鏇㈡⒒娴ｈ櫣銆婇柛鎾寸箞閹柉顦归柟顖氱焸楠炴绱掑Ο琛″亾閸偆绠鹃柟瀵稿剱娴煎棝鏌熸潏鍓х暠闁活厽顨婇悡顐﹀炊閵娧€濮囬梺缁樻尵閸犳牠寮婚敓鐘茬闁靛绠戦ˇ鈺侇渻閵堝懐绠冲┑鐐╁亾闂佸搫鏈粙鎴ｇ亙婵炶揪绲肩拃锕傚汲閿熺姵鈷戦梻鍫熺⊕閹兼劙鎮楀顓熺凡妞ゆ洩绲剧粋鎺斺偓锝庘偓顓滃姂閺屾洘寰勯崼婵堜患婵炲瓨绮庨崑鎾寸┍婵犲洤围闁告侗鍘藉▓鍫曟⒑缂佹鐭岀紒顕呭灡缁岃鲸绻濋崶顬囨煕閺囥劌骞栧┑鈥茬矙濮婃椽宕ㄦ繝鍕櫑缂備胶绮崹鍓佺矚鏉堛劎绡€闁搞儴鍩栭弲顒€鈹戦悩璇у伐闁瑰啿娴风划顓㈡晸閻樻枼鎷洪梺瑙勫劶婵倝寮柆宥嗙厱闁哄啠鍋撻柣妤冨█閻涱噣宕奸妷銉庘晠鏌曟径妯烘灍鐎点倖妞藉铏瑰寲閺囩偛鈷夊銈冨妼濡繈骞冮棃娑掓斀闁哥媭鍠楀Λ鍐箖閳哄懏顥堟繛鎴烆殕閸曞啴姊哄Ч鍥х労闁搞劎鏅幑銏犫攽鐎ｎ偄浠掑銈嗘磵閸嬫挻顨ラ悙鏉戠瑨閾绘牠鏌嶈閸撴稓鍒掔紒妯肩瘈婵﹩鍘奸埀顒傛暬閺岋綁濮€閻樺啿鏆堝┑鐐叉噺缁海妲愰幒鎾寸秶妞ゎ厽甯熼埀顒佸閹便劍绻濋崒銈囧悑閻庤娲樼敮鎺楀煝鎼淬劌绠ｉ柨婵嗘川瀹曞爼姊婚崒娆掑厡妞ゎ厼鐗撻、鏍川閺夋垹鐤囬柟鑲╄ˉ閳ь剙纾妶顐︽⒒閸屾瑧顦︽繝鈧柆宥呯？闁靛牆鎷嬪鏍喐閻楀牆淇柡?(闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃秹婀侀梺缁樺灱濡嫮绮婚悩缁樼厵闁硅鍔﹂崵娆戠磼閻橀潧鏋涙慨濠佺矙瀹曞爼顢楅埀顒侇攰闂備礁婀辨晶妤€顭垮Ο鑲╃焼闁告劦鍠楅悡蹇撯攽閻愭垵鍟顏呫亜閺冣偓濞茬喖寮婚敐鍡樺劅闁炽儱鍟挎潏鍛存⒑缁嬫鍎愰柟鐟版喘瀵鈽夐姀鐘插祮闂侀潧顭堥崕閬嶏綖椤忓嫧鏀?
                if (progress > 0.1f) {
                    // 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ巻鍋撶痪鎯ь煼閺岀喖鎮ч崼鐔哄嚒闂佺琚崝搴ㄥ箟閹间礁妫橀悹鎭掑妽濞堟儳顪冮妶鍡欏⒈闁稿孩鍔欏顐﹀礃椤旂晫鍘撻梻浣哥仢椤戝洭銆傞崣澶夌箚闁绘劘鍩栭ˉ澶愭煟閿濆妫戠紒顔界懅閹风娀鎮欓浣叉嫻闂佺懓鍢查幊鎰板箟閹绢喖绀嬫い鎾跺仜缂傛挸鈹戦悩鍨毄濠殿喚鏁婚、娆撳冀椤撶偟鐛ュ┑掳鍊曢幊蹇涘疾濠靛鐓冮柛婵嗗閸ｅ湱鐥幆褜鐓奸柡灞剧〒娴狅箓宕滆閻撳嫭绻濆▓鍨灈闁哥喎娼″﹢渚€姊虹紒妯诲碍婵炲鍏橀獮妤呮偐缂佹鍘介梺瑙勫礃濞夋稑鐡梻浣哥枃椤宕归崹顔炬殾闁圭儤鍩堝鈺呮煕韫囨挶浠氶柕澶堝劗閺€浠嬫煟閹邦剚鈻曢柛銈囧枛閺屾稖绠涢弬鍡╀邯閿濈偠绠涢弴鐘碉紲濠碘槅鍨甸崑鎰邦敊閺囥垺鈷戠紓浣姑慨锕傛煕閹炬潙鍝洪柟顔炬暬瀵挳鎮╅悽纰夌闯濠电偠鎻徊鑺ョ珶婵犲洤纾块煫鍥ㄦ煟娴滄粓鏌ㄩ弮鍥撶紒璺哄级閵囧嫰顢橀悙鏉戞灎濡炪們鍨哄Λ鍐ㄧ暦閻撳簶鏀介柛顐亜閺佹悂姊绘担绛嬪殭缂佺粯甯″畷鎴︽偐閸欏倹鐩畷鐔碱敇閻樿京鐟濋梻浣侯攰閹活亪姊介崟顖氱厱闁圭儤鍨熼弨浠嬫煟濡崵鍙€妞ゅ孩顨呴湁婵犲﹤瀚惌瀣磼缂佹銆掑ù鐙呯畵瀹曟帒顫濋敐鍛濠电娀娼уΛ娑㈠汲閿曞倹鐓涘璺猴功濮樸劍淇婇幓鎺斿闁逛究鍔岄～婊堝幢濡も偓鐎涳絽鈹戦悙璺轰汗闁哥姴閰ｉ崺鐐哄箣閿旇棄浜圭紓鍌欑劍钃遍梺娆惧幖椤啴濡堕崱妤冧淮闂佺娅曢崝娆撶嵁婢舵劕绠绘い鏃囧Г濞呭洭姊虹粙鎸庢拱缂佸鎹囧畷銏ゆ偨閸涘﹦鍘介柟鍏肩暘閸ㄥ鍩婇弴鐔翠簻妞ゆ挾鍋炲婵堢磼椤旂⒈鐓煎┑锛勫厴閺佸倻鎹勯妸褏鏆板┑锛勫亼閸婃牠鎮уΔ鍐ㄦ瀳鐎广儱锛嗘径鎰潊闁靛牆妫涢崢?1.5 闂?(缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋敐鍛婵＄偑鍊戦崹娲偋閻樿尙鏆﹂柕濞炬櫓閺佸秵绻濇繝鍌涘櫧闁告濞€濮婅櫣鎷犻幓鎺濆妷缂備礁顑嗙敮锟犲灳閿曞倸鐐婃い鎴︽暜閸嬫捇宕ㄩ弶鎴ｆ憰闂侀潧顧€婵″洭宕㈤幖浣光拺闁硅偐鍋涢崝妤呮煛閸涱喚娲寸€殿喖鎲￠幆鏃堟晲閸モ晪绱查梻浣告啞閹搁绮堟担鍦浄鐟滄棃寮婚悢鍏煎殤妞ゆ帒顦遍崝鎼佹⒑娴兼瑧绋荤紒璇茬墦瀹曟椽鍩€椤掍降浜滈柟鐑樺灥閳ь剚鎮傚畷鐟扳攽鐎ｎ偆鍘撻梺鍛婄箓鐎氼參宕抽崷顓犵＜闁绘鏁哥敮娑㈡煏閸パ冾伃鐎殿噮鍣ｅ畷鍫曗€﹂幋鐑嗘闂傚倷绶氶埀顒傚仜閼活垱鏅舵导瀛樼厱闊洦妫戦懓璺ㄢ偓娈垮枦椤曆囧煡婢舵劕顫呴柍鈺佸暞閻濇洟姊洪懡銈呅㈡繛璇х畳閵囨劙宕橀鍡曠瑝闁荤喐鐟ョ€氼喚绮?
                    List<LivingEntity> pushTargets = this.level().getEntitiesOfClass(LivingEntity.class, this.getBoundingBox().inflate(1.5));

                    for (LivingEntity e : pushTargets) {
                        // 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰鍐€闁靛ě鍛帎婵?闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箻閺岀喓绱掗姀鐘崇彯闂佽桨绀佺€氫即寮诲☉妯锋婵炲棙鍔楃粙鍥⒑濮瑰洤鈧倝宕伴弽顓熺畳闂備胶顭堢换鎰板触鐎ｎ剛绀婇柟杈鹃檮閻撴盯鎮楅敐鍌涙珖缂佹劖妫冮弻锛勪沪閻愵剛顦伴悗瑙勬礈閸樠囧煘閹达箑绠涙い鎾愁檧婵″洨妲愰幘瀛樺闁圭粯甯婃竟鏇㈡⒒娴ｈ櫣銆婇柛鎾寸箚閹筋偊姊洪崨濠勬噧缂佺粯鍨块獮鍫ュΩ閵夊孩妫冮崺鈧い鎺嗗亾閾荤偞淇婇妶鍛櫧鐎规挷绶氶弻鈥愁吋閸愩劌惟婵炲瓨绮嶇划鎾诲蓟閺囥垹閱囨繝闈涙搐濞呫倝姊洪幖鐐测偓鏇灻洪銏犺摕闁挎稑瀚▽顏堟煕閹炬瀚崹杈ㄤ繆閵堝洤啸闁稿绋戠叅妞ゆ搩娼块埀顑跨椤粓鍩€椤掑嫬绠栭柍鍝勬噹缁€鍐煕濞嗗浚妲虹憸閭﹀灡缁绘繈鎮介棃娴躲儵鏌℃担瑙勫€愮€规洘鍨甸埥澶愬閳ュ厖缃曞┑鐘垫暩婵潙煤閵堝鍨傞柛宀€鍋為悡鏇犳喐鎼淬劊鈧啴宕ㄧ€涙ê鐝旈梺缁樻煥閸氬鎮￠弴鐔虹闁瑰瓨绻傞懜鍦偓娈垮枤閸嬫挾鎹㈠☉姘剨闁哄秲鍔嶉悵姘舵倵濞堝灝鏋涢柣鏍帶閻ｇ兘鎮℃惔妯活潔濠碘槅鍨拃锕傛倵鐎涙绡€闁汇垽娼ф禒婊堟煟濡も偓鐎氭澘鐣风憴鍕浄閻庯綆浜ｉ幗鏇㈡⒑閺傘儲娅呴柛鐕佸亞濞嗐垽鎮欓悜妯煎幈闂佹枼鏅涢崣鎰板箣閿旇棄浠ч梺鍝勫€哥花閬嶅绩娴犲鐓熼柟浼村亰閺夋椽鏌涢妶鍜佸剳缂佽鲸甯￠幃鈺呮惞椤愩垻锛撻梻浣虹帛娓氭宕板Δ鍛畾闁哄啫鐗嗘儫闂侀潧顦Ч鐐哄礃閸撗冩暩闂佽崵濮惧銊ф媰閿曞倸纾块柟閭﹀幘缁?
                        if (isImmuneToPush(e)) {
                            continue; // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犖ч柛灞剧煯婢规洖鈹戦鐭亜鐣烽鍕偍閻庣數纭堕崑鎾舵喆閸曨剛顦ョ紓鍌氱Т閿曨亪鐛崘顔藉仼鐎光偓閳ь剟鎯屽▎鎾寸厱妞ゎ厽鍨甸弸鐔兼煕鎼搭喕绨肩紒缁樼箞閹粙妫冨ù韬插灲閺屻劑寮村Ο琛″亾濠靛棛鏆﹂柡澶嬵儥濞尖晠鎮规ウ鎸庮仩闁哄苯鐗撳娲川婵犲嫧妲堥梺瀹︽澘濮傞柟顕嗙節瀵挳鎮㈤搹璇″晭闂備胶纭堕崜婵嬫晪闂佸憡蓱閹倿寮婚悢鍛婄秶濡わ絽鍟宥夋⒑?婵犵數濮烽弫鍛婃叏閹绢喗鍎夊鑸靛姇缁狙囧箹鐎涙ɑ灏ù婊呭亾娣囧﹪濡堕崟顓炲闂佸憡鐟ョ换姗€寮婚敐澶婄闁挎繂妫Λ鍕磽娴ｆ彃浜鹃梺绋挎湰缁嬫帡宕ｈ箛鏂剧箚闁绘劙顤傞崵娆徝瑰鍫㈢暫婵?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼槮闁搞劍绻冮妵鍕冀椤愵澀鏉梺閫炲苯澧柛鐔告綑閻ｉ攱绺界粙璇俱劑鏌曟竟顖氭噺閻庮噣姊婚崒娆掑厡闁硅櫕鎸婚弲鍫曟偩鐏炶棄鐏婂銈嗙墱閸嬫稓澹曟繝姘厓閺夌偞澹嗙€靛ジ鏌￠崘銊у闁哄懏鐓￠弻娑樷槈閸楃偛绠哄┑鐐茬墱閸樺墽妲愰幒鏃傜＜闁靛繒濮寸粻浼存⒑缁嬫鍎愰柟鐟版搐椤繒绱掑Ο璇差€撻梺鍛婄☉閿曘儵宕曢幘鏂ユ斀闁绘劙顤傞崵瀣磼閻樺啿鐏撮柨婵堝仜閳规垹鈧綆鈧厸鏅濋幉姝岀疀濞戞瑥鍓归梺鐟板⒔缁垶鎮″▎鎴犵＝濞达綁娼ч悘鈺呮煛鐎ｎ剙鏋涢柡宀嬬秮楠炴﹢宕￠悙鎻掝潥缂傚倷鑳剁划顖炴儎椤栫偟宓侀悗锝庡枟閸婂鏌涢埄鍐噧濠殿喗妞藉缁樻媴閾忕懓绗￠柣銏╁灣閸嬨倕鐣峰Δ鈧～婊堝焵椤掆偓椤曪絾绻濆顓熸珳婵犮垼娉涢敃锕傤敇閸濆嫷娓婚柕鍫濇婢ч亶鏌涚€ｎ剙浠辨い銏℃尭椤撳ジ宕ㄩ鍛澑闂備胶绮崝娆忣焽瑜忛弫顕€鎳滈悙閫涚盎濡炪倖鎸鹃崑娑樜ｆ繝姘厽闁挎繂娲ら崢鎾煙閾忣偆鐭婇柍缁樻崌楠炴劙鐛銊ユ处閻撴瑩鏌ら崷顓烆暭鐟滄妸鍛＝鐎广儱鎳忛ˉ婊堝础鏉堚斁鍋撻悷鏉款仾濠㈢懓顑夊銊︾鐎ｎ偆鍘介梺褰掑亰閸樼晫绱為幋锔界厽闊洢鍎抽悾鐢告煛瀹€鈧崰鎾跺垝濞嗘挸绠伴幖娣灩閺嬫垹绱撻崒娆戣窗闁哥姵顨呰灋闁告劦鍠栫粻鏍归悩宸剰闁搞劌鍊归妵鍕箛閸撲胶蓱濡炪倖鏌ㄥú顓㈠蓟閿濆鍋勯柛婵勫劤閻撳倹绻濋埛鈧崟鍨暭闂佽桨绶￠崰鏍亙闂佸憡渚楅崢楣冨蓟?
                        }

                        // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑鏅悷婊冪箻閹崇偤鏌嗗鍡楁異闂佸疇妗ㄩ懗鍓佺驳韫囨梻绡€闁汇垽娼ф牎闂佺粯妫忛崜娑氭閻愬搫鍐€鐟滄粓鎮㈤崱娑欏仯閺夌偞濯介鐔兼煟閹垮啫澧撮柡宀嬬秮楠炴帒顓奸崶鈺冨幆闂備礁鎼張顒傜矙閹达箑鐓″鑸靛姇绾偓闂佺粯鍔曢顓熺閺嶎厽鈷掑ù锝勮閻掔偓銇勯幋婵嗘殻鐎规洝顫夌粋鎺斺偓锝庝海閹芥洖鈹戦悙鏉戠仸缂侇喖閰ｉ幃鍧楀焵椤掑嫭鈷戦柛婵嗗瀹告繈鏌涚€ｎ偆鈯曠紒鍌涘笒椤粓鍩€椤掆偓椤繐煤椤忓嫮顔呴梺鍏间航閸庢煡寮抽悩娴嬫斀闁宠棄妫楁禍婊堟煕閻斿憡灏﹂柣娑卞櫍瀹曟﹢顢旈崨顓狅紡闂佽崵鍋炵粙鍫ュ礈濠靛缍栫€广儱鎳夐弨浠嬫煃閽樺顥滈柣蹇ョ悼缁辨帡顢氶崨顓犱桓濡ょ姷鍋涚换姗€寮婚崱妤婂悑闁糕剝鐟ラ獮妤呮⒒娓氣偓濞佳呮崲閸℃稑鐤炬繛鎴欏灪閸婂爼鏌ㄥ┑鍡╂Ч闁绘挻鐟╅弻褑绠涢敐鍛凹閻庤娲栭張顒勫Φ閸曨垰顫呴柍銉ュ暱閹界敻姊烘潪鎵妽闁告梹鐗曢銉╁礋椤掑倻鐦堥梺鍛婃处閸嬪嫯顤傚┑鐘殿暜缁辨洟宕戦幋锕€纾归柡宥庡亝閺嗘粓鏌熼悜妯荤厸闁稿鎸搁～婵嬫偂鎼粹槅娼剧紓鍌欑贰閸犳牠鈥﹂悜钘夌疇闁哄稁鍘奸悡姗€鏌熼鍡楀€搁ˉ姘繆閵堝洤啸闁稿鐩幃妯衡攽鐎ｎ亞顦┑顔筋焾閸╂牠宕愰崹顐ｅ弿婵☆垳鍘х敮鍫曟煛鐎ｃ劌鈧妲?
                        // 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋敐鍛婵＄偑鍊戦崹娲偋閻樿尙鏆﹂柕濞炬櫓閺佸秵绻濇繝鍌涘櫧闁告濞€濮婅櫣鎷犻幓鎺濆妷缂備礁顑嗙敮锟犲灳閿曞倸鐐婃い鎴︽暜閸嬫捇宕ㄩ弶鎴ｆ憰闂侀潧顧€婵″洭宕㈤幖浣光拺闁硅偐鍋涢崝姗€鏌涙惔銊ゆ喚闁诡喗锕㈤崺锟犲礃椤忓棴绱查梻渚€鈧偛鑻晶瀵糕偓瑙勬礈閸犳牠銆佸☉姗嗙叆闁告劑鍔庣€靛ジ姊婚崒娆戝妽闁诡喖鐖煎畷鏇㈩敍閻愯尙顦悗骞垮劚濞诧綁鎮炴繝鍥ㄧ厱妞ゎ厽鍨垫禍婵嬫煕濞嗗繒绠婚柡灞诲妼閳规垿宕卞Ο鐑橆仱濠电姭鎷冮崟顒傤槹闂佸搫鑻粔褰掑箰婵犲啫绶炴俊顖滃劦閺嬪懏淇婇妶鍥ラ柛瀣仱閺佸啴濮€閵堝啠鍋撴担绯曟婵妫欓崓闈涱渻閵堝棗濮傞柛鈺佸铻炴繝濠傜墛閳锋帡鏌涚仦鎹愬闁逞屽墰閸忔﹢骞婂Δ鍛濞达絿顭堥悘濠傤渻閵堝棛澧遍柛瀣〒缁牊寰勭€ｂ晝绠氶梺闈涚墕閹冲繘宕抽崷顓犵＜闁绘﹢娼ч埢鍫ユ煛瀹€鈧崰鏍嵁閸℃凹妲鹃梺鍦櫕婵炩偓闁哄本绋戦埢搴ょ疀閺囩媭鍟嬮梻浣虹帛閹尖晠宕戞繝鍌滄殾闁割偅娲栨儫閻熸粌顦伴幈銊╁炊椤掍讲鎷?(0.1 -> 0.08)闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弮鍫熸殰闁稿鎸剧划顓炩槈濡娅ч梺娲诲幗閻熲晠寮婚悢鍛婄秶濡わ絽鍟宥夋⒑缁嬪灝顒㈡い銊ワ躬瀵鈽夊顐ｅ媰缂傚倷闄嶉崹鐟扳枔婵傚憡鈷戦柟绋挎捣缁犳挻绻涚拠褍顩柍褜鍓氱喊宥咁潩閵娾晛鐒垫い鎺戝€归崵鈧繝銏㈡嚀閿曨亜鐣烽弶璇炬棃鍩€椤掑嫨鈧懏绺界粙璇锯晠鏌嶉崫鍕偓鐢稿箯濞差亝鈷掗柛灞炬皑婢ф稓绱掔€ｎ偅灏电紒顔款嚙椤繈鎳滈悽闈涘笚闁荤喐绮嶇划鎾崇暦濠婂喚娼╅弶鍫厛閸嬨劑姊虹紒妯哄闁圭⒈鍋婇幃鈥斥槈閵忥紕鍘卞┑鐐村灥瀹曨剟寮搁妶澶嬬厱婵☆垳鍘ф禍鍓х磼缂佹娲寸€殿喖鐖奸獮瀣攽閸パ€鍋撻鐐粹拺闁煎鍊曢弳鈧梺鎼炲劘閸斿本绂掓總鍛娾拺闁告稑顭▓姗€鏌涚€ｎ偄濮嶇€殿喓鍔戦幊鐐哄Ψ閿濆嫮鐩庨梻浣告惈閸燁偄煤閵堝棛顩查柛锔诲幘绾惧ジ鏌ｅΟ鍏兼毄閻㈩垱绋掗妵鍕Ω閿濆懎濮﹂梺璇″枟閻熲晠宕洪埄鍐╁鐎瑰嫰鍋婂Λ婊堟⒒閸屾艾鈧悂宕愭搴ｇ焼濞撴埃鍋撴鐐寸墵椤㈡洟鍩涘顓熴仢濠碘剝鎮傞崺鈩冩媴閾忕懓鐐婇梻浣烘嚀閸氬鎮鹃鍫濈鐎广儱顦崥褰掓煕椤愮姴鐏柛鐘冲姍閺岋絽螖閳ь剟鎮ч崱娆戠當婵鍩栭悡鐔兼煙閹呮憼缂佲偓鐎ｎ喗鐓涚€光偓閳ь剟宕伴弽顓炵畺婵犲﹤鍚橀悢鐑樺珰闁肩⒈鍓﹂弳鈥斥攽閿涘嫬浜奸柛濠冨灴瀹曟洟鏌嗗搴㈡櫈婵犮垼鍩栭崝鏇犵不閺嶎灐褰掓偐瀹割喖鍓鹃梺杞扮缁夌數鎹㈠┑瀣棃婵炴垶鐟ч妶鈺傜箾鐎电袥闁哄懐濮撮～蹇撁洪鍛姷闂佺粯鍔樼亸顏嗏偓姘緲椤儻顦茬€殿喖鐖兼俊鐢稿礋椤栵絾鏅濋梺闈涚箚閺呮粓鍩㈤崼銉﹀€甸悷娆忓缁€鍐╃箾閸欏鐒界紓鍌涙崌閹儳鐣濋埀顒勬儗濞嗘挻鍋ｅ〒姘煎灣閸樻稒淇婇弻銉︽暠濞ｅ洤锕幃娆擃敂閸曘劌浜鹃柡宥庡幗閸嬪绻濇繝鍌滃缁炬儳顭烽弻锝夊箛椤掍焦鍎撻梺?
                        if (!e.isShiftKeyDown()) {
                            e.push(0, 0.08, 0);
                        }
                    }
                }
            }

            // ... (tickPrintLogic 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洟鎮烽幊濠傜秺閹晛顔忛鐓庡Η缂傚倸鍊哥粔鐢告偋閺団懇鈧妇鎹勯妸锕€纾梺缁樺灦钃遍柟鐑戒憾濮婅櫣绮欑捄銊ь唹缂備緡鍠楅幑鍥ь嚕鐠囨祴妲堥柕蹇婃櫆閺呮繈姊洪幐搴ｇ畵婵☆偅鐩棟闁靛鏅滈悡鐔兼煟閺傛寧鎲搁柟铏礈缁辨帡鎮╅搹顐㈢３闂佺粯渚楅崳锝咁嚕娴犲惟闁挎柨澧借倴闂傚倷绀侀幉锟犲箰閸℃稑绀嬫い鎯点倗绠烽梻? ...

            // ... (婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓闁搞劌鍊块弻娑㈩敃閿濆棛顦ョ紓浣哄С閸楁娊寮婚悢鍏尖拻閻庡灚鐡曠粣妤呮⒑鏉炴壆顦﹂悗姘煎墴閳ワ妇鎹勯妸锕€纾繛鎾村嚬閸ㄦ娊宕ｉ弴銏♀拺缂備焦锚缁椻晜淇婇銏狀伃婵犫偓娓氣偓濮婅櫣绱掑Ο璇茬濠电偛顕崗姗€鐛Δ鍛亹缂備焦顭囬崢閬嶆煙閼圭増褰х紒杈ㄦ礃閺呫儵姊绘担鍛婃儓闁哄牜鍓熼幆鍕敍濮樼厧娈ㄩ梺鍦檸閸犳牗鍎梻渚€娼ч悧鍡椕洪妸銉㈡灃闁秆勵殕閳锋帒霉閿濆牆袚闁靛棗鍟撮幃瑙勬媴閸︻厼寮ㄩ悗娈垮枟閻擄繝骞冮埡鍐╁珰闁艰壈鍩栭幉浼存⒒娴ｇ懓顕滅紒璇插€胯棟濞寸姴顑呴弸浣糕攽閻樻彃顏痪鎹愭闇夐柨婵嗘处椤忕喎銆掑顓犫姇濞ｅ洤锕、娑橆潩椤戣棄浜鹃柤濮愬€栭～鏇㈡煙閹呮憼濠殿垱鎸抽幃褰掑炊閿濆懎鈷夐梺浼欑秬濞夋盯鈥旈崘顔嘉ч煫鍥ㄦ惄濞差參姊烘潪鐗堢グ妞ゆ泦鍥舵晪?

            // 4. 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑鏅悷婊冪Ч濠€渚€姊虹紒妯虹伇婵☆偄瀚划濠氭偐缂佹鍘甸梺纭咁潐閸旓箓宕靛▎鎾村€垫慨姗嗗墻濡插綊鏌曢崶褍顏鐐村浮楠炲鈹戦幇顏呭亝闂傚倷鐒﹂幃鍫曞礉瀹€鍕９鐟滅増甯掔粻鐐烘煏婵炲灝鍓婚柣鏃傚帶缁犱即骞栨潏鍓хシ闁逞屽墯閸旀妲愰幘瀛樺闁圭粯甯婃竟鏇㈡⒒娴ｈ櫣銆婇柛鎾寸箘缁瑩骞掑Δ浣镐簵闂婎偄娲︾粙鎺楁偂閺囩喆浜滈柟鏉垮閹偐绱掗悩宕囧⒌闁哄本鐩弫鎰板礋椤撶姷鍘梻?
            if (progress >= 1.0f) {
                progress = 1.0f;
                setPrintState(0); // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎺嶇劍椤斿洭姊绘担鍛婅础闁稿簺鍊濆畷闈涱潩椤戠偞妞介、鏃堝川椤旂晫褰囬梻鍌欑窔閳ь剛鍋涢懟顖涙櫠閹绢喗鐓欐い鏇楀亾缂佺姵鐗犻獮鍐煥閸喎鐧勬繝銏ｆ硾鐎涒晠骞夋导瀛樷拻濞撴埃鍋撴繛浣冲泚鍥敇閵忕姷锛熼梺瑙勫劶濡嫮澹曡ぐ鎺撶厽闁归偊鍠栭崝瀣煃闁垮鐏╃紒杈ㄦ尰閹峰懏鎱ㄩ幋顓濈凹闁逛究鍔戝畷濂稿Ψ閿旀儳骞嶆俊鐐€栭悧妤€顫濋妸鈺傚€块柛婵勫劗閸嬫挾鎲撮崟顒傤槰缂備浇顕ч悧鎾崇暦濞差亜鐒垫い鎺嶉檷娴滄粓鏌熼悜妯虹仴妞ゅ浚浜弻锝夊箻鐠虹儤鐏堥梺鍝勬湰濞叉繄绮诲☉娆戠瘈闁告劏鏅濊ぐ鍛存⒒娴ｇ瓔鍤欑紒缁樺笚缁绘盯鍩€椤掑嫭鐓涚€光偓閳ь剟宕伴弽顓炵疇闁绘劕鎼敮閻熸粌绻橀幃鈩冪瑹閳ь剙顫忓ú顏呯劵婵炴垶鍩冮弫鈧梻浣告啞濮婂綊宕归崸妤佸仒妞ゆ洍鍋撶€殿喕绮欐俊鎼佹晝閳ь剟顢撻幘缁樼厽闁绘柨鎽滈幊鍐倵濮樼厧寮い?
                // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗霉閿濆浜ら柤鏉挎健濮婃椽顢楅埀顒傜矓閻㈢绠氶柣鎰惈缁犺绻涢敐搴″濠碘€炽偢閺屾稓浠︾拠鎻掝瀳闂傚洤顦甸弻锝呂熼悜妯锋灆闂佺楠哥换鎴炵┍婵犲浂鏁冮柨娑崇秵娴滎亜锕㈡笟鈧娲箰鎼达絿鐣甸梺缁橆殔鐎氫即宕洪埀顒併亜閹达絾顥夊ù婊堢畺濮婄粯鎷呮笟顖滃姼濡炪倖鍨靛Λ婵嬬嵁閹达箑鐐婃い鎺嗗亾缂佺姵鐗犻弻锝夊箣閿濆憛鎾绘煕鐎ｎ亶鍎旈柡灞剧洴椤㈡洟濡堕崨顔锯偓楣冩煟鎼淬垻顣插┑鐐诧工椤繒绱掑Ο璇差€撻柣鐔哥懃鐎氼剚绂掗埡鍛拺闁告稑锕ラ悡銉х磼婢跺灏﹂柟顔藉劤閳规垿宕奸姀銏㈠幆闂佽崵濮村ú銊╁磻閹剧粯鍎庢い鏍ㄦ皑閺嗭箓鏌曟繛褉鍋撻柛瀣尭閳藉鈻嶉搹顐㈢伌鐎规洘娲熼、鏃堝礋閸偄鐦滈梻渚€娼ч悧鍡椢涘Δ浣瑰弿鐟滃繒妲愰幒妤€钃熼柕澹懏姣囬梻?
                this.playSound(SoundEvents.EXPERIENCE_ORB_PICKUP, 1.0f, 1.0f);
                // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳婀辩槐鎺斺偓锝庡亾缁扁晜绻涘顔荤盎閸ユ挳姊洪崨濠傛惛闁稿﹥鐗曢—鍐嚍閵夈倗绠氶梺鍓插亝濞叉牠鎮欐繝鍐︿簻妞ゆ挾鍠庨悘锔剧磽瀹ュ棭娈滄慨濠勭帛閹峰懏绗熼娑欐殲闂備浇顫夊鎸庣閻愰潧鍨濆┑鐘宠壘缁狅絾绻濋崹顐㈠闁哄懐濮撮埞鎴︽偐缂佹ɑ閿銈嗗灥濡繈骞冮檱缁犳盯骞橀娑欐澑闂備胶绮崝妯间焊濞嗘劗顩烽柕蹇嬪€栭悡鏇㈡煛閸愶絽浜剧紓渚囧枛濞村嘲危?(闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柤纰卞墻濡茬兘姊绘担鍛婃儓缂佸绶氬畷妤€鈻庨幇顕呮锤閻熸粎澧楃敮妤呮偂閺囥垺鐓欏ù鐓庣摠濞懷囨煛鐎ｎ偆娲撮柡灞剧☉椤繈骞囨担鍦Х闂備線娼уú銈団偓姘緲椤曪綁寮堕幊铏閸┾偓妞ゆ帊鑳堕々鎻捨旈敐鍛殲闁?
                if (!this.level().isClientSide) {
                    ((ServerLevel)this.level()).sendParticles(ParticleTypes.EXPLOSION, this.getX(), this.getY()+1, this.getZ(), 1, 0, 0, 0, 0);
                    // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈢粯淇婇悙顏勨偓鏍偋濠婂牆纾绘繛鎴炴皑閻棝鏌涢銈呮灁缂佺娀绠栭弻娑㈠焺閸忊晜鍨规禍鎼侇敇閵忥紕鍘搁柣搴岛閺呮繈宕濆鍥╃＜缂備焦顭囩粻鏍磼缂佹绠炵€规洘甯掗…銊╁礃閻愵剚鐦掔紓鍌氬€搁崐鐑芥嚄閼搁潧鍨旈悗闈涙憸缁€濠傘€掑锝呬壕閻庢鍠栭…鐑藉箖閵忋倕绀傞柤娴嬫櫅婵椽姊绘担鐟邦嚋婵炴彃绉瑰畷鎴﹀箻閹颁胶鍞甸悷婊勭矒瀹曟澘螖閸涱厙锕傛煕閺囥劌鐏遍柡浣稿暣閺屾洟宕煎┑鍥ф櫧闂侀潧顦弲婊堟偂閻斿吋鐓忓鑸得弸娆撴⒑椤撗冪仭闁靛洤瀚版慨鈧柍钘夋閸旂顪冮妶蹇涙闁绘搫绻濆濠氭晬閸曘劌浜鹃柨婵嗘噽閸╋絾淇婄紒銏犳珝闁?
                    if (this.ownerUUID != null) {
                        Player p = this.level().getPlayerByUUID(this.ownerUUID);
                        if (p != null) p.displayClientMessage(Component.literal("System online: frame assembly complete."), true);
                    }
                }
            }
        }



        // [闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼槮闁搞劍绻冮妵鍕冀椤愵澀姹楅梺閫炲苯澧剧紒鐘虫尭閻ｉ攱绺界粙璇俱劍銇勯弮鍥撴繛鍛崌濮婄粯鎷呴崨濠呯婵犫拃鍕垫當妞ゎ厼鐏濊灒闁兼祴鏅欑粭?3] 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亜顒㈡い鎰矙閺屻劑鎮㈤崫鍕戙垻鐥幆褜鐓奸柡灞剧洴瀵挳濡搁妷銏犱壕闁绘ɑ绁村Σ鍫熶繆椤栨稓鐭嬫俊顐㈠暙閻ｇ兘濡搁埡濠冩櫍闂佺粯锚閻忔艾袙閸パ€鏀介柣妯虹仛閺嗏晛鈹戦鑺ュ唉闁轰礁鍟存俊鑸靛緞鐎ｎ亙缃曢梻浣虹《閸撴繄绮欓幒妤€纾圭€瑰嫭澹嬮弨浠嬫煟濡搫绾у璺哄閺岋綁骞樼捄鐑樼亪闂佸搫鐬奸崰鏍蓟閸ヮ剚鏅濋柍褜鍓氶弲鑸靛鐎涙鍘甸梺浼欑到閼活垶鍩㈤崼銉︾厸?(Recycling)
        else if (state == 3) {
            progress -= 0.02f; // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁逞屽墾缁犳挸鐣锋總绋课ㄩ柨鏃囧Г閻濇牠姊绘笟鈧褔鏁嶈箛娑樼妞ゆ帊绶￠崬鍫曟⒒閸屾瑦绁版繛澶嬫礋瀹曚即骞樼€涙ê寮块梺鍦檸閸犳宕愰崸妤佺厱妞ゎ厽鍨垫禍鏍瑰鍕煉闁哄瞼鍠愬蹇涘礈瑜忚摫婵＄偑鍊戦崕閬嵥囬鐐寸畳婵犵數濮撮敃銈夋偋韫囨稒鍋╅柣鎴炆戦崣蹇撯攽閻樻彃顏悽顖涚〒缁辨帒螖閸愩劍鐏堥悗瑙勬礃閸庡ジ藝鏉堚晝纾奸柕濞垮€楅惌娆愭叏婵犲啯銇濈€规洦鍋婃俊鐑藉Ψ閹扳晛鐏紒缁樼〒閳ь剛鏁搁…鍫ュ储閹绢喗鐓曢柍瑙勫劤娴滅偓淇婇悙顏勨偓鏍暜閹烘纾圭憸鐗堝笒閸氬綊鏌嶈閸撶喎顫忛崫鍕懷囧炊瑜夐崑鎾诲即閻忕粯妞芥俊姝岊槻闁搞劍绻堥幃褰掑炊閵娧佸仦濠碘剝褰冮悧鎾诲蓟閺囷紕鐤€濠电姴鍟悵鏇㈡⒑閸濆嫭鍣虹紒璇茬墕椤繐煤椤忓嫮顔囬柟鑹版彧缁插搫危閸儲鐓熼幖娣灩閸濇椽鏌￠埀顒佹綇閳规儳浜鹃梻鍫熺◤閸嬨垻鈧娲栭悥濂搞€佸Δ浣瑰闁告瑥顦?

            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼槮闁搞劍绻冮妵鍕冀椤愵澀鏉梺閫炲苯澧柛鐕佸灠椤曘儵宕熼姘辩杸闂佸憡鎸烽懗鍫曞煟閵堝應鏀介柣姗嗗枛閻忛亶鏌涢埡鍌滃⒌鐎规洘绻堝鎾閳ュ厖鐥┑掳鍊х徊浠嬪疮椤栫偞鍋傞煫鍥ㄦ惄閻斿棝鎮归搹鐟板妺妞ゃ儳鍋炵换娑㈠川椤撶噥妫﹂梺鍝勭焿缁绘繂鐣烽鍛缂佸顑欏浠嬫⒒娓氣偓閳ь剚绋撻埞鎺楁煕閺傝法鐒搁柨婵堝仜椤劑宕煎┑鍡氣偓鍨攽鎺抽崐鎰板磻閹炬番浜滄い鎰靛亗闁垱鎱ㄦ繝鍛仩缂侇喗鐟╅獮鎰償閿濆棗澧ら梻鍌欑劍閹爼宕曢鐐茬閹兼番鍔岄崒銊╂⒑椤掆偓缁夌敻藟婵犲啨浜滈柟鎵虫櫅閻忣亪鏌熼崗鐓庡闁靛洤瀚伴獮瀣攽閸パ勭暬闁诲氦顫夊ú妯兼崲閸喍绻嗛柤鎼佹涧缁剁偤鎮楅敐搴″妤犵偞顨嗘穱濠囨倷椤忓嫧鍋撻弽顓炵濡わ絽鍟粣妤呭箹濞ｎ剙濡介柛濠傜埣閺岀喓绱掗姀鐘崇亶闂?
            if (this.level().isClientSide) {
                this.level().addParticle(ParticleTypes.PORTAL, this.getX(), this.getY() + 1, this.getZ(), (random.nextDouble()-0.5), (random.nextDouble()-0.5), (random.nextDouble()-0.5));
            }

            if (progress <= 0.0f) {
                progress = 0.0f;
                if (!this.level().isClientSide) {
                    // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缂佺姷濞€閺岀喖骞戦幇闈涙缂備胶濮鹃～澶愬Φ閸曨垰绠涢柛銉憾閸ゆ瑦绻涘顔煎籍闁绘侗鍠楅幆鏃堝Ω閿曗偓閻у嫭绻濋姀锝嗙【闁活剙銈稿铏鐎涙ǚ鎷绘繛鎾村焹閸嬫挻绻涙担鍐叉处閸嬪鏌涢埄鍐巢闁搞儺鍓﹂弫宥夋煟閹邦厽缍戦柍褜鍓欓崲鏌ュ煘閹达附鍋愰柛娆忣槸椤︹晠姊虹紒妯诲暗闁哥姵鐗犲濠氭偄閸忚偐鍔烽梺鎸庢磵閸嬫挸顭胯閸楁娊寮婚悢鍏煎仼閻忕偠袙閺嬪懘姊洪崫鍕効缂佺粯绻傞悾鐑芥焼瀹ュ懐鍘搁梺閫炲苯澧撮柡灞芥喘椤㈡盯鎮欑€电骞愰梺璇茬箳閸嬬娀顢氳閸┾偓妞ゆ帊鑳舵晶杈╃磼椤曞懎寮柟顔哄灮閸犲﹥娼忛妸锔界彨濠电姵顔栭崰妤呮晪閻熸粍婢橀ˇ闈涚暦閻樿鍐€鐟滃寮?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁逞屽墾缁犳挸鐣锋總绋款潊闁炽儱鍟跨花銉╂⒒娴ｇ瓔娼愬鐟版閺呰泛螖閸涱厾锛涢柣搴秵閸犳岸宕ｉ幘缁樼厱闁靛绲芥俊鍧楁煃閽樺妯€闁哄矉绱曢埀顒婄岛閺呮繄绮ｉ弮鍫熺厸閻忕偟鍋撶粈瀣偓瑙勬礈閸樠囧煘閹达箑鐐婄憸蹇涙偘閳哄倻绡€缁剧増蓱椤﹪鏌涚€ｎ偄娴€规洖缍婂畷濂稿即閻愯埖鎲伴梻浣告惈濞村嫮妲愰弴銏″仾闁逞屽墴閺岋絾鎯旈婊呅ｆ繛瀛樼矌閸嬬偟鈧潧銈稿畷鐔碱敍濞戞帗瀚奸梻浣告啞缁嬫垿鏁冮敃鍌氱疇闁告洦鍨遍悡鏇㈠箹濞ｎ剙鐏╅柍缁樻礃缁绘繈鍩€椤掍胶鐟归柍褜鍓欓～蹇涙惞閸︻厾锛滃┑鈽嗗灠閸氬宕宠濮婅櫣娑甸崨顔惧涧闂佸憡姊归〃鍫ュ礆閹烘垟鏋庨柟瀵稿Х閿涙粌鈹戦埥鍡楃仴闁稿鍔欓、娆撳即閵忥紕鍘介柟鍏肩暘閸ㄥ鍩婇弴鐔翠簻妞ゆ挾鍋為幖鎰版偂閵堝鐓欑紓浣靛灩閺嬬喖鏌ｉ幘瀵糕槈闂囧鏌ㄥ┑鍡樺櫤闁规彃鎽滈埀顒佺⊕缁诲牆顫忛悜妯侯嚤婵炲棙鍨硅摫缂傚倷娴囬褔鎮ч幘宕囨殾婵炲樊浜滈悞鍨亜閹哄秹妾峰ù婊勭矒閺岀喖鎮滃Ο铏逛淮濡炪倕娴氭禍顏堝蓟濞戞埃鍋撻敐鍐ㄥ闁逞屽墯缁诲牆顕ｆ繝姘亜闁告稑锕︾粔鍫曟⒑閸涘﹥瀵欓柛娑卞枟椤斿繘姊绘担钘夊惞闁哥姵鍔欓幃閿嬫綇閳哄啩绗夐梺瑙勫礃瀹曢潧鐣垫笟鈧弻鈥愁吋鎼达絼绮撻柟鍏兼儗閻撳牓寮崱娑欑厓鐟滄粓宕滃顓犫攳濠电姴娲﹂崵宥夋煏婢跺牆鈧绮诲顑芥斀闁挎稑瀚禒褔鏌涘Ο鐘插閸欏繘鏌涘畝鈧崑鐐烘偂濞戞埃鍋撻崗澶婁壕闂侀€炲苯澧寸€规洑鍗抽獮妯兼嫚閼碱剙濮︽俊鐐€栫敮濠囨嚄閸洖鐓€闁哄洢鍨洪悡銉︽叏濡灝鐓愰柣鎾跺枛閻擃偊宕堕妷銉ュБ缂備礁顑堝畷鐢垫閹烘梻纾兼俊顖濆亹閻ｈ櫣绱撴担铏瑰笡缂佽鐗嗛悾宄邦潨閳ь剚淇婂宀婃Ш缂備浇椴哥换鍫ュ蓟閿濆棙鍎熼柕鍫濆缂嶅牆鈹戦悙鎻掔骇闁挎洏鍨归悾鐤亹閹烘挸浠洪梻鍌氱墐閺呮繄绮欒箛鎾斀闁绘绮☉褎銇勯幋婵囧櫧缂侇喖鐗撳畷姗€鍩￠崘顏嶅晭闂備礁澹婇崑鍛崲瀹ュ纾块柟杈鹃檮閻撴洟鏌ｅΟ铏癸紞濠⒀呮暩閳?
                    this.spawnAtLocation(ExampleMod.GLITCH_CHIP.get());
                    this.discard(); // 闂傚倸鍊搁崐宄懊归崶褏鏆﹂柣銏㈩焾缁愭鏌熼柇锕€鏋涢柛銊︾箘閳ь剙绠嶉崕鍗炍涘Δ鍛瀭闁哄倹锛曡ぐ鎺撳亹鐎瑰壊鍠栭崜楣冩⒑鏉炴壆顦︽い鎴濇喘楠炲顫㈠畝鈧悿鈧┑鐐村灦閻熴儱鈻撻悢鍏尖拻濞撴艾娲ゆ晶顔剧磼婢跺鍤熺紒顔碱煼椤㈡岸鍩€椤掑嫬钃熼柨鏇楀亾閾伙絽銆掑鐓庣仭濡ゆ梹淇婇悙顏勨偓褏鈧潧鐭傚畷鎴炵節閸屻倖缍庨梺鎯х箰濠€杈╁閸忓吋鍙忔俊銈傚亾婵☆偅鐩畷婵囶槹鎼达絿锛濇繛鎾磋壘濞层倕鈻嶅鈧弻娑㈠Ω閵壯冪厽濡?
                }
            }
        }

        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犵厱婵﹩鍘介妵婵嗏攽闄囬崺鏍ь嚗閸曨厸鍋撻敐搴濈胺婵″弶鍔欏缁樼瑹閳ь剙顭囪婢ф繈姊洪崫鍕櫤闁烩晩鍨堕獮蹇涘箣閿旇棄浜滈柣蹇撶箣閻掞箓寮埀顒勬⒒娴ｈ櫣甯涢拑杈╂喐閺夊灝鏆ｇ€殿喗濞婇幃娆戞啑娴ｇ儤鍤€闁崇懓鍟村畷褰掝敊閻熼澹曢梺鍝勭▉閸嬪懎鐣烽崣澶岀闁瑰瓨鐟ラ悘鈺冪磼閻欏懐绉柡宀嬬秬缁犳盯寮埀顒勫Φ閻旇鐟邦煥鎼存繈鍋楅梺?
        this.entityData.set(PRINT_PROGRESS, progress);
    }

    // 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫宥夋煟閹邦厽缍戝ù婊堜憾濮婅櫣鍖栭弴鐐测拤缂備礁顑嗛崹鍦垝婵犳碍鍋愰悹鍥皺椤旀劕鈹戦悜鍥╃У闁告挻鐟╅幃姗€顢旈崼鐔哄幈濠电偛妫楃换鎺旂不閺屻儲鐓忛柛銉戝喚浼傜紓浣哄У閻╊垶鐛Ο鍏煎磯濞撴凹鍨卞В鍥р攽閻樻鏆俊鎻掓嚇瀹曟垿宕ㄧ€涙ɑ娅囬梺闈涚箞閸婃洜绮婚弽顐熷亾閻熸澘顏鐟邦儔瀵憡鎯旈妸褍褰勯梺鎼炲劘閸斿秹骞嗛崟顐€鍦焊閺嵮傚闂傚倸鍊搁崐椋庢濮橆剦鐒界憸宥堢亱濠德板€曢幊蹇涘疾濠靛洢浜滈煫鍥ㄦ尵婢ф洟鏌﹂崘顏勬灈闁哄本娲樼换娑㈠垂椤旂厧顫庢繝纰樺墲瑜板啴鎮ф繝鍕床婵炴垯鍨归獮銏′繆閵堝懎鏆欓柛銈庡墴閺岋絾鎯旈姀鈶╂灁闂佸搫鎳忛惄顖炲灳閺冨牆绀冩い鏂挎瑜旈弻娑㈠焺閸忥附宀搁獮蹇涙偡閹佃櫕鏂€闂佺粯鍔栬ぐ鍐棯瑜忕槐鎺楊敊婵傚壊鈧宕￠柆宥嗙厵闁绘鐗婄欢鑼磼椤愩垻效闁哄本鐩、鏇㈩敃椤厾鍑归梻浣告惈閹冲寮查悩宸綎闁惧繗顫夌€氭岸鏌嶉妷銉э紞濞寸厧娲铏规嫚閼碱剛顔夌紓浣筋嚙閻楁挸顕ｉ锕€绀冩い鏃囧亹閿涙粌鈹戦悙鏉戠仸闁艰鍎抽?
    public void setPrintState(int state) {
        this.entityData.set(PRINT_STATE, state);
    }

    // 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫宥夋煟閹邦厽缍戝ù婊堜憾濮婅櫣鍖栭弴鐐测拤缂備礁顑嗛崹鍦垝婵犳碍鍋愰悹鍥皺椤旀劕鈹戦悜鍥╃У闁告挻鐟╅幃姗€顢旈崼鐔哄幈濠电偛妫楃换鎺旂不閺屻儲鐓忛柛銉戝喚浼傜紓浣哄У閻╊垶鐛Ο鍏煎磯濞撴凹鍨卞В鍥р攽閻樻鏆俊鎻掓嚇瀹曟垿宕ㄧ€涙ɑ娅囬梺闈涚箞閸婃洜绮婚弽顐熷亾閻熸澘顏鐟邦儔瀵憡鎯旈妸褍褰勯梺鎼炲劘閸斿秹骞嗛崟顐€鍦焊閺嵮傚闂傚倸鍊搁崐椋庢濮橆剦鐒界憸宥堢亱濠德板€曢幊蹇涘疾濠靛洢浜滈煫鍥ㄦ尵婢ф洟鏌﹂崘顏勬灈闁哄本娲樼换娑㈠垂椤旂厧顫庢繝纰樺墲瑜板啴鎮ф繝鍕床婵炴垯鍨归獮銏′繆閵堝懎鏆欓柛銈庡墴閺岋絾鎯旈姀鈶╂灁闂佸搫鎳忕粙鏍倶閸愵喗鈷戠紓浣癸公閼版寧绻涙担鍐插椤╅攱绻濇繝鍌涘櫧缁炬崘鍋愮槐鎾存媴閸忓锛堝銈呯箰閻楀﹪宕戦埡鍛厽闁硅揪绲借闂佸搫鎳忚ぐ鍐€︾捄銊﹀磯闁绘碍娼欐导鎰版⒑閸濄儱浜奸柛鏂跨焸閳ユ棃宕橀鍢壯囨煕閳╁喚娈橀柣鐔村姂濮婅櫣绮欓崠鈥充紣濡炪値鍘鹃崗姗€濡存担绯曟瀻闁规儳纾濠傗攽鎺抽崐鎾舵媼閺屻儱绠?(缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻锝夊箣閿濆憛鎾绘煕婵犲倹鍋ラ柡灞诲姂瀵挳鎮欏ù瀣壕鐟滅増甯掔壕濠氭煥閻斿搫校闁绘挶鍎甸弻锟犲礃閵娿儮鍋撻崨濠勵洸濡わ絽鍟悡鏇㈡煟閺傛寧鍟為柕鍥ㄧ箞閺岋紕浠﹂崜褎鍒涢梺绯曟櫅鐎氭澘鐣峰鈧、鏃€鎷呯拠鈩冪秾闂傚倸鍊峰ù鍥涢崟顖氱柈濞村吋娼欑粣妤呮煛瀹ュ骸骞栭柦鍐枛閺岋綁寮崒姘粯缂備胶濮甸悡锟犲蓟閻斿吋鐒介柨鏇楀亾妤犵偞顭囬幉鎼佸箮婵犲倹澶勯柍閿嬪灩缁辨挻鎷呯拠锛勫姺缂傚倸鍊瑰畝鎼佸蓟濞戞瑧绡€闁告劦浜為悿鍕倵?
    public float getPrintProgress() {
        return this.entityData.get(PRINT_PROGRESS);
    }

    // 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫宥夋煟閹邦厽缍戝ù婊堜憾濮婅櫣鍖栭弴鐐测拤缂備礁顑嗛崹鍦垝婵犳碍鍋愰悹鍥皺椤旀劕鈹戦悜鍥╃У闁告挻鐟╅幃姗€顢旈崼鐔哄幈濠电偛妫楃换鎺旂不閺屻儲鐓忛柛銉戝喚浼傜紓浣哄У閻╊垶鐛Ο鍏煎磯濞撴凹鍨卞В鍥р攽閻樻鏆俊鎻掓嚇瀹曟垿宕ㄧ€涙ɑ娅囬梺闈涚箞閸婃洜绮婚弽顐熷亾閻熸澘顏鐟邦儔瀵憡鎯旈妸褍褰勯梺鎼炲劘閸斿秹骞嗛崟顐€鍦焊閺嵮傚闂傚倸鍊搁崐椋庢濮橆剦鐒界憸宥堢亱濠德板€曢幊蹇涘疾濠靛洢浜滈煫鍥ㄦ尵婢ф洟鏌﹂崘顏勬灈闁哄本娲樼换娑㈠垂椤旂厧顫庢繝纰樺墲瑜板啴鎮ф繝鍕床婵炴垯鍨归獮銏′繆閵堝懎鏆欓柛銈庡墴閺岋絾鎯旈姀鈶╂灁闂佸搫鎳忕粙鏍倶閸愵喗鈷戠紓浣癸公閼版寧绻涙担鍐插椤╅攱绻濇繝鍌涘櫧缁炬崘鍋愮槐鎾存媴閸忓锛堝銈呯箰閻楀﹪宕戦埡鍛厽闁硅揪绲借闂佸搫鎳忚ぐ鍐€︾捄銊﹀磯闁绘碍娼欐导鎰版⒑閸濄儱浜奸柛鏂跨焸閳ユ棃宕橀鍢壯囨煕閳╁喚娈旀い顐㈡嚇濮婃椽宕烽褍濮曠紓鍌氱С缁舵艾顕ｉ锕€绀冩い鏃囧亹閿涙粌鈹戦悙鏉戠仸闁艰鍎抽?
    public int getPrintState() {
        return this.entityData.get(PRINT_STATE);
    }

    private void checkOwnerDistanceAndTeleport() {

        if (this.level().isClientSide) return;
        if (this.isPurgeActive()) return;
        if (!this.entityData.get(IS_FOLLOWING)) return;
        if (this.isCommandScavenging()) return;


        Player owner = this.level().getNearestPlayer(this, -1.0);
        if (ownerUUID != null) {
            Player p = this.level().getPlayerByUUID(ownerUUID);
            if (p != null) owner = p;
        }

        if (owner == null) return;
        if (ownerUUID == null) ownerUUID = owner.getUUID();

        double distSqr = this.distanceToSqr(owner);
        if (distSqr > 400.0) {
            teleportToSafeSpot(owner);
        }
    }

    public void teleportToSafeSpot(LivingEntity owner) {
        teleportToSafeSpot(owner, false);
    }

    public void teleportToSafeSpotFromTerminal(LivingEntity owner) {
        teleportToSafeSpotFromTerminal(owner, false);
    }

    public void teleportToSafeSpotFromTerminal(LivingEntity owner, boolean forceRecall) {
        this.terminalTeleportOverride = true;
        this.forceTerminalRecall = forceRecall;
        try {
            teleportToSafeSpot(owner, false);
        } finally {
            this.terminalTeleportOverride = false;
            this.forceTerminalRecall = false;
        }
    }

    public void teleportToSafeSpot(LivingEntity owner, boolean damageTriggered) {
        if (!this.isFollowing() && !this.terminalTeleportOverride) {
            return;
        }
        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁逞屽墾缁犳挸鐣锋總绋款潊闁炽儱鍟跨花銉╂⒒娴ｇ顥忛柛瀣╃窔瀹曟洘娼忛埡鍐劶婵犮垼娉涙径鍥磻閹捐绀傚璺猴梗婢规洟姊绘担鍛婂暈婵炶绠撳畷婊冣枎閹惧磭顦梺鍛婂姇濡﹤銆掓繝姘厪闁割偅绻冮ˉ婊呯磼濡や礁娴柡灞剧⊕缁绘繈宕掗妶鍥ф倯闂備浇顕栭崹浼村嫉椤掆偓椤曘儵宕熼鍌滎啎闂佸湱鍎ら崹鍦矓濞差亝鐓涘ù锝囨嚀婵秶鈧娲栭妶鎼併€侀弴銏狀潊闁挎稑瀚▓鍫曟⒒閸屾艾鈧绮堟笟鈧獮澶愭晸閻樿尙顔夐梺鎼炲劗閺呮繃绋夊澶嬬厸鐎广儱楠搁獮鏍煢閸愵亜鏋涢柡灞炬礃缁绘盯宕归鐓庮潕婵犵鍓濊ぐ鍐偋婵犲嫭宕叉繛鎴欏灩楠炪垺淇婇婵囶仩闁告梹鎮傚娲传閸曨剦妫忛梺閫炲苯澧柡瀣偢瀵劍绂掔€ｎ偆鍘藉┑顔筋殔濡绂嶅鍏犵懓顭ㄩ崟顐㈠Б濡炪値浜滈崯瀛樹繆閸洖骞㈡俊顖滃劋濞堫偄鈹戦悩鎰佸晱闁革綆鍣ｅ畷锝夊礃閵娧勬闂佺鎻粻鎴犵不閼姐倗纾藉ù锝咁潠椤忓懐顩锋い鎾卞灪閳锋帒銆掑顒佹悙鐎殿喖娼″濠氬礋椤愩埄浠鹃梺鐑┾偓宕囩闁宠鍨块弫宥夊礋椤愨剝婢€闂備胶顭堥敃銉╁垂閸喚鏆﹂柡鍥ュ灪閻掕偐鈧箍鍎卞Λ娆忊枍閸ヮ剚鈷戦梻鍫熺〒婢ф洟鏌ｅΔ鈧换鎴犵矉瀹ュ棛顩烽悗锝庡亐閹风粯绻涙潏鍓у埌闁圭⒈鍋呯粋鎺懨洪鍛幈闁瑰吋鐣崹铏圭礊閹达附鐓冮悹鍥皺鏁堥悗娈垮枟閹歌櫕鎱ㄩ埀顒勬煟濡⒈鏆滅紒閬嶄憾濮婄粯绗熼埀顒€顭囪钘濇い鎰剁畱閻ょ偓绻濇繝鍌滃闁稿鍊圭换娑㈠箣濞嗗繒浠鹃梺缁樻尰濞茬喖寮婚悢鐓庣骇闁割煈鍠楅崐搴ｇ磽娴ｉ潧濡兼い顓炲槻椤曪絾绂掔€ｎ偅娅栭梺鍛婃处閸橀箖鏁嶅鍛＝闁稿本鐟╁鐑芥煕閵娧勫殌妞ゆ洩缍佹俊鎼佸煛閸屾粌骞堥梻浣稿暱閹碱偊宕愮紒妯绘珷闂侇剙绉甸悡鍐喐濠婂牆绀堥柣鏂款殠閻掔晫鎲搁弮鈧穱濠囧醇閺囩偟顔愭繛杈剧到閹芥粓鎮鹃崫鍕垫富闁靛牆鎳愮粻浼存煟濡も偓濡顢欒箛鎾斀闁搞儯鍎扮花濠氭⒑閸濆嫬鏆欓柛濠勬暬楠炲繘鍨剧搾?
        if (!this.hasTeleportModule() && !this.forceTerminalRecall) {
            if (owner instanceof Player player) {
                player.displayClientMessage(Component.translatable("message.examplemod.teleport_module_missing"), true);
            }
            return;
        }
        if (!this.canTeleport() && !this.forceTerminalRecall) {
            if (owner instanceof Player player) {
                TeleportRequestGateway.notifyTeleportDeniedToOwner(this, player, this.getTeleportCooldown());
            }
            return;
        }

        net.minecraft.world.phys.Vec3 startPos = this.position();

        for (int i = 0; i < 10; i++) {
            double angle = this.random.nextDouble() * 2.0 * Math.PI;
            double distance = 2.0 + this.random.nextDouble() * 2.0;

            double targetX = owner.getX() + Math.cos(angle) * distance;
            double targetZ = owner.getZ() + Math.sin(angle) * distance;
            double targetY = owner.getY();

            BlockPos pos = new BlockPos((int)targetX, (int)targetY, (int)targetZ);

            int safeY = findSafeY(pos);
            if (safeY != -999) {
                this.moveTo(targetX, safeY, targetZ, this.getYRot(), this.getXRot());
                this.getNavigation().stop();
                if (!this.forceTerminalRecall) {
                    this.setTeleportCooldown(this.getMaxTeleportCooldown());
                }
                this.notifyTeleport();
                this.onTeleportCompleted(startPos, damageTriggered);
                if (!this.isFollowing()) {
                    this.guardLockX = this.getX();
                    this.guardLockY = this.getY();
                    this.guardLockZ = this.getZ();
                    this.guardLockValid = true;
                }
                if (this.level() instanceof ServerLevel sl) {
                    sl.sendParticles(ParticleTypes.PORTAL, targetX, safeY + 1, targetZ, 10, 0.5, 0.5, 0.5, 0.5);
                    // 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌熼梻瀵割槮缁惧墽绮换娑㈠箣閺冣偓閸ゅ秹鏌涢妷顔煎⒒闁轰礁娲弻鏇＄疀閺囩倫銉︺亜閿旇娅嶉柟顔筋殜閻涱噣宕归鐓庮潛婵＄偑鍊х€靛矂宕瑰畷鍥у灊闁割偁鍎遍柋鍥ㄧ節閵忥紕绠撶紓宥咃躬楠炲啴鍩勯崘鈺佸妳闂佹寧绻傚Λ娆撳窗閺嶎厽鈷?SoundEvents.ENDERMAN_TELEPORT 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰级閻ゅ嫬鈹戞幊閸娧呭緤娴犲鐤い鏍仦閸嬪倿鏌嶈閸撶喎顫忓ú顏勭閹艰揪绲块悾鐢告⒑閻熸澘妲绘い鎴濐樀楠炲啴鎮欑€靛壊娴勯柣搴秵閸嬪棝宕㈤挊澶嗘斀閹烘娊宕愰幇鏉跨；闁瑰墽绮悡鐔镐繆閵堝倸浜惧┑鈽嗗亝缁嬫垿鍩㈡惔銊ヮ潊闁靛牆妫楅埀顒傚厴閹鈽夊▍顓т簻椤曪綁宕归瑙勬杸濡炪倖姊婚悺鏂库枔閺冣偓娣囧﹪顢曢敐搴㈢暦闂佸搫鎳庨悥濂搞€佸▎鎰弿闁归偊浜為惄搴繆閻愵亜鈧牠宕濋敃鍌氱婵炴垯鍨圭粈鍡椕归悡搴ｆ憼妞ゃ儱妫楅…璺ㄦ崉娓氼垰鍓崇紓浣叉閸嬫挸鈹戦悩鍨毄濠殿喗鎸冲畷鎰板箹娴ｅ憡杈堥梺缁樺姈閻ｎ亝绂嶅鍫熺厪濠㈣埖绋戦々顒勬煙閸愬弶鍣界紒杈ㄥ笚濞煎繘濡搁妷锕佺檨闁诲孩顔栭崳顕€宕抽敐澶婃槬闁逞屽墯閵囧嫰骞掗崱妞惧婵＄偑鍊ら崢鐓幟洪妶澶婄厺閹兼番鍔岀粻鑽も偓瑙勬礀濞层倝鐛幒妤佲拻濞达絿鐡斿鎰偓瑙勬礃閿曘垽銆佸鎰佹Ь缂備緡鍠栭悧鎾崇暦閹烘埈鐓ラ柛娑卞灲缁辨煡姊虹拠鎻掑毐缂傚秴妫濆畷鎴﹀礋椤栵絾鏅┑鐘诧工閻楀﹪鎮″☉銏＄厱闁斥晛鍙愰幋鐘电焼閻庯綆鍋呴崣?
                    sl.playSound(null, targetX, safeY, targetZ, SoundEvents.ENDERMAN_TELEPORT, net.minecraft.sounds.SoundSource.HOSTILE, 1.0f, 1.0f);
                }
                return;
            }
        }
        this.moveTo(owner.getX(), owner.getY(), owner.getZ());
    }

    private int findSafeY(BlockPos pos) {
        Level level = this.level();
        for (int i = 0; i < 3; i++) {
            BlockPos p = pos.above(i);
            BlockState state = level.getBlockState(p);
            BlockState stateUp = level.getBlockState(p.above());
            if (!state.blocksMotion() && !stateUp.blocksMotion()) {
                return p.getY();
            }
        }
        return -999;
    }

    @Override
    public void setTarget(@Nullable LivingEntity target) {
        if (target == this) {
            return;
        }
        super.setTarget(target);
    }




    // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙８闁逞屽厸閻掞妇鎹㈠┑瀣＜婵°倓鑳舵禍娆愮節閻㈤潧浠﹂柛顭戝灦瀹曠懓煤椤忓嫮鏌у┑鐘绘涧椤戝棝鎮¤箛娑欑厱妞ゆ劧绲跨粻鏍ь熆鐠哄搫顏柡宀嬬節瀹曞崬螣閼测晝鍘戦梻渚€娼уú銈団偓姘嵆閻涱噣宕堕鈧柋鍥煛閸モ晛娅忛柍褜鍓欑粔鐟邦潖?tick 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛濠傛健閺屻劑寮村鑸殿€栨繛瀛樼矊缂嶅﹪寮诲☉銏犵疀闁靛闄勯悵鏍⒒閸屾艾顏╅悗姘嵆瀵鏁撻悩鑼槰闂侀潧顭堥崕顕€宕戦幘璇叉嵍妞ゆ挻绋戞禍鐐叏濮楀棗澧婚柣鎾炽偢閺岋紕浠﹂悾灞澭囨煕閳规儳澧查柟宄版嚇瀹曘劍绻濋崘鎯ф櫃闂傚倸鍊风粈浣哄椤撶姴鍨濇い鏍嚤濞戙垹绀冩い鏃囧閹芥洖鈹戦悙鏉戠仧闁搞劌婀辩划璇测槈閵忥紕鍘撻柡澶屽仦婢瑰棝藝閿斿浜滄い鎺嗗亾闁绘鎹囬獮鍐ㄧ暋闁妇鍙嗛梺鍛婃处閸撴盯宕欓敓鐘崇厽閹兼番鍨归崵顒勬煕閻樺疇澹橀崡閬嶆煙閻楀牊绶茬紒鐘烘珪娣囧﹪濡堕崪鍐╂暰闂佸搫鎷嬮崜娆撳煘閹达附鍋愰悹鍥囧啩绱ｉ梻浣告憸閸ｃ儵宕归崼鏇炵畺婵☆垳绮刊瀵哥磼椤栨稒绀冮柡鍌楀亾闂傚倷鑳剁划顖炲礉濡棿鐒婃繛鍡樺姈濞呯姵绻涢幋娆忕仾闁绘挻娲熼弻鏇熺箾閸喖濮曢梺绋款儍閸庢娊鍩€椤掍緡鍟忛柛鐘崇墵閳ワ箑鐣￠幍顔芥闂侀潧艌閺呮稓鐥閺岀喓鈧稒顭囩粻鎾绘煙閹肩偛鈧繂顫忕紒妯肩瘈閹肩补鈧尙鐩庢繝鐢靛仩椤曟粎绮婚幋鐘插疾闂備礁鎼粙渚€宕戦崱娑樼婵﹩鍏橀弨浠嬫煕鐏炲墽顣查柛鐔哄仱閺屽秹鏌ㄧ€ｎ亞鐟ㄩ梺闈涙鐢帡锝炲┑瀣垫晢濞达綀顫夐崐鐑芥⒒娴ｅ憡鎯堟い鎴炲灴濮婁粙宕熼鍌楁敵婵犵數濮村ù鍌炲极閸愵喗鐓忛煫鍥ㄦ礀椤庡苯霉閻撳骸鏆ｆ慨濠冩そ濡啫鈽夊▎妯活棤缂傚倷娴囬崺鏍х暆缁嬫鍤曟い鎰剁畱缁犳稒銇勯幘璺轰户缂佹劗鍋炵换婵嬫偨闂堟刀銏ゆ倵濮橆剙妲婚崡閬嶆煙缂併垹鏋熼柍閿嬪笒闇夐柨婵嗘搐閸斿鏌涢妶鍌氫壕闂傚倷鐒﹂幃鍫曞垂濞差亝鍋傞柨鐔哄Т缁犳艾顭块懜闈涘闁搞倕鍟撮弻宥夊传閸曨偅娈ㄧ紓浣诡殔椤︾敻骞冨畡閭︾叆闁告侗鍙庨弳顓㈡煟閵忊晛鐏℃い銊ワ躬瀹曞搫鈽夐姀鐘殿吅闂佹寧姊婚弲顐﹀储閻㈢數纾介柛灞剧懅閸斿秹鏌ㄥ杈╃＜婵＄儑绠戝ú锕傛偂閻斿吋鐓欓柣鎴灻悘锕傛煕閻斿搫浠х紒杈ㄥ笧缁辨帒螣閸忕厧鍨辨繝娈垮枛閿曘倝鈥﹀畡閭﹀殨闁割偅娲栫粻锝嗙節闂堟稓澧戦柛瀣墵濮婂宕掑▎鎰偘濠碘剝銇滈崝搴ｅ垝閸喐濯撮柧蹇撴贡閻撳姊洪悡搴㈡喐闁轰焦鎮傞妴鍛存倻閼恒儳鍙嗛梺鍝勬川閸嬫盯鍩€椤掆偓缂嶅﹤鐣烽悽绋跨妞ゆ梻鏅崢鎾绘⒑閸涘﹦绠撻悗姘煎墴瀵悂濡舵径瀣幈闂佺粯妫冮ˉ鎾存櫏婵?tick 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌熼梻瀵割槮缁炬儳顭烽弻锝夊箛椤掍焦鍎撶紓浣哄С閸楁娊寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磽娴ｅ搫啸濠电偐鍋撻梺鍝勭灱閸犳牠骞冭瀹曞ジ鎮㈤崫鍕闂?
    private void runNormalLogic() {
        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰缁鎮╅崗鍛畾濡炪倖鐗楃换鍌涚閸︻厾妫柟瑙勫姇琚氶梺閫涚┒閸斿矁鐏掗梺鍦焾濞寸兘濡撮幇顔剧＝濞达絾褰冩禍楣冩⒑缁嬫寧婀扮紒瀣浮瀹曪綀绠涢弬鍓х畾闂佺粯鍔欓·鍌炲吹濞嗗緷鐟邦煥閸曨偄濮㈤柧缁樼墵閺岋絽顫滈埀顒€顭囪缁傛帒顭ㄩ崟鈺€绨婚梺鐟扮摠缁诲啴宕甸埀顒勬⒑鐠囪尙绠查悽顖滃仧濡叉劙骞樼拠鑼紲濠电偛妫欓崹鍨繆閽樺娓婚柕鍫濋楠炴牗绻涚拠褍顩紒顔碱儏椤撳吋寰勬繝鍥ф暪闂備礁鎼ú銊╁疮閸ф绠繛宸簼閳锋垹绱撴担濮戭亪鎮樺澶嬬厸闁告侗鍠氶惌濠囨煃鐠囪尙效鐎规洖宕埥澶娾枎閹存繂绠為梻鍌欑窔濞佳団€﹂崼銉ョ？闂侇剙绉查埀顒€鍊块獮搴ㄦ嚍閵壯冨箰?
        LivingEntity target = this.getTarget();
        if (target != null && target.isAlive()) {
            if (target.getLastHurtByMob() == this) {
                if (this.tickCount - target.getLastHurtByMobTimestamp() < 10) {
                    this.consecutiveMisses = 0;
                }
            }
            if (this.consecutiveMisses >= 5) {
                this.setTarget(null);
                this.consecutiveMisses = 0;
            }
        }
// 闂?runNormalLogic() 闂?tick() 闂?
        if (this.tickCount % 200 == 0) { // 闂?0缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋敐鍛闂佽姤蓱缁诲牓寮婚悢灏佹灁闁割煈鍠楅悘宥夋⒑閸濆嫭顥炵紒顔肩У缁岃鲸绻濋崶顬囨煕濞戝崬鏋涢柛鏃€鐟︾换婵嬪閿濆懐鍘梺鍛婃⒐濞叉牠顢欒箛鎾斀閻庯綆鍋嗛崢鍛婄節閵忥絾纭炬い鎴濇嚇閹﹢鏌嗗鍡欏幍闂佸吋浜介崕鑼矆鐎ｎ偅鍙忓┑鐘插暞閵囨繃淇婇銏犳殭闁宠棄顦板蹇涘Ω閹扳晛鈧繂顫忛搹鍦煓闁告牑鍓濋弫鎯ь渻閵堝啫濡奸柨鏇ㄤ邯婵″瓨绗熼埀顒€顕ｉ鈧畷濂告偄閸濆嫬笑闂佽楠哥粻宥夊磿閸楃倣娑樷槈閵忕姷鐓?
}

        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙闁稿被鍔庨幉鎼佸籍閸惊銉╂煕閹般劍娅嗛柛搴ｅ枛閺屾洝绠涚€ｎ亞鍔村┑鐐跺皺椤牓鍩為幋锔藉亹閻犲泧鍐х矗闂佽瀛╅崙褰掑矗閸愩劎鏆﹂柨婵嗙墢閻も偓濠电偞鍨堕悷褔宕㈤幘缁樷拺闁告稑锕︾粻鎾绘倵濮樼厧寮€规洖鐤囬妵鎰板箳閹惧厖鐢绘繝鐢靛仜濡瑩鎮疯閹箖鎮介崨濠勫幐闁诲繒鍋涙晶钘壝虹€涙﹩娈介柣鎰级瀹告繂霉閻欏懐鐣甸柟宕囧仱婵＄兘濡烽鐟颁壕婵炴垯鍨洪埛鎴犵磼鐎ｎ偒鍎ラ柛搴＄Ч閺屾盯寮埀顒勫垂閻㈤潻缍?
        autoEat();

        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犵厱婵﹩鍘介妵婵嗏攽闄囬崺鏍ь嚗閸曨厸鍋撻敐搴濈胺婵″弶鍔欏缁樼瑹閳ь剙顭囪婢ф繈姊洪崫鍕櫤闁烩晩鍨堕獮蹇涘箣閿旇棄浜滈柣蹇撶箣閻掞箓寮埀顒勬⒒娴ｈ櫣甯涢拑杈╂喐閺夊灝鏆ｇ€殿喗濞婇幃銏ゅ礂閼测晛甯楃紓鍌氬€烽悞锕佹懌缂備讲鍋撻悗锝庡枟閻撴盯鎮橀悙棰濆殭濠殿喖鍊婚埀顒侇問閸ｎ噣宕抽敐鍛殾闁割偅娲嶉埀顒佺墵椤㈡瑩鎳為妷銉э紦闂?
        if (this.tickCount % 20 == 0) updateInfoBookAndSlots();
        lockInfoBook();

        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弴鐐测偓鍝ョ不閺嶎厽鐓曟い鎰剁稻缁€鈧梺鎼炲妼閸婂潡寮婚妶鍚ゅ湱鈧綆鍋呴悵鎺楁⒑缂佹ê绗掗柨鏇樺劦婵＄敻宕熼鍓ф澑闂佽宕樺▔娑㈠煕閸儲鈷戦弶鐐村椤︼箓鏌ㄩ弴銊ら偗鐎殿喖顭烽弫鎾绘偐閼碱剦妲伴梻渚€娼ц噹闁告劗鍋撳В鍥╃磽閸屾艾鈧兘鎳楅懜鍨弿闁汇垻顭堥崹鍌炴煕椤愶絾绀€濡楀懘姊洪崨濠冨闁哥姵宀搁幃鍧楀焵椤掑嫭鈷戦柛锔诲幖娴滈箖鏌熼姘冲閾荤偤鏌ｉ幇顔煎妺闁?
        if (this.tickCount % 10 == 0) tauntNearbyMonsters();

        // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｅΟ娆惧殭缂佺姴鐏氶妵鍕疀閹炬惌妫炵紓浣界堪閸婃繈寮婚悢铏圭煓闁割煈鍣崝澶愭⒑閸涘﹦鎳冪紒缁樺浮閸┾偓妞ゆ帒鍊归崵鈧柣搴㈠嚬閸樼晫绮╅悢琛″亾閿濆骸鏋涢柛鎴犲█閺岋繝宕橀妸褍顤€闂佺粯鎸婚悷鈺侇嚕閸洖閱囨繝闈涙閹稿啴姊烘导娆戠К濞存粠鍓涘Σ鎰板箳濡も偓閻掑灚銇勯幒鎴濐仼缁炬儳銈搁弻锝夊箛椤掑娈堕梺鍛娚戦幃鍌氼潖濞差亜绀堥柟缁樺笂缁ㄦ挳姊洪幖鐐插婵＄偠妫勯锝夊箮閽樺鍘搁梺鍛婁緱閸犳帡骞忓ú顏呪拺閻犲洠鈧磭鈧鏌涢幇鍓佸埌濞存粓绠栭弻娑滎槼妞ゃ劌鎳橀幏鎴︽偄閸忚偐鍘介梺鍝勫暙閸婂摜鏁崼鏇熺厱闁靛鍎遍埀顒€婀遍幑銏犫槈閵忕姷顓洪梺璇茬箺椤曆囧触鐎ｎ剛鍗氶柣鏃傚帶閸楁娊鏌曡箛濠冾€嗛柟?
        manageBrutalityAbility();
        manageTorchBehavior();
        handlePickupAndXp();
        checkOwnerDistanceAndTeleport();
    }

    private int hurtRecursionCounter = 0;

    @Override
    public boolean hurt(DamageSource source, float amount) {
        if (this.hurtRecursionCounter > 5) {
            System.err.println("[SkeletonTurret] Hurt loop detected for entity " + this.getId() + ", breaking loop.");
            return false;
        }

        this.hurtRecursionCounter++;
        try {
            if (!this.level().isClientSide && GUARD_STUTTER_DEBUG && !this.isFollowing()) {
                TurretModuleLog.info(
                        "[GuardDebug] hurt-enter unit=#{} tick={} src={} rawAmt={} hurtTime={} guardCd={} invul={} vanillaInvul={} health={}/{}",
                        this.entityData.get(UNIT_ID),
                        this.tickCount,
                        source.getMsgId(),
                        String.format(java.util.Locale.ROOT, "%.3f", amount),
                        this.hurtTime,
                        this.guardDamageCooldown,
                        this.invincibilityTimer,
                        this.invulnerableTime,
                        String.format(java.util.Locale.ROOT, "%.2f", this.getHealth()),
                        String.format(java.util.Locale.ROOT, "%.2f", this.getMaxHealth())
                );
            }
            // 闂?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ弬娆炬祲濠㈣埖鍔曠粻娑㈡煛婢跺孩纭堕柨娑欑洴濮婇缚銇愰幒鎴滃枈闂佸憡锚婢х晫鍒掔紒妯稿亝闁告劏鏅濋崢鎾绘偡濠婂嫮鐭掔€规洘绮撻幃銏ゆ偂鎼淬倖鎲伴柣搴＄畭閸庨亶鎮у鍐剧€堕柕濞炬櫆閳锋垹绱掔€ｎ厽纭剁紒鐘崇叀閺岋綁鍩℃繝鍌滀桓濡ょ姷鍋涢崯鎾箖濞嗘挻鍊绘俊顖滅帛閻濇牠姊绘笟鈧埀顒傚仜閼活垱鏅堕弻銉︾厽闊洦鎼╅崕鏃€鎱ㄦ繝鍐┿仢婵☆偄鍟埥澶婎潩椤掑姣囧┑锛勫亼閸娧呪偓闈涚焸瀹曞湱鎹勬笟顖氭闂佸憡绋戦敃锕傛偡瑜版帗鐓冪憸婊堝礈閻旇偐宓侀柛鎰电厛濞笺劑鏌嶈閸撶喖鐛崘銊㈡瀻闁圭偓娼欏▓婵嗏攽閻愯尙澧涢悗绗涘泚澶嬪緞閹邦厸鎷绘繛杈剧悼閻℃棃宕靛▎鎴犵＜缂備焦锚閻忔挳鏌熼鍡欑瘈闁轰焦鎹囬幃鈺呮嚑閼稿灚鍟?(0.3s)
            if (this.invincibilityTimer > 0 && !source.is(net.minecraft.tags.DamageTypeTags.BYPASSES_INVULNERABILITY)) {
                if (!this.level().isClientSide && GUARD_STUTTER_DEBUG && !this.isFollowing()) {
                    TurretModuleLog.info(
                            "[GuardDebug] hurt-block unit=#{} tick={} reason=tp_invul src={} invul={}",
                            this.entityData.get(UNIT_ID),
                            this.tickCount,
                            source.getMsgId(),
                            this.invincibilityTimer
                    );
                }
                return false;
            }

            // 1. 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯锋嫼閻熸粎澧楃敮鎺撶娴煎瓨鐓曢柟鎯ь嚟閹冲啯銇勯弴顏嗗埌闁伙綇绻濋弻鍥晜閽樺妲ｉ梻鍌欑窔濞佳囨偋閸℃あ娑樷槈濞嗘劖鐝峰銈嗗笒閸婅崵澹曟總鍛婂€甸柨婵嗛娴滄粍绻涢幖顓炴珝闁哄备鍓濋幏鍛喆閸曨偆锛撳┑鐘殿暜缁辨洟宕楀鈧畷娲晸閻樿尙锛滃┑鐘诧工閸燁偆绮婚悧鍫㈢瘈闁汇垽娼ф禒鈺呮煙濞茶绨界€垫澘锕ョ粋鎺斺偓锝庝簽椤旀垵鈹戦悩璇у伐闁绘锕畷鎰板醇閺囩喓鍘卞┑掳鍊曢崯顐ｇ瑜版帗鐓涢柍褜鍓熼幊鐐哄Ψ閿濆嫮鐩庨梻浣告惈閸燁偄煤閵堝牜鏆遍梻鍌欒兌椤牓鏁冮妷鈺佺闁哄稁鍘归埀顒€鍟存俊鐑藉煛閸屾埃鍋撻悜鑺ョ厓閺夌偟澧楅ˇ宄邦熆鐟欏嫭绀冪紒缁樼箞閹粙妫冨☉妤佸媰闂備礁婀遍…鍫モ€﹂悜钘夌疇婵犻潧娲㈤崑鍛存煕閹般劍娅嗘繛鍛喘濮婃椽骞愭惔銏㈠弳婵犫拃鍌滅煓闁诡垰鐭傚畷鍗炍旀繝鍕暩闂備礁鍚嬮幃鍌氼焽瑜庨幈銊╁醇閵夛妇鍘介梺瑙勫礃濞夋盯寮稿☉銏＄厸閻忕偟鏅牎濠电偟鈷堟禍顏堢嵁韫囨洑娌柦妯侯槸閼垫劙姊婚崒娆戭槮婵犫偓闁秴鐤炬い鎰剁悼缁犻箖鏌嶈閸撶喖寮婚悢纰辨晩闁煎鍊楅悡鎾愁渻閵堝啫鐏紒瀣灴閸┿儲寰勬繛鐐€婚棅顐㈡处閹稿寮鍫熲拺閻犲洤寮堕崬澶嬨亜椤愩埄妲搁悡銈嗘叏濡炶浜鹃梺闈涙閸熸潙鐣烽妸鈺佺妞ゆ挾鍠愬▍宥呪攽閻樼粯娑ч柛濠傤煼閳ワ箓宕奸妷锕€鈧嘲鈹戦悩鍙夊闁绘挸绻愰埞鎴︽倷閹存繂鏆欓柡鍡樼懇瀹曨垶骞栨担鍏夋嫽闂佺鏈懝楣冨焵椤掑嫷妫戠紒顔肩墛閹峰懘妫冮埡鍕ㄥ亾閸ф鈷戞い鎺嗗亾缂佸鐓￠崺鈧い鎺嗗亾闁稿﹤婀辩划瀣箳閺傚搫浜鹃柨婵嗙凹缁ㄤ粙鏌ㄥ☉娆戞创婵﹥妞介幃鐑藉级鎼存挻瀵栫紓鍌欑贰閸ｎ噣宕归崼鏇炵畺闁炽儲鏋煎Σ鍫ユ煏韫囥儳纾块柛妯哄船椤啴濡堕崱妤€衼缂備浇灏▔鏇犲垝婵犳艾唯闁挎棁娉曠粻姘舵⒑閸濆嫯顫﹂柛搴㈢叀瀵偅娼忛埡鍐紲缂傚倷鐒﹂…鍥╃不濮椻偓閺屾盯鎮╃拠褍浼愰柧浼欑秮瀵爼鎮欑€涙鍑″銈冨劜瀹€绋款潖?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻娑樷攽閸曨偄濮夐梺绋款儐閹告悂锝炲┑瀣ㄩ柕澶堝労濞煎酣鏌ｆ惔銈庢綈婵炲弶锕㈠畷婵嗏枎閹捐泛绁﹀┑顔姐仜閸嬫挻顨ラ悙鍙夘棦鐎殿喖鐖煎畷顖炲礃鐠恒劎鐦堝┑顔硷龚濞咃綁骞戦崟顖毼╅柕澶涘娴滄牕鈹戦悩鎰佸晱闁哥姵宀稿顐ｇ節濮樺崬绁﹂梺绯曞墲缁嬫帡宕愰悜鑺ュ€垫繛鎴烆仾椤忓嫷鍤曢柛顭戝枓閺€浠嬫煃閽樺顥滈柣蹇嬪劜閵囧嫰寮撮崱妤佸偍闁逞屽墮閸婂潡鐛惔銊﹀殟闁靛／鍐ㄧ婵犵數鍋犻幓顏嗗緤閸фせ鈧箓宕奸妷顔芥櫆濡炪倖鎸堕崹娲偂濞戞埃鍋撻崗澶婁壕闂侀€炲苯澧寸€规洑鍗冲鍊燁槾闁哄棴闄勯妵鍕箛閸撲胶鏆犵紓浣插亾閻庯綆鍠楅悡鏇熴亜椤撶喎鐏ラ柍褜鍓ㄧ紞渚€銆侀弮鍫濋唶闁绘柨寮剁€?
            if (this.isInvulnerable()) {
                return source.is(net.minecraft.world.damagesource.DamageTypes.FELL_OUT_OF_WORLD);
            }

            // 2. 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼槮闁搞劍绻冮妵鍕冀閵娧佲偓鎺楁煟濠靛棛鍩ｉ柡宀嬬節瀹曞爼濡烽妷褌鎮ｉ梻浣圭湽閸婃宕戦幘鑸靛床婵炴垯鍨圭粻锝嗙箾閸℃绠抽柛鏃€鎸冲鐑樻姜閹殿噮妲梺鎸庢穿缁犳捇宕洪埀顒併亜閹哄棗浜剧紓浣哄Т缁夌懓鐣烽弴銏＄劶鐎广儱鎳愰鍡涙煟鎼搭垳绉甸柛鐘崇墵瀹曘儴銇愰幒鎾跺幐闂佹悶鍎崕閬嶆倶椤忓牊鐓熼柟鎯х摠缁€鍐磼缂佹绠炴俊顐㈠暙閳藉鈻庡Ο娲绘＇濠碉紕鍋戦崐鏇犳崲閸℃稑鐤鹃柣妯款嚙閽冪喖鏌ㄥ┑鍡╂Ц缂佺姴顭烽弻鈩冨緞鐎ｎ亞浠兼繛瀵稿帶閻倸顫忓ú顏勪紶闁告洦鍘炬导鍥⒑閸濄儱孝闂佸府缍侀獮鍐┿偅閸愨晜娅㈤梺缁樏崯鎸庣闁秵鈷戦柛鎾村絻娴滀粙鏌涚€ｎ亝鍤囬柡浣哥Ч瀹曞崬螣閼测晝妲囬梻浣圭湽閸ㄨ棄顭囪缁傛帒顭ㄩ崼鐔哄幍闂佸憡鍔栭悡锟犲矗閸曨垱鐓涢悘鐐存灮闊剟鏌℃担鐟板鐎垫澘瀚换婵嬪川椤旇棄鏆梻鍌氬€风粈渚€骞夐敍鍕煓闁圭儤鍩堥悞鑺ョ箾閸℃ɑ灏柣顓燁殔閳规垿鎮╅崣澶婄獩闂佸憡鐟﹂幑鍥蓟濞戙垹唯闁挎繂鎳庨‖澶岀磽娴ｆ彃浜鹃梺閫炲苯澧扮紒?(Shift+闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃酣銆冮妷鈺佷紶闁靛／鍜佹Ц濠电姷鏁告慨鎾磻閸℃稒鍊垮ù鐘差儐閻撶姴鈹戦钘夊闁逞屽墯椤ㄥ棛绮欐径濠庡悑濠㈣泛顑囬崢鐢告⒑绾拋娼愰柛鏃撶畵瀹曢潧鈻庨幘瀵稿幐? - 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓闁搞劌鍊块弻娑㈩敃閿濆棛顦ョ紓浣哄У瑜板啴濡撮幒鎴僵闁挎繂鎳嶆竟鏇熶繆閻愵亜鈧垿宕瑰ú顏呭仭闁挎梻鍋撳畷鍙夌節闂堟侗鍎忕痪鎯с偢閺屾稓浠﹂挊澶嬫闁诲孩鍑归崜娑樷枎閵忋倖鍊烽柣鎴烆焽閸樼敻姊绘笟鍥у伎缂佺姵鍨堕弲鑸靛鐎涙鍘介梺鍦亾濞兼瑩鎮橀妷锔轰簻妞ゅ繐瀚弳锝呪攽閳ュ磭鍩ｇ€规洖宕埢搴ょ疀閿濆棙顦烽梻鍌氬€峰ù鍥х暦閻㈢绐楅柛鈩冪☉绾捐淇婇妶鍛櫤闁搞倕绉瑰娲敆閳ь剛绮旈悽绋跨；閻庯綆鍠楅悡鏇熴亜閹邦喖孝闁诲浚鍠楅妵鍕籍閳ь剙煤閻斿娼栭柧蹇氼潐閸犲棝鏌涢弴銊ヤ簽妞わ负鍔岄埞鎴︽倷閸欏娅ゅ┑鐐跺皺閸犲酣鎮鹃悜鑺ユ優妞ゆ劑鍊ゅù鍕煟鎼搭垳绉甸柛瀣瀹曘垽妫冨☉杈ㄥ瘜闂侀潧鐗嗗Λ娆撳煕閹烘鐓忛柛鈩冾殢閸庡繑銇勯弬璺ㄧ濠碉紕鍏橀弫鍌涙姜閹殿喚娉垮┑锛勫亼閸婃牠骞愰懡銈呭灊閻忕偟鍋撻崣蹇涙煕鐏炲墽鈼ョ紒璇叉閺岀喓鎲撮崟顐㈩潚闂佸憡绻冨浠嬪蓟閺囥垹鐐婄憸宥夘敂椤撶偐鏀芥い鏃傛嚀娴滈箖姊绘担铏瑰笡闁挎岸鏌涢悢椋庝虎闁崇粯鎸歌灃闁告侗鍠掗幏娲煟閻樺弶绀岄柍褜鍓欑壕顓熺閳哄懏鈷戦柛婵勫劚閺嬫垶绻涢崗鑲╂噰闁诡噣绠栭幃婊堟嚍閵夈儰绨荤紓浣哄亾婵姤銇旈幖浣哥柧婵犻潧妫〒濠氭煏閸繃顥滃┑顔ㄥ懐纾奸柛娆忣槸閸斻倝鏌?
            if (source.getEntity() instanceof Player p) {
                if (this.ownerUUID != null && p.getUUID().equals(this.ownerUUID) && p.isShiftKeyDown()) {
                    return super.hurt(source, amount);
                }
                return false; // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰缁顢涢悙鏉戔偓鐢告煥濠靛棝顎楅柡瀣洴濮婂宕掗妶鍛桓闂佸搫琚崝宀勫煘閹达箑骞㈤柍鍝勫€愰敃鍌涒拺缂備焦锚缁楁帡鏌ｈ箛鏂垮摵濠碉紕鏁诲畷鐔碱敍濮橀硸鍞洪柣搴＄畭閸庡崬螞濞戙垹围闁绘鐗忕弧鈧梺闈涢獜缂嶅棗顭囬幇鐗堢叆婵鍩栭悡鍐煢濡警妯堟俊顖楀亾闁诲孩顔栭崳顕€宕滃☉銏犵闁告洦鍨版儫閻熸粍绮撳畷顖溾偓锝庡枟閳锋帒霉閿濆懏鍟為柟顖氱墦閹泛顫濋悡搴濆枈閻庤娲樼换鍫ョ嵁鐎ｎ喗鏅滈悶娑掆偓鍏呭婵炶揪绲跨涵鍫曞几鎼淬劍鐓欓柣鎰靛墯缂嶆垵霉濠婂嫷娈滈柡宀€鍠栭幊鏍煛閸曨厽鈻撻梻渚€娼ч悧鍡椕洪姀銈呯；闁绘劗鍎ら埛鎺楁煕鐏炴崘澹橀柍褜鍓涢崗姗€骞冮悙鐑樻櫇闁稿本绋戦崜鎶芥偡濠婂懎顣奸悽顖涘笧婢规洝銇愰幒鎾跺帾闂佸壊鍋呯换宥呂ｉ崫銉ф／闁硅鍔﹂崵娆愩亜椤撶偞鍋ラ柟铏矒濡啫鈽夊Ο鐐存礋濮婄儤娼幍顕呮М濡炪倖鍨甸ˇ闈涱嚕婵犳艾鍗抽柕蹇曞█閸炶泛鈹戦悩鑼粵闁告梹鐗楅弲銉╂⒒?
            }

            // Guard mode anti-stutter gate:
            // prevent hurt animation from being refreshed every tick by dense repeated hits.
            if (!this.isFollowing()
                    && (this.guardDamageCooldown > 0 || this.hurtTime > 0)
                    && !source.is(net.minecraft.tags.DamageTypeTags.BYPASSES_INVULNERABILITY)) {
                if (!this.level().isClientSide && GUARD_STUTTER_DEBUG) {
                    TurretModuleLog.info(
                            "[GuardDebug] hurt-block unit=#{} tick={} reason=guard_gate src={} hurtTime={} guardCd={}",
                            this.entityData.get(UNIT_ID),
                            this.tickCount,
                            source.getMsgId(),
                            this.hurtTime,
                            this.guardDamageCooldown
                    );
                }
                return false;
            }

            // Teleport module passive: reduce fall damage by 50%-80% based on module level.
            if (source.is(net.minecraft.world.damagesource.DamageTypes.FALL) && this.hasTeleportModule()) {
                int tpLevel = Math.max(1, this.getTeleportModuleLevel());
                int reductionPercent = TeleportModuleRules.fallDamageReductionPercentForLevel(tpLevel);
                amount = amount * Math.max(0.0f, 1.0f - (reductionPercent / 100.0f));
                if (amount <= 0.01f) {
                    return false;
                }
            }

            // Guard mode exclusive buff: reduce incoming damage by 60%.
            if (!this.isFollowing()) {
                amount = amount * GUARD_DAMAGE_TAKEN_MULTIPLIER;
                if (amount <= 0.01f) {
                    return false;
                }
            }

            boolean damaged = super.hurt(source, amount);
            if (damaged && !this.isFollowing()) {
                this.guardDamageCooldown = Math.max(this.guardDamageCooldown, GUARD_DAMAGE_COOLDOWN_TICKS);
                this.guardLastAcceptedHurtTick = this.tickCount;
            }
            if (!this.level().isClientSide && GUARD_STUTTER_DEBUG && !this.isFollowing()) {
                TurretModuleLog.info(
                        "[GuardDebug] hurt-exit unit=#{} tick={} src={} finalAmt={} damaged={} hurtTime={} guardCd={} health={}/{}",
                        this.entityData.get(UNIT_ID),
                        this.tickCount,
                        source.getMsgId(),
                        String.format(java.util.Locale.ROOT, "%.3f", amount),
                        damaged,
                        this.hurtTime,
                        this.guardDamageCooldown,
                        String.format(java.util.Locale.ROOT, "%.2f", this.getHealth()),
                        String.format(java.util.Locale.ROOT, "%.2f", this.getMaxHealth())
                );
            }
            return damaged;
        } finally {
            this.hurtRecursionCounter--;
        }
    }

    @Override
    public void handleEntityEvent(byte id) {
        super.handleEntityEvent(id);

        if (id == 2 && GUARD_STUTTER_DEBUG) {
            TurretModuleLog.info(
                    "[GuardDebug] hurt-event unit=#{} side={} tick={} follow={} hurtTime={} guardCd={} invul={} vanillaInvul={} health={}/{} lastAcceptedHurtTick={}",
                    this.entityData.get(UNIT_ID),
                    this.level().isClientSide ? "client" : "server",
                    this.tickCount,
                    this.isFollowing(),
                    this.hurtTime,
                    this.guardDamageCooldown,
                    this.invincibilityTimer,
                    this.invulnerableTime,
                    String.format(java.util.Locale.ROOT, "%.2f", this.getHealth()),
                    String.format(java.util.Locale.ROOT, "%.2f", this.getMaxHealth()),
                    this.guardLastAcceptedHurtTick
            );
        }
    }





    private void triggerLastStand() {
        if (this.level().isClientSide) return;

        float radius = 5.0f;
        List<LivingEntity> targets = this.level().getEntitiesOfClass(LivingEntity.class, this.getBoundingBox().inflate(radius));
        for (LivingEntity target : targets) {
            if (target instanceof Player) continue;
            if (target instanceof SkeletonTurret) continue;
            if (target.hasCustomName() && target.getCustomName().getString().contains("infected")) continue;

            target.hurt(this.level().damageSources().explosion(this, this), 200.0f);
            target.setSecondsOnFire(10);
        }

        ServerLevel sl = (ServerLevel) this.level();
        sl.sendParticles(ParticleTypes.EXPLOSION_EMITTER, this.getX(), this.getY(), this.getZ(), 1, 0, 0, 0, 0);
        sl.playSound(null, this.getX(), this.getY(), this.getZ(), SoundEvents.GENERIC_EXPLODE, net.minecraft.sounds.SoundSource.HOSTILE, 4.0f, 1.0f);
    }

        // Duplicate hurt method removed


    @Override
    public void die(DamageSource source) {
        super.die(source);
    }

    @Override
    protected void registerGoals() {
        // 闂?0. 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌熼梻瀵割槮缁炬儳顭烽弻锝夊箛椤掍焦鍎撶紓浣哄У濮樸劑鍩€椤掆偓閸樻粓宕戦幘缁樼厱闁哄洢鍔屾禍鐐烘煟濞戞牕鍔氶柍瑙勫灦楠炲﹪鏌涙繝鍐╃妤犵偛锕ラ幆鏃堟晲閸ワ妇鐟?(闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫆闁芥ê顦純鏇㈡⒒娴ｅ憡鍟為柛鏃撶畵瀹曚即寮介銏╂婵犵數濮电喊宥夋偂濞嗘挻鐓熼柟浼存涧婢ф壆绱掗幇顔间槐闁哄矉绻濆畷姗€濡歌椤ｈ櫣绱掗悙顒€鍔ら柛姘儑閹广垹鈽夊Ο鎾抽叄椤㈡鍩€椤掑嫭鍊堕梺顒€绉甸悡鏇㈡倵閿濆骸浜滃┑顔兼喘瀹曪繝鏌嗗鍡欏幍婵炴潙鍚嬪娆愮娴煎瓨鐓涘ù锝呮啞閸犳﹢鏌＄仦鐐缂佺姵鐩鎾倷閹扳晛鍔滈柕鍥у閻斾線鏌涢妷锝呭Ψ闁归攱妞藉娲川婵犲啫闉嶉悷婊勬緲閸燁垳绮嬪澶婂唨妞ゆ挾鍠撻崢閬嶆⒑闂堟侗鐒鹃柛濠冾殜閹苯鈻庨幘瀵稿幍?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弮鍫熸殰闁稿鎸剧划顓炩槈濡娅ч梺娲诲幗閻熲晠寮婚悢鍏煎€绘慨妤€妫欓悾鐑芥⒑缁嬪灝顒㈡い銊ユ婵＄敻宕熼姘辩潉闂佺鏈惌顔界珶閺囥垺鍊甸悷娆忓缁€鈧悗娈垮枛閻栧ジ鐛崼銉ノ╅柕澶婃捣閸犳牕鐣风粙璇炬棃鍩€椤掑嫬绠洪柣銏犳啞閻撶喖骞栧ǎ顒€鐏い锝嗙叀閺屻倛銇愰幒鏃傛毇濠电姭鍋撳〒姘ｅ亾婵﹥妞介獮鎰償閿濆洨鏆ゆ繝鐢靛仩椤曟粎绮婚幘宕囨殾闁汇垻顭堥悞鍨亜閹烘垵鈧崵澹曢挊澹濆綊鏁愰崼顐ｇ秷闂佺粯鎸堕崕鐢稿蓟閿濆棗绠犻梺鍛婃⒐閸ㄥ潡鎮伴鈧畷濂稿Ψ閵夊簶鏅犻弻鏇熷緞婵犲啯宕抽梺鍝ュУ閹告儳危閹版澘绠抽柟鍐茬－閸犳牕鐣烽锕€绀嬫い鎺嶇劍濞堫剟姊婚崒姘偓鎼佸磹妞嬪孩顐芥慨姗嗗墻閻掍粙鏌ゆ慨鎰偓妤冪矆婵犲倶鈧帒顫濋敐鍛闁诲孩顔栭崰鎾诲礉瀹ュ拋鐒介煫鍥ㄧ☉閻撴﹢鏌熼鍡楀€搁ˉ姘舵⒒娴ｅ湱婀介柛銊ㄦ椤洩顦撮柡渚囧櫍閹虫粓鎮欓柅娑氱泿婵＄偑鍊栭崝褏寰婄捄銊т笉闁绘劗顣介崑鎾舵喆閸曨剛顦ㄩ梺鎸庢磸閸ㄥ綊鎮鹃悜鑺ユ櫜闁糕剝顨堢粣鐐测攽閳藉棗鐏ｉ柛搴涘€濆鎶筋敂閸啿鎷绘繛杈剧悼閻℃棃宕靛▎鎰弿婵鐗忛悾鐢告煥濠靛牆浠︾€垫澘瀚伴獮鍥敇閻愮増顫曢梻鍌欑閹碱偄煤閵娾晛绐楅柛鈩冾焽椤╃兘鏌涢鐘插姕闁绘挻娲樼换婵嬫濞戞﹩浠奸梺鍛婃⒐缁捇骞冨Δ鈧～婵嬵敇閻愬弶鎳欓梻浣告惈閻绱炴笟鈧悰顕€宕堕澶嬫櫌闂佺鏈悷褎銇欓幎鑺モ拺閻犲洩灏欑粻鎵磼缂佹ê濮嶉柡灞斤躬閺佹劙宕担鍦▉婵犵數鍋涘Ο濠冪濠婂牆鍨傞柛灞剧◤娴滄粓鏌￠崶鈺佷沪闁革絽缍婇弻娑㈠箻鐠佽櫕鍠氬┑顔硷工椤嘲鐣烽幒鎴僵妞ゆ帒顦幃锝囩磽閸屾瑧顦︽い锔诲灣缁辩偞绻濋崒銈呮婵犵數濮甸懝鐐劔闂備線娼чˇ顓㈠垂濞差亷缍栫€广儱鎳夐弨浠嬫煃閽樺顥滈柣蹇嬪劦閺屾稓鈧綆鍋勬慨宥団偓瑙勬礃缁诲牓銆佸璺虹劦妞ゆ巻鍋撴い顐㈢箰鐓ゆい蹇撴噽閸旂敻姊虹紒妯哄閻忓浚浜為埀顒佺濠㈡﹢鈥﹂懗顖ｆ闂佸摜濮甸悧鐘诲春閻愬搫绠ｉ柨鏇楀亾缁炬儳鍚嬬换娑㈠箣閻愬灚鍠涢梺鍦焿瀹曠數妲愰幘瀵哥懝闁搞儜鍕蒋闂備礁鎲￠…鍫澪涢崟顖ｆ晪闁靛鏅涚粈瀣亜閺嶃劍鐨戦柣銈傚亾濠碉紕鍋戦崐鏍ь啅婵犳艾纾婚柟鎯х亪閸嬫挸鈻撻崹顔界亪闂佹悶鍨洪悡锟犲灳閺冨牆绀冩い鏂挎瑜旈弻娑㈠焺閸愵亝鍣у銈庡€ら崨顖滐紳婵炶揪绲芥竟濠囧磿閹扮増鐓欓柣鐔哄閸犳ɑ顨ラ悙鎻掓殻闁诡喗鐟ч埀顒勬涧婢瑰﹤霉閸曨垱鐓熼幖鎼灣缁夌敻鏌涚€ｎ亝顥㈢€?
        this.goalSelector.addGoal(0, new net.minecraft.world.entity.ai.goal.FloatGoal(this));
        // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱槸濞寸兘宕伴弽褏鏆︾紒瀣嚦閺冨牆鐒垫い鎺戝缁犳椽鏌ｉ姀鐘冲暈闁稿鍓濈换婵囩節閸屾稑娅ｅ銈忕到閵堟悂寮婚敐澶婄厸濠电姴鍊绘禒鎼佹倵濞堝灝鏋涙い顓犲厴楠炲啴濮€閵忕姵鐎抽柡澶婄墑閸斿秴鈻嶉崼銉︹拻濞达絿鐡旈崵鍐煕閵娿儵鍙勭€规洘锕㈤垾锕傚箣閻愮數鈻撶紓鍌氬€搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗霉閿濆懏鎲搁柡鍡檮閵囧嫰骞掗幋婵愪痪闂佺顑呴ˇ顖炲煘閹达箑纾兼繝濠傛捣閸旀悂姊?(婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佲枙闁绘帟濮ょ换娑㈠幢濡纰嶉柣鐔哥懕缁犳捇骞冨Δ鍛櫜閹肩补鍓濋悘宥夋⒑閸濆嫭濯煎ù婊庝簻椤繒绱掑Ο璇差€撻梺鍛婄☉閿曘倝寮抽崼銉︾參闁告劦鍠曢幉楣冩煛瀹€瀣М闁糕斁鍓濈换婵嬪磼濠娾偓濡楁捇鏌?1) - 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈢粯淇婇悙顏勨偓鏍偋濡ゅ啰鐭欓柟鐐湽閳ь剙鎳樺畷锝嗗緞瀹€鈧惁鍫ユ⒒閸屾氨澧涚紒瀣浮閺佸秹寮崼鐔哄幘闂佸搫顦冲▔鏇熺閵忋倖鐓忛柛鈩兠粭鎺撱亜椤愶絿绠為柡浣瑰姍瀹曘劑顢楅埀顒勊夊鑸碘拺閻犲洤寮堕崬澶嬨亜椤愩埄妲搁悡銈嗙節婵犲倻澧曠紒鈧崒娑楃箚妞ゆ牗绻嶉崬铏圭磼鐠囧弶顥㈤柡宀€鍠栧鑽ゅ鐎ｉ潧鏁奸梻渚€鈧偛鑻晶鍓х磼閻樿櫕宕岄柣娑卞枤閳ь剨缍嗛崰妤呭磹閻戣姤鐓犵紒瀣硶娴犳盯鏌ｅ┑鎾剁М婵﹤顭峰畷鎺戭潩椤戣棄浜鹃柣鎴ｅГ閸婂潡鏌ㄩ弴鐐测偓鍝ョ不閺嶎厽鐓曟い鎰剁稻缁€鈧紒鐐劤濞尖€愁潖濞差亶鏁嗛柍褜鍓涚划鏃堟偨缁嬭法锛涢梺闈涚墕椤︿即鎮¤箛鎾斀闁绘劙娼ф禍鐐箾閸涱喗宕岄柡灞稿墲閹峰懘妫冮埡鍕儓闂備浇顕栭崰妤呫€冩繝鍥ф瀬闁归偊鍘介崕鐔兼煃閵夈劌鐨洪柡浣圭墵濮婄粯鎷呴崫銉礊缂備緡鍣崹鎷岀亱闂佸憡鍔﹂崰鏍嫅閻斿吋鐓ラ柣鏂挎惈瀛濈紓浣插亾闁告劦鍠楅悡銉︾節闂堟稒顥為柛锝囶焾椤法鎲撮崟顒傤槰缂備胶绮换鍕窗婵犲伣鐔访虹紒妯肩Ч闂傚倷鑳堕…鍫ヮ敄閸曨厽顐芥慨姗嗗墰閺嗭箓鏌熼悧鍫熺凡闁告濞婇弻鏇＄疀閺囩倫銉╂煕濡粯銇濇慨濠冩そ瀹曨偊宕熼锝嗩唲闂備胶绮〃鍛涘┑鍡欐殾闁跨喓濮寸粻顕€鏌ら幁鎺戝姢闁告ɑ鎹囧娲箹閻愭彃顬夌紓浣割儐鐢帡鍩㈠澶婂窛妞ゆ帟鍋愰幊鎾烩€﹂妸鈺侀唶闁靛繈鍨哄В鍥⒒娴ｅ憡鎯堥柡鍫墴閹嫰顢涢悙闈涚ウ闂佹悶鍎洪崜姘端夐崼鐔虹闁瑰鍎愰悞鑺ャ亜閺冣偓閸旀洟鍩為幋锔藉亹闁归绀侀弲閬嶆⒑閸濄儱校闁绘濞€瀵粯绻濋崶銊︽珳婵犮垼娉涢敃銊╁箺閺囥垺鈷戦悹鎭掑妼閺嬫柨鈹戦纰卞殶缂侇喖鐗撳畷姗€顢欓悾灞藉笚闂佸搫顦遍崑鐐寸珶閸℃蛋鍥晝閳ь剟鍩為幋锔绘晩闁兼亽鍎遍埀顒佸姍閺岀喖顢欓幐搴ｃ€愬銈庡亝缁诲牓銆佸鈧幃鈺呮偨閸偅绶伴梻?
        this.goalSelector.addGoal(1, new TurretEmergencyTeleportGoal(this));

        // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱樈閸犳顕欏ú顏呪拺缂侇垱娲栨晶鍙夈亜閵娿儲鍤囬柨婵堝仱閸╋繝宕ㄩ瑙勫闂備礁鎲＄换鍌溾偓姘煎墴閸┾偓妞ゆ帊绀侀悘瀵糕偓瑙勬礀閻栧吋淇婂宀婃Щ濡ょ姷鍋涢悧鎾愁潖缂佹ɑ濯撮柣鐔煎亰閸ゅ鈹戦埥鍡椾簵闁绘帪绠撻獮鍫ュΩ閳轰絼褔鏌涢妷顔惧帥闁稿鍔戝娲传閸曨噮娼堕梺绋垮閻撯€崇暦閹达附鏅插璺侯儑閸樼敻姊绘笟鍥у伎缂傚倹姘ㄩ懞閬嶆嚒閵堝倸浜鹃悷娆忓鐏忣厽淇婇锝囩疄鐎?(婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佲枙闁绘帟濮ょ换娑㈠幢濡纰嶉柣鐔哥懕缁犳捇骞冨Δ鍛櫜閹肩补鍓濋悘宥夋⒑閸濆嫭濯煎ù婊庝簻椤繒绱掑Ο璇差€撻梺鍛婄☉閿曘倝寮抽崼銉︾參闁告劦鍠曢幉楣冩煛瀹€瀣М闁糕斁鍓濈换婵嬪磼濠娾偓濡楁捇鏌?6闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弮鍫熸殰闁稿鎸剧划顓炩槈濡娅ч梺娲诲幗閻熲晠寮婚悢鍛婄秶闁告挆鍛闂佽瀛╅懝楣兯囨导鏉懳﹂柛鏇ㄥ灠缁犳娊鏌熺€涙绠ュù鐘荤畺濮婅櫣绮欓崸妤娾偓妤呮煥閺囨ê鍔﹀┑锛勬暬瀹曠喖顢涘顒€绁繝寰锋澘鈧劙宕戦幘瓒佺懓顭ㄩ崟顐㈠Б闁剧粯鐗犻弻锝咁潨閳ь剙顭囪缁傛帒顭ㄩ崨顖滐紲婵犮垼娉涢敃锔剧矓濞差亝鐓熸繛鎴濆船閺嬫盯鎽堕敐澶嬬厽闁圭偓濞婇妤呮煟韫囨搫韬慨濠冩そ閹筹繝濡堕崨顔句邯婵＄偑鍊х紞鍥⒔閸曨厾鍗氶柣鏃傚帶閸楁娊鏌ｉ幋婵囶棡閻庨潧鐭傚娲濞戞艾顣洪梺纭呮珪閸旀鍒掔紒妯侯嚤閻庢稒顭囬崢閬嶆⒑缂佹ɑ鈷掓い顓炵墦钘熼悗锝庡墰绾惧吋銇勯弮鍥撴い銉ョ墦閺岀喖顢欓懡銈囩厯閻庤娲忛崝宥囨崲濠靛绀嬫い鎰╁灪鏉堝牊绻濋悽闈浶ラ柡浣规倐瀹曟垿鎮欓崫鍕€梺璇″灣婢ф骞婄仦鍓х瘈闁汇垽娼цⅴ闂佺顑嗛幐鎼佹箒闂佺粯鎸稿ù鐑藉箺閻樼粯鐓熼柟鎹愭硾閺嬫盯鏌＄仦璇插鐎殿噮鍣ｅ畷鍓佹崉閻戞﹩鍞插┑鐘垫暩閸嬫盯骞婃惔锝囩煋闁割偅娲栭悞鍨亜閹烘垵鏋ゆ繛鍏煎姈缁绘稑霉鐎ｎ偅鐝栫紓浣戒含閸嬬偟绮悢鐓庣劦妞ゆ帒瀚崑妯汇亜閺冨牊鏆滈柛瀣崌閺佹劖鎯斿┑鍫熷瘻闂備浇銆€閸嬫挸霉閻樺樊鍎愰柣鎾存礋閺屾洘寰勭€ｎ亞浠撮柣搴㈠嚬閸欏啴銆侀弮鍫熸櫇闁稿本绋堥幏?
        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈠姊绘笟鈧褔藝椤愶箑鐤炬繛鎴炶壘椤ユ岸鏌涢敂璇插箺闁哥姵鍔欓弻锝呂旈埀顒勬偋閸℃瑧绠旈柟鐑樻尰閸欏繘鎮峰▎蹇擃伀闁告瑢鍋撻梻浣告惈閻绱炴担鍓插殨妞ゆ帒瀚崹鍌涖亜閺冨洦顥夐柍褜鍓﹂崹璺侯潖濞差亜浼犻柛鏇ㄥ墮椤庢盯姊洪崨濠冨鞍鐎光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱槸濞寸兘宕伴弽顓炵鐟滅増甯楅悞缁樼箾閹存瑥鐏╁ù鐘冲姍濮婂宕掑▎鎺戝帯濡炪値鍘奸悧鎾汇€侀弽顓炲耿婵炴垶顭囬澶愭⒑閹肩偛鍔撮柛鎾寸懅缁寮介鐔哄帾闂婎偄娲﹀ú鏍ф毄闂備礁鎼Λ妤咁敄婢跺娼栨繛宸憾閺佸洭鏌曟繛褍鎳忓▓鎼佹⒒?1.0
        this.targetSelector.addGoal(0, new NearestAttackableTargetGoal<>(this, LivingEntity.class, 0, true, false, (e) -> {
            if (!this.isPurgeActive()) return false; // 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌熼梻瀵割槮缁惧墽绮换娑㈠箣閻愬灚鍣х紓浣稿閸嬨倝寮诲☉銏犖ㄦい鏃傚帶椤晠姊虹紒妯虹瑨闁诲繑宀告俊鐢稿礋椤栨氨顔婇梺绯曞墲閵囩偞绔熼弴鐘电＝濞达絿顭堥埛鏃堟煣韫囨捇鍙勭€规洏鍨介幃娆擃敆閸屾粌楠勯梻浣告惈濞层劍鎱ㄦ搴☆棜闁稿繘妫跨换鍡樸亜閺嶃劎顣查悹鎰剁磿缁辨帡鎮╃€圭姴顥濆銈庝簻閸熷瓨淇婇崼鏇炲耿婵炲棗娴氬鐑芥⒒娓氣偓濞佳兠洪敃鍌涘剮妞ゆ牗姘ㄩ弳锕傛煙鏉堝墽鐣辩紒鐘哄吹閳ь剝顫夊ú鏍洪敃鈧埢鎾淬偅閸愨斁鎷洪梺纭呭亹閸嬫盯宕濆Δ鍛厸闁告侗浜濆▍濠勨偓娈垮枔閸旀垶淇婇幖浣哥厸闁稿本顨嗙€氬ジ姊洪懡銈呅㈡繛娴嬫櫇娴滅鈻庨幋鐘辩瑝闂佽顔栭崰姘卞閼测晝纾藉ù锝咁潠椤忓懏鍙忕€光偓閸曨剛鍘梺鎼炲劘閸斿本鎱ㄩ崼鈶╁亾閸偅绶查悗姘煎墴閹儳鈹戠€ｎ亞鍔﹀銈嗗笒閸婄粯绋夊澶嬬厸闁稿本渚楅崕銉╂煟閺傛寧顥㈤柡灞诲€濋獮鏍ㄦ媴鐟欏嫰鏁┑鐘愁問閸犳牠鎮ч幘璇茶摕婵炴垶鍩冮崑鎾绘晲閸愩劌顬堟繝娈垮枛閸婂潡寮婚垾宕囨殕閻庯綆鍓涜ⅵ闁诲孩顔栭崳顕€宕滈悢鑲╁祦闁归偊鍘介崕鐔兼煃閳轰礁鏆為柣锝囧帶閳?
            // 闂?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧潡鏌熺€电孝缂佽翰鍊濋弻锕€螣娓氼垱锛嗛悷婊呭鐢帞澹曟總鍛婄厽闁归偊鍨伴惃娲煟濞戞牕鍔︽慨濠冩そ瀹曨偊宕熼娑欑€遍梻浣告啞钃辨俊顐㈠暙閻ｇ兘宕奸弴銊︽櫌闂侀€炲苯澧撮柟閿嬪灴閹垽宕楅懖鈺佸妇濠电姰鍨煎▔娑㈡偋閸℃稑绀夋慨妯垮煐閻撴洟鏌ｉ幇鍏哥盎濠德ゆ硶缁辨帗娼忛妸锕€闉嶉梺鐟板槻閹虫ê鐣峰鍫濈闁圭儤鍨甸ˉ鎺戔攽閻樺灚鏆╅柛瀣洴钘濋柡澶嬶紩閸濆嫀鐔兼嚒閵堝倹鏁靛┑鐘垫暩婵潙煤閵堝鍊峰┑鐘插暔娴滄粓鏌熼崫鍕ラ柛蹇撶焸閺屾稑鈻庤箛鏃戞闂佸疇顫夐崹鍧楀箖濞嗘挸绾ч柟瀵稿С濡楁捇姊绘担钘夊惞闁哥姴妫濆畷鏇㈡濞戞碍娈惧銈嗗姧闂勫嫰宕愮紒妯圭箚妞ゆ牗纰嶇拹锛勭磼閻樺啿鍝烘慨濠呮缁辨帒螣閸濆嫅鏇㈡⒑閸涘﹥灏扮€光偓閸涘﹣绻嗛梻鍫熺▓閺€浠嬫煕椤愶綀澹樺ù婊堢畺閹嘲鈻庤箛鎿冧痪缂備讲鍋撻柛鎰典簴閸嬫捇宕楁径濠佸缂傚倷绀侀鍫濃枖閺囥垹姹查柨鏇楀亾闁宠鍨垮畷鎺戭煥鎼达絽濮奸梻浣告啞椤ㄥ棙绻涙繝鍥ц摕闁挎繂顦Λ姗€鏌熺粙鍧楊€楅柡鍡楃墕閳规垿鎮欓懠顒€顣洪梻浣稿簻缁蹭粙锝炶箛娑欐優閻熸瑥瀚悵浼存⒑閸涘﹦鎳冩い锔诲灦瀵劑顢橀悜鍡樺瘜闂侀潧鐗嗘鍛婄濠婂嫨浜滈柨鏃囨椤ュ绱掗钘夊摵闁哄苯妫楅濂稿幢濡搫濮冮梻鍌欑窔濞艰崵鈧潧鐭傚畷銏°偅閸愵亜绁﹂梺鍦亾閺嬪ジ寮ㄦ禒瀣厽闁归偊鍘界紞鎴︽煟韫囥儵妾柟渚垮妼铻ｇ紒瀣仢椤洭姊虹拠鈥崇仩闁哄牜鍓欓銉╁礋椤掑倻顔曢梺鍦劋閸ㄥ湱绮旈搹鍏夊亾鐟欏嫭绀冩い銊ワ躬楠炲﹪寮介鐐靛幐闂佺鏈喊宥夋偟椤斿墽纾?
            double range = this.getAttackRange();
            if (e.distanceToSqr(this) > range * range) return false; // 闂?闂傚倸鍊搁崐鎼佸磹閻戣姤鍤勯柛顐ｆ礀绾惧潡鏌ｉ姀銏╃劸缂佲偓閸喓绡€闂傚牊绋撴晶娑㈡煛閸℃鐭掗柡宀€鍠栭幃婊冾潨閸℃鏆ョ紓鍌欒兌婵攱绻涢埀顒勬煛瀹€鈧崰鏍嵁閹达箑绠涙い鎺戝€哥敮鍧楁煟鎼淬値娼愭繛鍙夛耿閹繝鏁撻悩鑼舵憰濠电偞鍨崹鍦不濞戙垺鐓曢煫鍥ㄦ尰閹叉悂鏌℃担鍦濞ｅ洤锕幃娆撳垂椤愩垺鐣梻浣告憸閸犲骸顭囬敓鐘茬伋闁挎梻鍋撳畷澶愭煏婵犲繒鐣辩痪缁㈠灦濮婃椽骞嗚缁犵増绻濋埀顒勬焼瀹ュ懐顦銈嗙墱閸嬬偤鍩涢幋鐘电＝濞达綀顕栭悞浠嬫煃椤栨稒绀嬮柡宀€鍠栭幃鐑芥偋閸繃鐏庢俊銈囧Х閸嬫盯宕銉т航闂佽崵濮垫禍浠嬪礉鎼淬劌绾ч柟闂寸劍閳锋垿鏌涢敂璇插箹濞存粓绠栭弻娑㈠箻鐎靛壊鏆￠柣搴ㄦ涧閵堟悂宕洪埀顒併亜閹烘垵顏柍閿嬪笒闇夐柨婵嗙墕琚氶梺缁樼箥娴滄繃绌辨繝鍥х煑濠㈣泛锕ョ拠鐐烘倵鐟欏嫭绀冮柛銊ユ健閻涱噣宕堕澶嬫櫍闂佺粯鐟㈤崑鎾寸箾閸欏鍊愭慨濠囩細閵囨劙骞掗幙鍕惞缂傚倷璁查崑鎾炽€掑锝呬壕闂佽鍨伴懟顖濈亙婵炶揪缍侀ˉ鎾剁不濮橆剦娓婚柕鍫濇婢ь剛绱掔拠鎻掆偓鍦矉瀹ュ牄浜归柟鐑樻尵閸樼敻姊洪崷顓犲笡閻㈩垳鍋熺划鏃堟倻濡寮?
            if (this.isFollowMode()) {
                // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗霉閿濆浜ら柤鏉挎健濮婃椽顢楅埀顒傜矓閻㈢纾婚柨鐔哄У閻撴瑩鏌熼婊冾暭妞ゃ儱顦伴〃銉╂倷椤忓嫮浼堥梺鍝勮嫰缁夌懓鐣烽锕€绀嬫い鎰枎娴滃墽鎲搁悧鍫濈瑨缂佺嫏鍥ㄧ厵闂傚倸顕崝宥夋煃闁垮鐏撮柡灞诲€栭幈銊╁箛椤戣棄浜鹃柡鍥ュ灮閳ь剟鏀辩换婵嬫偨闂堟稐绮堕梺褰掓敱閸ㄥ湱妲愰悙瀛樺闁告縿鍎插▓鐐箾閺夋垵鎮戞繛鍏肩懇瀹曟﹢鍩€椤掑嫭鍋℃繝濠傚枤濡偓閻庢鍠楅幃鍌氼嚕椤曗偓瀹曞ジ鎮㈤崫鍕闂傚倸顭崑鍕洪妶澶樻晞闁告稒娼欓悞鍨亜閹哄秷鍏屽褏鏁婚弻鐔碱敊閹傛勃缂備胶绮换鍌烇綖濠靛鏁囬柣妯诲絻缁犱即姊婚崒娆戭槮闁规祴鈧秮娲晝閸屾氨锛涢梺绯曞墲閻熝勭▔瀹ュ鐓欓柟顖涙緲琚氶梺?
            }
            if (e instanceof Player) return false;
            if (e instanceof SkeletonTurret) return false;
            if (e instanceof IronGolem) return false;
            if (e.getPersistentData().getBoolean("IsFriendlyZombie")) return false;
            if (e.getPersistentData().getBoolean("IsFriendlyCreeper")) return false;
            if (e instanceof net.minecraft.world.entity.decoration.ArmorStand) return false;
            return true;
        }));
        this.targetSelector.addGoal(4, new NearestAttackableTargetGoal<>(this, Mob.class, 10, true, false, (entity) -> {
            if (entity instanceof SkeletonTurret) return false;
            if (entity instanceof Mob mob && mob.getTarget() instanceof Player) return true;
            return false;
        }));
        // 闂?3. 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰缁顢涢悙鏉戔偓鐢告煥濠靛棝顎楅柡瀣洴濮婂宕掗妶鍛桓闂佸搫琚崝宀勫煘閹达箑骞㈤柍鍝勫€愰敃鍌涒拺缂備焦锚缁楁帡鏌ｈ箛鏂垮摵濠碉紕鏁诲畷鐔碱敍濮橀硸鍞洪柣搴＄畭閸庨亶鎮ч崱娑樺偍闁炽儲鍓氬〒濠氭煏閸繄绠崇紒瀣煼閺岋綁骞欓崟顓犵槇閻庢鍠涢褔顢樻總绋块唶妞ゆ劧缍嗛埀顒€娲缁樻媴閸涘﹤鏆堥梺鍦拡閸嬪﹤顫忔禒瀣妞ゆ挾濮烽悞鍧楁倵楠炲灝鍔氭い锔垮嵆瀹曟劙鎮滈懞銉モ偓鍨箾閹寸儐浼嗛柟杈鹃檮閸嬬喖鏌ｉ幋锝呅撻柍閿嬪灩缁辨帗寰勬繝鍐炬闁诲孩鑹鹃崲鏌ュ煝閹捐鍗抽柕蹇ョ磿閸樻捇姊绘担鍝ヤ虎妞ゆ垵妫楅悾宄扮暆閸曨剛鍘搁悗鍏夊亾闁逞屽墴瀹曚即骞橀懜娈挎綗闂佸湱鍎ら崵锕傛偄閸忓吋鍎梺闈╁瘜閸樹粙宕抽鐐粹拻?(闂傚倸鍊搁崐鎼佸磹閻戣姤鍊块柨鏇炲€归崕鎴犳喐閻楀牆绗掗柡鍕╁劦閺屾盯寮撮妸銉т哗闂佹悶鍔岄崐鍧楀蓟閵堝绠掗柟鐑樺灥婵秶绱撴担绛嬪殭婵☆偅绻堝璇测槈閵忕姈銊︺亜閺冨倸甯舵い顐邯濮婅櫣绮欏▎鎯у壄闂佺锕ョ换鍫濐嚕婵犳碍鍋勯悶娑掆偓鍏呭闂佹眹鍨洪鏍倿妤ｅ啫鐤紒瀣氨閺€浠嬫煃閽樺顥滃ù婊€绮欓弻娑㈠Ω閿曗偓閳绘洘顨ラ悙宸Ш缂侇喗鐟ラ埢搴ㄥ箚瑜庨崐顖氣攽閻橆喖鐏辨繛澶嬬洴椤㈡牠宕ㄩ弶鎴狀槶濡炪倖鎸堕崹娲煕閹寸姷纾藉ù锝囨娓氭盯鏌ｉ幒宥囩煓闁哄备鍓濋幏鍛喆閸曨偀鍋撻幇鐗堢厵妞ゆ牗淇虹€氫即鏌嶇拠鏌ュ弰妤犵偞锕㈠鍫曞箣閺傚じ澹曢梺姹囧灩閹诧繝鎮￠妷锔剧瘈闂傚牊绋掗ˉ銏°亜鎼淬埄娈滈柡宀嬬磿閳ь剨缍嗛崜娆撳几閹达附鐓忛柛銉戝喚浠鹃梺璇″灡濡啯鎱ㄩ埀顒勬煏韫囧ň鍋撻搹顐ゅ酱闂?
        this.targetSelector.addGoal(3, new NearestAttackableTargetGoal<>(this, Monster.class, 10, true, false,
                (entity) -> {
                    if (entity instanceof SkeletonTurret) return false;
                    if (entity instanceof Player) return false;
                    if (entity.getPersistentData().getBoolean("IsFriendlyZombie")) return false;
                    if (entity.getPersistentData().getBoolean("IsFriendlyCreeper")) return false;
                    if (entity instanceof IronGolem) return false;
                    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱槸濞寸兘宕伴弽顓炵鐟滅増甯楅崕宀勬煕濠靛嫬鍔ゆい锔诲灦濮婂宕掑▎鎺戝帯缂備緡鍣崹宕囧垝濞嗘挸閱囬柕澶堝劤閺屟冣攽閻樼粯娑ч柣妤€锕敐鐐哄即閵忥紕鍘甸梺缁樺灦閿曗晛鈻撻弮鍌滄／闁诡垎鍐╁€紓浣虹帛缁诲啰鎹㈠┑瀣＜婵炴垶蓱椤忕姷绱撻崒娆戝妽闁靛洦鐩崺鈧い鎺嶇婢ь垱绻涢幘鎰佺吋闁哄本娲熷畷鐓庘攽閸℃ɑ顔勯梻浣告啞濮婄懓鐣濋幖浣歌摕闁绘柨鍚嬮幆鐐淬亜閹伴潧澧查柍褜鍓濆▔鏇㈠焵?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲梺姹囧€ら崰妤呭Φ閸曨垰绠涢柍杞拌兌閸旀挳姊洪幖鐐测偓鏍洪悢鐓庤摕婵炴垯鍩勯弫鍐煥濠靛棙顥滄い锔规櫊濮?D缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛銈呭閺屾盯骞橀懠棰濆敼闂佺顑嗛幐鎼侊綖濠靛鏁嗛柛灞剧矤閸熷鏌ｆ惔銈庢綈婵炴彃绻樺畷婵嬪箣閿旇　鍋撴担鑲濈喓鎮伴埄鍐╂澑闂備礁澹婇崑渚€宕瑰ú顏勭厱闁哄洢鍨洪埛鎺楁煕鐏炴崘澹橀柍褜鍓熼ˉ鎾跺垝閸喓鐟归柍褜鍓熼悰顔藉緞閹邦厽娅㈤梺缁樏崯鎸庣椤撱垺鈷戦柟绋垮绾剧敻鏌涚€ｎ偅灏伴柕鍥у椤㈡﹢鎮欓崗姝屾婵＄偑鍊ら崑鍛垝閹捐鏄ラ柍褜鍓氶妵鍕箳閹存繍浠鹃梺绋款儐钃遍柕鍥у瀵潙螖閳ь剚绂嶉幆顬棃鎮╅棃娑楁勃濡炪値鍘煎ú銊ノｉ幇鏉跨闁瑰啿纾崰鎾舵閹烘埈娼ㄩ柛鈩冩礃閸?100闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犖ч柛銉㈡櫇閸樼娀姊绘担绋款棌闁稿鎳庣叅闁哄稁鍘肩壕濂告煏婵炑冨閺嬫垿姊洪崫鍕殭婵炶绠撹棢闁靛牆鎳夐弨浠嬫煟濡櫣浠涢柡鍡忔櫅閳规垿顢欓悙顒佹瘎闂佸摜濮撮敃銈夘敇閸忕厧绶炲┑鐘插缁辩敻鏌ｆ惔锛勭暛闁稿酣浜惰棟濞寸厧鐡ㄩ崑鍌炴煛閸ャ儱鐏柣鎾寸洴閺屾盯濡烽敐鍛婵犵鈧偨鍋㈤柡宀嬬磿閳ь剨缍嗛崑鍡涘煀閺囥垺鐓忛柛銉戝喚浼傜紓浣哄У閻╊垱淇婇悿顖ｆЬ闂佷紮绠戦悧鎾愁潖濞差亜浼犻柛鏇ㄥ墯閹烽亶姊洪悜鈺傛珦闁搞劋鍗抽、姘舵晲婢舵ɑ鏅梺閫炲苯澧寸€规洘妞介崺鈧い鎺嶉檷娴滄粓鏌熼悜妯虹仴妞ゅ繆鏅濈槐鎺楀焵椤掑嫬绀冮柕濞垮灪閺傗偓闂備胶绮敋闁汇倕娲︾粩鐔肺熼懖鈺冿紲?
                    double range = this.getAttackRange();
                    if (entity.distanceToSqr(this) > range * range) return false;
                    return true;
                }));

        // 闂?1. 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゅ繐绉靛В搴ㄦ⒒閸屾瑨鍏屾い顓炵墦椤㈡牠宕卞☉妯碱唹闂佹悶鍎洪崜娆撴嫅閻斿吋鐓忛柛顐ｇ箥濡插摜绱掗悩鍐叉诞闁哄瞼鍠栭幃婊兾熼搹閫涙樊濠电姵顔栭崰妤€煤閻旂厧钃熼柨婵嗘閸庣喖鏌ㄥ☉妯侯仹缂侇喚鏁哥槐鎾寸瑹閸パ勭亶闂佺懓鎲￠幃鍌炴晲閻愬墎鐤€闁瑰彞鐒﹀浠嬨€侀弬娆惧悑闁糕剝蓱閻濇牠姊婚崒娆戠獢婵炰匠鍛床闁圭儤鎸婚崣蹇涙⒒閸喓鈻撻柡瀣閺屾盯顢曢敐鍡欘槰闂佹娊鏀遍崹鍨嚕閸洘鍊烽柡澶嬪焾濡棝姊洪崨濠冪叆缂佸缍婂濠氭偄閸忕厧浠梺缁橆殔閻楀棝寮搁悩缁樺€垫繛鍫濈仢濞呮﹢鏌涚€ｎ亜顏い銏∩戠缓鐣岀矙閹稿簺浠㈠┑鐐舵彧缁插潡骞婇幘璇茬濠电姴鍟╃换鍡涙煟閹板吀绨婚柍褜鍓氶悧婊堝极椤曗偓楠炴帒顪冨┑鍡樺閻庨潧銈稿鍫曞箣閻欌偓閸熷洭姊绘担绛嬫綈濠㈢懓妫欓弲璺何旈崨顓犲幈闂佺鎻梽鍕偂閺囩喓绡€闂傚牊绋掗ˉ婊勩亜韫囨梹灏﹂柡灞剧⊕閹棃濮€閻樺樊娼曠紓鍌欐祰妞村摜鏁敓鐘偓浣糕枎閹炬潙娈為梺鍝勵槹椤戞瑦瀵奸崘顔解拻濞达絿鎳撻婊勭箾閹绘帞绠荤€规洝顫夌粋鎺斺偓锝冨妷閸嬫挻绗熼埀顒€顕ｉ鈧畷鐓庘攽閸偅效闂傚倷绀佹竟濠囨偂閸儱纾婚柛鏇ㄥ灠缁€鍌氣攽閻樺弶澶勯柍閿嬪笒闇夐柨婵嗘噺閸熺偤鎮归幇鍓佺瘈闁哄睙鍡欑杸闁规崘顕у浼存倵鐟欏嫭纾婚柛妤€鍟块锝夊磹閻曚焦啸闂備礁鎼鍛矓瑜版帒钃熼柕濞炬櫆閸嬪嫰鏌涘┑鍡楃彅闁挎繂顦伴悡鐔兼煙閹冭埞闁告梹绮庣槐鎺旂磼濡吋鍒涘Δ鐘靛仜椤戝骞冨Ο濂借櫣鎷嬮幎钘変粣闂備線娼уΛ妤呭疮椤愶箑鐓濋幖娣妼缁狅綁鏌ｅΟ纰辨殰缂佽鲸褰冮埞鎴﹀焺閸愩劎绁烽梺鍝勭墱閸撶喖骞冭瀵挳鎮滈崱妤侇吙婵＄偑鍊栧Λ鍐极椤曗偓瀹曟垿骞橀懜闈涙瀭闂佸憡娲﹂崜娑⑺囬妸銉富闁靛牆鍟俊濂告煥閺囨ê鈧繈骞冩ィ鍐╁€婚柤鎭掑劚娴滄鏌熼悡搴ｆ憼閽冮亶鏌￠崒妤€浜鹃梻鍌氬€风粈浣圭珶婵犲洤纾诲〒姘ｅ亾鐎规洖婀遍幏鐘绘嚑椤掍焦顔曢梻浣告贡缁垰顔忔繝姘哗濞寸姴顑嗛悡鐔兼煙闁箑骞楃紓宥嗗灴閺岋綀绠涢妷褏鏆ら梺鍝勭灱閸犳牠寮婚崨顓涙婵浜畷鍙変繆閻愵亜鈧垿宕瑰ú顏呭仭闁挎梻鍋撳畷鍙夌節闂堟侗鍎忕痪鎯с偢閺屾稓浠﹂挊澶嬫闁诲孩鍑归崜娑樷枎閵忋倖鍊烽柣鎴烆焽閸樼敻姊绘笟鍥у伎缂佺姵鍨垮绋库槈濮橆厼鏋戦梺鍝勵槹鐎笛囁夊鍕╀簻妞ゅ繐瀚弳锝呪攽閳ュ磭鍩ｇ€规洖宕灃闁逞屽墴閿濈偤宕堕浣叉嫼缂備礁顑呴悘婵嬵敆閵忕姭鏀介柣鎰嚋闊剚顨ラ悙鎻掓殻闁诡喕绮欏畷銊︾節閸屾稓鏉洪梻鍌欑劍閻綊宕规繝姘瀬闁归棿绶￠弫濠囨煛閸ャ儱鐏柍閿嬪灴閺岋綁鎮㈤崨濠勫嚒闂佹娊鏀卞鑽ゆ閹烘鏁嬮柛娑卞幘娴狀厾绱撴担绋库偓鍝ョ矓鐟欏嫪绻嗛柛顐ｆ礀閻愬﹪鏌嶉崫鍕灕缂佽鲸鐓″娲传閸曞灚笑闂佺粯顨呯€氭澘鐣峰┑鍥ㄥ劅闁挎繂娲ｇ粭澶愭⒑閸濆嫮鈻夐柛瀣婢规洘绺介崨濠傗偓鐢告煥濠靛棛鍑归柟鑼亾娣囧﹪骞撻幒鎾虫殘闂侀潧娲ょ€氫即鐛鈧幃娆撴寠婢跺鍨濋梺璇叉唉椤煤韫囨稑绀夐柟杈捐礋閳ь兛绀侀～婊堝焵椤掑嫬绠栭柕蹇嬪€曟导鐘绘煕閺囥劌娅橀柛鐐茬秺濮婂宕掑顑藉亾閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缂佺姷濞€閺岀喖宕滆鐢盯鏌涙繝鍛厫闁逛究鍔岃灒闁圭娴烽妴鎰磽娴ｅ搫校婵犮垺锕㈤崺鐐哄箣閿旇棄浜归悗瑙勬礀濞村倿寮抽敓鐘斥拺?
        // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗霉閿濆浜ら柤鏉挎健瀵爼宕煎顓熺彅闂佹悶鍔嶇换鍐Φ閸曨垰鍐€闁靛ě鍛帒闂備礁鎼Λ娆戝垝閹捐钃熼柣鏂垮悑閸婄粯鎱ㄥΔ鈧Λ娆撴偩閸洘鈷戞繛鑼额嚙楠炴銇勯妸銉含鐎殿喛顕ч埥澶愬閻橀潧濮堕梻浣告啞閸旓附绂嶉弽顬綁宕奸妷锔规嫼闂侀潻瀵岄崢浠嬪吹閳ь剟姊虹紒妯煎ⅹ闁靛牏顭堥锝嗙節濮橆剙宓嗛梺缁樻濞咃綁顢欓弴銏♀拺闁告捁灏欓崢娑㈡煕閻樺磭澧甸柍銉︾墱閳ь剨缍嗛崜娑氬閽樺褰掓晲閸涱喗鍎撻悗娑欑箘缁辨捇宕掑姣欍垽鏌ㄩ弴銊ょ盎妞?(婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佲枙闁绘帟濮ょ换娑㈠幢濡纰嶉柣鐔哥懕缁犳捇骞冨Δ鍛櫜閹肩补鍓濋悘宥夋⒑閸濆嫭濯煎ù婊庝簻椤繒绱掑Ο璇差€撻梺鍛婄☉閿曘倝寮抽崼銉︾參闁告劦鍠曢幉楣冩煛瀹€瀣М闁糕斁鍓濈换婵嬪磼濠娾偓濡楁捇鏌?1)闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弮鍫熸殰闁稿鎸剧划顓炩槈濡娅ч梺娲诲幗閻熲晠寮婚悢鍏煎€绘俊顖濆吹閸欏棝姊洪崫鍕靛剰闁绘绻橀崺鈧い鎺嗗亾缂佺姴绉瑰畷鏇㈡焼瀹撱儱娲、娑㈡倷閺夋垟鍋撻崸妤佺厱妞ゎ厽鍨垫禍鏍瑰鍕煉闁哄瞼鍠栭幃婊兾熼搹鐟板Ъ婵犵鍓濋悡锟犲绩鏉堚晜宕叉繛鎴炲焹閸嬫捇鎮藉▓璺ㄥ姼闂佸憡蓱閹告娊寮婚敍鍕勃闁告挆鍕灡婵°倗濮烽崑鐐垫暜閿熺姷宓佹慨妞诲亾闁硅櫕绮撳Λ鍐ㄢ槈濡棿鐢婚梻鍌氬€搁崐鐑芥嚄閸洏鈧焦绻濋崒妤佺€洪梺鍝勬储閸ㄦ椽寮插┑瀣厪闊洦娲栭灞剧箾閸忚偐澧遍柟鍙夋倐閹囧醇濠靛牏鎳嗙紓鍌欒兌婵數绮欓幒妤€桅闁告洦鍨板Λ姗€鏌涢…鎴濇灍闁稿鍨伴埞鎴︽倷閸欏娅ら梺鍦嚀濞层倝锝炶箛鏇犵＜婵☆垵顕ч鎾寸箾閹炬潙鍤柛銊﹀▕瀹曟繈宕妷褏锛濇繛杈剧秬濞咃絿鏁☉銏＄厱闁哄啠鍋撻柣鐔叉櫊閻涱噣宕橀褎歇缂傚倷鑳剁划顖滄崲閸繄鏆︽慨妞诲亾濠碘剝鎮傛俊鐤槺缂併劍娼欓埞鎴︽偐閸偅姣勯梺绋款儐缁嬫垼鐏掓繝鐢靛Т閸熶即銆呴崣澶岀瘈濠电姴鍊归崳钘夆槈閹惧磭效闁哄本娲樺鍕槈濠婂拋妲瑰┑鐐茬摠缁秶鍒掗幘璇茶摕闁炽儲鍓氶崥瀣煕閹扳晛濡煎┑顔奸叄濮婃椽鏌呴悙鑼跺濠⒀屽灡閵囧嫰濡搁妷褍顤€缂?
        this.targetSelector.addGoal(1, new HurtByTargetGoal(this, SkeletonTurret.class).setAlertOthers());
        // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎺嶇劍椤斿洭姊绘担铏瑰笡闁告梹娲熼、姘额敇閻樺吀绗夋俊銈忕到閸燁垶鎮￠崘顏呭枑婵犲﹤鐗嗙粈鍫熸叏濡潡鍝虹€规洖寮剁换娑㈠箣濞嗗繒浠奸悗鐟版啞缁诲啴濡甸崟顖氱闁告鍋熸禒濂告倵濞堝灝鏋欓柛妤€鍟块～蹇涙倻濡顫￠梺瑙勵問閸ｎ喖危椤斿墽纾藉ù锝呭濡插綊鏌熼崨濠傗枙鐎规洘妞芥慨鈧柍鈺佸暙閸斿懘姊洪幐搴ｇ畵婵炲眰鍔嶅鍕礋椤栨稈鎷虹紓鍌欑劍椤洦鏅堕妶澶嬬厱閻庯綆鍋呴崐鐭癷stanceGoal (闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃酣銆冮妷褏鐭欓柛鏌倐鍋撻崸妤佲拺妞ゆ巻鍋撶紒澶樺櫍閸┾偓妞ゆ帒锕﹂悾鐢碘偓瑙勬礈閸樠囧煘閹达箑绠涙い鎺嶇贰閸氭瑩姊绘担钘夊惞濠殿喗鎸抽獮鏍敃閿曗偓鍥存繛瀵稿Т椤戝棝宕戦敓鐘崇厵濞达絽鍟悵顏呫亜椤愩垻效婵﹥妞藉Λ鍐ㄢ槈濮橀硸鍞哄┑鐘愁問閸犳岸宕楀鈧妴浣糕枎閹邦剛绐炴繝鐢靛Т鐎涒晝鈧潧鐭傚娲濞戞艾顣烘俊銈囧Т閹诧紕绮嬪鍡欘浄閻庯綆鍋嗛崢鍗炩攽閻愬弶顥滈柤娲诲灡缁傚秹宕滆绾句粙鏌涚仦鍓ф噯妞ゆ柨顦甸弻娑氣偓锝庡亝瀹曞矂鏌熼绛嬫疁闁轰焦鍔栭幆鏂课熸潪鏉款棜闂備線娼х换鎺撴叏妞嬪海鐭撴繛宸簼閻撴瑩鏌ц箛锝呬簽濠⒀呮暬閺屾盯鍩為幆褍鈷夌紓浣诡殘閸犳牕鐣烽崼鏇熸櫜闁告侗鍓欓ˉ姘舵⒒娴ｇ儤鍤€濠⒀呮櫕閸掓帡顢涢悙鏉戜簵?
        // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎺嶇劍椤斿洭姊绘担铏瑰笡闁告梹娲熼、姘额敇閻樺吀绗夋俊銈忕到閸燁垶鎮￠崘顏呭枑婵犲﹤鐗嗙粈鍫熸叏濡潡鍝虹€规洖寮剁换娑㈠箣濞嗗繒浠奸悗鐟版啞缁诲啴濡甸崟顖氱闁告鍋熸禒濂告倵濞堝灝鏋欓柛妤€鍟块～蹇涙倻濡顫￠梺瑙勵問閸ｎ喖危椤斿墽纾藉ù锝呭濡插綊鏌熼崨濠傗枙闁轰焦鍔欓幃娆撳传閸曞灚缍傞梻浣瑰缁嬫垹鈧皜鍥у嚑婵炲棗娴氬〒濠氭煏閸繄绠抽柣锝堜含缁辨帗娼忛…鎴濆ainSpaceGoal (闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃酣銆冮妷褏鐭欓柛鏌倐鍋撻崸妤佲拺妞ゆ巻鍋撶紒澶樺櫍閸┾偓妞ゆ帒锕﹂悾鐢碘偓瑙勬礈閸樠囧煘閹达箑绠涙い鎺嶇贰閸氭瑩姊绘担钘夊惞濠殿喗鎸抽獮鏍敃閿曗偓鍥存繛瀵稿Т椤戝棝宕戦敓鐘崇厵濞达絽鍟悵顏呫亜椤愩垻效婵﹥妞藉Λ鍐ㄢ槈濮橀硸鍞哄┑鐘愁問閸犳岸宕楀鈧妴浣糕枎閹邦剛绐炴繝鐢靛Т鐎涒晝鈧潧鐭傚娲濞戞艾顣烘俊銈囧Т閹诧紕绮嬪鍡欘浄閻庯綆鍋嗛崢鍗炩攽閻愬弶顥滈柤娲诲灡缁傚秹宕滆绾句粙鏌涚仦鍓ф噯妞ゆ柨顦甸弻娑氣偓锝庡亝瀹曞矂鏌熼绛嬫疁闁轰焦鍔栭幆鏂课熸潪鏉款棜闂備線娼х换鎺撴叏妞嬪海鐭撴繛宸簼閻撴瑩鏌ц箛锝呬簽濠⒀呮暬閺屾盯鍩為幆褍鈷夌紓浣诡殘閸犳牕鐣烽崼鏇熸櫜闁告侗鍓欓ˉ姘舵⒒娴ｇ儤鍤€濠⒀呮櫕閸掓帡顢涢悙鏉戜簵?
        this.goalSelector.addGoal(1, new EscapeWaterGoal(this, 2.0)); // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亜顒㈡い鎰矙閺屻劑鎮㈤崫鍕戙垻鐥幆褜鐓奸柡灞剧洴閸╁嫰宕橀浣诡潔缂傚倷鐒﹂崝鏍€冩繝鍥╁祦闁哄秲鍔嶇紞鍥煕閹炬鍟伴悡妤呮⒒?2.0 (濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌熼梻瀵割槮缁炬儳顭烽弻锝夊箛椤掍焦鍎撶紓浣哄У濠㈡鐏冮梺鎸庣箓閹冲酣寮虫繝鍥ㄧ厓鐟滄粓宕滈妸褏涓嶉柟鎯х－閺嗭箑鈹戦崒婊庣劸閸烆垶姊洪棃娑崇础閻忕偠濮ら弶鎼佹⒒閸屾艾鈧绮堟笟鈧畷顖炲锤濡も偓缁犺銇勯幇鍓佺暠缂佺姷濞€閻擃偊宕堕妸褉妲堥梺?

        // Attack mode (priority 2): tactical kite + ranged fire
        this.goalSelector.addGoal(2, new TacticalKiteAttackGoal(this));

        // 闂?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧潡鏌熺€电孝缂佽翰鍊濋弻锕€螣娓氼垱锛嗛悷婊呭鐢帞澹曟總鍛婄厽闁归偊鍨伴惃娲煟濞戞牕鍔︽慨濠冩そ瀹曨偊宕熼娑欑€遍梻浣告啞钃辨俊顐㈠暙閻ｇ兘宕奸弴銊︽櫌闂侀€炲苯澧撮柟閿嬪灴閹垽宕楅懖鈺佸妇濠电姰鍨奸崺鏍儎椤栨凹鐎舵い鏃傛櫕缁犻箖鏌涘☉鍗炴灓濠⒀屼邯閺屽秶鎲撮崟顐や紝濡炪們鍨洪悷鈺侇嚕椤掑嫬围闁告洦鍙€缁绘垿姊婚崒娆戭槮闁硅绻濋獮鎰節濮橆厼浠梺闈涱槴閺呮盯鎮￠垾鎰佺唵閻犲搫鎼惁銊︿繆椤栨艾顏慨濠冩そ瀹曨偊宕熼鐘插Ы缂傚倷鑳剁划顖滄崲閸岀偞鍋╅柣鎴ｅГ閸嬪倿骞栫€涙〞鎴﹀棘閳ь剟姊绘担鍝ョШ闁稿锕畷銏狀煥閸喐娅囬梺閫炲苯澧撮柛鈺冨仱楠炲鏁傞挊澶夋睏婵＄偑鍊栭崝锕€顭块埀顒€顭跨憴鍕濞ｅ洤锕幃娆擃敂閸曘劌浜鹃柡鍥╁У瀹曟煡鏌熼幍顔碱暭闁稿顑夐弻娑㈠焺閸愵亖濮囬梺绋匡工閻栧ジ寮昏缁犳盯鏁愰崨顒傛晼缂傚倷璁插褔宕戦幘鏂ユ斀闁绘ê鐏氶弳鈺佲攽椤旇姤灏︾€规洘鍔橀妵鎰板箲閵堝拋妯€闁诡喒鏅犻幃娆撳箣閹烘梻娉块梻浣告贡閸樠囨偤閵娾晜鏅┑鐐茬摠缁挾绮婚弽褜娼栧┑鐘宠壘绾惧吋鎱ㄥ鍡楀幋闁稿鎹囬獮鏍ㄦ媴閸濄儻绱梻浣哥秺濡法绮堟担铏逛笉闁绘顕х粻褰掑级閸繂鈷旂紒瀣吹閳ь剝顫夊ú姗€鎮￠敓鐘茶摕闁绘柨鎲＄紞鍥煕閹炬鍟悡鍌炴⒒娴ｅ憡鎯堟俊顐ｇ洴瀹曟垿濡舵径濠呮憰闂佹寧绻傚Λ娆撳磿閻斿吋鐓忛煫鍥э攻濞呭懘鏌￠崨缈犳喚婵﹥妞藉畷顐﹀Ψ閵夋劧缍侀弻锝呂旀担铏圭厜濡ょ姷鍋為崹鎸庢叏閳ь剟鏌曢崼婵囧櫣闁兼澘鐏濋埞鎴︽倷閺夋垹浠稿銈庡幖濞差厼鐣峰┑瀣櫇闁逞屽墴閳ユ棃宕橀鍢壯囨煕閳╁喚娈橀柣鐔稿姍濮婃椽鎮℃惔鈩冩瘣婵犫拃鍐╂崳闁告帗甯楃换婵嗩潩椤掑偆鍟嬮梻浣告啞閹哥兘鎳楅崼鏇熸櫖婵犲﹤鐗婇悡娑橆熆鐠虹尨鍔熷褎鍨块弻娑㈠棘鐠恒劎鍔梺璇″枟椤洭鍩€椤掑倹鏆╃痪顓炵埣瀹曟垿骞橀懜闈涙瀭闂佸憡娲﹂崜娑㈡晬濮椻偓濮婅櫣绮欓幐搴㈠闯闂佽桨绀侀…閿嬩繆鐎涙ɑ濯寸紒顖涙礃椤秴鈹戦埥鍡楃仸闁衡偓闁稄缍栫€广儱鎳夐弨浠嬫煟閹邦剙绾фい銉у仱閹锋垶娼忛埡鍌氫粡閻熸粍鏌ㄩ～蹇旂節濮橆剛锛滃┑鐐叉閸ㄥ灚淇婃禒瀣厽閹艰揪绲块幊妤呮煕濞戝崬鐏ｉ柣鎾存崌濮婅櫣娑甸崨顔兼锭缂備胶濮甸崹褰掑焵椤掍浇澹樻い锔垮嵆婵＄敻宕熼姘鳖唺閻庡箍鍎卞ú銈嗕繆閽樺鏀介柣鎰级閸ｈ棄鈹戦悙鈺佷壕闂備礁鎼惌澶屽緤閸婄喓浜芥繝鐢靛仜濡瑩宕曢崘娴嬫灁妞ゆ挾濮风壕钘壝归敐鍡楃祷濞存粓绠栧铏圭矙閹稿孩鎷卞銈嗘磸閸ㄥジ濡甸幇鏉跨闁规儳鐡ㄩ悵鎶芥⒒娴ｈ鍋犻柛搴櫍瀵彃顭ㄩ崼婵堢枀濠殿喗銇涢崑鎾存叏婵犲啯銇濈€规洦鍋婃俊鐑藉Ψ閿旈敮鍋撴繝姘拺缁绢厼鎳忛悵顏堟煕閺冣偓椤ㄥ懎宓勯梺鍦濠㈡绮婚幎鑺ョ厵闁诡垎鍜冪礊缂備焦鍔楅崑銈夊蓟閻旂厧绀傞柛蹇曞帶閸撳綊姊洪崫銉バｉ柣妤佹礋閸┿垽骞樺ú缁樻櫍闂佺粯妫佸▍锝夋儊?(婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佲枙闁绘帟濮ょ换娑㈠幢濡纰嶉柣鐔哥懕缁犳捇骞冨Δ鍛櫜閹肩补鍓濋悘宥夋⒑閸濆嫭濯煎ù婊庝簻椤繒绱掑Ο璇差€撻梺鍛婄☉閿曘倝寮抽崼銉︾參闁告劦鍠曢幉楣冩煛瀹€瀣М闁糕斁鍓濈换婵嬪磼濠娾偓濡楁捇鏌?4)
        this.goalSelector.addGoal(4, new TurretFollowGoal(this, 1.2, 10.0F, 2.0F));

        // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱樈閸犳顕欏ú顏呪拺缂侇垱娲栨晶鍙夈亜閵娿儲鍣界紒顔垮吹閹风姴顔忛钘夌槣闂備線娼ч悧鍡涘箠閹邦喚涓嶉柡灞诲劜閻撴瑦銇勯弮鍌氬付闁逞屽墮閻忔繈顢氶敐鍥ㄥ珰婵炴潙顑嗛～宥夋⒑闂堟稓绠冲┑顔惧厴椤㈡瑩骞掑Δ浣叉嫼闂佸憡绻傜€氬嘲危瑜版帗鐓曢柍杞拌兌婢э妇鈧娲滈弫鎼佸焵椤掑﹦绉甸柛鐘愁殜閹繝鎮╃紒妯煎幈闂侀潧顭俊鍥煀閺囩喓绠鹃柛娑卞弿闊剟鏌?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣椤愯姤鎱ㄥ鍡楀⒒闁绘帞鏅槐鎾存媴婵垼鍋愰幑銏ゅ幢濞戞瑧鍘遍梺闈涱檧缁茶姤淇婇懞銉х闁告侗鍨版牎婵烇絽娲ら敃顏呬繆閸洖宸濇い鏃傗拡閳ь剚鐩鐑樻姜閹殿噮妲銈嗗灥椤﹂潧顕ｆ繝姘嵆闁靛繒濞€閸炶泛鈹戦悩缁樻锭婵炲眰鍊濋、鎾斥槈閵忊檧鎷洪梺纭呭亹閸嬫盯鍩€椤掍胶澧悡銈夋煟閺傚灝鎮戦柛瀣€归妵鍕箛閸撲胶鏆犻梺缁樺姇閿曨亪寮婚弴鐔虹瘈闊洦鑹鹃幃鍛存⒑閻熸澘妲荤紓宥咃工椤繘鎼归崷顓犵厯濠电偛妫欓崕鎶藉礈鏉堚晝纾藉ù锝囩摂閸ゆ瑩鏌ｅΔ浣瑰碍妞?(婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佲枙闁绘帟濮ょ换娑㈠幢濡纰嶉柣鐔哥懕缁犳捇骞冨Δ鍛櫜閹肩补鍓濋悘宥夋⒑閸濆嫭濯煎ù婊庝簻椤繒绱掑Ο璇差€撻梺鍛婄☉閿曘倝寮抽崼銉︾參闁告劦鍠曢幉楣冩煛瀹€瀣М闁糕斁鍓濈换婵嬪磼濠娾偓濡楁捇鏌?3)
        this.goalSelector.addGoal(3, new PurgeMoveGoal(this));
        this.goalSelector.addGoal(3, new FollowMiningAvoidGoal(this));

        this.goalSelector.addGoal(5, new TurretScavengeGoal(this, 1.15));
        // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂?2闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弮鍫熸殰闁稿鎸剧划顓炩槈濡娅ч梺娲诲幗閻熲晠寮婚悢鍏煎€绘俊顖濆吹閸欏棝姊洪崫鍕靛剰闁绘绻橀崺鈧い鎺嗗亾缂佺姴绉瑰畷鏇㈠础閻愬秵绋戦埢搴ㄥ箻瀹曞洨鍘梻濠庡亜濞诧妇绮欓幒妤佸亗闊洦绋撻崣鎾绘煕閵夛絽鍔氶柛鏂诲€楅惀顏堝箚瑜庨崑銉╂煛鐏炵晫肖缂佽鲸甯掕灒闁绘垟鏅滅€氱晫绱撻崒娆愮グ濡炲瓨鎮傞獮鎰節濮橆剛顔嗛梺鍛婄⊕濞兼瑧绮堥崒姘肩唵閻犺桨璀﹂崕婊呯磼鏉堛劏澹橀柍瑙勫灴閹瑧鈧稒锚闂夊秹姊虹化鏇熸珔闁哥喐娼欓悾鐑藉箣閿曗偓缁犺崵绱撴担璇＄劷闁?(闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ巻鍋撴潻婵嬫⒑闁偛鑻晶鎾煛鐏炲墽銆掗柍褜鍓ㄧ紞鍡涘磻閸涱厾鏆︾€光偓閸曨剛鍘靛銈嗘閸嬫劗绮旈搹鍏夊亾鐟欏嫭绀€闁绘牕鍚嬫穱濠囧箹娴ｈ倽銊ф喐韫囨稑围闂佸灝顑囩弧鈧┑鐐茬墕閻忔繂鈻嶅▎鎴犵＜闂婎偒鍘鹃惌娆撴煛娴ｇ鏆ｅ┑陇鍩栧鍕節閸曨偄缁╂繝鐢靛О閸ㄥジ宕洪弽顓炵闁哄洨濮锋稉宥呪攽閻樺磭顣查柛瀣剁秮閺屾盯濡烽婊冪煗闂佺顑嗛幑鍥箹瑜版帩鏁冮柨婵嗘濡诧絽鈹戦悩鍨毄濠殿喚鏁婚、娆撳冀椤撶偟鐛ュ┑顔筋焾濞夋稓绮婚悩缁樼厵闁诡垎鍐╊啈闂佹悶鍎洪崜姘跺磻閵娧呯＜閻庯綆鍘界涵鍫曟煟閿濆鐣烘慨濠冩そ瀹曘劍绻濋崒姣挎洟姊洪崫銉バｉ柣妤佺矌閸掓帡宕奸埗鈺佷壕闁挎繂楠告禍鏍瑰鍕煉闁哄瞼鍠栧畷顐﹀礋椤撳鍊濋弻娑㈠棘鐠恒剱褔鏌″畝瀣埌闁宠鍨块獮鍥敂閸繀绮ｅ┑?
        this.targetSelector.addGoal(2, new TurretDefendOwnerGoal(this));
        // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂?3闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弮鍫熸殰闁稿鎸剧划顓炩槈濡娅ч梺娲诲幗閻熲晠寮婚悢鍏煎€绘慨妤€妫欓悾鐑芥⒑閹肩偛鈧洟鎯岄崒鐐茶摕闁绘梻鈷堥弫宥夋煕閳╁喚娈曢柛锝囧劋缁绘盯宕奸悢宄板Б闂佸疇顫夐崹鍫曠嵁婵犲洦鐓曞┑鐘插暞瀹曞矂鏌熼鎯т槐闁轰礁鍊块幐濠冨緞婵犲嫪绨撮梻浣筋嚙鐎涒晝绮欓幒妞烩偓锕傚炊閳轰礁袣闂侀€炲苯澧紒缁樼箞閹粙妫冨ù韬插灲閺屾稒绻濋崘鈺佲偓鎰亜閵忊剝灏靛ù鐙呴檮閹便劑骞囬妸銉ゅ闂佸湱鍎ら崺鍫濐焽閳哄懏鐓ユ繝闈涙閸ｇ顭跨憴鍕婵?(闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ巻鍋撴潻婵嬫⒑闁偛鑻晶鎾煛鐏炲墽銆掗柍褜鍓ㄧ紞鍡涘磻閸涱厾鏆︾€光偓閸曨剛鍘靛銈嗘閸嬫劗绮旈搹鍏夊亾鐟欏嫭绀€闁绘牕鍚嬫穱濠囧箹娴ｈ倽銊ф喐韫囨稑围闂佸灝顑囩弧鈧┑鐐茬墕閻忔繂鈻嶅▎鎴犵＜闂婎偒鍘鹃惌娆撴煛娴ｇ鏆ｅ┑陇鍩栧鍕節閸曨偄缁╂繝鐢靛О閸ㄥジ宕洪弽顓炵闁哄洨濮锋稉宥呪攽閻樺磭顣查柛瀣剁秮閺屾盯濡烽婊冪煗闂佺顑嗛幑鍥箹瑜版帩鏁冮柨婵嗘濡诧絽鈹戦悩鍨毄濠殿喚鏁婚、娆撳冀椤撶偟鐛ュ┑顔筋焾濞夋稓绮婚悩缁樼厵闁诡垎鍐╊啈闂佹悶鍎洪崜锕傚极瀹ュ鐓熼柟瀛樼箖瀹告繄绱掔€ｎ亞绠绘慨濠冩そ濡啫鈽夊杈╂澖闂備胶顭堥敃銉╂偋閻樺樊鍤曢柡灞诲劚閽冪喖鏌曟径娑橆洭闁告ê宕埞鎴︽倷閺夋垹浠撮悗瑙勬处閸撶喎顕ｉ幖浣规櫇闁稿本绋撻崢鍗炩攽椤旂瓔鐒介柛妯犲嫮顩查柣妤€鐗婇崣蹇撯攽閻樻彃鏆為柕鍥ㄧ箞閺岀喖顢欓幆褍骞嬪Δ鐘靛仜缁夊綊銆佸▎鎾村殥闁靛牆顦弨娲⒒閸屾艾鈧兘鎳楅崼鏇炵疇闁规崘顕х粻鐔兼煥閻斿搫孝缁炬儳娼￠弻鐔煎箚閻楀牜妫勯梺缁樻尰缁诲牓寮婚悢鐓庣闁逛即娼у▓顓犵磽娴ｅ搫顎撶紓宥勭窔瀵濡搁埡浣稿祮濠德板€愰崑鎾趁瑰鍫㈢暫婵﹥妞藉畷顐﹀礋闂堟稑澹嗙紓鍌欐祰閸╂牕鐣濋幖浣哄祦闁告劦鐓堝銊╂煃瑜滈崜鐔肩嵁閸愩劉鏋庨柟鎯х－椤斿矂姊洪崷顓炲妺闁瑰憡鎮傞崺鈧い鎺戭槸閻忥附鎱?
        this.targetSelector.addGoal(3, new TurretAssistOwnerGoal(this));
        this.goalSelector.addGoal(3, new LookAtPlayerGoal(this, Player.class, 8.0F));
        // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂?4: 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缂佺姷濞€閺岀喖宕滆鐢盯鏌涚€ｃ劌鈧繈寮婚弴鐔虹闁割煈鍠栭‖澶愭⒑閻熸澘鏆遍柡鍫墰閹广垹鈹戠€ｎ偄浠洪梻鍌氱墛閸掆偓婵炴垯鍨洪悡鏇㈡倵閿濆骸浜濈€规洖鐭傞弻鈥崇暆閳ь剟宕伴弽顓犲祦闁糕剝绋掗崑瀣煕椤愵偄浜濇い銉ヮ樀濮婃椽鎳￠妶鍛€鹃梺鑽ゅ枙娴滎剛鍒掓繝姘閻犲洩灏欓悾鍝勨攽椤斿浠滈柛瀣崌閺岀喖顢欓悾灞惧櫗闂佺懓鍢查幊妯虹暦濮椻偓閸┾剝绻涢幆褌澹曞┑掳鍊曢幊蹇涘煕?(婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯锋嫼閻熸粎澧楃敮鎺撶娴煎瓨鐓曢柟鎯ь嚟閹冲洭鏌熼鈧褑鐏掗梺鐓庮潟閸婃鎯侀崼銉︹拺闂傚牊鐩悰婊呯磼闊厾鐭欓柟顕嗙節楠炲洭鎮ч崼銏犲箞闂備礁鎼崯鐘诲磻閹剧粯鐓熸俊銈呭暙娴犺京鎹勯鐐寸厱鐎光偓閳ь剟宕戦悙鍝勭厱闁圭儤鍤氳ぐ鎺撴櫜闁告侗鍠栭弳鍫ユ⒑閸濄儱鏋旈柛瀣ㄥ€濆濠氭晲婢跺浜滈梺鍝勵槹閸ㄥ灚鎱ㄩ敃鈧—鍐Χ閸愩劎浠鹃梺缁橆殘婵挳鎮鹃悜钘壩╅柍鍝勶攻閺咃綁姊洪棃娑辩劸闁告柨顦靛畷鎴﹀箻鐠囪尙顔囬柟鐓庣摠缁嬫劗鑺辨繝姘棅妞ゆ劑鍨烘径鍕煙閸濄儱浜鹃柡鍛埣瀵挳鎮╅悽纰夌床闂備胶绮敃鈺呭窗閺嶎厼绀夐柨鏇炲€归悡娑氣偓鍏夊亾闁逞屽墴瀹曚即寮介鐘茬ウ闂佺硶鍓濋崙鐟邦瀶閵娾晜鈷戦柟鑲╁仜閳ь剚顨婂畷鐗堟償閵婏妇鐣抽梻鍌欒兌缁垶鈥﹂崼婵冩瀺闁哄洢鍨圭壕褰掓煙閹殿喖顣奸柣鎾寸洴閹﹢鎮欐０婵嗘婵犵鈧偨鍋㈤柡灞界Ч閹稿﹥寰勫Ο鎭嶏箓鏌ф导娆戞偧缂佽鲸鎸婚幏鍛存嚃閳╁啫鐏╅柍褜鍓氱喊宥嗙箾婵犲偆娼栫紓浣股戞刊鎾偡濞嗗繐顏╁ù鐘櫊濮婃椽宕ㄦ繝鍐弳缂備礁顦悥鐓庣暦濮樿泛绠抽柟鎼幖閹垿姊洪幖鐐插姉闁哄懏绻堥幃锟犲箻鐎靛摜鐦堥梺姹囧灲濞佳冪摥婵犵數鍋犻婊呯不閹惧磭鏆﹂柟杈剧畱缁€瀣亜閹惧鈽夊ù婊堢畺閺岋綁鎮㈤崨濠勫嚒濡炪倕娴氶崣鍐蓟濞戞埃鍋撻敐搴濇倣鐎规悶鍎查妵鍕敇閻愭潙鏋犻梺鍝勮嫰濡顢樻總绋垮耿闊洦鏌ㄩ?
        this.targetSelector.addGoal(4, new TurretPackAttackGoal(this));

        this.targetSelector.addGoal(4, new NearestAttackableTargetGoal<>(this, IronGolem.class, true));
    }

    // ==========================================
    // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾剧粯绻涢幋娆忕仾闁稿鍊濋弻鏇熺箾閻愵剚鐝旈梺鍛婅壘缂嶅﹪鐛弽顬ュ酣顢楅埀顒佷繆閼测晝妫柟顖嗗懐楔闂佸搫鐬奸崰鏍箖濞嗘搩鏁嗛柍褜鍓熷畷婵堟崉鐞涒剝鏂€濡炪倖姊婚崢褔寮抽柆宥嗩梿濠㈣埖鍔栭悡鐔兼煙閹规劖鐝柟鐧哥秮閺岀喖鎮剧仦瑙ｆ瀰闂佸搫鐭夌紞渚€鐛幒妤€绠ｆい鎾跺Т閹垿姊绘担鍛婃儓闁活厼顦遍幑銏犫攽閸℃瑦娈鹃梺缁樻⒒閳峰牓寮崘顔界厪闁割偅绻冪粊鈺呮煕閻愬瓨銇濇慨濠傛惈鏁堥柛銉戝懎濮堕梻浣规偠閸斿秴顭垮Ο璺ㄤ罕婵犵數濞€濞佳囶敄閸涱垳涓嶉柡宥庡亝閸犳劙鏌ｅΔ鈧悧鍡欑箔閹烘鐓熼柟閭﹀墾閸旂喖鏌熼崣澶屾憙缂佺姵绋戦埥澶娢熺喊鍗炴櫏闂傚倷鑳剁划顖炴晪闂佸憡蓱閻楁粓骞?
    // ==========================================



    private void lockInfoBook() {
        ItemStack stack = this.inventory.getItem(40);
        if (stack.isEmpty() || stack.getItem() != Items.WRITTEN_BOOK) {
            updateInfoBookAndSlots();
        }
    }

    private void tauntNearbyMonsters() {
        List<Monster> nearbyMonsters = this.level().getEntitiesOfClass(Monster.class, this.getBoundingBox().inflate(20.0));
        for (Monster monster : nearbyMonsters) {
            if (monster instanceof SkeletonTurret) continue;
            LivingEntity currentTarget = monster.getTarget();
            if (currentTarget == null || currentTarget instanceof Player) {
                monster.setTarget(this);
            }
        }
    }

    private void updateInfoBookAndSlots() {
        // 1. 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰级閻ゅ嫬鈹戞幊閸娧呭緤娴犲鐤い鎰╁€愰崑鎾愁潩椤掑效闂侀潧娲ょ€氫即鐛幒妤€绠ｆ繝鍨姃缁辨繈姊绘担鑺ャ€冪紒鈧担鑲濇稑鈹戠€ｎ亣鎽曢梺鎸庣箓椤︻垳绮诲☉娆嶄簻闁圭儤鍨甸埀顒勵棑閸掓帡鎮介崨濞炬嫼闂佸憡绺块崕閬嶅几閹达附鐓曢柕濞垮劜閸嬨儳鈧鍠涢褔鍩ユ径濞㈢喖鏌ㄧ€ｅ灚缍岄梻鍌欑閹诧繝銆冮崼銉ョ；婵炴垶鍩冮崑鎾斥槈瀹曞洤鍩岄梺瀹狀潐閸ㄥ潡宕洪崟顖氱闁靛ě鍛仭闂傚倷娴囬褏鎹㈤幋鐘叉瀳鐎广儱娲ㄩ惌姘跺级閸稑濡跨紒鈾€鍋撻梻浣规偠閸庢粓宕ㄩ姘畱濠电姷鏁告慨浼村垂閻撳簶鏋栨繛鎴欏灪閺呮繈鏌ㄩ弮鍌涙珪妞も晜鐓￠弻鐔封枔閸喗鐏撶紒鎯у綖缁瑩寮诲☉姘勃闁绘劦鍓涘▓銈夋倵濞戞瑧绠炴慨濠呮濞戠敻宕ㄩ鎯ф锭闂備焦瀵у畝鎼佸蓟閿濆鏅查柛娑卞幗浜涙俊鐐€ら崑鍛崲閸曨垰绠查柛鏇ㄥ灡閹偤鎮归崶锝傚亾閾忣偅姣勯梻鍌氬€峰ù鍥敋瑜忛幑銏ゅ箳濡も偓绾惧鏌ｅΟ鍝勬婵炴垯鍨圭粈瀣亜閹烘垵鈧槒銇愭ィ鍐┾拺闁革富鍘奸崝瀣亜閵娿儲顥㈤柛鈺傜洴楠炲鏁傞悾灞藉箞婵犵數鍋為崹鍫曟晝椤愶箑绀夐柣鏂款殠閻斿棛鎲稿鍕洸妞ゅ繐鐗嗛拑鐔兼煟閺冨倸甯剁紒鈧崘顔界厵缂備焦锚娣囶垶鏌涢弬娆炬█婵?闂?
        this.inventory.setItem(0, this.getItemBySlot(net.minecraft.world.entity.EquipmentSlot.MAINHAND));
        this.inventory.setItem(1, this.getItemBySlot(net.minecraft.world.entity.EquipmentSlot.HEAD));
        this.inventory.setItem(2, this.getItemBySlot(net.minecraft.world.entity.EquipmentSlot.CHEST));
        this.inventory.setItem(3, this.getItemBySlot(net.minecraft.world.entity.EquipmentSlot.LEGS));
        this.inventory.setItem(4, this.getItemBySlot(net.minecraft.world.entity.EquipmentSlot.FEET));

        // 2. 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弴鐐测偓褰掑磿閹寸姵鍠愰柣妤€鐗嗙粭鎺楁煕閵娿儱鈧悂鍩為幋锔藉亹閻庡湱濮撮ˉ婵堢磽娴ｇ懓濮堟い銊ワ躬瀵鎮㈤崗鐓庝罕闂佸壊鍋嗛崰鎾诲礄閿熺姵鈷戦柟鑲╁仜婵″ジ鏌涙繝鍌滅Ш妤犵偛鐗撴俊鎼佸Ψ鎼达絽鏋涚€规洜顭堣灃闁逞屽墴楠炴鎮介崨濠勫幗闁瑰吋鐣崹濠氥€傞懠顑藉亾閸忓浜鹃梺褰掓？缁€渚€鎷戦悢鍏肩厪濠电偟鍋撳▍鍛繆椤愶綇鑰块柡灞剧洴閳ワ箓骞嬪┑鍥╀簮闂備礁婀遍…鍫ュ疮閺夋埈娼栭柛婵嗗▕閾忚瀚氶柟缁樺笧椤旀劙姊婚崒娆戭槮閹煎瓨绮庣槐鐐寸瑹閳ь剟鎮伴鈧畷姗€顢樺鈧Ч妤呮⒑閸︻厼鍔嬮柛銊ョ秺瀹曟劙鎮欓悜妯轰画濠电姴锕ら崯鎵不缂佹﹩娈介柣鎰儗濞堟粓鏌熼瑙勬珚鐎规洘顨婂畷銊╊敍濠婂懏姣庨梻鍌氬€风粈渚€骞夐敓鐘冲仭闁靛鏁￠崶顒夋晬闁绘劖娼欓埀顒€鐖奸弻鐔虹磼閵忕姵鐏嶉梺?
        ItemStack book = new ItemStack(Items.WRITTEN_BOOK);
        book.setHoverName(Component.literal("闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗ù锝堟缁€濠傗攽閻樿弓杩规繛鎴欏灩缁犱即骞栭幖顓炴灍妞ゆ梹妫冨Λ鍛搭敃閵忊€愁槱缂備礁顑嗙敮锟犲箖閳ユ枼鏋庨柟鍓цˉ閹峰姊虹粙鎸庢拱缂佸甯炵槐鐐哄箣閿旂晫鍘?>> 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫆闁芥ê顦純鏇㈡⒒娴ｅ摜绉洪柛瀣躬瀹曟粓鏁冮埀顒勬箒闂佸搫绋侀崢浠嬫偂韫囨挴鏀介柣鎰灥閸燁垶宕抽懞銉ｄ簻闁挎棁顕ч悘锕傛煛瀹€瀣ɑ闁诡垱妫冮、娑橆煥閸涘拑缍佸娲传閵夈儛锝嗐亜閵娿儻宸ラ柣锝囧厴楠炲鏁冮埀顒傜不濞戙垺鐓熸俊銈傚亾闁绘绻樺畷銏°偅閸愨斁鎷洪梺鍛婄☉閿曪妇绱撳鑸电厱閹兼番鍨洪妵婵堚偓娈垮枟婵炲﹪銆佸☉銏″€烽悗鐢殿焾楠炲牓姊虹拠鎻掑毐缂傚秴妫濆畷鎴﹀川椤栨瑧鍓ㄦ繛瀵稿帶閻°劑鎮″▎鎴斿亾閻熸澘顏褎顨婂畷鐢稿炊椤掍胶鍘靛銈嗘⒒閺咁偊鎯屾繝鍥ㄦ嚉闁挎繂娲ㄥΛ顖涖亜閹惧崬鐒烘俊顐ｅ灩缁辨帡鍩€椤掑嫬绀冩い鏃囆掗幏?<<<"));

        // --- 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞鐟滄粌霉閺嶎厽鐓忓┑鐐靛亾濞呭棝鏌涢妶鍛伃闁哄被鍊楃划娆戞崉閵娿倗椹虫繝鐢靛仜閹虫劖鎱ㄩ崹顐も攳濠电姴娲ゅ洿闂佺鏈惌顔界珶閺囥垺鈷掑ù锝夘棑娑撹尙绱掗煫顓犵煓闁诡喗锚椤繄鎹勯搹璇″數闂備礁鎲＄粙鎴︽偤閵娾晛纾圭紓浣姑肩换鍡樸亜閺嶃劎鎳嗘い鎺斿枛閺屽秷顧侀柛鎾村哺閹嫰顢涘鍏肩稁濠电偛妯婃禍婊呯不娴兼潙绠归弶鍫濆⒔瀹€娑欎繆閹绘帞澧﹂柡宀嬬稻閹棃濮€閻樺弶鐦撻梻渚€娼荤紞鍥╁緤娴犲鏁?---
        int tier = getTier();

        float hp = this.getHealth();
        float maxHp = this.getMaxHealth();

        if (hp < maxHp * 0.2f) {
} else if (hp < maxHp * 0.5f) {
}

        // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箳閳ь剝顫夊ú鏍洪敃鍌ゆ晝濞寸姴顑嗛悡蹇涙煕椤愶絿绠栧璺哄閵囧嫰顢曢敐鍡欘槹闂佸搫鐭夌换婵嗙暦閸洖唯闁靛／鍌滄／闂傚倷鑳堕…鍫ヮ敄閸岀偛鐤炬繛鎴欏灩閻撴﹢鏌熸潏楣冩闁稿鍔欓幃妤呭捶椤撶倫銏°亜閵夛妇绠樼紒杈ㄦ崌瀹曟帒鈻庨幒婵嗘暭闂備礁鎼幊蹇涙儎椤栨熬鑰垮〒姘ｅ亾婵﹨娅ｇ划娆戞崉閵娧屽晥闂備胶顭堥鍡涘礉濞嗘挾宓佸┑鐘叉搐缁€瀣亜閺嶃劎鈽夐柍?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弴妤€浜惧銈庝簻閸熸潙鐣疯ぐ鎺濇晪闁告侗鍨版慨娲⒒娴ｄ警娼掗柛鏇炵仛閻ｅ墎绱撴担鎻掍壕婵犮垼鍩栭崝鏍磹閻㈠憡鐓ユ繝闈涙椤庢顭胯瑜板啴鍩為幋锔绘晩闁圭娴疯ぐ褔姊洪棃娑欐悙閻庢矮鍗抽悰顕€骞掑Δ鈧粻锝嗙節閸偄濮冮柟顕嗙秮濮婄粯鎷呴崨濠傛殘闂佽崵鍠嗛崕鐢稿极閸愵噮鏁傞柛顐ｇ箚閹芥洖鈹戦悙鏉戠仧闁搞劌婀辩划鑽ょ磼濡湱绠氶梺缁樺姍濞佳勭閻愵兙浜滈柨鏇炲亞濡垹绱?
        float speed = getFireRate();

        // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箳閳ь剝顫夊ú鏍洪敃鍌ゆ晝濞寸姴顑嗛悡蹇涙煕椤愶絿绠栧璺哄閵囧嫰顢曢敐鍡欘槹闂佸搫鐭夌换婵嗙暦閸洖唯闁靛／鍌滄／闂傚倷鑳堕…鍫ヮ敄閸岀偛鐤炬繝闈涚墛椤洟鏌熼幆褏鎽犲┑顖涙綑閳规垿顢欓挊澶屽姼婵炲瓨绮犳禍顏堝Υ娴ｅ壊娼╅柤鍝ユ暩閸斿爼鎮楅獮鍨姎婵☆偅鐩畷銏ゎ敂閸啿鎷洪梺鍛婃尰瑜板啯绂嶅┑鍫㈢＜閻犲洦褰冮弳鐐烘煕閹烘埊鏀荤紒杞扮矙瀹曘劍绻濋崟顐㈢疄?
        double dmg = getWeaponDamageForTier(tier);

        String state = this.entityData.get(IS_FOLLOWING) ? "[Follow Mode]" : "[Guard Mode]";
        boolean isBrutal = this.entityData.get(IS_BRUTAL);

        List<Component> lore = new ArrayList<>();
        lore.add(Component.literal("闂?===================="));

        // [A] 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ帒顦伴弲顏堟⒑閸濆嫮鈻夐柛妯垮亹缁絽螖閸涱喚鍘搁悗瑙勬惄閸犳牠鎳熼姘ｆ灁闁靛ň鏅滈埛鎴︽煕閹炬潙绲诲ù婊勭箖缁绘盯宕ｆ径灞解拡婵犮垼顫夊ú鐔风暦缁嬭鏃€鎷呴崫鍕婵犵數濮伴崹鐓庘枖濞戙埄鏁勯柛娑樼摠閸婂潡鏌ｉ幇闈涘缂佺娀绠栭幃妤€鈽夊▎妯煎姺婵犫拃鍛毈闁哄矉绱曟禒锔炬嫚閹绘帩鐎抽梻浣哥枃椤宕归崹顔炬殾闁告鍎愬銊╂煕椤愮姴鐏い锔诲灦濮婂宕掑▎鎰偘闂侀潧妫岄崑鎾绘⒑?
        if (tier == 0) {
            lore.add(Component.literal("闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墴閹潡顢氶埀顒勫蓟閺囩喓绠鹃柣鎰靛墯閻濇梻绱掗悙顒€鍔ゆ繛纭风節瀵鎮㈤搹鍦紲闂侀潧绻掓慨鐢告偟椤曗偓濮婄儤娼幍顕呮М闂佹寧娲︽禍顏勵嚕鐠囨祴妲堥柕蹇曞閵婏负浜滈柡鍐ㄥ€哥敮鑸点亜椤愮喐娅囩紒杈ㄦ尰閹峰懘骞撻幒宥咁棜闂傚倷鑳堕…鍫ユ儔婵傜纾婚柣鎰劋閸嬪倿鐓崶銊﹀皑闁衡偓娴犲鐓熸俊顖氱仢閻ㄨ櫣绱掗悩鐢靛笡濞ｅ洤锕︾槐鎺楀閻樺磭浜剧紓鍌欑贰閸ｎ噣宕ｉ崘顔惧祦閻庯綆鍠楅崐鐑芥煟閵忊槅鍟忛柛鐔烽叄濮婄粯鎷呴悜妯烘畬濡炪倖娲﹂崣鍐ㄧ暦閹达附鍊烽柡宥囶焾椤﹂潧鐣烽崡鐑嗘富闁哄洨濮甸崵鈧銈庡幑閸斿秹骞嗛弮鍫濈伋闁哄倶鍎茬€氼剟姊?.. 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈢粯淇婇悙顏勨偓鏍偋濡ゅ啰鐭欓柟鐐湽閳ь剙鎳樺畷锝嗗緞瀹€鈧惁鍫ユ⒒閸屾氨澧涚紒瀣浮閺佸秹寮崼鐔哄幘闂佸搫顦冲▔鏇熺閵忋倖顥嗗鑸靛姈閻撱儲绻濋棃娑欘棡闁革絾妞介幃褰掑箛閸撲胶鐦堥梺鍝勮嫰缁夊墎妲愰幒鎳崇喎煤缂佹﹩妫冮梻鍌欑閹碱偊鎳熼婊呯煋闁绘垿鎽妸锔剧懝闁逞屽墴瀵鈽夐姀鐘殿啋闁诲酣娼ч幉锟犲礆濞戞鏃堟偐闂堟稐绮堕梺鍝ュ枑閹告娊鎮伴纰卞悑濠㈣埖蓱閺呪晝绱撻崒娆戝妽闁挎艾鈹戦娆忓祮婵﹦绮幏鍛槹鎼存繆顩紓鍌欐祰瀵挾鍒掑▎蹇ｅ殨闁汇垹澹婇弫鍡涙煕閺囥劌浜為柣銈呮噺缁绘繈鎮介棃娴讹絿鐥弶璺ㄐч柛鈺傜洴楠炲鏁傞悾灞藉箺闂備浇顫夊畷妯衡枍閺囥垹绠查柨婵嗩槹閻撱儲绻涢幋鐑嗙劷閺佸牓姊洪崫鍕効缂佺粯绻傞悾鐑筋敂閸涱喖顎撻梻鍌楀亾闁归偊鍠氬▔鍧楁⒒閸屾瑧鍔嶉悗绗涘厾楦跨疀濞戞ê鐎梺鑺ッˇ閬嶅汲閿曞倹鐓忓┑鐐戔偓閸嬫捇鏌涚€ｎ偅灏柍钘夘槸閳诲秹鎼归銏淮闂?"));
            lore.add(Component.literal("[T0] Obey command. Commander is absolute."));
        } else if (tier >= 1 && tier < 4) {
            lore.add(Component.literal("闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗ù锝堟缁€濠傗攽閻樿弓杩规繛鎴炵瀹曞鏌曟繝蹇曠暠閹兼潙锕ら埞?闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箻閺岀喖骞嗛弶鍟冩捇鏌涙繝鍌涘仴闁哄被鍔戝鏉懳旈埀顒佺閹屾富闁靛牆楠搁獮鏍煟韫囨梻绠氶柣蹇斿浮濮婅櫣绮欑捄銊ь唺闂佸憡顭嗛崟顒€鍔呮繝鐢靛Т濞诧箓鍩涢幋鐘电＜閻庯綆鍋勯婊勭節閳ь剟骞嶉鍓э紲濡炪倖妫侀崑鎰版倿閸濄儮鍋撳▓鍨灍闁诡喖鍊搁悾閿嬬附缁嬭銊╂煏婢诡垰鑻弲锝夋⒒娴ｅ憡鎯堟い锔诲灦閹囧幢濡粯鐝锋繛瀵稿Т椤戝懐绮堥崱娑欑厽婵°倐鍋撻柣妤€瀚粋? 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤濠€閬嶅箟閹间焦鍋嬮柛顐ｇ箘閻熸煡姊虹粙娆惧剰妞ゆ垵顦靛濠氭晸閻樻彃鎯為梺鍓插亝濞诧箓寮抽幒鎾村弿?" + this.entityData.get(UNIT_ID) + " ]"));
            lore.add(Component.literal("[T1] No heroes here, only survivors."));
            lore.add(Component.literal("[T1] Weapons are carved from bone and will."));
        } else {
            lore.add(Component.literal("闂?[ 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煟閵忋埄鐒剧紒鎰殜閺岀喖骞嶉纰辨毉闂佺顑戠换婵嬪蓟閺囩喎绶為柛鈩兩戝▓婵嬫⒑閹肩偛鍔撮柛鎾村哺瀹曟垿濡歌绾惧ジ鎮楅敐搴″箺缁绢厼鐖奸弻锛勪沪閻ｅ苯鈪甸梺鍝勭焿缁查箖骞嗛弮鍫晬婵犲﹤鎲涢敐澶嬧拺闁告稑锕ョ亸鎵棯閺夎法效鐎规洘纰嶇换婵嬪礃椤忓牊顎嶉梻浣告啞缁嬫垿鏁冮敃鍌氬偍闁告稑锕︾弧鈧梺闈涢獜缁插墽娑垫ィ鍐╁€垫繛鎴炲笚濞呭洦绻涢幋鐘虫毈鐎规洘绮嶉幏鍛存惞閻у摜搴? 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛濠傛健閺屻劑寮崼鐔告闂佺顑嗛幐鍓у垝椤撶偐妲堟俊顖濐嚙椤︹晠姊虹粙娆惧劀缂佺粯绻堝濠氬即閻旇櫣顔曢梺缁樺姦閸撴岸鎮甸敃鍌涒拺?]"));
            lore.add(Component.literal("[T3] I saw giant coordinates streak across the sky."));
            lore.add(Component.literal("[T3] Are we data in a simulation? Answer me, commander."));
        }



        lore.add(Component.literal(" "));

// [B] 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缂佺姷濞€閺岀喖宕滆鐢盯鏌涚€ｃ劌鈧繈寮婚弴鐔虹闁割煈鍠栭‖澶愭⒑閻熸澘鏆遍柣顓炲€搁～蹇曠磼濡顎撻梺鍛婄☉閿曘儵宕曢幘鎰佹富闁靛牆妫楅悘銉︾箾瀹割喖骞栭柣锝夋敱鐎靛ジ寮堕幋婵嗘暏婵＄偑鍊栭幐楣冨磻閻樿绠洪柡鍥ュ灪閳锋垹绱掗娑欑濠⒀嗗皺缁辨帞鈧綆鍋勯悘銉╂煛娓氬洤娅嶆慨濠勭帛閹峰懘鎮烽柇锕€娈濋梻浣告惈閻瑩宕惰椤︽澘鈹戦濮愪粶闁稿鎸鹃埀?(闂?闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫鍐煥閺囨浜鹃梺姹囧€楅崑鎾舵崲濠靛洨绡€闁稿本绮岄·鈧梻浣侯焾椤戞垹鎹㈠┑瀣摕鐎广儱顦导鐘绘煕閺囥劌澧繛鍜冪秮濮婂宕掑顑跨敖闂佹悶鍔忓▔娑綖韫囨拋娲敂閸曨偆鈧厼顪冮妶鍡樼闁瑰啿閰ｅ畷婊堝箮閼恒儮鎷洪悗瑙勬礀濞层劎鏁☉娆愬弿濠电姴鍋嗛悡濂告煕閳规儳浜炬俊鐐€栧濠氬磻閹惧墎纾奸柣妯垮皺鏁堥悗瑙勬礃濞叉ê顭囪箛娑樼厴闁诡垎鍌氼棜婵犳鍠楅…鍥储瑜斿鎼佸Χ閸モ晝锛滃銈嗘礀濡盯宕氭导瀛樻嚉闁哄稁鍘介悡鏇熺箾閹存繂鑸归柡瀣ㄥ€濋弻娑橆潨閳ь剚绂嶇捄渚綎濡わ箒锟ユ禍褰掓煙閻戞ê鐏ｉ柛鐘诧躬濮婃椽宕ㄦ繝鍐ㄩ瀺缂備礁顑嗙敮锟犲箖瑜庨幆鏃堝煢閳ь剟寮ㄦ禒瀣厽婵☆垵顕ф晶顖炴煕閻旈绠婚柡灞剧洴閹晠鎼归銏紦闁诲氦顫夊ú姗€宕濋弴銏犵厴闁瑰濮崑鎾绘晲鎼存繃鎹ｉ梺纭呭Г濞茬喎顫忓ú顏咁棃婵炴垼浜崝鎼佹⒑缁嬪灝鐦ㄩ柛锝忕到椤曪綁宕ㄦ繝鍐ㄥ妳闂侀潧顭堥崕鎶筋敊閹扮増鐓涘璺猴功婢ф洖顭胯缁瑥鐣峰顓烆嚤閻庢稒顭囬崢?
        lore.add(Component.literal("[Combat Telemetry]"));
        lore.add(Component.literal(String.format("  闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗ù锝堟缁€濠傗攽閻樿弓杩规繛鎴炵瀹曞鏌曟繛褍鍟憴锕傛⒒娴ｇ懓顕滅紒璇插€哥叅闁靛ě鍐炬婵炲濮撮鍡涙偂閺囥垺鍊堕柣鎰絻閳锋棃鏌熼崘鍙夊殗闁哄本鐩顒傛崉閵婃剬鍥ㄧ厸鐎光偓閳ь剟宕伴幘璺哄灊婵炲棗绻嗛弸搴ㄦ煕閹炬鍟崐顖炴⒒閸屾瑦绁版い鏇熺墵瀹曟澘螖閸涱偀鍋撻崘鈺冪瘈闁搞儯鍎崑鎾存媴缁洘顫嶅┑鈽嗗灦閺€閬嶅极閻樼粯鈷戦悹鍥ｂ偓宕団偓濠氭煕鐏炴儳鍤俊顐ｇ矒濮婂宕掑▎鎰偘閻庤娲滈弫璇茬暦娴兼潙绠婚悗娑櫳戦悵宄扳攽鎺抽崐鎰板磻閹剧粯鐓ラ柡鍥悘顏堟倵娴ｅ啫浜归柍褜鍓氱粙鎺椻€﹂崶顒€鍌?%.0f / %.0f", hp, maxHp)));
        lore.add(Component.literal(String.format("  闂?闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃繘鍩€椤掍胶鈻撻柡鍛█閵嗕礁鈻庨幘鍐插敤濡炪倖鎸鹃崑鐔兼偘閵夈儮鏀芥い鏃傜摂閻掑墽绱撻崼婊冨祮闁糕斁鍋撳銈嗗灱濞夋洟宕濆鍥╃＜缂備焦顭囩粻鐐碘偓瑙勬礃鐢帡鈥﹂妸鈺佺妞ゆ帒顦弲顐︽⒒閸屾艾鈧兘鎳楅崼鏇椻偓锕傚醇閵夛箑鍓舵繝闈涘€婚…鍫㈠婵犳碍鐓熼柟閭﹀墯閹牏鐥悙顒€顕滈柟渚垮妼椤啰鎷犻煫顓烆棜闂傚倷绀侀幖顐ｅ緞閸ヮ剙绀堟繝闈涙－閸ゆ鏌涢弴銊ュ箰闁稿鎹囬弫鎰償濠靛牊鏅煎┑鐐差嚟婵挳骞楀鍛潟?%.1f", dmg)));
        lore.add(Component.literal(String.format("闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗ù锝堟缁€濠傗攽閻樿弓杩规繛鎴炵瀹曞鏌曟繝蹇曠暠閹兼潙锕ら埞鎴︽偐缂佹ɑ閿銈嗗灥濡繈骞冮敓鐘冲亜闁兼祴鏅涜ぐ鍕⒑閹肩偛鍔橀柛鏂跨Ф娴滄悂鎮介悽鐢碉紲闂佺粯锚瀹曨剙鐣甸崱娑欑厵妞ゆ梻鐡斿▓鏃€銇勯锝囩疄闁诡喒鍓濋幆鏃堝煢閳ь剟骞忛锔界厽閹兼番鍊ゅ鎰箾閸欏鐭掔€殿噮鍋呯换婵嗩潩閵夈垹浜惧ù锝囩《閺嬪酣鏌熼幑鎰彧妞ゃ儲绻堝娲濞戞艾顣哄┑鐐茬湴閸旀垿骞冮敓鐘茬闁挎棁袙閹风粯绻涙潏鍓ф偧闁稿簺鍊濆畷鐢稿焵椤掆偓椤啴濡堕崱妯侯槱闂佸憡眉缁瑩鐛崼銉ノ╅柍杞拌兌椤旀帒顪冮妶鍡橆梿婵☆偄瀚埢? %.1f", speed)));
        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼槮闁搞劍绻冮妵鍕冀椤愵澀绮堕梺鍝勫閸庣敻寮诲☉銏╂晝闁绘ɑ褰冩慨搴ㄦ⒑缁嬭儻顫﹂柛鏃€鍨垮濠氬Χ閸氥倕婀遍埀顒婄秵閸嬪懎顭块幒妤佲拺缂佸顑欓崕鎰版煙閹间胶鐣烘鐐差樀楠炴﹢顢欓懖鈺婃Ч婵＄偑鍊栭崝妤呭窗閹扮増鍊堕柛鈩冪⊕閻撶喖骞栧ǎ顒€鐒洪柛鐔风箻閺屾盯鎮╅搹顐ゎ槹閻庤娲╃换婵嗙暦濮椻偓閹崇娀顢楁担璇″晭濠电姷鏁告慨鎾晝閵堝憘娑㈩敇閻愬稄绲块幉鎾礋椤撶媭鍟?

        if (isBrutal) {
            lore.add(Component.literal("  闂?濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰鍐€妞ゆ劦婢€缁泛鈹?闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃繘鍩€椤掍胶鈻撻柡鍛█閵嗕礁鈻庨幘鍐插敤濡炪倖鎸鹃崑鐔兼偘閵夈儮鏀介幒鎶藉磹閹版澘纾婚柟鍓х帛閸嬪倿鏌曢崼婵囶棡闁告瑥绻戞穱濠囨倷妫版繂娈繛瀛樼矋閸庡疇鐏冮梺缁橈耿濞佳勭閿曞倹鐓熸俊銈呭暙瀛濋梺浼欑悼閸忔ɑ淇婇幖浣规櫆闁告挆鍛潓闂傚倷绀侀幉锟犲礈椤掑嫬绀嬫い鎰剁稻閺嗘﹢姊婚崒姘偓鎼佸磹閻戣姤鍊块柨鏇炲€哥粻鏍煕椤愶絾绀€缁炬儳娼￠弻锝夊箣閻戝棛鍔峰銈傛櫅瀵墎鎹㈠┑瀣棃婵炴垶鑹鹃埅閬嶆⒑? 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌熼梻瀵割槮缁惧墽绮换娑㈠箣濞嗗繒浠鹃梺绋款儏椤戝寮诲☉銏犵労闁告剬鍛畳闂備浇妗ㄧ粈浣衡偓姘嵆瀵鈽夐姀鐘靛姶闂佸憡鍔х紓姘辫姳婵傚憡鈷戦柛锔诲幖閸斿鏌涢埡浣哄妞ゎ厼娲崺锟犲磼濡湱鐩庨梻浣烘嚀閻°劌顫忛悷鎵虫瀺闁搞儺鍓氶悡鏇㈡煟濡櫣锛嶅褏鏁搁埀顒冾潐濞叉牜绱炴繝鍥╁祦闁糕剝鍑瑰Σ楣冩⒑閸濆嫭锛旂紒鐘虫崌瀵鈽夐姀鐘栥劑鏌曡箛濠傚⒉闁绘繐绠撳铏规偘閳ュ厖澹曢梻渚€娼ц墝闁哄懏绮撻幃锟犳偄閻撳海顔愮紓渚囧枤閹虫挻鏅堕弻銉﹀仯闁硅埇鍔屾晶鏌ユ煏閸パ冾伃妞ゃ垺锕㈤幃娆撴濞戣鲸姣囧┑锛勫亼閸婃牕煤閳哄啰绀婂ù锝呮憸閺嗭附绻濇繝鍌氼仾濠殿垱鎸抽弻褑绠涢弴鐔锋畬濡炪倧鑵归弲婊呮崲濠靛鍋ㄩ梻鍫熺◥缁泛鈹戦埥鍡楃仩闁挎洏鍎崇划瀣吋閸涱亝鏂€闁诲函缍嗘禍鐐哄蓟?"));
        } else {
            int heat = getHeat();
            String heatColor = heat > 80 ? "[HOT] " : (heat > 40 ? "[WARM] " : "[COOL] ");
            lore.add(Component.literal(String.format("  闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗ù锝堟缁€濠傗攽閻樿弓杩规繛鎴欏灩闁裤倖淇婇妶鍕厡闁告梹鎮傚娲倷閽樺濮曠紓浣稿閸嬫盯鍩ユ径鎰潊闁斥晛鍟悵鎶芥⒒娴ｅ憡鍟炲〒姘殜瀹曘垽鎸婃径鍡樼亖闂佸搫琚崕鏌ュ煕?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫆缂備焦蓱濞呭牓姊绘担鍝ョШ闁稿锕畷銏°偅閸愶腹鍋撻崨鏉戣摕闁靛濡囬崢浠嬫⒑瑜版帒浜板ù婊愮秮椤㈡鎮㈤崗鑲╁幐婵炶揪绲介幉锟犲窗濮椻偓閺屸€崇暆閳ь剟宕伴弽褜娼栭柤濮愬€愰崑鎾绘偨濞堣法鍔告繝纰樷偓鑼煓婵﹨娅ｇ划娆撳礌閳ュ啿顫犵紓鍌欑贰閸ｎ噣宕归懜鍏哥箚闁汇垻顭堢粈瀣亜閺嶃劍鐨戞い鏃€甯￠弻锝夋偐閼姐倗绐楀┑鈩冦仠閸斿酣宕氶幒鏃€宕夊〒姘煎灡鐎? %s%d%%", heatColor, heat)));
        }

        lore.add(Component.literal(" "));

        // [C] 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缂佺姷濞€閺岀喖宕滆鐢盯鏌涙繝鍌滃煟闁哄本鐩、鏇㈡偐閹绘帒顫撶紓浣哄亾閸庢娊鈥﹂悜钘夎摕闁绘梻鍘х粈鍫㈡喐韫囨洘鏆滄繛鎴欏灪閻撶喖鏌熼幑鎰【闁宠鐗撻弻鐔碱敊缁涘鐤侀悗瑙勬礈閸忔﹢銆佸鈧幃娆撳箛閳轰胶浼勯梺璇″櫘閸犳牠锝炲┑瀣殝闁汇垽娼ч獮姗€姊绘担瑙勫仩闁告柨绉剁划娆撳箳閹存梹鐎烘繝鐢靛Т濞诧箓鎮?(闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柤鑹板煐閹蹭即姊绘担鐟邦嚋缂佽鍊胯棟妞ゆ牗绮庨惌鍡楊熆鐠哄搫顦柛瀣崌閻涱噣宕归鐓庮潛婵＄偑鍊х€靛矂宕归崼鏇炵畺闁绘劕鎼崹鍌涖亜閹邦喖小缂併劌顭峰铏规兜閸涱喖娑х紓浣瑰絻婢ц棄鈽夐悽绋块唶闁哄洨鍠撻崢閬嶆⒑閸濆嫬鈧棄鈻旈弴鐔哄ⅰ婵犵數鍎戠徊钘壝洪妶澶嬫櫇妞ゅ繐鐗勯埀顑跨閳藉顫滈崱妯哄厞闂備胶顭堢换鎰板Φ濞嗘挸惟鐟滃繒澹曢挊澶堚偓鎺戭潩椤掍焦鎮欓梺鍝勵儐閻╊垶寮婚敐鍛傛梹鎷呴悷鎵暡闂備椒绱徊鍧楀礂濮椻偓閵嗕線寮撮姀鈩冩珖闂侀€炲苯澧扮紒顔肩墢閳ь剨缍嗛崑浣圭濠婂牊鐓欓柟瑙勫姈绾偓銇勯锝呯仸闁靛洤瀚粻娑㈠箻鐠轰警鏉搁梻浣瑰▕閺€閬嶅垂閸ф钃熸繛鎴炃氬Σ鍫熸叏濡も偓閻楀﹪寮ィ鍐╃厽闊洦鎸荤粋瀣煕濡搫鈷旀俊鍙夊姍楠炴帡骞樺畷鍥╃嵁闂佽绻掗崑鐔煎磻閹炬壙鎺楀礋椤栨稈鎷洪梻渚囧亞閸嬫盯鎳熼娑欐珷妞ゆ牜鍋為悡鏇熺節闂堟稒顥㈤柛娆忓閳ь剝顫夊ú鏍礊婵犲洤绠板┑鐘插暙缁剁偞淇婇婊冨妺妞ゆ挸娼″缁樻媴缁嬫妫岄梺缁樻尭閻楁挸鐣烽幋锕€绀嬫い鎾跺櫏閸嬨劑姊虹紒妯哄闁稿簺鍊濆畷鎰板醇閺囩喓鍘介梺褰掑亰閸樿偐寰婃繝姘厓闂佸灝顑嗛ˉ鍫ユ煛?
        lore.add(Component.literal("[Skills]"));
        getSkillList(tier).forEach(s -> lore.add(Component.literal("  " + s)));

        lore.add(Component.literal(" "));

        // [D] 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫鍐煥閺囨浜鹃梺姹囧€楅崑鎾舵崲濠靛洨绡€闁稿本绋戝▍褔姊哄ú璇插箺闁荤啿鏅犲濠氭偄鐞涒€充壕闁汇垺顔栭悞鍓ф偖閵夆晜鈷戠紒瀣儥閸庢劙鏌熼悷鐗堟悙闁伙絿鏌夐妵鎰板箳濠靛洦娅囬梻渚€娼ч悧鍡涘箠鎼达絿纾奸柍鍝勫€风换鍡涙煏閸繃鎼愰崯鎼佹⒑缁嬫鍎戦柛瀣ㄥ€曢悾宄扳攽閸″繑鐎婚棅顐㈡处濞叉ê鈻撴ィ鍐┾拺閻犲洠鈧磭浠搁梺绋款儏閿曘倕宓勯梺鍛婃寙閸涱垽绱?(闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柤鑹板煐閹蹭即姊绘担鐟邦嚋缂佽鍊胯棟妞ゆ牗绮庨惌鍡楊熆鐠哄搫顦柛瀣崌閻涱噣宕归鐓庮潛婵＄偑鍊х€靛矂宕归崼鏇炵畺闁绘劕鎼崹鍌涖亜閹邦喖小缂併劌顭峰铏规兜閸涱喖娑х紓浣瑰絻婢ц棄鈽夐悽绋块唶闁哄洨鍠撻崢閬嶆⒑閸濆嫬鈧棄鈻旈弴鐔哄ⅰ婵犵數鍎戠徊钘壝洪妶澶嬫櫇妞ゅ繐鐗勯埀顑跨閳藉顫滈崱妯哄厞闂備胶顭堢换鎰板Φ濞嗘挸惟鐟滃繒澹曢挊澶堚偓鎺戭潩椤掍焦鎮欓梺鍝勵儐閻╊垶寮婚敐鍛傛棃鍩€椤掑嫭鏅濋柕鍫濐槴閳ь剨绠撳畷鍫曨敆婢跺娅嗛梻浣稿閸嬪懐鎹㈤崟顖ｆ晣闁绘挸瀵掑〒濠氭煏閸繃顥為柍閿嬪浮閺屾稓鈧綆鍋呭畷宀€鈧娲﹂崹璺侯嚕閸洖绠ｉ柡鍐ｅ亾闁哄倵鍋撻梻鍌欒兌缁垶宕濋弽褜鐒芥繛鍡樻尰閸婂爼鏌ㄩ弴鐐测偓褰掓偂濞嗘挻鐓曟繛鎴烇公閺€濠氭倶韫囥儱顩柍褜鍓濋～澶娒哄鈧畷褰掑锤濡ゅ啫绁﹀┑顔姐仜閸嬫挾鈧娲樼划宥夊箯閸涘瓨鍋栭悗鐢殿焾缁ㄣ儵姊婚崒姘偓鐑芥嚄閸撲礁鍨濇い鏍仦閸嬶繝鏌ㄩ弴鐐测偓褰掑磻閿熺姵鐓忓璺虹墕閸擃厽绻涘顔荤凹闁哄懏绮撻弻锝夋晲閸涱垳鍔稿┑鐐存綑鐎氼剟鍩為幋锔绘晩濠殿喗鍔掔划鍫曟⒑缁嬫鍎愰柟鐟版喘瀵?
        if (tier < 5) {
            lore.add(Component.literal("Next Tier -> " + getTierName(tier + 1)));

            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴姘辩Т闂佹悶鍎洪崜锕傚极閸愵喗鐓ラ柡鍥殔娴滃墽绱掗悙顒€鍔ゆい顓犲厴瀵鎮㈤悡搴ｎ槶閻熸粌绻掗弫顔尖槈閵忥紕鍘介梺瑙勫劤椤曨參鍩ユ径鎰梿濠㈣埖鍔栭悡銉︾節闂堟稒顥為柛锝嗘そ閺岀喖宕ｆ径瀣偓鎰版煛瀹€瀣М妤犵偞甯￠獮瀣倷閸欏鐣肩紓鍌氬€烽懗鍓佸垝椤栫偞鍎庢い鏍仧瀹撲焦淇婇婵囶仩闁哄棴绠撻弻娑㈠Ψ閹存繃鍣规鐐搭殜濮?
            int kills = getKillCount();
            int target = getKillTarget(tier);
            String killColor = kills >= target ? "[READY]" : "[PROGRESS]";
            lore.add(Component.literal(String.format("  %s 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柟缁樺笧閳ь剦鍙冨娲閳轰胶妲ｉ梺鍛娒妶绋跨暦閻熸壋鏀介柛銉ｅ劙缁ㄥ姊洪崫鍕犻柛鏂跨焸瀹曠敻顢楅崟顒傚幗闂佺懓鎼粔鍫曟儗濞嗘挻鐓涢悘鐐插⒔濞插瓨顨ラ悙鍙夊枠婵☆偄鍟埥澶娾枎閹存粓鍋楃紓鍌氬€搁崐鐑芥嚄閼搁潧鍨旈悗鐢殿焾缁躲倝鏌ｉ幇闈涘闁崇懓绉撮埞鎴︽偐閸欏銈╅梺杞扮缁夌數鎹㈠┑鍥╃瘈闁稿本纰嶅▓顓熺箾鐎电校闁挎洏鍨归～? %d / %d", killColor, kills, target)));

            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴姘辩Т闂佹悶鍎崝宀勵敋闁秵鐓涘璺侯儏閻忊晜銇勯敂璇叉珝婵﹥妞藉畷顐﹀礋椤撴稒鐎遍梻浣告啞閿氶柕鍫㈩焾閻ｅ嘲鈻庨幘鏉戜汗缂傚倷鐒﹂…鍥矗閸℃稒鈷戠紓浣股戦悡銉╂煙绾板崬浜濋柣妤€瀛╂穱濠囨倷椤忓嫧鍋撻幋锕€纾块柛妤冨€ｅ☉妯锋斀閻庯綆浜ｉ幗鏇㈡倵楠炲灝鍔氶柣妤佺矊椤﹪濡搁埡鍌楁嫼闂佸憡绋戦敃銉т焊閻㈠憡鐓曢柣妯虹－婢ь亝銇?
            Item mat = getUpgradeMaterial(tier);
            int cost = getBaseMaterialCost(tier);
            boolean hasDiscount = ((float)kills / target) >= 0.5f;
            if (hasDiscount) cost = (int)Math.ceil(cost / 2.0); // 5闂?

            String costStr = hasDiscount ? ("闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗ù锝堟缁€濠傗攽閻樿弓杩规繛鎴欏灩缁犱即骞栭幖顓炴灍妞?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愭い鏃傛嚀娴滈箖鏌涢幇闈涙灈鐎瑰憡绻堥幃妤€鈽夊▍铏灥閳诲秹宕堕浣叉嫼闂佸湱顭堝ù椋庣不閹炬番浜滈柨鏂跨仢瀹撳棛鈧? " + cost) : ("" + cost);
            lore.add(Component.literal("  Material Injection: " + mat.getDescription().getString() + " x" + costStr));
            lore.add(Component.literal("  闂? (闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗霉閿濆牊顏犵紒鈧繝鍌楁斀闁绘ɑ褰冩禍鐐烘煟閹烘梹娅曢柟鍙夋倐瀵噣宕煎☉鎺戜壕濞撴埃鍋撶€殿喕绮欓、姗€鎮欓懠鍨涘亾閸喒鏀介柣鎰级椤ユ粓鏌ゅú璇茬仭缂佸倸绉甸妶锝夊礃閳哄啫骞堟俊鐐€ら崢浠嬪垂閸偆顩叉繝闈涙储娴滄粓鏌曟径鍫濆姢濠⒀佸灲閺屽秷顧侀柛鎾村哺椤㈡瑩寮介鐐电崶闂佸搫绋侀崢浠嬪磻婢跺ň鏀介柛灞剧閹插摜鈧鎸风欢姘跺蓟濞戙垹唯妞ゆ梻鍘ч埛鎺楁⒑鏉炴壆顦︽繛宸弮瀵鏁愭径濠勭潉闂佹悶鍎崝濠囧焵椤掆偓閸燁垶骞堥妸褎鍠嗛柛鏇炵仛閻や礁鈹戦纭峰姛缂侇噮鍨堕獮蹇涘川閺夋垵绐涙繝鐢靛Т閸婄懓鈻撳鈧缁樻媴閽樺鎯為梺闈╃秶缁犳挸顫忔禒瀣妞ゆ挾鍠庢惔濠傗攽閻愭潙鐏﹂柣鐔濆懎濮柍褜鍓熷娲箹閻愭彃濡ч梺鍛婃处閸樻悂宕戦幘娲绘晢闁逞屽墴閳ユ棃宕橀鍢壯囨煕閳╁厾顏堟嫊婵傚憡鈷戦柟鑲╁仜婵¤姤淇婇悙鑸殿棄闁伙絿鍏橀獮鍥偋閸績鍋撴繝姘厾闁诡厽甯掗崝銈夋煕濡湱鐭欐慨濠呮缁辨帒螣閼姐倕寮抽梻浣侯攰椤曟粎妲愰弴鐐╂瀻闁靛繈鍊曢惌妤€顭跨捄渚剰鐎殿喖娼″娲箰鎼达絿鐣甸梺褰掓敱閸ㄥ灝顕ｉ妸鈺傚殥闁靛牆娲ㄩ敍婊呯磽閸屾瑧鍔嶆い顓炴喘閸╁﹪寮撮悩顐壕闁割煈鍋呯欢鏌ユ倵濮橆厽绶查柣锝囧厴閹剝鎯斿Ο缁樻澑闂備胶纭跺褔寮插┑瀣劦妞ゆ帊绀侀埢鏇熸叏?"));
        } else {
            lore.add(Component.literal("[MAX] Chassis evolution complete."));
        }

        lore.add(Component.literal("闂?===================="));
        lore.add(Component.literal("*This card is a holographic projection only."));

        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缂佺姷濞€閺岀喖宕滆鐢盯鏌涙繝鍛厫闁逛究鍔岃灒闁圭娴烽妴鎰磽娴ｅ搫小闁告濞婂璇测槈濡攱鏂€闂佸憡娲﹂崑鍕叏婢舵劖鈷戠紒瀣儥閸庢劙鏌熼悷鐗堟悙闁伙絿鏌夐妵鎰板箳濠靛洦娅囨俊鐐€栫敮鎺楀疮閻樿纾婚柟鎹愬煐瀹曞鏌曟繛鍨仼濞存粓绠栭幃宄扳枎韫囨搩浠剧紓浣插亾闁告劦鍠楅悡銉︽叏濡灝鐓愰柣鎾冲暣閹綊宕惰缁狙囨煕閻愬樊妲虹紒杈ㄥ浮閹晛鐣烽崶銊ュ灡婵°倗濮烽崑鐐烘晝閵忋倕绠圭憸鐗堝俯閺佸啴鏌曟竟顖氬暙缁?NBT
        CompoundTag display = new CompoundTag();
        ListTag loreTag = new ListTag();
        for (Component c : lore) {
            loreTag.add(net.minecraft.nbt.StringTag.valueOf(Component.Serializer.toJson(c)));
        }
        display.put("Lore", loreTag);
        book.addTagElement("display", display);

        this.inventory.setItem(40, book);
    }



    // ==========================================
    // 闂?[闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柤纰卞墻濡茬兘姊绘担鍛婃儓缂佸绶氬畷銏ゅ礂绾拌鲸鏁梻鍌氬€烽懗鍓佸垝椤栫偛绀夋俊銈呮噹閺嬩線鏌涘┑鍕姢闁活厼妫楅埞鎴︽偐閸欏顦╅梺缁樻尰閻熲晛顕ｉ崼鏇為唶婵犻潧妫岄幐鍐⒑娴兼瑧绉ù婊庡墰濡叉劙骞掑Δ浣镐汗闂佸憡鍔栫粊鎾几濞嗘挻鈷戦柛婵嗗濠€鐗堢箾閸欏顏堫敋閵夆晛绀嬫い鏍ㄥ哺閸炶泛鈹戦悩缁樻锭婵☆偅顨婇敐鐐哄箻閸撲胶锛濋梺绋挎湰閼归箖鍩€椤掆偓閹芥粎鍒掗弮鈧幏鍛村礃閿旀寧鐫?UI 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞鐟滄粌霉閺嶎厽鐓忓┑鐐靛亾濞呭棝鏌涢妶鍛伃闁哄被鍊楃划娆戞崉閵娿倗椹虫繝鐢靛仜閹虫劖鎱ㄩ崹顐も攳濠电姴娲ゅ洿闂佺鏈惌顔界珶閺囥垺鈷掑ù锝夘棑娑撹尙绱掗煫顓犵煓闁诡喗锚椤繄鎹勯搹璇″數闂備礁鎲＄粙鎴︽偤閵娾晛纾圭紓浣姑肩换鍡樸亜閺嶃劎绠栨い蹇曞Х閹叉悂鎮ч崼鐔峰攭濠殿喖锕ュ浠嬪箠閿熺姴围闁告稑鎳岄崹铏规崲濞戞碍瀚氱憸蹇涙偩閹惰姤鐓忛柛銉ｅ妼婵秶鈧娲橀敃銏ゃ€侀弮鍫濈妞ゆ挾濮烽幗宀勬⒒閸屾瑧顦﹀鐟帮躬閹繝宕奸妷銉х崶闂佸湱鍎ら崵锕傛晲婢跺﹪鍞堕梺闈涱檧婵″洭宕㈤悽鍛娾拺閻犲洠鈧磭鈧鏌涘☉鍗炴灍闁哥姵鐗犲铏规嫚閼碱剛顔囩紓浣虹帛鐢€愁嚕椤愶絿绡€婵﹩鍓濋幗?(Getter)
    // ==========================================

    // 1. 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕閻庤娲忛崕鎶藉焵椤掑﹦绉甸柛鐘崇墱婢规洟宕稿Δ浣哄幍闂佽鍨虫晶妤吽夋径鎰闁哄鍩婇煬顒勬煛鐏炶鈧繈骞婂┑瀣妞ゆ棁鍋愭晶顖氣攽閻愯尙鎽犵紒顔肩灱缁辩偞绻濋崶褑鎽曞┑鐐村灟閸ㄧ懓鏁俊鐐€栧濠氬储瑜旈敐鐐哄煛閸涱喒鎷洪梺鍛婄箓鐎氼剟顢旈妷鈺傜厱閹艰揪绲鹃弳顒傗偓娈垮枟濡叉帡藝閸撲胶纾奸柣妯虹－閳藉銇勯锝囩疄闁诡喒鍓濋幆鏃堝閵忊剝顔嶉梻鍌氬€搁崐宄懊归崶顒€违闁逞屽墴閺屾稓鈧綆鍋呭畷宀勬煛鐏炵偓绀冪紒缁樼洴閹瑩顢楁担鍝勭稻闂傚倷鑳剁划顖炲箰鐠囪鍝勵潨閳ь剟鐛崼銉ノ╅柕澶樺枟瀵ゆ椽姊虹化鏇炲⒉妞ゃ劌鎳橀敐鐐侯敃閿旇棄鈧灚绻涢幋鐐垫噮缂佺姷鍋為幈?(婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓闁搞劌鍊块弻娑㈩敃閿濆棛顦ョ紓浣哄С閸楁娊寮诲☉妯锋斀闁告洦鍋勬慨銏ゆ⒑濞茶骞楅柟鐟版喘瀵鎮㈤搹鍦紲闂侀潧绻掓慨鐢告倶瀹ュ鈷戠紒瀣儥閸庡秹鏌涢弬璺ㄐу┑锛勬暬瀹曠喖顢涘杈╂澑闂備礁鎲￠幐鐑芥嚄閸洖姹查柣妯兼暩绾捐棄霉閿濆棗绲诲ù婊堢畺濮婃椽宕滈幓鎺嶇爱闂佺懓鍟垮ú顓炵暦閹达箑绠婚柤濮愬€曠粊锕傛⒑閸撹尙鍘涢柛鐘崇墬閹便劍鎯旈埦鈧弨浠嬫煟閹邦垰鐨烘繝鈧幘顔界厱闁哄倸鐏濋銏㈢磼閺冨倸鏋涚€殿喗鎸抽幃銏ゆ惞閸︻厽顫屽┑鐘愁問閸犳鏁冮埡鍛偍濡わ絽鍟惌?
    public String getBaseName() {
        return this.entityData.get(SYNC_BASE_NAME);
    }

    public static String sanitizeBaseNameInput(String input) {
        if (input == null) return "";
        String trimmed = input.trim();
        if (trimmed.isEmpty()) return "";
        StringBuilder sanitized = new StringBuilder(trimmed.length());
        for (int i = 0; i < trimmed.length(); i++) {
            char ch = trimmed.charAt(i);
            if (!Character.isISOControl(ch)) {
                sanitized.append(ch);
            }
        }
        String result = sanitized.toString().trim();
        if (result.length() > MAX_BASE_NAME_LENGTH) {
            result = result.substring(0, MAX_BASE_NAME_LENGTH);
        }
        return result;
    }

    private boolean isPlayerNameLocked() {
        return this.getPersistentData().getBoolean(PLAYER_NAME_LOCK_TAG);
    }

    private void setPlayerNameLocked(boolean locked) {
        this.getPersistentData().putBoolean(PLAYER_NAME_LOCK_TAG, locked);
    }

    public boolean applyPlayerBaseName(String requestedName) {
        String sanitized = sanitizeBaseNameInput(requestedName);
        if (sanitized.isEmpty()) {
            return false;
        }
        this.entityData.set(SYNC_BASE_NAME, normalizeBaseName(sanitized));
        setPlayerNameLocked(true);
        updateCustomName();
        return true;
    }

    private void applyBaseNameFromIdCard(String cardName) {
        if (isPlayerNameLocked()) {
            return;
        }
        String normalized = normalizeBaseName(cardName);
        if (!normalized.equals(this.entityData.get(SYNC_BASE_NAME))) {
            this.entityData.set(SYNC_BASE_NAME, normalized);
            updateCustomName();
            this.playSound(SoundEvents.UI_CARTOGRAPHY_TABLE_TAKE_RESULT, 1.0f, 1.0f);
        }
    }

    private void restoreDefaultBaseNameFromIdCardRule() {
        if (isPlayerNameLocked()) {
            return;
        }
        String currentName = this.entityData.get(SYNC_BASE_NAME);
        if (!isDefaultBaseName(currentName)) {
            this.entityData.set(SYNC_BASE_NAME, DEFAULT_BASE_NAME_TOKEN);
            updateCustomName();
        }
    }

    // 2. 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕閻庤娲忛崕鎶藉焵椤掑﹦绉甸柛鐘崇墱婢规洟宕稿Δ浣哄幍闂佽鍨虫晶妤吽夋径鎰闁哄鍩婇煬顒勬煛鐏炶鈧繈骞婂┑瀣妞ゆ棁鍋愭晶顖氣攽閻愯尙鎽犵紒顔肩灱缁辩偞绻濋崶褑鎽曞┑鐐村灟閸ㄧ懓鏁俊鐐€栧濠氬储瑜旈敐鐐哄煛閸涱喒鎷洪梺鍛婄☉閿曘倝鎮橀埡浣叉斀妞ゆ梻鍋撻弳顒€鈹戦敍鍕毈鐎规洜鍠栭、娆撳礈瑜庡鎴︽⒒娴ｇ瓔娼愮€规洘锕㈤獮鎾活敂閸℃﹩娼熼梺缁樺姉閸庛倝鍩涢幋锔界厱婵炴垶锕銉╂煟閹烘垹绉洪柡灞剧〒閳ь剨缍嗛崑鍛暦鐏炵偓鍙忓┑鐘插鐢盯鏌熷畡鐗堝殗闁圭厧缍婇幃鐑藉箥椤曞懎浠归梻鍌氬€烽懗鍓佹兜閸洖鐤炬繛鎴欏灪閸嬪鏌熼幆褏锛嶉柡鍡畵閺屾洝绠涚€ｎ亖鍋撻弽顓炲惞闁告劦鍠楅悡鍐偡濞嗗繐顏╅柛鏂诲€曢湁?(0-100)
    public int getHeat() {
        return this.entityData.get(DATA_HEAT);
    }

    // 3. 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕閻庤娲忛崕鎶藉焵椤掑﹦绉甸柛鐘崇墱婢规洟宕稿Δ浣哄幍闂佽鍨虫晶妤吽夋径鎰闁哄鍩婇煬顒勬煛鐏炶鈧繈骞婂┑瀣妞ゆ棁鍋愭晶顖氣攽閻愯尙鎽犵紒顔肩灱缁辩偞绻濋崶褑鎽曞┑鐐村灟閸ㄧ懓鏁梻渚€娼х换鍡涘礈濠靛棭鐔嗛柟鐑橆殕閳锋垹绱掔€ｎ偒鍎ラ柛搴㈠姍閺岀喖鎮烽悧鍫熸倷闂佷紮绲块崗姗€骞冨鍛┏閻庯綆鍋呭▍宥夋⒒娴ｈ櫣甯涢柛鏃€顨嗛弲璺何旈崨顓狀槹闂佸憡鍔忛弲婵堝姬閳ь剛绱掗悙顒佺凡妞わ箒浜竟鏇㈠锤濡や胶鍘遍柣搴秵閸嬪棗煤鐎电硶鍋撶憴鍕闁告梹顨堝Σ鎰板箳閹冲磭鍠撻崰濠冩綇閵娾晜鏆呴梻鍌氬€风粈浣虹礊婵犲伣娑氭崉閵娧呯劶婵炶揪缍€濞咃綁鎯岄崱娑欏€甸柨婵嗛閺嬬喖鏌ｉ幘璺衡枅闁哄瞼鍠栧鑽も偓鐢殿焾婵¤棄鈹戦悙鏉戞瘑闁告洍鏅欑花?(闂?闂? - 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亜顒㈡い鎰矙閺屻劑鎮㈤崫鍕戙垻鐥幆褜鐓奸柡灞剧☉閳藉宕￠悙鑼洿闂備焦瀵х换鍌炈囬婊呬笉闁规儼濮ら悡娑㈡煕閹板墎鍒板ù婊勫劤椤啴濡堕崱妤€顫戞繝娈垮枔閸婃繃淇婇悽绋跨妞ゆ牗姘ㄩ悿鈧梻浣告啞閹哥兘鎮為敃鍌氱；鐟滄柨顫忛崫鍕殾闁搞儮鏅涚粭鈥斥攽閳藉棗浜滈柛鐔告尦閹即顢氶埀顒€顕ｆ禒瀣垫晝闁绘棁娓规竟鏇炩攽閻愭潙鐏﹂柣鐕佸灦閹偤鎮惧畝鈧壕濂告煟濡寧鐝悘蹇ｅ弮閺屽秶鎲撮崟顐や紝濡炪們鍨洪悷鈺呭箖閸撗傛勃闁诡垎鍐画闂傚倸鍊风粈渚€骞栭锔藉剹濠㈣泛鏈畷鍙夌節闂堟稒顥犻柡鍡畱閳规垿宕掑顒夋闂佽桨绀侀崯鎾蓟閺囷紕鐤€闁哄洨鍊姀銏㈢＜闁绘ê鍟块ˉ瀣磼鏉堛劍宕岀€规洘甯掗埢搴ㄥ箳閹存繂鑵愮紓鍌氬€风欢锟犲闯椤曗偓瀹曡瀵肩€涙ê浠煎┑鐘绘涧椤戝懐绮婚悷鎳婂綊鏁愰崨顔藉創缂備椒绶ょ粻鎾愁潖妤﹁￥浜归柟鐑樺灣閸犲﹪姊洪崨濠庣劸濠殿喓鍊濆畷姘節閸パ呴獓闂佽鎯岄崢鐣屸偓闈涚焸閺岋絾鎯旈婊呅ｆ繛瀛樼矋缁捇骞嗘笟鈧俊鎼佸Ψ閸愩劎绉洪柟顔瑰墲閹棃濮€閻樺磭浜峰┑?
    public float getFireRate() {
        return 20.0f / getFireDelay();
    }


    private List<String> getSkillList(int tier) {
        List<String> skills = new ArrayList<>();
        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼妽闁稿繑绮撻弻娑㈩敃閿濆棛顦ラ梺姹囧€濈粻鏍蓟閿濆绠涙い鎾跺О閸嬬偤姊洪崫鍕靛剰缂佸缍婂濠氬Ω閵夈垺鏂€闂佺硶妾ч弲婊嗗€撮梻鍌欑窔閳ь剛鍋涢懟顖炲储閸濄儳纾奸柤闀愮祷婢规﹢鏌ｉ敐鍥у幋濠碘剝鎮傞崺鈩冪節閸愨晜鐝┑鐘垫暩閸嬬偤宕归崜浣圭畳缂傚倷绶￠崰鎺楀礈濠靛洨鈹嶅┑鐘叉处閸婇攱銇勮箛鎾愁仱闁稿鎹囧浠嬵敇閻愭妲烽梻浣侯攰閹活亞绮婚幋锕€鍨傞柛灞剧矌濡垱銇勯幘璺轰沪濠殿垰銈搁弻?
        skills.add("闂?闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柤鑹板煐閹蹭即姊绘担鐟邦嚋缂佽鍊胯棟妞ゆ牗绮庨惌鍡楊熆閼搁潧濮夐柛娆愭崌閺屾盯濡烽敐鍛瀷闂佸疇妫勯ˇ杈╂閹烘鐒垫い鎺戝绾惧吋绻涢幋鐑嗘畼缂佺姵鑹鹃—鍐Χ閸℃瑥顫х紓浣筋嚙閸婂湱绮嬪鍫涗汗闁圭儤鎸鹃崢钘夘渻閵堝棙灏甸柛鐘查叄瀹曨偄煤椤忓懐鍘搁柣蹇曞仜婢ц棄煤鐎电硶鍋撳▓鍨灆缂侇喗鐟︽穱濠囧醇閺囩偛绐涘銈嗘尰缁嬫帞鈧氨鍠栧?(缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛銈呭閺屻倝骞栨担瑙勯敪闂佹悶鍔嶅褰掑Φ閸曨垰绠婚柛妤冨仧娴犲ジ姊虹粙鑳潶闁告柨鐭侀悘鍐⒑閹稿海绠撻柟鍐查叄瀵娊鎮欓悜妯煎幈闁诲函缍嗘禍婊堝焵椤掆偓濠€閬嶅箲閵忕姭鏀介悗锝庡亽濡啫鈹戦悙鏉戠仸闁煎綊绠栭崺鍛存焼瀹ュ棌鎷哄┑鐐跺蔼椤曆囩嵁濡ゅ啠鍋撻崗澶婁壕闂佸綊妫跨粈渚€鎷戦悢鍝ョ闁瑰瓨鐟ラ悘鈺呮煕閹般劌浜鹃梻鍌欑窔濞佳囨偋閸℃稑绠犻幖娣妼閻撴洖顭块懜闈涘闁?");

        if (tier >= 1) skills.add("闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗ù锝堟缁€濠傗攽閻樿弓杩规繛鎴炵瀹曞鏌曟繝蹇曠暠閹兼潙锕ら埞鎴︻敊婵劒绮堕梺绋款儐閹稿骞?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫆缂備焦蓱濞呭牓姊绘担鍛婂暈婵炶绠撳畷銏°偅閸愨晛鍓归梺绯曞墲閵囨粓鍩€椤掍礁绗掓い顐ｇ箞閺佹劙宕ㄩ鈧ˉ姘舵⒒閸屾瑦绁版い鏇熺墵瀹曞綊顢涘鍕靛仺濠殿喗锕╅崢铏规崲閸℃稒鐓欓梻鍌氼嚟椤︼箓宕姘兼富闁靛牆妫欓悡銉╂煕濮橆剦鍎旀い銏★耿瀹曠螖娴ｅ弶瀚藉┑鐐舵彧缂嶁偓婵☆偄瀚板畷銉ㄣ亹閹烘挾鍘遍梺缁橆焾濞呮洜绮堢€ｎ兘鍋撶憴鍕婵＄偠妫勯悾鐑藉醇閺囩倣鈺冩喐濠婂厾?(闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柟缁樺笧閳ь剦鍙冨娲礈閼碱剙甯ラ梺绋款儐鐢帡鍩㈤幘瀵割浄閻庯綆鍓欒ぐ鍕⒑閹肩偛鍔橀柛鏂块叄閸┿儲寰勫畝鈧壕?II)");
        if (tier >= 2) skills.add("闂?闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弴鐐测偓褰掑磿閹寸姵鍠愰柣妤€鐗嗙粭鎺楁煕閵娿儱鈧悂鍩為幋锔藉亹閻庡湱濮撮ˉ婵嬫⒑閸濆嫷鍎庣紒鑸靛哺瀵鎮㈤崗灏栨嫽闁诲骸鐏氶悺鏇犵不閻愬绡€闁靛骏绲介悡鎰版煕閺冣偓濞茬喖鎮伴鈧慨鈧柨娑樺椤旀洟姊洪悷閭﹀殶闁稿孩鍔欓幃鐐烘嚍閵夛絼绨婚梺鎸庢椤曆冣枍瀹ュ棙鍙忓┑鐘叉噺椤忕姷绱掓潏銊ョ瑨閾伙綁鏌涜箛鏇炲付婵炲懏鍨垮缁樻媴閻戞ê娈岄梺鍝ュ枙濞夋洟骞戦姀銈呯婵°倐鍋撻柣?(闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墴閹潡顢氶埀顒勫蓟閿濆憘鏃堝焵椤掑嫭鍋嬪┑鐘叉搐閻鐓崶銊﹀闁哄啫鐗婇弲鏌ユ煕濞戝崬骞楅柣蹇旀礈缁辨捇宕掑姣欙綁鏌ｅΔ鍐ㄢ枅妤犵偛鍟灃闁告侗鍠楀▍婊堟煙閼测晞藟闁告挻绻堥幃妯侯吋婢跺鎷虹紓鍌欑劍钃遍悘蹇ｅ弮閺屾稒绻濋崒銈囧悑闂佺硶鏂侀崑鎾愁渻閵堝棗鍧婇柛瀣尵缁辨帡鎮╅懠顑呪偓瑙勬礃濞茬喖寮婚崱妤婂悑闁告侗鍨抽弸鍐⒑閻熸澘鎮戦柟顖氱焸閹剝寰勫畝鈧粈?");
        if (tier >= 3) {
            skills.add("闂?闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰缁鎮╅崗鍛畾濡炪倖鐗楃换鍌涚閸︻厾妫柟瑙勫姇琚氶梺閫涚┒閸斿矁鐏掗梺鍦焾濞寸兘濡撮幇顔剧＝濞达絾褰冩禍楣冩⒑缁嬫寧婀扮紒瀣姉閹广垽宕卞Ο闀愮盎闂佸搫绉查崝搴ㄥ箠閸℃ǜ浜滈柟鐑樻煥閺嬫盯鏌＄仦鍓ф创濠碘€崇埣瀹曞崬螣绾拌鲸效闂傚倷绀侀幖顐︽儗婢跺本宕叉繝闈涙閺嗭箓鏌涢锝嗙閹喖鎮峰鍐鐎规洩绲介埞鎴﹀醇閵忣澁绱?(闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑鏅悷婊冪Ч濠€渚€姊虹紒妯虹伇婵☆偄瀚划濠氭偐缂佹鍘甸梺璇″瀻閸愨晩鍟堥梻浣规偠閸庢椽宕滈敃鍌氭瀬鐎广儱顦伴悡鐔兼煙闁箑鐏犻柣銊︽そ閺岋綁骞橀弶鎴犱紝濠碘槅鍋勯幊姗€銆侀弴銏狀潊闁炽儲鍓氬Σ杈╃磽閸屾瑧顦︽い鎴濇閺侇噣鍨惧畷鍥ㄦ闂佺懓顕崑娑氭閻愮儤鐓欓梺顓ㄧ畱楠炴﹢鏌涘鈧禍璺侯潖濞差亜妫橀柕澶涢檮閻濇棃姊洪崫銉ユ瀺闁告濞婇悰顔界節閸パ冪獩濡炪倖鎸嗛崨顓熸毄?");
            skills.add("闂?闂?缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧湱鈧懓瀚伴崑濠傘€掓繝姘厵闁绘垶锕╁▓鏇㈡煕閵堝懎顏柡灞剧洴椤㈡洟鏁愰崱娆樻К缂備胶鍋撻崕鎶解€﹂悜钘夎摕闁挎繂顦Λ姗€鏌熺粙鍨劉闁稿孩鎹囧娲箹閻愭彃顬夌紓浣筋嚙閻楁挸顕ｇ拠宸悑濠㈣泛谩閵娾晜鐓ラ柡鍥殔娴滄儳顪冮妶鍐ㄥ姢闁稿鍊濆濠氭偄閸忕厧鈧粯鎱ㄥΔ鈧Λ娆撴偩閸撲胶纾藉ù锝呮惈鏍℃繝鐢靛仜閿曨亜顕ｆ繝姘櫢闁绘灏欓ˇ銊╂⒑闂堟侗鐒鹃柛搴㈠閼洪亶鎸婃径鍡樻杸?(闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃繘鍩€椤掍胶鈻撻柡鍛█閵嗕礁鈻庨幘鍐插敤濡炪倖鎸鹃崑鐔兼偘閵夈儮鏀介柣鎰綑閻忥箓鏌ｉ悤鍌滅ɑ缂佸倹甯″畷濂稿Ψ閿旀儳骞嶉梻鍌氬€搁崐鎼侇敋椤撯懞鍥晝閸屾稓鍘介梺闈涚墕椤﹂亶鎮惧ú顏呯厸閻忕偟鍋撶粈鍐磼閺冨倸鏋涙い銏＄☉椤繈顢橀悙瀵告毈闂傚倷绀佺壕顓㈠箠閹捐埖宕叉俊顖欒濞兼牗绻涘顔荤盎濞磋偐濞€閺屾盯寮撮妸銉︾亾濠碘€插嫎閸旀垵顫忓ú顏勫窛濠电姴鍊搁～鍥⒑閸涘﹥鐓ラ柣顓炲€搁?");
        }
        if (tier >= 4) {
            skills.add("闂?闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞闁靛ě鍛獎闂備礁澹婇崑鍡涘窗閸℃顩烽柛顐犲劜閻撴瑩姊婚崒姘煎殶闁告柨绉归弻娑㈠Χ閸涱垳鍔梺鍝勭灱閸犳捇骞夐幘顔肩妞ゆ劑鍩勫搴♀攽閻愯尙鎽犵紒顔奸叄楠炲﹪骞橀悜鈹惧亾閿曞倸閿ゆ俊銈勭濞堟繈姊婚崒姘卞缂佸鍨块敐鐐茬暆閳ь剛妲愰幘瀛樺闁告繂瀚呴悙鐑樼厱閹艰揪绲鹃弳顒傗偓娈垮枛椤兘骞冮姀銈嗗亗閹艰揪绲块弳浼存煟閻斿摜鐭婄紒澶屾嚀椤曪綁鎼归锝囩Ф闂侀潧顭粻鎴濐嚕?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳婀辩槐鎺斺偓锝庡弾閸わ附绻涢幋鐐冩艾危閸儲鐓忛煫鍥ㄦ礀鍟稿銇礁鍟犻弨浠嬫煃閽樺顥滈柣蹇娾偓瓒佺懓顭ㄩ埀顒傚垝濞嗘挸鏄ラ柍褜鍓氶妵鍕箳瀹ュ浂妲┑鐐存儗閸犳岸鍩€椤掑喚娼愭繛鍙夘焽閸掓帟绠涘ù鏉挎喘椤㈡岸鍩€椤掑嫬钃熸繛鎴炲焹閸嬫捇鏁愭惔鈥茬凹閻庤娲栭惉濂稿焵椤掑喚娼愭繛鍙夛耿閵嗗啴宕卞Δ濠傛闂佸憡娲﹂崹浼寸嵁閵忊€茬箚闁绘劖娼欓崝銈嗐亜閵夛箑鍝烘慨濠勭帛閹峰懘宕ㄦ繝鍌涙畼闂備礁鎲″褰掆€﹂崶銊ь洸缂佸绨遍弸搴ㄦ煙闁箑澧婚柛?");
            skills.add("闂?闂?缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛濠傛健閺屻劑寮撮悙娴嬪亾閸濄儱顥氶悹鎭掑妷閸嬫挾鎲撮崟顒傤槬濠电偛鐪伴崐婵婃＂濠殿喗锕╅崢瑙勭濠婂牊鐓欓柟顖嗗啳鍩為梺璇叉禋娴滎亪寮诲☉銏犖ч柛娑卞弾娴煎啴姊虹拠鈥虫灍闁挎洏鍨介獮鍐ㄢ枎閹惧磭顔岄梺鐟版惈濡瑧鈧灚鐗犲缁樻媴閸濄儻绱為梺纭呮珪閹稿墽鍒掗弮鍫熷仺缂佸顕抽敃鍌涚厱闁哄洢鍔岄悘鐘电磼椤愩垻效闁哄本绋撴禒锔剧磼閵忥紕鏆﹂梺璇插绾板秶绮欓幋锕€鐓?(闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎰剁悼閳ь剚濞婇幃妤呯嵁閸喖濮庡銈忕細閸楀啿鐣烽幋锕€围濠㈣泛顑囬崢鎼佹⒑閹肩偛鍔ラ柛鈺傜墬缁绘盯宕堕浣哄帗閻熸粍绮撳畷妤€鈽夊顓у仺濠殿喗锕╅崜娑㈠汲閿曞倹鐓忓┑鐐靛亾濞呭懐绱掗悪娆忔处閻撴瑩鎮楅悽娈跨劸妞ゅ骸鏈穱濠傤啅椤旇偐浠╅梺瀹狀潐閸ㄥ潡骞冮埡鍜佹晩闁兼祴鏅欑槐妯荤節閻㈤潧浠滄い锔垮嵆閹嫰顢涢悙鑼枃闂佺粯姊婚埛鍫ュ极瀹ュ棛绡€濠电姴鍊归崳鍝ョ磼?");
        }
        if (tier >= 5) {
            skills.add("闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗ù锝堟缁€濠傗攽閻樿弓杩规繛鎴炵瀹曞鏌曟繛褍鍟憴锕傛⒒娴ｇ懓顕滅紒璇插€胯棟濞村吋娼欓悡?缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐偓锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫晲閸涱剙顥氶梻鍌欐祰椤曟牠宕锕€骞㈡繛鍡樺灦濠㈡垶绻濋悽闈涗沪闁搞劌鐖奸垾锕傚炊椤戯箑娲、姗€濮€閳锯偓閹锋椽姊洪崷顓х劸閻庢稈鏅濈划鍫ュ焵椤掑嫭鈷戠紒瀣皡瀹搞儵鏌熼懞銉х煀闁宠棄顦甸幃鐣岀矙鐠恒劌濮︽俊鐐€栫敮鎺斺偓姘煎弮钘熷┑鐘插暔娴滄粓鏌熼幍铏珔闁诲浚浜滈…璺ㄦ崉閸濆嫷浼冮梺鍝勬湰閻╊垶鐛€ｎ亖鏀介柛顐熸嚕閵娾晜鍊?(闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈢粯淇婇悙顏勨偓鏍偋濠婂牆纾绘繛鎴炴皑閻棝鏌涢銈呮灁缂佺娀绠栭弻娑㈠焺閸忊晜鍨规禍鎼侇敇閵忥紕鍘搁柣搴岛閺呮繈宕濆鍥╃＜缂備焦顭囩粻鏍磼缂佹绠炵€规洘甯掗…銊╁礃閻愵剚鐦掔紓鍌氬€搁崐鐑芥嚄閼稿灚鍙忛柣鎴ｆ閺嬩礁鈹戦悩瀹犲闁藉啰鍠栭弻宥夊煛娴ｅ憡娈紓浣稿閸嬨倝骞冨Δ鍛櫜閹煎瓨绻勯弫鏍ㄧ箾鐎电校闁圭鍟块～?");
            skills.add("闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗ù锝堟缁€濠傗攽閻樿弓杩规繛鎴炵瀹曞鏌曟繛褍鍟憴锕傛⒒娴ｇ懓顕滅紒璇插€胯棟濞村吋娼欓悡?缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亜顒㈡い鎰矙閺屻劑鎮㈤崫鍕戙垻绱掗幇顓ф疁闁哄备鈧剚鍚嬮柛鎰╁妼椤鈹戦悙鍙夊櫧濠殿喗鎸冲﹢渚€姊虹紒妯忣亜螣婵犲洤纾跨€广儱顦伴悡鍐喐濠婂牆绀堟繛鍡樻尭閻ゎ噣鏌熺紒銏犳灈闁哄绶氶弻鐔兼焽閿曗偓楠炴牜绱掗崜浣镐粶闁宠鍨块幃鈺呭箵閹烘繀绱濋梻浣告憸閸嬬偛顪冩禒瀣摕闁挎繂顦伴崑鍕煕濠靛嫬鍔ら柣鎾亾缂傚倸鍊风粈渚€藝闁秴绠犻柟鍓х帛閸?(闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃繘鍩€椤掍胶鈻撻柡鍛█閵嗕礁鈻庨幘鍐插敤濡炪倖鎸鹃崑鐔兼偘閵夈儮鏀芥い鏃傜摂閻掔偓绻涙径瀣€掑瑙勬礋瀹曠螖娴ｅ搫甯鹃梻浣稿閸嬪懐鎹㈠鍛傦綁骞栨担鍦幗闂侀潧鐗嗛ˇ閬嶆偩濞差亝鐓涢悘鐐靛亾缁€鍐磼閺冨倸鏋涙い銏＄☉椤繈顢橀悙瀵告毈闂傚倷绀佺壕顓㈠箠閹捐埖宕叉俊顖欒濞兼牗绻涘顔荤盎濞磋偐濞€閺屾盯寮撮妸銉︾亾濠碘€插嫎閸旀垵顫忓ú顏勫窛濠电姴鍊搁～鍥⒑閸涘﹥鐓ラ柣顓炲€搁?");
        }

        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柤鑹板煐閹蹭即姊绘担鐟邦嚋缂佽鍊胯棟妞ゆ牗绮庨惌鍡楊熆鐠哄搫顦柛瀣崌閻涱噣宕归鐓庮潛婵＄偑鍊х€靛矂宕归崼鏇炵畺闁绘劕鎼崹鍌涖亜閹邦喖小缂併劌顭峰铏规兜閸涱喖娑х紓浣瑰絻婢ц棄鈽夐悽绋块唶闁哄洨鍠撻崢閬嶆⒑閸濆嫬鈧棄鈻旈弴鐐垫懃闂傚倷绀侀悿鍥綖婢舵劕鍨傞柛褎顨呴弰銉モ攽閻樻彃鈧敻寮告惔銊у彄闁搞儯鍔嶉悡銉︺亜閿旇娅婃慨?
        if (this.entityData.get(IS_BRUTAL)) {
            skills.add("[Brutal Passive] +400% damage and enhanced suppression aura.");
        } else if (checkFullBodyEnchanted()) {
            skills.add("闂?[闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑鏅悷婊冪箻楠炴垿濮€閵堝懐鐤€濡炪倖妫佸Λ鍕償婵犲倵鏀介幒鎶藉磹閹剧粯鍤勯柛顐ｆ磸閳ь剙鎳樺畷锝嗗緞閸粎鐩庨梻浣告贡閸庛倝宕归悽鍓叉晜闁冲搫鍟板Λ顖涖亜閹惧鈽夊ù婊堢畺濮?濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌熼梻瀵割槮缁惧墽绮换娑㈠箣濞嗗繒浠鹃梺绋款儏椤戝寮诲☉銏犵労闁告剬鍛畳闂備浇妗ㄧ粈浣衡偓姘嵆瀵鈽夐姀鐘靛姶闂佸憡鍔х紓姘辫姳婵傚憡鈷戦柛锔诲幖閸斿鏌涢埡浣哄妞ゎ厼娲崺锟犲磼濡湱鐩庨梻浣烘嚀閻°劌顫忛悷鎵虫瀺闁搞儺鍓氶悡鏇㈡煟濡櫣锛嶅褏鏁搁埀顒冾潐濞叉牜绱炴繝鍥╁祦闁糕剝鍑瑰Σ楣冩⒑閸濆嫭锛旂紒鐘虫崌瀵鈽夐姀鐘栥劑鏌曡箛濠傚⒉闁绘繐绠撳铏规偘閳ュ厖澹?(缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛濠傛健閺屻劑寮崹顔规寖闂佹椿鍘介悷鈺呭蓟閻斿皝鏋庨梽鍥敋瑜嶇叅妞ゆ搩娼块埀顑跨閳藉顫滈崱娆忓汲闂備礁鎲″ú鐔奉焽瑜庣粋鎺懨洪鍛嫽婵炶揪缍€濞咃絿鏁☉娆愬弿濠电姴鍋嗛悡鑲┾偓瑙勬磸閸ㄥジ藝鐎靛摜纾兼い鏃囧亹婢э妇鈧娲橀敃銏ゃ€侀弮鈧幏鍛存⒐閹邦剦妫滈梻鍌欐祰瀹曠敻宕伴幇顒夌唵婵せ鍋撴い銏℃椤㈡棃宕ㄩ婊呮闂備線娼х换鍡椢ｉ崨瀛樺€块柣锝呯灱绾?");
        }

        return skills;
    }

    private void autoEat() {
        if (eatCooldown > 0) {
            eatCooldown--;
            return;
        }
        float hp = this.getHealth();
        float maxHp = this.getMaxHealth();
        if (maxHp <= 0.0f) return;
        float ratio = hp / maxHp;

        if (ratio >= 0.80f) return;
        boolean allowRareFood = ratio < 0.30f;

        ItemStack selected = findFoodForHeal(allowRareFood);
        if (selected == null || selected.isEmpty()) {
            return;
        }
        FoodProperties food = selected.getItem().getFoodProperties(selected, this);
        if (food == null) {
            return;
        }

        this.heal((float) food.getNutrition());
        this.playSound(SoundEvents.GENERIC_EAT, 1.0f, 1.0f);
        if (this.level() instanceof ServerLevel sl) {
            sl.sendParticles(new ItemParticleOption(ParticleTypes.ITEM, selected), this.getX(), this.getEyeY(), this.getZ(), 10, 0.1, 0.1, 0.1, 0.1);
            sl.sendParticles(ParticleTypes.HEART, this.getX(), this.getEyeY() + 0.2, this.getZ(), 6, 0.25, 0.2, 0.25, 0.01);
        }
        selected.shrink(1);
        eatCooldown = 40;
    }

    private ItemStack findFoodForHeal(boolean allowRareFood) {
        ItemStack fallbackRare = ItemStack.EMPTY;
        for (int i = 0; i < inventory.getContainerSize(); i++) {
            ItemStack stack = inventory.getItem(i);
            if (stack.isEmpty() || !stack.isEdible()) continue;
            boolean rare = isRareFood(stack);
            if (rare && !allowRareFood) {
                if (fallbackRare.isEmpty()) {
                    fallbackRare = stack;
                }
                continue;
            }
            return stack;
        }
        return allowRareFood ? fallbackRare : ItemStack.EMPTY;
    }

    private boolean isRareFood(ItemStack stack) {
        Item item = stack.getItem();
        return item == Items.GOLDEN_APPLE
                || item == Items.ENCHANTED_GOLDEN_APPLE
                || item == Items.GOLDEN_CARROT;
    }

    public void registerHit() {
        if (this.random.nextFloat() < 0.1f) this.playSound(SoundEvents.ARROW_HIT, 0.5f, 1.5f);
    }


    private int getEnchantLimit(int tier) {
        return switch(tier) {
            case 0 -> 2;
            case 1 -> 3;
            case 2 -> 4;
            case 3 -> 5;
            case 4 -> 6;
            case 5 -> 6;
            default -> 2;
        };
    }

    // =========================================================
    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忛搹鍦＜婵☆垵娅ｉ悷銊ヮ渻閵堝骸骞橀柛蹇斆锝嗙節濮橆厽娅㈤梺缁橆焾鐏忔瑩藝閺夋娓婚柕鍫濇婵倿鏌涙繝鍐炬疁妞ゃ垺鐟︾换婵嬪炊閵娧冨箺闂備線娼х换鍡涘疾濞戙垺鍊堕柣妯哄帠缁诲棙銇勯幇鍓佹偧婵炲弶鎸抽弻娑㈠煘閹傚濠碉紕鍋戦崐鏍暜婵犲嫭顐介柨鐔哄Т閻ゎ噣鐓崶銊р姇闁绘挻娲熼弻锝呂熼崫鍕瘣濠电偞鎯岄崰姘跺焵椤掑喚娼愭繛鍙夛耿瀹曞綊宕稿Δ鍐ㄧウ濠碘槅鍨甸崑鎰閸忛棿绻嗘い鏍ㄧ矊鐢墎鈧?
    // =========================================================

    // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕閻庤娲忛崕鎶藉焵椤掑﹦绉甸柛鐘崇墱婢规洟宕稿Δ浣哄幍闂佽鍨虫晶妤吽夋径鎰闁哄鍩婇煬顒勬煛鐏炶鈧繈骞婂┑瀣妞ゆ棁鍋愭晶顖氣攽閻愯尙鎽犵紒顔肩灱缁辩偞绻濋崶褑鎽曞┑鐐村灟閸ㄧ懓鏁俊鐐€栧Λ浣哥暦閻㈢姹叉俊銈勮兌缁犻箖鎮楀☉娆樼劷闁活厼锕︾槐鎾愁吋閸滃啳鍚悗娈垮枛椤兘骞冮姀銈嗗亗閹艰揪绲块弳浼存煟閻斿摜鐭婄紒澶屾嚀椤曪綁鎼归锝囩Ф闂侀潧顭徊鑲╄姳婵犳碍鈷戦梻鍫熺〒婢ф洟鏌熼崘鑼鐎规洘濞婇幃鎯х暆閳ь剛澹曟總绋跨骇闁割偅绋戞俊鑲╃磼濡や礁娴柡灞界Ч閹稿﹥寰勫Ο鎭嶏箑顪冮妶搴′簼缂侇喗鎸搁悾鐑藉础閻愬秶鍠栭幃娆擃敂閸曨偒鐎村┑鐑囩到濞层倝鏁冮鍛箚闁割偅娲栭悙濠冦亜椤掑鏋旈柛銊ㄦ閹广垹鈽夊鍡楁櫊濡炪倖姊婚崢褏绮昏ぐ鎺撯拺濞村吋鐟ч幃濂告煕韫囨棑鑰跨€殿噮鍋婇獮妯肩磼濡桨姹楅梻浣藉亹閳峰牓宕滃▎鎾崇劦妞ゆ帒鍊告禒杈ㄦ叏婵犲啯銇濈€规洘锕㈠畷锝嗗緞鐎ｎ亜澹嶉梻鍌欒兌椤㈠﹤鈻嶉弴銏犵闁哄洢鍨洪崑鈺冣偓鐟板閸嬪﹪鎮￠妷鈺傜厱妞ゆ劑鍊曢弳閬嶆煙闁垮銇濇慨濠冩そ濡啴鍩℃担鐑樞掗梻浣告啞閻熴儵鏌婇敐鍜佸殨闁瑰墎鐡旈弫宥夋煟閹邦剦鍤熼柛姗€浜堕弻锝嗘償椤栨粎校闂佺顑呴幊搴ㄦ偩妞嬪簼娌柣鎰靛墮瀵寧绻濋悽闈浶㈤柛瀣閹繝鎳栭埞鎯т壕閻熸瑥瀚粈鈧梺缁樼墪閵堢顕ｉ锕€绠涢柡澶婄仢缁愭稑顪冮妶鍡楀潑闁稿鎸婚妵鍕Ψ閿曗偓閸濈儤鎱ㄦ繝鍌ょ吋鐎规洘甯掗埢搴ㄥ箣椤撶啘婊堟⒒娴ｅ憡璐￠柍宄扮墦瀹曟垶绻濋崨顕呮（濠碉紕鍋戦崐鏍礉瑜忕划濠氬箣閻樺樊妫滄繝鐢靛У绾板秹鎮″▎鎾寸厱闁圭偓顨呴幊搴ｇ箔閿熺姵鈷戠紓浣股戠亸鎵磼鐎ｎ偄鐏存繝鈧笟鈧娲箰鎼达絿鐣甸梺鐟板暱缁绘ê鐣烽鐐村€烽悗闈涙憸閻﹀牓姊洪柅鐐茶嫰婢ь垶鎮楁担鍐ㄤ汗闁逞屽墯缁嬫帡鈥﹂崶顒€鍌?
    private int getKillTarget(int tier) {
        return switch (tier) {
            case 0 -> 5;   // D -> C
            case 1 -> 80;  // C -> B
            case 2 -> 600; // B -> A
            case 3 -> 999; // A -> S
            case 4 -> 9999; // S -> L
            default -> 9999;
        };
    }

    // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕閻庤娲忛崕鎶藉焵椤掑﹦绉甸柛鐘崇墱婢规洟宕稿Δ浣哄幍闂佽鍨虫晶妤吽夋径鎰闁哄鍩婇煬顒勬煛鐏炶鈧繈骞婂┑瀣妞ゆ棁鍋愭晶顖氣攽閻愯尙鎽犵紒顔肩灱缁辩偞绻濋崶褑鎽曞┑鐐村灟閸ㄧ懓鏁俊鐐€栧濠氬储瑜旈敐鐐哄煛閸愵亞锛滅紓鍌欓檷閸ㄥ綊鐛幇鐗堢厱閻庯綆鍋呭畷灞炬叏婵犲嫮甯涢柟宄版噽閹叉挳宕熼鈥虫憢闂傚倷鑳堕…鍫⑩偓鍨浮瀹曟娊鏁愰崪浣告闂佸搫琚崕鏌ュ磻閹邦喚纾藉ù锝咁潠椤忓懐顩烽柟鐑橆殕閳锋垿鏌ｉ悢鍛婄凡闁抽攱姊荤槐鎺楊敋閸涱厾浠搁梺璇″枓閳ь剚鏋奸弸搴ㄦ煙鐎电校闁挎稑绻樺铏圭磼濮楀棙鐣堕梺缁樻惄閸嬪﹪銆侀弮鍫濆窛妞ゆ牭绲鹃柨銈呪攽鎺抽崐褏寰婃禒瀣柈妞ゆ牜鍋涢悡鏇㈡煙閻戞﹩娈曢柣鎾存礋閹﹢鎮欓幓鎺嗘寖濡炪倧缍€鐏忔瑧妲愰幒妤€鐒垫い鎺嗗亾闁伙絾绻堝畷鐔碱敆閸屾艾绠為梻浣筋嚙閸戠晫绱為崱娑樼；闁告侗鍘鹃弳锔锯偓鍏夊亾闁告洦鍓涢崢鎼佹煟韫囨洖浠фい顓炵墛閺呭爼鎳犻钘変壕闁割煈鍋呯欢鏌ユ倵濮樼厧娅嶉柛鈹惧亾濡炪倖甯掗敃锔剧矓闂堟耽鐟邦煥閸曨厾鐓夐梺鎸庣箘閸嬫盯顢橀崗鐓庣窞閻庯急鍕伖闂傚倷绀侀幉锛勬崲閸屾壕鍋撳鍗炲幋鐎规洘娲栭…銊╁川椤栨粣绱查梺鍝勵槸閻楀嫰宕濆鍥╃焼閻庯綆鍠楅悡娆愩亜閺囩偞鍣规繛鍛Ф閳ь剝顫夊ú妯煎垝韫囨蛋鍥箮閼恒儱鈧灚鎱ㄥ鍡楀箹闁告繃妞介弻锛勪沪鐠囨祴鍋撳Δ鍛獥濠电姴娲ょ涵鈧梺缁樺姈瑜板啰绮婚敐澶嬧拻?
    private Item getUpgradeMaterial(int tier) {
        return switch (tier) {
            case 0 -> Items.COPPER_INGOT;      // D -> C
            case 1 -> Items.IRON_INGOT;        // C -> B
            case 2 -> Items.GOLD_INGOT;        // B -> A
            case 3 -> Items.DIAMOND;           // A -> S
            case 4 -> Items.NETHERITE_SCRAP;   // S -> L (濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣銏犲閺佸﹪鏌″搴″箹缂佹劖顨嗘穱濠囧Χ閸涱厽娈剁紓浣瑰敾缁犳捇寮诲☉婊庢Ъ濡炪們鍔岄幊鎰珶閺嚶颁汗闁圭儤鎸鹃崢鎼佹⒑閹肩偛鍔电紒鏌ョ畺瀹曢潧顓兼径瀣幈闂侀潧顦介崰鏍ㄦ櫠椤曗偓閺岋綁骞樼€靛憡鍒涢梺鍝勬湰缁嬫挻绂掗敃鍌氱畾鐟滄粌螞濠婂牊鈷戦柛婵嗗閸庢劙鏌ｅΔ鍐ㄢ枅鐎殿喖顭烽崺鍕礃閵娧呯嵁闂佽绻掗崑鐐哄垂濠靛棌鏌︽い蹇撴噽缁♀偓闂侀潧绻堥崹娲吹閳ь剙鈹戦埥鍡椾簼缂佽鐗撻悰顕€宕橀钘夆偓濠氭煢濡警妲烘い鏃€甯炵槐鎾诲磼濞嗘垵濡藉銈庡幖濞差厼鐣烽姀锛勵浄閻庯綆鍋€閹锋椽姊洪崷顓х劸婵炴挳顥撶划濠氬箻缂佹鍘甸梺鎯ф禋閸嬪懐浜搁悽鍛婄厓鐟滄粓宕滃鑸靛剹妞ゆ洍鍋撶€规洩绻濋獮搴ㄦ寠婢跺孩鎲伴梻浣虹帛濮婂鍩涢崼銉ユ瀬濠电姴鍊甸弨浠嬫煕鐏炲墽鐭ら柣鎺戝⒔閳ь剚顔栭崰鏇㈠础閸愬樊娼栨繛宸簻娴肩娀鏌涢弴銊ユ灈妞ゅ浚鍙冨鍝劽虹拠鎻掔闂佺锕ゅ锟犲箖娴兼惌鏁婇梺娆惧灠娴滈箖鏌ㄥ┑鍡涱€楅柡瀣枛閺屾稓鈧綆鍋勯悘鎾煛鐏炵晫啸妞ぱ傜窔閺屾盯骞樼捄鐑樼€诲銈嗘穿缂嶄線鐛惔銊﹀癄濠㈣埖蓱缂嶅倿姊绘笟鈧褔鎮ч崱妞㈡稑鈽夐姀鐘电厬?
            default -> Items.ANCIENT_DEBRIS;
        };
    }

    // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕閻庤娲忛崕鎶藉焵椤掑﹦绉甸柛鐘崇墱婢规洟宕稿Δ浣哄幍闂佽鍨虫晶妤吽夋径鎰闁哄鍩婇煬顒勬煛鐏炶鈧繈骞婂┑瀣妞ゆ棁鍋愭晶顖氣攽閻愯尙鎽犵紒顔肩灱缁辩偞绻濋崶褑鎽曞┑鐐村灟閸ㄧ懓鏁俊鐐€栧濠氬储瑜旈敐鐐哄煛閸愵亞锛滅紓鍌欓檷閸ㄥ綊鐛幇鐗堢厱閻庯綆鍋呭畷灞炬叏婵犲嫮甯涢柟宄版噽閹叉挳宕熼鈥虫憢闂傚倷鑳堕…鍫⑩偓鍨浮瀹曟娊鏁愰崪浣告闂佸搫琚崕鏌ュ磻閹邦喚纾藉ù锝咁潠椤忓懐顩烽柟鐑橆殕閳锋垿鏌ｉ悢鍛婄凡闁抽攱姊荤槐鎺楊敋閸涱厾浠搁梺璇″枓閳ь剚鏋奸弸搴ㄦ煙鐎电校闁挎稑绻樺铏圭磼濮楀棙鐣堕梺缁樻惄閸嬪﹪銆侀弮鍫濆窛妞ゆ牭绲鹃柨銈呪攽鎺抽崐褏寰婃禒瀣柈妞ゆ牜鍋涢悡鏇㈡煙閻戞﹩娈曢柣鎾存礋閹﹢鎮欓幓鎺嗘寖濡炪倧缍€鐏忔瑧妲愰幒妤€鐒垫い鎺嗗亾闁伙絾绻堝畷鐔碱敆閸屾艾绠為梻浣筋嚙閸戠晫绱為崱娑樼；闁告侗鍘鹃弳锔锯偓鍏夊亾闁告洦鍓涢崢鎼佹煟韫囨洖浠滃褑妫勭叅闁圭虎鍠楅悡鏇㈡煃閸濆嫷鍎戠紒鈾€鍋撻柣搴ゎ潐濞叉粓宕伴弽顓溾偓浣肝旀担鍝ョ獮婵犮垼娉涢敃銉╁箟閵忥紕绡€缁炬澘顦辩壕鍧楁煕鐎ｎ偄鐏寸€规洘鍔欓獮瀣晝閳ь剟宕归崒婊勫枑闁绘鐗嗙粭鎺旂磼閻橀潧校濞ｅ洤锕、娑樷枎閹烘繂濡抽梻浣规偠閸婃牕煤濮椻偓婵＄敻宕熼姘辩杸闂佸憡鎸风粈渚€宕虹仦绛嬫富闁靛牆妫欑粈瀣瑰鍐煟鐎殿喖顭烽崺鍕礃閵娧呯嵁闂佽鍑界紞鍡樼閻愬顩风紒瀣儥濞?
    private int getBaseMaterialCost(int tier) {
        return (tier == 4) ? 5 : 25; // S->L闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳婀辩槐鎺斺偓锝庡亾缁扁晜绻涘顔荤凹闁稿鍔欓幃褰掑炊椤忓嫮姣㈤梺鎸庣⊕閻╊垰顫忓ú顏呭仭闁哄绨遍幐鍐磽娓氬洤娅橀柛銊ョ埣楠?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓闁搞劌鍊块弻娑㈩敃閿濆棛顦ョ紓浣哄Т缂嶅﹪寮诲澶婁紶闁告洦鍋€閸嬫挻绻濆銉㈠亾閸涙潙绠甸柟鐑樼箖鐎靛矂鏌ｆ惔顖滅У濞存粍绮撻、妤呭鎺虫禍婊勩亜閹板墎绋荤紒鈧崘顏嗙＜缂備焦顭囩粻鐐翠繆椤愩垹鏆欓柍钘夘樀瀹曪繝鎮欓幓鎺濇缂傚倸鍊搁崐椋庢媼閺屻儱纾婚柟鍓х帛閻撴洜鈧厜鍋撻柍褜鍓熷畷鎴︽倷閻戞ê浜楀┑鐐村灟閸ㄦ椽鎮￠弴鐔翠簻闁归偊鍠栧瓭闂佽娴氭禍顏堝蓟閿熺姴骞㈤煫鍥ㄦ⒐閻濇艾鈹?5闂?
    }

    // ==========================================
    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱槸濞寸兘宕伴弽褏鏆︽い鎰剁畱缁€瀣亜閹哄秷鍏屾俊宸簽缁辨捇宕掑顑藉亾閻戣姤鍤勯柤鎼佹涧閸ㄦ梹銇勯幘鍗炵仼闁搞劌鍊块弻娑㈩敃閿濆棛顦ラ梺钘夊暟閸犳劗鎹㈠☉銏犵闁绘劕鍟畝绋款嚕閸涘﹥鍎熼柕濠忓閸樼敻姊绘笟鍥у伎缂佺姵鍨垮绋库槈閵忥紕鍘撳銈呯箰鐎氼喚绮斿ú顏呯厵妞ゆ梻鐡斿▓姗€鏌熼崣澶嬪唉鐎规洜鍠栭、妤呭磼閵堝柊姘舵⒒閸屾瑧鍔嶆俊鐐叉健瀹曟粌鈻庨幘婢勓囨煙闂傚顦︾紒鐘冲哺閺屽秷顧侀柛鎾村哺婵＄敻宕熼鍓ф澑闂佽鍎抽顓㈠Χ閳轰讲鏀介柍鈺佸暙缁茬粯銇勯鐐叉Щ妞ゎ偄绻愮叅妞ゅ繐瀚粣娑欑節閻㈤潧浠︾痪鏉跨Ч瀹曞綊宕稿Δ鈧粻鏍喐閺冨牆绠栭柍鍝勫暞鐎氭岸鏌ょ喊鍗炲闁哄鍟换婵嗩嚗闁垮绶查柍褜鍓氬ú鐔肩嵁婵犲啯鍎熼柨婵嗘媼濡粓鎮峰鍛暭閻㈩垱顨婇幃锟犳偄閸忚偐鍘搁梺鍛婂姂閸斿秵寰勯崟顑句簻闊洦娲栨牎闂侀潧娲ょ€氭澘顕ｉ鈧崺鈧い鎺戝€归弳婊堟煃閵夛箑澧繛?(0-5)
    // ==========================================
    public int getUpgradeProgress() {
        return this.entityData.get(UPGRADE_PROGRESS);
    }
    // ==========================================
    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱槸濞寸兘宕伴弽褏鏆︽い鎰剁畱缁€瀣亜閹哄秷鍏屾俊宸簽缁辨捇宕掑顑藉亾閻戣姤鍤勯柤鎼佹涧閸ㄦ梹銇勯幘鍗炵仼闁搞劌鍊块弻娑㈩敃閿濆棛顦ラ梺钘夊暟閸犳劗鎹㈠☉銏犵闁绘劕鍟畝绋款嚕閸涘﹥鍎熼柕濠忓閸樼敻姊绘笟鍥у伎缂佺姵鍨垮绋库槈濞嗗秳绨诲銈嗗姇妤犳悂宕悩璇茬哗濞寸姴顑嗛悡鐔兼煙閹殿喖顣兼繛鎳峰洦鍋ㄦい鏍ㄦ皑閸╋綁鏌＄仦鍓ф创闁诡喓鍨藉畷銊︾節閸曨厸鏋忓┑锛勫亼閸婃牕煤閳哄啰绀婂〒姘ｅ亾闁靛棔绶氬鎾閻欌偓濞煎﹪姊洪棃娑氱畾闁告挻绻堥幃楣冩倻閼恒儮鎷绘繛杈剧到閹诧繝宕悙鐑樼厱闁哄啯鎹囧顔剧磼閸屾氨效闁诡喗鐟︾粭鐔碱敍濞戞瑦鐝﹂梻鍌欑濠€閬嶅磿閵堝鈧啴宕卞☉娆忎簵濠电偛妫欓幐濠氭偂閻樼粯鐓曢柨鏃囶嚙楠炴牗銇勯敐鍫濅汗闁瑰弶鎮傞獮搴㈢節閸屾碍娈滈梺琛″亾濞寸姴顑嗛悡鍐煏婢跺牆濡介柣婵愪邯閺岀喖宕楅悡搴☆潚闂佸搫鑻粔鍫曞箯閻樼粯鍤戞い鎴€ら崘锝嗘杸闂佹枼鏅涢崯顖炲磹閹扮増鐓曢柍瑙勫劤婢ф煡鏌熷畡鐗堝櫤缂佹鍠栭、娑樏归煬鎻掔伈婵﹤顭峰畷鎺戔枎閹烘垵甯紓浣鸿檸閸樺ジ鎮ラ悡搴ｆ殾婵犲﹤鍟犻弨浠嬫倵閿涙墎鍋撻柛瀣崌閺佸啴宕掑鍗炩偓鐐差渻?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弴妤€浜惧銈庝簻閸熸潙鐣疯ぐ鎺濇晪闁告侗鍨版慨娲⒒娴ｄ警娼掗柛鏇炵仛閻ｅ墎绱撴担鎻掍壕婵犮垼鍩栭崝鏍磹閻㈠憡鐓ユ繝闈涙椤庢顭胯瑜板啴鍩?HUD 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犖ч柛灞剧煯婢规洖鈹戦绛嬬劷闁告鍕珷妞ゆ牜鍋為悡娑㈡煕濞戞瑦绶查柣鎾村姉缁辨帡宕掑☉妯碱儌闂侀€炲苯澧剧紓宥呮閸┾偓?
    // ==========================================
    public int getKillProgressPercent() {
        int tier = getTier();
        if (tier >= 5) return 100; // 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌涘☉姗堟敾闁告瑥绻橀弻鐔虹磼閵忕姵鐏€闂侀€炲苯澧剧紒鐘虫崌閵嗕礁顫滈埀顒勫箖閳哄懎绠涘ù锝呮贡缁嬫劙姊婚崒娆戭槮闁圭⒈鍋勭叅闁靛ň鏅涢梻顖炴煏婢跺牆鍔楅柡瀣煥闇夐柣妯烘▕閸庢劙鏌ｉ幘瀛樼闁哄本娲樺鍕槈濮橆剙鐓傚┑鐘殿暯閸撴繄鈧瑳鍥﹂柛鏇ㄥ灠閻撴盯鏌涚仦鍓х煀鐎殿喓鍔戝娲传閸曨剚鎷遍梺鐑╂櫓閸ㄨ泛鐣峰ú顏勭妞ゆ牗姘ㄩˇ褔姊洪崘鍙夋儓闁稿﹥鎮傞幃姗€骞橀鐣屽幈闂佸磭鎳撻悘婵嬫倶閼碱兘鍋撳▓鍨珮闁革綇绲介悾閿嬬附閸涘﹤浜滈梺鍛婄箓鐎氼剙效?100%

        // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箻閺岀喓绱掗姀鐘崇彯闂佽桨绀佺€氫即寮诲☉妯锋婵炲棙鍔楃粙鍥⒑濮瑰洤鈧倝宕伴弽顓熺畳闂備胶顭堢换鎰板触鐎ｎ剛绀婇柟杈鹃檮閻撴盯鎮楅敐鍌涙珖缂佹劖妫冮弻锛勪沪閻愵剛顦伴悗瑙勬礈閸樠囧煘閹达箑绠涙い鎾愁檧婵″洨妲愰幘瀛樺闁圭粯甯婃竟鏇㈡⒒娴ｅ憡鍟為柛鏃撶畵瀹曟澘螖閸涱喖浜楅梺鍝勬川閸犳挾绮绘ィ鍐╃厵閻庣數顭堟禒褔鏌熼崘鎻掝伀缂佽鲸鎸搁濂稿幢濡ゅ啩绱濋梻浣告惈閺堫剟鎯勯姘煎殨妞ゆ帒鍊圭€氭岸鏌熺紒妯虹瑨鐞氭繈姊婚崒娆戭槮闁圭⒈鍋婇幆灞惧緞瀹€鈧粈濠偯归敐澶嗗亾濞戞氨鐣鹃梻浣哥秺濡法绮堟担鍛婃殰闂傚倷绶氬褔藝娴犲绐楅柡鍥╁У椤洟鏌熼崜褏绡€缂佽妫濋弻鏇㈠醇濠靛洦鎮欓柛鐔告倐濮婅櫣绮欏▎鎯у壉缂備礁顑嗛幑鍥嵁閹达箑顫呴柣妯荤墱閸犳牠骞栭崷顓熷枂闁告洦鍓﹂崯搴ㄦ⒒閸屾瑧鍔嶉悗绗涘懏宕查柛宀€鍊涢崶顒夋晬闁绘劘灏欓ˇ銊╂⒑闁偛鑻晶顔姐亜椤忓嫬鏆ｅ┑鈥崇埣瀹曞崬螖閳ь剝銆栫紓鍌氬€烽悞锕併亹閸愵煈鐒介柨鐔哄Т缁犳牕霉閸忓吋缍戦崬顖炴⒑閸愬弶鎯堥柛濠勬暬楠炲繐煤椤忓應鎷洪梺鍛婄☉閿曪妇绮婚幘缁樺€垫慨妯煎帶閺嬫盯鏌ｉ埥鍡楀箺缂佺粯绻堥幃浠嬫濞戞鎽嬫俊鐐€栧ú妯煎垝鎼达絽鍨濆┑鐘宠壘缁犲鏌熸０浣侯槮婵炲牄鍔嶇换婵嬫偨闂堟刀锝囩棯閺夎法效鐎规洘鍨垮畷鐔碱敍濞戞艾骞堥梻濠庡亜濞诧箓骞愰幖浣哥畺闁瑰鍋熺粻?
        int target = getKillTarget(tier);
        if (target == 0) return 100; // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲梺姹囧€ら崰妤呭Φ閸曨垰绠涢柍杞拌兌閸旀挳姊洪幖鐐测偓鏍洪悢鐓庤摕婵炴垯鍩勯弫鍐煥濠靛棙顥滄い锔规櫊濮婄儤娼幍顕呮М濠碘槅鍋呴悷褔骞戦姀鐘闁靛繒濮烽鍝勨攽閻愬弶顥滅紒缁樺笚缁傛帗銈ｉ崘鈹炬嫼闂佽鍎兼慨銈夊极鏉堛劋绻嗘い鎰╁灩閺嗭絿鈧鍠栭…宄邦嚕閹绢喖顫呴柣妯款嚙閺佽绻濋悽闈涒枅婵炰匠鍏炬盯顢橀悢渚祫闂侀潻瀵岄崢鍓у?

        int kills = getKillCount();

        // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箳閳ь剝顫夊ú鏍洪敃鍌ゆ晝濞寸姴顑嗛悡蹇涙煕椤愶絿绠栧璺哄閵囧嫰顢曢敐鍡欘槹闂佸搫鐭夌换婵嗙暦閸洖唯闁靛／鍌滄／闂傚倷鑳堕…鍫ヮ敄閸岀偛鐤炬繛鎴欏灩閻撴﹢鏌熸潏楣冩闁稿鍔楅埀顒冾潐濞叉牕霉閸岀偛姹查柨鐔哄У閳锋垹绱掔€ｎ亝鍋ユい搴㈩殜閺岋綁顢橀悙娴嬪亾閸噮鍤曞┑鐘崇閸嬪嫮鐥幏宀勫摵闁哄拋鍓熷铏瑰寲閺囩偛鈷夊銈冨妼閹虫ê顕ｉ幎鑺ュ亜闁稿繗鍋愰崢鎾绘偡濠婂嫮鐭掔€规洘绮岄埢搴ㄥ箻椤栨浜鹃柨鏇炲€归崐濠氭煢濡警妲奸柟?(婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓缂佺姵婢橀埞鎴︽偐瀹曞浂鏆￠梺鎼炲€曢懟顖濈亙闂佹寧绻傞幊搴ㄥ几閵堝鐓涘ù锝囶焾椤忣參鏌＄仦鍓р槈闁宠棄顦埢搴ㄥ箣閻愭惌鍞梻? 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴姘辩Т闂佹悶鍎洪崜锕傚极閸愵喗鐓ラ柡鍥殔娴滃墽绱掗悙顒€鍔ゆい顓犲厴瀵鎮㈤悡搴ｎ槶閻熸粌绻掗弫顔尖槈閵忥紕鍘?0 / 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缁炬儳娼￠弻锝夊閵忊晝鍔搁梺姹囧€濈粻鏍蓟瀹ュ浼犻柛鏇ㄥ墮濞咃絿绱撴担鐟板妞ゃ劌妫欑粚杈ㄧ節閸ヮ灛褔鏌涘☉鍗炴灈婵炲懌鍊濆?0 = 50%)
        int percent = (int)((float)kills / target * 100);

        return Math.min(percent, 100); // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑鏅悷婊冪箻楠炴垿濮€閵堝懐鐤€濡炪倖妫佸Λ鍕償婵犲洦鐓熼幖鎼灣缁夌敻鏌涢幘鏉戝摵妞ゃ垺娲熼幊鐐哄Ψ閿曗偓瀵灝鈹戦埥鍡楃仭閻庣瑳鍛厹闁绘劦鍓氭禍?100%
    }





    // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕閻庤娲忛崕鎶藉焵椤掑﹦绉甸柛鐘崇墱婢规洟宕稿Δ浣哄幍闂佽鍨虫晶妤吽夋径鎰闁哄鍩婇煬顒勬煛鐏炶鈧繈骞婂┑瀣妞ゆ棁鍋愭晶顖氣攽閻愯尙鎽犵紒顔肩灱缁辩偞绻濋崶褑鎽曞┑鐐村灟閸ㄧ懓鏁梻渚€娼х换鍡涘礈濠靛鍋熼柡宥冨妺缁诲棝鏌ｉ幇顒備粵闁搞倐鍋撻梻浣告憸閸犲骸顭囬敓鐘茬伋闁挎梻鍋撳畷澶愭煏婵犲繒鐣辩痪缁㈠灦濮婃椽骞嗚缁犵増绻濋埀顒勬焼瀹ュ懐顦銈嗙墱閸嬬偤鍩涢幋鐘电＝濞达綀顕栭悞浠嬫煃椤栨稒绀嬮柡宀€鍠栭幃鐑芥偋閸繃鐏庨柣搴㈩問閸犳盯顢氳閸┿儲寰勬繝搴㈠缓闂佺硶鍓濋敋闁稿繐锕ユ穱濠囨倷椤忓嫧鍋撻弽顐ｆ殰闁圭儤顨呯壕褰掓煙閻楀牊绶查崶鎾⒑閹肩偛鍔橀柛鏂挎湰缁?
    private String getTierName(int tier) {
        if (this.entityData.get(IS_BRUTAL)) return "[L] BRUTAL MODE";
        return switch(tier) {
            case 0 -> "[D] Basic Guard";
            case 1 -> "[C] Veteran Guard";
            case 2 -> "[B] Elite Guard";
            case 3 -> "[A] Ace Guard";
            case 4 -> "[S] Special Guard";
            case 5 -> "[L] Legendary Guard";
            default -> "Unknown";
        };
    }
    // ==========================================
    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱槸濞寸兘宕伴弽褏鏆︽い鎰剁畱缁€瀣亜閹哄秷鍏屾俊宸簽缁辨捇宕掑顑藉亾閻戣姤鍤勯柤鎼佹涧閸ㄦ梹銇勯幘鍗炵仼闁搞劌鍊块弻娑㈩敃閿濆棛顦ラ梺钘夊暟閸犳劗鎹㈠☉銏犵闁绘劕鍟畝绋款嚕閸涘﹥鍎熼柕濠忓閸樼敻姊绘笟鍥у伎缂佺姵鍨垮绋库槈濞嗗秳绨诲銈嗗姇妤犵煤閿曞倸鐓曢柟杈鹃檮閻撴瑩鏌ゅù瀣珔濞寸姵绮岄埞鎴﹀焺閸愨晛鈧劙鏌＄仦鍓ф创鐎殿噮鍣ｉ崺鈧い鎺戝閸ㄥ倿鏌涜椤ㄥ牆鐣垫笟鈧弻娑㈠箛閵婏附鐝栧銈傛櫇閸忔﹢骞冨Δ鍛櫜閹肩补鈧尙鐩庡┑鐐茬摠缁秶鍒掓惔锝嗩潟闁规儳鐡ㄦ刊鎾煕閹炬潙绲婚柛鎾绘涧閳规垿鎮欏顔叫у┑鐐插级椤洨鍒掔€ｎ亶鍚嬪璺侯儐濞呮粍绻濋姀锝嗙【妞ゆ垵鍊块獮蹇曠磼濡偐鐦堥梺姹囧灲濞佳冪摥濠德板€楁慨鎾箟閿熺姴鐤鹃柤鍝ユ暩缁♀偓濠殿喗锕╅崢楣冨储闁秵鐓熼幖鎼灣缁夐潧霉濠婂嫮鐭掗柛鈹惧亾濡炪倖宸婚崑鎾绘煟韫囨梻绠為柟顕€绠栭幃婊呯驳鐎ｎ偅娅岄梻浣告啞濞诧箓宕愰悩渚▌闂佸搫鏈惄顖涗繆閻戣棄顫呴柍鈺佸暟瑜板洭姊绘担鐟邦嚋缂佸甯為幑銏ゅ醇濠垫劖缍庡┑鐐叉▕娴滄粍瀵奸悩缁樼厱闁哄洢鍔岄弸銈嗕繆娣囧崬濮傛慨濠冩そ瀹曘劍绻濋崒姘兼綆闂備礁鎲￠弻銊┧囬棃娑卞殨?
    // ==========================================
    private String getUnitIdString() {
        int id = this.entityData.get(UNIT_ID);

        // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯煎幗闁瑰吋鎯岄崹宕囩矓閻㈠憡鐓曢悗锝庝簻閳ь剚鎮傞敐鐐测攽鐎ｎ偅娅囬梺閫炲苯澧撮柛鈺冨仱楠炲鏁冮埀顒勬偂閿熺姵鐓曢柍鈺佸枤濞堟ê霉閻樿櫕灏﹂柟顔筋殘閹叉挳宕熼鍌ゆЧ婵犵數鍋橀崠鐘诲炊妞嬪海鈼ら梻濠庡亜濞诧箓寮婚敐澶婄；闁告稑鐡ㄩ悡鏇㈡煙閼割剙濡芥繛鍛喘閺屾稑螣缂佹ê鈧劖鎱ㄦ繝鍐┿仢鐎规洘绮撻獮鎾诲箳瀹ュ洤鍤紓鍌氬€峰ù鍥敋瑜忕划鏃堝级閹存繄銈梻鍌欑劍閸庡磭鎹㈤幇顒婅€块弶鍫氭櫅椤ユ岸鏌ｉ幘鍐差唫闁挎繂娲ｅ▽顏堟煕閹炬鍟犻崣楣冩⒒閸屾瑧璐伴柛娆忛叄瀹曞綊宕奸弴鐐舵憰?(闂?)闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弮鍫熸殰闁稿鎸剧划顓炩槈濡娅ч梺娲诲幗閻熲晠寮婚悢鍛婄秶濡わ絽鍟宥夋⒑閹肩偛鈧牠宕濋弽顓炍﹂柛鏇ㄥ灠閸愨偓闂侀潧顭堥崕鍗炐掗崼婵冩斀闁绘劘灏欏В鐐烘煛閸涱垰鈻堢€殿喖顭峰鎾偄閾忚鍟庨梻浣虹帛閸旓箓宕滃鑸靛仧闁哄洢鍨洪埛鎴︽煙閹澘袚闁轰浇椴哥换娑㈡嚑椤掆偓閺嬫盯鏌熼鍡欑瘈妞ゃ垺娲熼弫鍐焵椤掑嫭鍊峰┑鐘叉处閻撳繐鈹戦悩鑼闁告艾鍊块弻鐔风暋閻楀牐纭€缂備浇椴搁幐濠氬箯閸涘瓨顥堟繛鎴烇供閻庢挳鏌ｆ惔鈥冲辅闁稿鎹囬弻鐔兼⒒鐎靛壊妲梺钘夊暟閸犳牠寮婚妸銉㈡斀闁糕檧鏅滅瑧婵＄偑鍊ら崑鍕箠濮椻偓瀵寮撮敍鍕澑闂佸搫娲ㄩ崐顐︽晲婢跺鍘介柟鍏肩暘閸斿酣鎮鹃悜妯诲弿濠电姴鍟妵婵囶殽閻愬澧甸柟顔界懇楠炴捇骞掑┑鍫氬亾鐎靛摜纾藉ù锝呮惈娴滅偓绻濋姀鈽嗙劷缂侇喗妫冨畷婊勬媴缁嬭法浜版繝鐢靛仜濡瑩宕濋弴鐘愁偨闁绘劗鍎ら悡娆撴⒑椤撱劎鐣卞褌鍗抽弻娑㈠籍閹惧墎鏆犲銈庝簻閸熷瓨淇婇崼鏇炲耿婵°倕鍟伴幊鍡涙⒑鐠囨彃顒㈤柛鎴濈秺瀹曪綁宕橀…鎴濇?(1-999)
        if (id == 0) {
            id = this.random.nextInt(999) + 1;
            this.entityData.set(UNIT_ID, id);
        }

        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犖ч柛銉㈡櫇閸樼娀姊绘担绋款棌闁稿鎳庣叅闁哄稁鍘肩壕濂告煏婵炑冨閺嬫垿妫呴銏″闁瑰嘲缍婇弫鎰緞婵犲嫮鏉搁梻浣虹帛椤ㄥ懘鎮ф繝鍌楁瀺闁靛繈鍊栭埛鎴犵磽娴ｇ櫢渚涢柣鎺楃畺閹绠涢弮鍌涘櫚闁芥ɑ绻堝娲敆閳ь剛绮旈悽绋跨厱闁硅揪闄勯悡鏇熺節闂堟稒顥滄い蹇ｅ亰閺屽秶鎷犻懠顒備紘缂備浇椴哥敮锟犲箖閳哄懎绀冮柤纰卞墻閸庡瞼绱?3婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｅΟ娆惧殭缂佺姴鐏氶妵鍕疀閹炬惌妫炵紓浣界堪閸婃繈寮婚敐澶嬫櫜闁告侗鍨虫导鍥⒑濞茶骞楅柟鐟版喘瀵鏁愭径濠庢綂闂侀潧绻嗛弲婵嬪礉缁嬪簱鏀芥い鏃€顑欏鎰版煟閹垮嫮绡€鐎殿喖顭烽弫鎰緞婵犲喚妫熼梻浣稿閻撳牓宕板Δ鍛９妞ゆ牜鍋為埛?(婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓缂佺姵婢橀埞鎴︽偐瀹曞浂鏆￠梺鎼炲€曢懟顖濈亙闂佹寧绻傞幊搴ㄥ几閵堝鐓涘ù锝囶焾椤忣參鏌＄仦鍓р槈闁宠棄顦埢搴ㄥ箣閻愭惌鍞梻?7 -> "007")
        return String.format("%03d", id);
    }

    // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犵厱婵﹩鍘介妵婵嗏攽闄囬崺鏍ь嚗閸曨厸鍋撻敐搴濈胺婵″弶鍔欏缁樼瑹閳ь剙顭囪婢ф繈姊洪崫鍕櫤闁烩晩鍨堕獮蹇涘箣閿旇棄浜滈柣蹇撶箣閻掞箓寮埀顒勬⒒娴ｈ櫣甯涢柨姘扁偓娈垮枛閻栧ジ鐛弽顓炵疀闁绘鐗嗘禒顓炩攽閻愬弶顥為柣鐔村劦閵嗗懘顢楅崟顒傚帗閻熸粍绮撳畷婊冣枎閹寸姳绗夐悗骞垮劚椤︻垳澹曢崸妤佲拺妞ゆ巻鍋撶紒澶婎嚟缁鎮╃紒妯煎幍闂佺粯顨呴悧濠勬閼碱剛纾奸柣妯挎珪閵囨繈鏌″畝瀣М鐎殿噮鍓熷畷褰掝敊閽樺鍋撻鐐粹拺缂備焦蓱鐏忎即鏌ｉ埡濠傜仸鐎殿喛顕ч埥澶愬閻樻彃绁梻渚€娼ч…鍫ュ磿閹殿喛濮冲┑鐘崇閳锋垿鏌熼幆鏉啃撻柡浣介哺娣囧﹪顢曢姀鐘虫閻?
// 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犵厱婵﹩鍘介妵婵嗏攽闄囬崺鏍ь嚗閸曨厸鍋撻敐搴濈胺婵″弶鍔欏缁樼瑹閳ь剙顭囪婢ф繈姊洪崫鍕櫤闁烩晩鍨堕獮蹇涘箣閿旇棄浜滈柣蹇撶箣閻掞箓寮埀顒勬⒒娴ｈ櫣甯涢柨姘扁偓娈垮枛閻栧ジ鐛弽顓炵疀闁绘鐗嗘禒顓炩攽閻愬弶顥為柣鐔村劦閵嗗懘顢楅崟顒傚帗閻熸粍绮撳畷婊冣枎閹寸姳绗夐悗骞垮劚椤︻垳澹曢崸妤佲拺妞ゆ巻鍋撶紒澶婎嚟缁鎮╃紒妯煎幍闂佺粯顨呴悧濠勬閼碱剛纾奸柣妯挎珪閵囨繈鏌″畝瀣М鐎殿噮鍓熷畷褰掝敊閽樺鍋撻鐐粹拺缂備焦蓱鐏忎即鏌ｉ埡濠傜仸鐎殿喛顕ч埥澶愬閻樻彃绁梻渚€娼ч…鍫ュ磿閹殿喛濮冲┑鐘崇閳锋垿鏌熼幆鏉啃撻柡浣介哺娣囧﹪顢曢姀鐘虫閻?
// ==================== 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰鍐€妞ゆ劦婢€缁墎绱?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣椤愯姤鎱ㄥ鍡楀⒒闁绘帞鏅幉绋款吋閸澀缃曞┑鐘垫暩閸嬫稑螞濞嗘挸绠伴柛婵勫劤閻棗顭跨捄渚剮缂佽妫濋弻鏇㈠醇濠靛洤娅ゆ繝娈垮灠閵堟悂寮婚埄鍐╁缂佸顑欐导鍐⒑閸濆嫭婀伴柣鈺婂灡娣囧﹪鎮滅粵瀣櫓闂佺粯鎸哥€垫帒顭囨繝姘拻濞达綀娅ｇ敮娑㈡煕閺冣偓濞茬喖寮崘顔嘉ㄧ憸搴＄暦閸欏绠鹃柟瀛樼懃閻忊晝绱掗悪鍛М闁哄矉缍侀獮鍥敆閸屾瑧椹抽梻渚€娼荤徊鑲╁垝濞嗗浚娼栨繛宸簻瀹告繂鈹戦悩鎻掓殶闁告瑥妫濋弻锝嗘償閵忋垻鍙濋梺鍛婎殔閸熷潡顢?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰级閻ゅ嫰姊绘担鍛婂暈闁圭妫濆畷銊╊敍濠婂啫鑴梻鍌氬€风粈浣革耿闁秵鎯為幖娣妼缁愭淇婇妶鍛櫣缁炬儳顭烽弻鏇㈠醇濠靛洤顦╅梺鍝ュУ閸旀瑩寮婚敓鐘茬＜婵炴垵宕崝宀勬⒑閹肩偛鈧牕煤閺嶎厽绠掗梻浣侯焾缁绘劙宕ョ€ｎ剛绀婇柟瀵稿Х绾惧ジ鏌嶈閸撶喎鐣锋總绋款潊闁炽儴娅曢悗楣冩⒑鐠囨彃鍤辩紓宥呮瀹曟垿宕卞☉鏍ゅ亾閸涘瓨鐓ラ悗锝庡墰椤旀洟姊洪悷鎵憼闁荤喆鍎甸幃姗€顢旈崼鐔哄帗闂備礁鐏濋鍛存倶閿曞倹鐓忛柛銉戝喚浼冨Δ鐘靛仜濞差厼鐣峰鍕闁间粙鏀遍崹鐢糕€旈崘顔嘉ч幖绮光偓鑼嚬婵＄偑鍊戦崝宀勬偋韫囨拹?====================
    public void updateCustomName() {
        if (this.level().isClientSide) return;

        ChatFormatting tierColor = switch (getTier()) {
            case 0 -> ChatFormatting.GRAY;
            case 1 -> ChatFormatting.GREEN;
            case 2 -> ChatFormatting.BLUE;
            case 3 -> ChatFormatting.GOLD;
            case 4 -> ChatFormatting.DARK_PURPLE;
            case 5 -> ChatFormatting.RED;
            default -> ChatFormatting.WHITE;
        };

        String baseNameRaw = this.entityData.get(SYNC_BASE_NAME);
        Component baseName = TurretTextResolver.resolveBaseName(baseNameRaw).copy().withStyle(tierColor);
        Component idText = Component.literal(" #" + getUnitIdString()).withStyle(ChatFormatting.WHITE);

        Component finalName;
        if (this.entityData.get(IS_FOLLOWING)) {
            net.minecraft.network.chat.MutableComponent prefix =
                    Component.literal("[\u961F\u4F0D] ").withStyle(ChatFormatting.AQUA);
            if (this.entityData.get(IS_CAPTAIN)) {
                // Captain marker must match tactical panel: yellow crown, captain-only.
                prefix.append(Component.literal("\uD83D\uDC51 ").withStyle(ChatFormatting.GOLD));
            }
            finalName = prefix.append(baseName).append(idText);
        } else {
            finalName = Component.translatable("name.examplemod.turret.default", baseName, idText);
        }

        this.setCustomName(finalName);
    }

    public static boolean isLegacyDefaultBaseName(String name) {
        if (name == null) return false;
        return "Vanguard".equals(name) || "Skeleton Turret".equals(name);
    }

    private static boolean isDefaultBaseName(String name) {
        return name == null || name.isBlank() || DEFAULT_BASE_NAME_TOKEN.equals(name) || isLegacyDefaultBaseName(name);
    }

    private static String normalizeBaseName(String name) {
        if (isDefaultBaseName(name)) {
            return DEFAULT_BASE_NAME_TOKEN;
        }
        return name;
    }

    private void checkKillUpgrade() {
        int tier = getTier();
        if (tier < 5) {
            int kills = getKillCount();
            int target = getKillTarget(tier);
            if (kills >= target) {
                performUpgrade(tier + 1);
                return;
            }
        }
        updateCustomName();
    }

    // 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰鍐€妞ゆ劦婢€濞岊亪姊?闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煟閵忋埄鐒剧痪鎯ь煼閺岋綁骞囬鑺ユ瘎闂佹椿鍘介悷鈺呮偂椤愶箑鐐婇柕濞р偓濡插牏绱掗悙顒€鍔ゆ繛纭风節瀵鎮㈢亸浣圭亖闂佸壊鐓堥崰妤呮倶閹惧墎纾藉ù锝呮惈鏍″┑鈽嗗亜閸熸潙顕ｇ拠娴嬫婵☆垰鍚嬪▓鏇㈡⒑闁偛鑻晶瀵糕偓瑙勬礃閸ㄧ敻鍩ユ径濞㈢喎顭ㄩ崟顓涙濡炪値鍋呯划鎾诲春閳ь剚銇勯幒鎴濐仼缂佺姵鐗滈埀顒傛嚀鐎氼厽绔熺€ｎ喖鍑犻幖娣妿閸欐捇鏌涢妷锝呭闁诡垰瀚湁閻忓繑鐗曟禍楣冩⒒閸屾艾鈧娆㈠顒夌劷鐟滃秷鐏嬪┑掳鍊曢幊蹇涘疾濠靛鐓忛柛顐ｇ箥濡叉挳鏌嶈閸撱劎绮婚幘宕囨殾缂佸顕抽弮鍫濈劦妞ゆ帒鍊绘稉宥嗘叏濡灝鐓愰柣鎾跺枑娣囧﹪濡堕崒姘闂備胶绮〃鍛涘Δ鍛叀濠㈣泛瀵掑Σ鍓х磽娴ｄ粙鍝洪柟绋款煼楠炲繘宕ㄩ缁㈡祫闁诲函缍嗘禍婵嬪箠濞嗘垹纾介柛灞剧懄缁佺増銇勯弴鍡楁处閸嬪鏌涢埄鍐姇闁稿鏅犻弻锝夊箣閿濆憛鎾绘煕鐎ｎ偄濮嶉柟顔肩秺瀹曞爼濡搁妷褏銈风紓鍌欑劍閸旀牜绮欓幋锔光偓鏃堝礃椤斿槈褔鏌涢埄鍐炬畼闁荤喆鍔戝铏圭矙閸栤剝鏁惧┑鈥冲级鐢€崇暦閹邦喒鍋撳☉娆樼劷缂佲檧鍋撻梻浣圭湽閸ㄨ棄顭囪缁傛帡鏁冮崒娑氬幈闂侀潧顭堥崕鎶藉春閿濆棭娈介柣鎰綑婵秵顨ラ悙瀵稿缂佹鍠栧畷鍫曞Ω閿旂晫褰堝┑鐘垫暩婵即宕归悡搴樻灃婵炴垟鎳囬埀顒婄畵椤㈡宕熼鈧埀顒€娼￠弻锕€螣娓氼垱锛嗛悷婊呭鐢宕戦崒鐐茬閺夊牆澧界粙濠氭煙閹绘帇鍋㈡慨濠呮缁瑩宕稿Δ濞惧亾濡ゅ啰纾煎璺猴功缁夎櫣鈧鍠涢褔鍩ユ径鎰潊闁绘ɑ褰冪粊顕€姊绘笟鈧褔鈥﹂崼銉ョ？闁惧浚鍋嗛々閿嬫叏濡灝鐓愰柍閿嬪灩缁辨帞鈧綆鍋掗崕銉╂煕鎼淬垹濮嶉柡宀€鍠栭幃鐑芥偋閸喐鍊锋俊鐐€栧ú鈺冪礊娓氣偓閻涱喛绠涢幘鑸垫畷闂侀€炲苯澧撮柟顔兼健閸┾偓妞ゆ帒瀚埛鎴︽煕濠靛棗顏€瑰憡绻堥弻娑氣偓锝庡墮閺嬫稒銇?
    @Override
    public InteractionResult mobInteract(Player player, InteractionHand hand) {
        ItemStack item = player.getItemInHand(hand);
        if (player.isShiftKeyDown()) {
            // Shift 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾剧粯绻涢幋娆忕仾闁稿鍊濋弻鏇熺箾閻愵剚鐝旈梺鍛婅壘缂嶅﹪鐛弽顬ュ酣顢楅埀顒佷繆閼测晝妫柟顖嗗懐楔闂佸搫鐬奸崰鏍箖濞嗘搩鏁嗛柍褜鍓熷畷婵堟崉鐞涒剝鏂€濡炪倖妫佸Λ鍕煝閺囥垺鐓涚€光偓閳ь剟宕版惔銊ョ厺闁规崘顕ч崹鍌涖亜閺冨倹娅曞ù婊冨⒔缁辨挻鎷呴崫鍕闂佺瀛╂繛濠冧繆閸洖绠瑰ù锝嗙摃閹芥洟姊洪幐搴ｇ畵妞わ富鍨拌灋婵せ鍋撻柡灞剧洴閳ワ箓骞嬪┑鍥╁蒋闂備礁鎼Λ搴ㄥ垂瑜版巻鈧棃宕橀鍢壯囨煕濞戝崬鐏ｆい鏃€甯楃换娑氣偓娑欘焽閻﹪鏌ｉ弽顐㈠付妞ゆ洩绲剧换婵嗩潩椤撶喐顏熼梻浣虹帛椤牏浜稿▎鎾崇闁挎洍鍋撴い顏勫暣婵″爼宕卞Δ鍐噯闂佽瀛╅崙褰掑礈濞戞艾鍨濆┑鐘宠壘閽冪喖鏌曟径娑橆洭闁告鏁诲娲传閸曞灚歇濠电偛顦板ú妯肩矉閹烘垟妲堥柕蹇ョ磿閸樻悂姊虹粙鎸庢拱妞ゃ劌鎳忕粋宥嗐偅閸愨斁鎷?Carry On / 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁逞屽墾缁犳挸鐣锋總绋款潊闁炽儱鍟跨花銉╂⒒娴ｇ儤鍤€闁宦板妿閹广垽骞囬悧鍫濇畬闂佺鍕垫畷闁绘挻娲熼弻銊╁籍閸ヨ泛娈Δ鐘靛仦閻楃娀寮诲☉銏犖╅柨鏂垮⒔閻ｆ椽姊洪棃娑欐悙閻庢矮鍗抽悰顕€骞掑Δ鈧粻锝嗙節閸偄濮冮柟顕嗙悼缁辨捇宕掑▎鎺戝帯婵犳鍣ｇ粻鏍晲閻愭潙绶為柟閭﹀劦閿曞倹鐓曢柡鍥ュ妼閻忕姷绱掗悩鍐测枙闁哄瞼鍠撻埀顒佺⊕椤洨绮婚弽銊х闁割偅绻傞。宕囩磼鏉堛劍灏伴柟宄版嚇瀹曨偊宕熼幋鐘蹭槐闁哄本绋掗幆鏃堝灳瀹曞洭鐛撶紓鍌欑閻焦銇旈崫銉﹀床婵犻潧顑呴悙濠囨煠缁嬭法浠涙繛鍛墵濮婄粯绗熼埀顒€顭囪閹囧幢濡炴洘妞芥俊鎼佸煛閸屾稒鐝梻浣虹帛濡礁鈻嶉敐鍥ь棜闁芥ê顦埀顒佸笒椤繈顢楁担瑙勫€烽梻浣告惈椤戝棛绮欓幘鑸殿潟闁圭儤鎸哥欢鐐测攽閻樻彃顏Δ鏃堟煟鎼淬埄鍟忛柛锝庡櫍瀹曟垿宕熼锝嗘櫍婵犻潧鍊婚…鍫濐啅濠靛洢浜滈柡宥冨妿閳洟鏌ｉ敐鍥у幋婵﹦绮幏鍛村川婵犲倹娈樻繝鐢靛仩椤曟粓姊介崟顓犵焿鐎广儱顦伴崐鐑芥煕椤垵浜芥繛鑲╁枎閳规垿顢欑粵瀣姼闂佺硶鏅滈悧鐘诲春濞戙垹绠ｉ柣妯兼暩閿涙粓鏌ｆ惔顖滅У闁告鏅☉鐢稿礈娴ｈ櫣锛滈梺缁樏崯鍧椝夌€ｎ剛纾奸弶鍫涘妼缁楁氨鈧灚婢樼€氼噣鍩€椤掑﹦绉甸柛瀣瀹曨剚寰勯幇顓涙嫼闁荤姴娲犻埀顒冩珪閻忓牆鈹戦悙鑼癁闁逞屽墮绾绢參寮抽敃鍌涚厽闁哄啫鍊甸幏锟犳煛娴ｅ憡顥滈棁澶愭煥濠靛棙鍣规い銉ョ箻閺屽秷顧侀柛鎾村哺楠炴垿宕惰濞兼牗绻涘顔荤凹闁稿绻濋弻鈩冨緞婵犲嫭鐨戦梺鍦焾閸熸潙顫忛搹瑙勫厹闁告侗鍠氳ぐ褔姊洪悷鐗堝暈闁诡喖鍊垮畷娲閵堝懐顔掗梺鍝勵槹閸╁牓宕甸妶澶嬬厽閹兼番鍨婚埊鏇㈡煥閺囨娅呴摶鐐烘煕濞戝崬寮炬繛鎾愁煼閺屾洟宕煎┑鍥舵缂備焦顨嗙敮妤呭Φ閸曨垱鏅滈悹鍥皺娴狀厾绱撴担绋库偓鍝ョ矓绾惧浜欏┑鐐舵彧缁插潡骞婇幘鎰佸殨闁割煈鍠掗弨鑺ャ亜閺冨倻鎽傛繛鍫熸閺岋絽螖娴ｇ懓纰嶅銈庡墮閿曨亪銆佸▎鎾崇鐟滃繘鏁嶅鍫熲拺缂佸瀵у﹢鐗堟叏濡濡介柡鍛劜娣囧﹪濡堕崶顬儵鏌涚€ｎ剙浠ч柡渚囧櫍閺佹捇鎮╅棃娑氥偊闂佽鍑界紞鍡涘窗濡ゅ懎纾归柣鎴ｅГ椤ュ﹥銇勯幇闈涗簻妤犵偞鐗犻弻鐔兼寠婢舵ê鍓辩紓浣虹帛缁诲牓骞冩禒瀣棃婵炴垶顨堥幑鏇㈡⒒娴ｅ壊鍚旈柡澶婄仢椤姊洪崨濠傜瑲閻㈩垱甯￠幃鎯р攽鐎ｎ亞顦伴梺鍓茬厛閸嬪懎鈻嶉崼銉︹拻濞达絽鎲￠崯鐐寸箾鐠囇呯暤鐎规洘鍨块崺鈧い鎺戝閻撴盯鎮楅敐搴濋偗闁告瑥瀚伴弻锛勪沪閻愵剛顦紓浣哄У缁嬫捇鍩€椤掑﹦绉靛ù婊勭墵瀹曟垿骞樼拠鎻掑敤濡炪倖鎸鹃崑鐔煎蓟?            return InteractionResult.PASS;
        }



        // ==================== 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰绠涢柛鎾茬劍閸嬔呯磽娴ｅ搫鈻堢紒鐘崇墵瀵鈽夐姀鐘栥劍銇勯弮鍌氬付妞ゎ偒浜?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎾跺Х閸橆垶姊绘担鍛婃儓缂佸绶氶幃妯衡槈濡攱顫嶉梺闈涚箳婵兘藝閺夋娓婚柕鍫濇婢ь剚鎱ㄥΟ绋垮闁诡喗鍎崇叅妞ゅ繐鎳夐幏娲⒑閸涘﹦绠撻悗姘煎弮瀹曟帡濡搁埡鍌滃幈闂侀潧顭堥崕鑼嫻閳╁啰绠鹃柟瀵稿У閺嗩剟鏌涢埞鎯т壕婵＄偑鍊栫敮鎺斺偓姘煎弮閸╂盯骞嬮敂鐣屽幐闂佺鏈敋闁告梹绮嶇换娑㈠川椤撶喎娈楅梺鍝勬湰閻╊垶骞冮妶鍡樺闁告縿鍎板鎾绘煟鎼淬埄鍟忛柛鐘愁殕缁绘稒绻濋崶銉㈠亾娴ｅ壊娼ㄩ柍褜鍓氶幈銊╁焵椤掑嫭鐓ユ繛鎴灻鈺傤殽閻愯尙澧涚紒缁樼箓閳绘捇宕归鐣屼憾闂備焦瀵уú宥夊疾閻樿尙鏆︽繝濠傚暊濡插牊绻涢崱妯哄闁绘繐绻濆濠氬磼濮橆兘鍋撴搴㈩偨婵娉涢悞鍨亜閹烘垵鈧憡绂掑鍫熺厾婵炶尪顕ч悘锟犳煛閸涱厾鍩ｆい銏＄☉閳藉螖閸愵亞鏆伴梻鍌欑閹诧繝鎮烽妷鈹у洭顢涘鍛暥閻熸粌娴烽幑?(闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墴閹潡顢氶埀顒勫蓟閿濆憘鏃堝焵椤掑嫭鍋嬮煫鍥ㄦ礈娑撳秴螖閿濆懎鏆為柣鎾冲暟閹茬顭ㄩ崼婵堫槶闂佺粯姊婚崢褔鎷戦悢鍏肩厸闁搞儯鍎遍悘鈺傤殽閻愵亜鐏ǎ鍥э躬婵″爼宕ㄩ鐔割吙缂傚倷鐒﹂〃鍛村灳濞撳獝t) ====================

        // ==================== 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰鍐€妞ゆ劦婢€缁泛鈹?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎电濡介梺绋款儏椤戝懘鍩為幋锔藉亹闁圭粯甯╂禒楣冩⒑閸濆嫭顥炵紒顔芥崌瀵濡搁埡鍌氫簻闂佸憡绻傜€氬懘濮€閵堝棌鎷婚梺绋胯閸婃洟鎮橀悩缁樻嚉闁哄稁鍘介悡銉︾節闂堟稒顥為柛锝呯秺閺岋繝宕卞▎蹇庢闂佸搫鏈粙鎺楀箚閺冨牆顫呴柍鍝勫€婚弶褰掓⒒娴ｅ憡鎯堥柣顒€銈稿畷浼村冀椤撶姴绁﹂梺绯曞墲缁嬫垹鐥閺屾盯鎮㈠畡鐗堟闂佸湱顭堥…閿嬩繆閻㈢绀嬫い鎺嶇閸斿懘姊洪幐搴ｂ槈閻庢艾鎳樻慨鈧幒铏濠婂嫨浜滈柟鏉垮缁夊灚绻涢崼鐔虹煂闁逞屽墲椤煤濠婂牆绐楅柡宥庡幑閳ь兛绀佽灃濞达綀娅ｉ幊婵嬫⒑閹肩偛鍔撮柣鎾崇墕铻為柛鎰靛枟閳锋帡鏌涚仦鍓ф噮缂佹劖妫冮弻宥堫檨闁告挻鐩畷鎴濃槈閵忊€虫濡炪倖鐗楃粙鎺戔枍閻樼偨浜滈柡宥冨妿閳笺儳绱掔拠鍙夘棦闁哄本绋戦埢搴ょ疀閿濆柊锔剧磽娴ｅ箍浜為柛鏇ㄥ幘椤?(Vanilla-Like) ====================
        if (item.getItem() == Items.LAPIS_LAZULI) {
            if (this.level().isClientSide) {
                return InteractionResult.SUCCESS;
            }

            // 1. 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ帒锕︾粙蹇旂節閵忥絽鐓愰柛鏃撶畵瀵偅绻濋崶銊у幐閻庡箍鍎辨鎼佺嵁閺嶎偆妫柟顖嗗瞼鍚嬮梺鍝勬湰缁嬫垿鍩ユ径鎰闁绘劖褰冮婊堟⒒娴ｈ鍋犻柛濠冪墪鐓ら柣鏃傚帶閽冪喐绻涢幋鐐电煠婵¤尙鍘ч—鍐Χ閸愩劌顬堥梺纭呮珪閿曘垽鐛崱娆庢勃閺夌偞瀵у褰掑箯閸涙潙绀傞柛婵勫劤濞夊潡姊婚崒娆戭槮闁圭⒈鍋嗙划娆愮瑹閳ь剙鐣烽幋锕€绀嬫い鎺戝亞濞村嫰姊洪幐搴㈢叆妞ゎ偅娲樼粋宥咁煥閸繄顔愰柡澶婄墕婢х晫澹曠捄銊㈠亾濞戞瑧绠撴い顏勫暣婵¤埖鎯旈垾鑼嚬婵＄偑鍊戦崝宀勬晝閵堝鍋╅柣鎴ｅГ閸嬪嫮鐥幏宀勫摵闁哄懌鍨虹换娑㈠箻绾惧顥濆┑鐐额嚋缁犳捇宕哄☉銏犲唨闁靛鍊楃粻姘舵⒑缂佹ê濮﹀ù婊勭矒閸┾偓妞ゆ帊绀侀悘瀵糕偓瑙勬礃濞茬喖寮婚崱妤婂悑闁糕剝蓱閻濇牗淇婇悙顏勨偓鏇犳崲閹扮増鍋嬮柛鈩冪☉閸?
            EquipmentSlot[] slots = {
                net.minecraft.world.entity.EquipmentSlot.MAINHAND,
                net.minecraft.world.entity.EquipmentSlot.HEAD,
                net.minecraft.world.entity.EquipmentSlot.CHEST,
                net.minecraft.world.entity.EquipmentSlot.LEGS,
                net.minecraft.world.entity.EquipmentSlot.FEET,
                net.minecraft.world.entity.EquipmentSlot.OFFHAND
            };

            ItemStack targetStack = ItemStack.EMPTY;
            EquipmentSlot targetSlot = null;

            for (EquipmentSlot slot : slots) {
                ItemStack s = this.getItemBySlot(slot);
                if (!s.isEmpty() && s.isEnchantable() && !s.isEnchanted()) {
                    targetStack = s;
                    targetSlot = slot;
                    break;
                }
            }

            if (targetStack.isEmpty()) {
                player.displayClientMessage(Component.literal("[Enchanter] No eligible equipment found."), true);
                return InteractionResult.FAIL;
            }

            // 2. 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙闁诡垳鍋ら獮鏍庨鈧俊濂告煟椤撶噥娈滄鐐寸墪鑿愭い鎺嗗亾濠德ゅ亹缁辨帡骞囬褎鐤侀梺鍝勫閳ь剚鍓氶崥瀣箹缁厜鍋撳畷鍥跺晥闂傚倷鑳堕…鍫ヮ敄閸岀偛鐤炬繛鎴炵矌娴滄瑩姊绘担鐟邦嚋缂佽鍊块獮濠冩償閵娿儲杈堥梺缁樺姉閸庛倝鎮￠崘顔解拺闁割煈鍣崕鎰亜閵夈儳澧﹂柡宀嬬磿娴狅箓宕滆閸掓盯鎮楀▓鍨灍闁规瓕娅曟穱濠囧箹娴ｈ倽銊ф喐瀹€鍕闁哄稁鍘介埛鎺懨归敐鍕劅闁衡偓閺夊簱鏀芥い鏂挎惈閳ь剚娲滈崣鍛攽閻樿宸ラ柟鍐茬箻閿濈偤寮撮姀锛勫幍闂佺粯鍨堕敋闁诲繐绉垫穱濠囧箵閹烘柨顤€闂侀€涚┒閸斿矁鐏冮梺閫炲苯澧摶鐐寸箾閸℃ê濮︽繛鍫幖閳规垿鎮╅懠顒侇棄闂佸搫顦花閬嶅磻閹炬緞鏃€鎷呴悷鏉夸紟闂備礁鎼ˇ浼村吹濮橆優娲敂閸涱喗鐝曢梻浣告啞閹稿棝宕ㄩ姘畾濠电姷鏁告慨浼村垂閻撳簶鏋栨繛鎴欏焺閺佸嫰鏌涢埄鍐槈缁炬儳娼￠弻锝夊棘閸喗鍊梺缁樻尭缁绘﹢鎮￠锕€鐐婄憸婵嬪绩婵犳碍鐓曢柕鍫濇缁€瀣煛鐏炵偓绀冪€垫澘瀚板畷鍗炍熼懡銈呯稻闂?(闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑鏅悷婊冪Ч濠€渚€姊虹紒妯虹伇婵☆偄瀚划濠氭偐缂佹鍘甸梺鍛婃寙閸涱厾顐奸梻浣规偠閸婃牠宕濋弽顓炍﹂柛鏇ㄥ灠閸愨偓濡炪倖鍔﹀鈧紒顔肩埣濮婂搫煤鐠囨彃绠哄銈冨妼閿曨亪骞冮敓鐙€鏁冮柨鏇楀亾闁绘劕锕弻鏇熺節韫囨搩娲梺鎸庣⊕濞茬喎顫忛搹鍦煓婵炲棙鍎抽崜閬嶆⒑閸︻収鐒炬い顓犲厴閻涱喛绠涘☉妯虹獩闂佸搫顦伴崹褰捤囬妸鈺傗拺缂備焦锚婵箓鏌涢幘瀵搞€掔紒顔芥閹粓鎳為妷銏″濠电偠鎻紞鈧繛鍜冪悼閺侇喖鈽夐姀锛勫幗濠德板€曢敃銈夌嵁濡偐纾奸弶鍫氭櫅娴狅箓鏌熷畡鐗堝殗鐎规洦鍋婃俊鐑芥晜缁涘鏅梻鍌氬€风欢姘焽瑜忛幑銏ゅ醇閵夈儳锛欓梺鍝勭▉閸樿偐澹曟繝姘厱闁哄洢鍔岄悘锟犳煟閹惧瓨绀冪紒缁樼箞濡啫鈽夊▎妯活棧婵＄偑鍊曠换鎴﹀箰閹惰棄钃熼柨鐔哄Т楠炪垽鏌嶆潪鎵槮缂侇偄绉撮埞鎴︻敊绾嘲浼愬銈庡幖閸㈡煡鎮鹃悜钘夌闁规惌鍘介崓闈涱渻閵堝棗绗掓い锔诲櫍楠炲啴鏁愭径瀣ф嫼闁荤姴娲﹁ぐ鍐敆閵忋倖鐓熸い鎾楀啯鐝濋悗瑙勬穿缁绘繈鐛惔銊﹀癄濠㈣泛鐬奸弳顐ｇ節閻㈤潧浠滄俊顖氾攻缁傚秴鈹戠€ｎ亞锛涢梺鍛婃处閸ㄩ亶鎮￠悢鍏肩厵闁硅鍔栭悵顏堟煙閻у摜绉柡宀嬬秮楠炴﹢寮堕幋鐘辨缂傚倷鑳剁划顖滅矙閹惧鐝堕柡鍥╁Л閸嬫捇鏁愭惔婵堣兒濠殿喛顫夐〃濠囧蓟閿濆鍊烽悗鐢电《濡劑姊虹粙鍧楀弰婵炰匠鍥ㄥ仼闁绘垼妫勭粻锝夋煥閺囨浜剧紓浣哄Т椤兘骞冭ぐ鎺戠倞闁靛鍎崇粊鐑芥倵濞堝灝鏋ら柛蹇斆灋闁告稒鎯岄弫鍐煏韫囧ň鍋撻幇浣剐熷┑鐘垫暩閸嬫稑顕ｉ崼鏇熷亱婵犲﹤鎳庨崹?
            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亜顒㈡い鎰矙閺屻劑鎮㈤崫鍕戙垻鐥幆褜鐓奸柡灞剧☉閳藉宕￠悙鑼洿闂備焦瀵х换鍌炈囬婊呬笉闁规儼濮ら悡娑㈡煕閹板墎鍒板ù婊勫劤椤? 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴濐潟閳ь剙鍊块幐濠冪珶閳哄绉€规洏鍔戝鍫曞箣閻欏懐骞㈤梻鍌欑窔閳ь剛鍋涢懟顖涙櫠閹绢喗鐓涢悘鐐插⒔閵嗘帡鏌嶈閸撱劎绱為崱娑樼；闁告侗鍘鹃弳锔锯偓鍏夊亾闁告洦鍓涢崢鎼佹倵閸忓浜鹃柣搴秵閸撴盯鏁嶉悢鍝ョ閻庣數顭堥鎾斥攽閳ヨ櫕鍠樻鐐茬箻閹晝鎷犻懠顒夊斀闂備礁婀遍崕銈夊吹閳哄懎绠ｉ柨鏃囆掗幏鍝勨攽椤旂偓鍤€婵炲眰鍊濋幃鐐裁洪鍛幈闂侀潧艌閺呮粌鈽夎閺屽秶鎷犻懠顑囨煛娴ｇ懓濮堢€垫澘瀚换婵嬪礋椤愨懣鏇炩攽閿涘嫬浜奸柛濠冪墱閺侇噣骞掑Δ鈧粣妤佹叏濮楀棗澧婚柣鎺嶇矙閺岀喖骞嶉纰辨毉闂佺粯鎸诲ú鐔肩嵁閺嶎偆纾奸柣妤€鐗婄欢鎻捗归悪鈧崳锝夊箖濡ゅ啯鍠嗛柛鏇ㄥ墰椤︺劌鈹戦悙鎻掔骇闁绘鍋ら幃姗€宕橀瑙ｆ嫼闂佸憡绋戦敃锝囨闁秵鐓曟慨妞诲亾缂佺姵鐗炲Λ鐔兼⒒娓氬洤澧紒澶屾暬閸╂盯骞嬮敂鐣屽幈濠电偞鍨堕敃顐㈩潖濡ゅ啰纾奸柛顐ｆ磻閹查箖鏌＄仦鍓ф创妤犵偞顭囬埀顒勬涧閹芥粓鎮块崟顖涘€甸悷娆忓绾炬悂鏌涢妸銈囩煓闁靛棔绀佽灃闁告侗鍘鹃ˇ鏉款渻閵堝棗绗掗柛濠冩倐閻涱喖螖閸涱喒鎷绘繛鎾村焹閸嬫挻绻涙担鍐叉礌閳ь剨绠撳畷濂稿Ψ閵壯嶇吹闂傚倷绶￠崜娆戠矙娓氣偓瀵偊宕掑☉鏍︾盎闂佽宕樺▔娑㈠几閺冨倻纾奸柣妯垮吹閻ｆ椽鏌＄仦鍓ь灱缂佺姵鐩鎾倷闊厾甯涢梻鍌欑閹诧紕鎹㈤崘顭戞富濞寸姴顑呴拑鐔兼煥濞戞ê顏ф繛宀婁邯閺岋綁鏁愰崨顖滀紘闂佸憡妫忛崹鎷岀亙闂佺粯锕㈠褎绂掑鍕╀簻闁瑰瓨绻嶅Ο鈧Δ鐘靛仜閸熸挳宕洪敓鐘插窛妞ゆ洖鎳忛ˉ鍫熺節閻㈤潧浠﹂柛銊ョ埣閳ワ箓宕堕埡鍐槱婵犵數濮电喊宥夊煕閹烘鐓曢悘鐐插⒔閹冲嫮绱掓担鍝勵暭濞ｅ洤锕ら—鍐偂鎼粹槅鐎虫俊鐐€ゆ禍婊堝疮閹绢喚宓侀柟鐑樺殾閺冨牆鐒垫い鎺戝€归崗婊堟煃瑜滈崜鐔奉潖閾忚鍠嗛柛鏇ㄥ亜婵鈹戦埥鍡椾簻閻庢碍婢橀～?-> 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柤纰卞墻濡茬兘姊绘担鍛婃儓婵炲眰鍨藉畷纭呫亹閹烘挸浠惧銈嗘磵閸嬫捇鏌＄仦鍓ь灱妞わ箒娅曢妵鍕Ω閵夛富妫﹂悗瑙勬礃閸ㄥ潡宕洪埄鍐╁闁告洦鍓氶ˉ鍫ユ煛娴ｇ懓濮嶇€规洏鍔戦、姗€鎮㈤崜鎻掓暭闂傚倸鍊烽悞锔界箾婵犲洤缁╅柛妤冨€ｅ☉銏犵妞ゆ棁澹堥幗鏇炩攽閻愭潙鐏熼柛銊ョ秺瀹曪繝骞庨懞銉у帾婵犵數鍋涢悘婵嬪礉閵堝悿褰掓偑閳ь剟宕圭捄渚綎闁惧繗顫夐崗婊堟煕濞戝崬甯ㄩ柟鎯ь嚟缁犻箖鏌涘▎蹇ョ磾闁瑰濮烽惌姘跺级閸稑濡跨紒鈾€鍋撻梻浣侯焾椤戝牊鎱ㄩ妶鍜佹綎濠电姵鑹鹃悞鍨亜閹烘埊鍔熺紒澶屾暬閺屾盯骞樼€靛憡鍣板銈冨灪绾板秴顭囪箛娑樼厸闁告劦浜风槐?
            // 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴濐潟閳ь剙鍊圭粋鎺斺偓锝庝簽椤︻厼鈹戦悩缁樻锭妞ゆ垵鍟撮崺鈧い鎺嗗亾闁哥喐鎸抽悰顕€宕堕澶嬫櫓闂佸吋绁撮弲婵嬫偤濮椻偓濮婄粯鎷呯粙鎸庡€紓浣风劍閹稿啿顕ｉ幓鎺嗘斀闁割偁鍨婚悞?1: 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌熼梻瀵割槮缁炬儳顭烽弻锝夊箛椤掍焦鍎撻梺鎼炲妼閸婂潡寮婚敐澶婎潊闁绘ê鍟块弳鍫ユ⒑缁嬫鍎忔い鎴濐樀瀵鏁愭径濠勭杸濡炪倖甯婇悞锕傚磿閹惧墎纾?1 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎电濡介梺绋款儏椤戝懘鍩為幋锔藉亹闁圭粯甯╂禒楣冩⒑閸濆嫭顥炵紒顔芥崌瀵濡搁埡鍌氫簻闂佸憡绻傜€氬懘濮€閵堝棌鎷婚梺绋胯閸婃洟鎮橀悩缁樻嚉闁哄稁鍘介悡銉︾節闂堟稒顥為柛锝呯秺閺岋繝宕卞▎蹇庢闂?+ 1 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐偓锝庝簼閹癸綁鏌ｉ鐐搭棞闂囧鏌ㄥ┑鍡樻悙闁告柨顑囬埀顒冾潐濞叉牕顕ｉ崼鏇炵疄闁靛鍎哄〒濠氭偣閸ヮ亜绱﹀瑙勬礋濮婄粯鎷呯粵瀣異闂佸摜濮甸〃鍛粹€﹂崹顕呮建闁逞屽墴瀹曟椽濮€閳╁啫鍔呴梺闈涱焾閸庢娊顢樺ú顏呪拺缂備焦锕╅悞浠嬫煕鎼达絾鏆€殿喓鍔戝畷顐﹀礋閵婏附鏉搁梻浣虹帛閿曗晠宕伴弽顓熷€堕弶鍫涘妿缁犳儳顭跨捄渚剳婵炲弶鎸抽弻鐔碱敍濮樿京鍔悗瑙勬礃鐢繝骞冨▎鎾崇骇闁瑰瓨绮庨柦?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳婀辩槐鎺斺偓锝庡亾缁扁晜绻涘顔荤凹闁稿鍔欓幃褰掑炊椤忓嫮姣㈤梺鎸庣⊕閻╊垰顫忓ú顏呭仭闁哄绨遍幐鍐磽娓氬洤娅橀柛銊ョ埣楠?10 闂? -> 闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃繘鍩€椤掍胶鈻撻柡鍛█閵嗕礁鈻庨幘鍐插敤濡炪倖鎸鹃崑鐔兼偘閵夆晜鈷戦柛婵嗗閳诲鏌涘Ο鍨汗缂侇喛宕甸幉鎾礋閳衡偓缁ㄥ姊虹憴鍕棎闁哄懏鐩崺鈧い鎺嶇婵秶鈧?10
            // 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴濐潟閳ь剙鍊圭粋鎺斺偓锝庝簽椤︻厼鈹戦悩缁樻锭妞ゆ垵鍟撮崺鈧い鎺嗗亾闁哥喐鎸抽悰顕€宕堕澶嬫櫓闂佸吋绁撮弲婵嬫偤濮椻偓濮婄粯鎷呯粙鎸庡€紓浣风劍閹稿啿顕ｉ幓鎺嗘斀闁割偁鍨婚悞?2: 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌熼梻瀵割槮缁炬儳顭烽弻锝夊箛椤掍焦鍎撻梺鎼炲妼閸婂潡寮婚敐澶婎潊闁绘ê鍟块弳鍫ユ⒑缁嬫鍎忔い鎴濐樀瀵鏁愭径濠勭杸濡炪倖甯婇悞锕傚磿閹惧墎纾?2 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎电濡介梺绋款儏椤戝懘鍩為幋锔藉亹闁圭粯甯╂禒楣冩⒑閸濆嫭顥炵紒顔芥崌瀵濡搁埡鍌氫簻闂佸憡绻傜€氬懘濮€閵堝棌鎷婚梺绋胯閸婃洟鎮橀悩缁樻嚉闁哄稁鍘介悡銉︾節闂堟稒顥為柛锝呯秺閺岋繝宕卞▎蹇庢闂?+ 2 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐偓锝庝簼閹癸綁鏌ｉ鐐搭棞闂囧鏌ㄥ┑鍡樻悙闁告柨顑囬埀顒冾潐濞叉牕顕ｉ崼鏇炵疄闁靛鍎哄〒濠氭偣閸ヮ亜绱﹀瑙勬礋濮婄粯鎷呯粵瀣異闂佸摜濮甸〃鍛粹€﹂崹顕呮建闁逞屽墴瀹曟椽濮€閳╁啫鍔呴梺闈涱焾閸庢娊顢樺ú顏呪拺缂備焦锕╅悞浠嬫煕鎼达絾鏆€殿喓鍔戝畷顐﹀礋閵婏附鏉搁梻浣虹帛閿曗晠宕伴弽顓熷€堕弶鍫涘妿缁犳儳顭跨捄渚剳婵炲弶鎸抽弻鐔碱敍濮樿京鍔悗瑙勬礃鐢繝骞冨▎鎾崇骇闁瑰瓨绮庨柦?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳婀辩槐鎺斺偓锝庡亾缁扁晜绻涘顔荤凹闁稿鍔欓幃褰掑炊椤忓嫮姣㈤梺鎸庣⊕閻╊垰顫忓ú顏呭仭闁哄绨遍幐鍐磽娓氬洤娅橀柛銊ョ埣楠?20 闂? -> 闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃繘鍩€椤掍胶鈻撻柡鍛█閵嗕礁鈻庨幘鍐插敤濡炪倖鎸鹃崑鐔兼偘閵夆晜鈷戦柛婵嗗閳诲鏌涘Ο鍨汗缂侇喛宕甸幉鎾礋閳衡偓缁ㄥ姊虹憴鍕棎闁哄懏鐩崺鈧い鎺嶇婵秶鈧?20
            // 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴濐潟閳ь剙鍊圭粋鎺斺偓锝庝簽椤︻厼鈹戦悩缁樻锭妞ゆ垵鍟撮崺鈧い鎺嗗亾闁哥喐鎸抽悰顕€宕堕澶嬫櫓闂佸吋绁撮弲婵嬫偤濮椻偓濮婄粯鎷呯粙鎸庡€紓浣风劍閹稿啿顕ｉ幓鎺嗘斀闁割偁鍨婚悞?3: 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌熼梻瀵割槮缁炬儳顭烽弻锝夊箛椤掍焦鍎撻梺鎼炲妼閸婂潡寮婚敐澶婎潊闁绘ê鍟块弳鍫ユ⒑缁嬫鍎忔い鎴濐樀瀵鏁愭径濠勭杸濡炪倖甯婇悞锕傚磿閹惧墎纾?3 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎电濡介梺绋款儏椤戝懘鍩為幋锔藉亹闁圭粯甯╂禒楣冩⒑閸濆嫭顥炵紒顔芥崌瀵濡搁埡鍌氫簻闂佸憡绻傜€氬懘濮€閵堝棌鎷婚梺绋胯閸婃洟鎮橀悩缁樻嚉闁哄稁鍘介悡銉︾節闂堟稒顥為柛锝呯秺閺岋繝宕卞▎蹇庢闂?+ 3 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐偓锝庝簼閹癸綁鏌ｉ鐐搭棞闂囧鏌ㄥ┑鍡樻悙闁告柨顑囬埀顒冾潐濞叉牕顕ｉ崼鏇炵疄闁靛鍎哄〒濠氭偣閸ヮ亜绱﹀瑙勬礋濮婄粯鎷呯粵瀣異闂佸摜濮甸〃鍛粹€﹂崹顕呮建闁逞屽墴瀹曟椽濮€閳╁啫鍔呴梺闈涱焾閸庢娊顢樺ú顏呪拺缂備焦锕╅悞浠嬫煕鎼达絾鏆€殿喓鍔戝畷顐﹀礋閵婏附鏉搁梻浣虹帛閿曗晠宕伴弽顓熷€堕弶鍫涘妿缁犳儳顭跨捄渚剳婵炲弶鎸抽弻鐔碱敍濮樿京鍔悗瑙勬礃鐢繝骞冨▎鎾崇骇闁瑰瓨绮庨柦?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳婀辩槐鎺斺偓锝庡亾缁扁晜绻涘顔荤凹闁稿鍔欓幃褰掑炊椤忓嫮姣㈤梺鎸庣⊕閻╊垰顫忓ú顏呭仭闁哄绨遍幐鍐磽娓氬洤娅橀柛銊ョ埣楠?30 闂? -> 闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃繘鍩€椤掍胶鈻撻柡鍛█閵嗕礁鈻庨幘鍐插敤濡炪倖鎸鹃崑鐔兼偘閵夆晜鈷戦柛婵嗗閳诲鏌涘Ο鍨汗缂侇喛宕甸幉鎾礋閳衡偓缁ㄥ姊虹憴鍕棎闁哄懏鐩崺鈧い鎺嶇婵秶鈧?30

            int lapisHeld = item.getCount();
            int tier = 0;
            int costLevels = 0;
            int requiredLevels = 0;
            int enchantPower = 0;

            // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佲枙闁绘帟濮ょ换娑㈠幢濡纰嶉柣鐔哥懕缁犳捇骞冨Δ鍛櫜閹肩补鍓濋悘宥夋⒑閸濆嫭濯煎ù婊庝簻椤繒绱掑Ο璇差€撻梺鍛婄☉閿曘倝寮抽崼銉︾參闁告劦鍠曢幉楣冩煛瀹€瀣М闁糕斁鍓濈换婵嬪磼濠娾偓閸濇姊绘担椋庝覆缂佹彃娼″畷妤€顫滈埀顒勭嵁閸愵喖鐓涢柛娑卞幘閻ｆ娊姊洪悷鐗堟儓缂佸鏁婚幆鍫ｇ疀濞戞瑢鎷绘繛杈剧到閹诧紕鎷归敓鐘崇厱閹煎瓨绋戦埀顒佺箓閻ｇ柉銇愰幒鎾充缓闂佸壊鐓堥崑鍕儍椤愶附鐓熼幖鎼灣缁夌敻鏌涢悩鎰佹疁闁糕晜鐩獮瀣晜閻ｅ苯骞堟繝鐢靛█濞佳兾涘Δ鍜佹晜妞ゆ劑鍩勯悢鍡欐喐鎼淬劌绀夋繛鍡樻尭閽冪喐绻涢幋鐐茬劰闁稿鎹囬弫鎰償閳ヨ尙鍑归梺璇茬箰濞存岸宕ｉ崘顔肩闁割偅娲栭崘鈧銈嗘尵閸犳捇宕㈤柆宥嗙厽闊洦娲栨禒褔鏌涚€ｎ偅宕岀€规洘娲栫叅妞ゅ繐鎳愰崢鐢告煛婢跺﹦澧曞褌绮欓幃鐐綇閵婏缚姘﹀┑鐘绘涧椤戝棝鍩涢幋鐘电＜閻庯綆鍘界涵鍫曟煟韫囨稐鎲鹃柡灞剧〒閳ь剨缍嗛崜娆愮鏉堚斁鍋?
            if (lapisHeld >= 3) {
                tier = 3;
                costLevels = 3;
                requiredLevels = 30;
                enchantPower = 30;
            } else if (lapisHeld == 2) {
                tier = 2;
                costLevels = 2;
                requiredLevels = 20;
                enchantPower = 20;
            } else {
                tier = 1;
                costLevels = 1;
                requiredLevels = 10;
                enchantPower = 10;
            }

            // 3. 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犖ч柛銉㈡櫇閸橆垶姊绘担鍛婂暈婵炶绠撳畷銏ゆ寠婢跺本娈鹃梺鍛婄懃椤﹁京寮ч埀顒勬⒒閸屾氨澧涘〒姘殜瀹曟洟骞囬悧鍫㈠幈闁诲函缍嗛崐鏍箣閻樺啿搴婂┑鐐村灟閸ㄥ綊鐛姀鈥茬箚妞ゆ牗绻嶉崵娆撴⒒婢跺﹦效婵﹨娅ｇ划娆忊枎閹冨缂傚倷娴囬褔鎮ч幘鎰佸殨閻犲洤妯婇崥瀣煕閳╁厾顏堬綖閿熺姵鈷戦悷娆忓閸熷繘鏌涢悩宕囥€掔紒顕嗙到铻栭柛娑卞枓閹锋椽姊洪崨濠勭細闁稿酣浜跺鎶芥焼瀹ュ棛鍘遍柣搴秵閸嬪懐浜搁悽鐢电＜閺夊牄鍔嶅畷宀€鈧娲樼敮鎺楋綖濠靛鏁勯柦妯侯槷婢规洘淇婇悙宸剰婵炲鍏橀幆宀勫幢濡炴洖缍婇弫鎰板炊瑜嶆俊娲倵鐟欏嫭绀€鐎殿喖鐖奸獮鍫ュΩ閵夘喗瀵岄柣鐘叉穿瀵挻绔熼弴銏♀拻?(闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎺嶇劍椤斿洦绻濆閿嬫緲閳ь剚娲熼獮濠呯疀濞戞锛熼柟鍏兼儗濞兼寧绂嶅鍫熺厸鐎广儱楠告禍婊兠归悩宕囩煉闁哄矉缍侀獮鎺楀箣閻樿京椹抽梻渚€娼уú銈団偓姘嵆閻涱噣骞掑Δ鈧粻锝嗙節闂堟稑鏆欏ù婊堢畺閺屾稑鈽夊鍫濆婵犫拃宥囩瘈婵﹦绮幏鍛村传閸曨偂绮梻浣筋嚙缁绘劙鎮ч幘鎰佸殨闁圭粯宸婚弨浠嬫倵閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤冪憪缂備浇顔愮换婵嗙暦椤栨繄鐤€婵炴垶鐟ч崢閬嶆⒑缂佹◤顏嗗椤撶喐娅犻梺顒€绉甸悡娆愵殽閻愯尙浠㈤柣蹇婃櫊閹藉爼寮介鐔哄幈濠电偞鍨靛畷顒勫几濞戙垺鐓冪憸婊堝礈濞嗘挴鈧箓鎮滈挊澶庢憰闂侀潧艌閺呮盯宕￠幎鑺ョ厽闁归偊鍘鹃妶鎾煕鐎ｎ偅宕勯柕鍥ㄥ姍楠炴帡骞嬮悩宕囧弰?
            if (!player.getAbilities().instabuild) {
                if (player.experienceLevel < requiredLevels) {
                    player.displayClientMessage(Component.literal("闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗ù锝堟缁€濠傗攽閻樿弓杩规繛鎴炵瀹曞鏌曟繛褍鍟憴锔戒繆閻愵亜鈧垿宕愯閹广垹鈹戦崱鈺傜稁缂傚倷鐒﹁摫濠殿垱鎸抽弻娑樷槈濮楀牊鏁鹃梺绋垮閹告悂鈥旈崘顔嘉ч煫鍥ㄦ尵濡诧綁姊虹粙娆惧剰闁挎洦浜滈悾宄懊洪鍕姦濡炪倖甯婇梽宥嗙濠婂牊鐓欓柛婵嗗椤ユ粌霉濠婂牏鐣洪柟顔筋殔閳绘捇宕归鐣屼邯闂備胶绮悧鏇㈠Χ閹间礁违濞撴埃鍋撶€殿喗鎸虫慨鈧柍銉ョ－濡绢喖鈹戦悩顔肩伇婵炲绋戣灋婵炲棙鎼紞鏍偓骞垮劚椤︿即鍩涢幋锔藉仭婵炲棗绻愰鈺呮煕閺傝鈧鎯€椤忓棛纾奸柕蹇曞Т缁犲綊姊洪崫鍕棏闁哄懐濮撮～蹇曠磼濡顎撻梺鍛婄☉閿曘倝寮抽崼銉︹拺闁告稑锕ラ埛鎰亜閵娿儻韬?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳婀辩槐鎺斺偓锝庡亾缁扁晜绻涘顔荤凹闁稿鍔欓幃褰掑炊椤忓嫮姣㈤梺鎸庣⊕閻╊垰顫忓ú顏呭仭闁哄绨遍幐鍐磽娓氬洤娅橀柛銊ョ埣楠?" + requiredLevels + " 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛銈呭閺屾盯骞橀懠棰濆敼闂佺顑嗛幐鎼侊綖濠靛鏁嗛柛灞剧矤閸熷鏌ｆ惔銈庢綈婵炴彃绻樺畷婵嬪箣閿旇　鍋撴担绯曟婵妫涢崣鍡涙⒑閸涘﹥纾搁柛鏂跨Ф閳ь剙鐏氶〃濠傤潖?(闂傚倸鍊搁崐宄懊归崶褏鏆﹂柣銏㈩焾缁愭鏌熼柇锕€鏋涢柛銊︾箞楠炴牕菐椤掆偓閻忣亝绻涢崨顖毿ｅǎ鍥э躬婵″爼宕ㄩ鍏碱仩缂傚倷鑳舵慨鎶藉础閹惰棄钃熸繛鎴炃氬Σ鍫熸叏濡も偓閻楀﹪寮幆褉鏀? " + player.experienceLevel + ")"), true);
                    return InteractionResult.FAIL;
                }
            }

            // 4. 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗霉閿濆浜ら柤鏉挎健濮婃椽顢楅埀顒傜矓閻㈢纾婚柨鐔哄У閻撴瑩鏌熼婊冾暭妞ゃ儱顦伴〃銉╂倷椤忓嫮浼堥梺鍝勮嫰缁夌懓鐣烽锕€绀嬫い鎰枎娴滃墽鎲搁悧鍫濈瑨缂佺嫏鍥ㄧ厵闂傚倸顕崝宥夋煃闁垮绗掗棁澶愭煥濠靛棙鍣洪柛鐔哄仱閹綊骞囬妸銉モ拤闂侀潧娲ょ€氫即寮幇顓熷劅闁斥晛鍟版禍鍓х磽閸屾瑦绁板ù婊庡墴瀹曟垿鎮欓崫鍕唵闂佸憡渚楅崹鎵偓鍨叀閺岋繝宕堕埡浣圭亖闂?
            if (!player.getAbilities().instabuild) {
                item.shrink(costLevels);
                player.giveExperienceLevels(-costLevels); // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗霉閿濆浜ら柤鏉挎健濮婃椽顢楅埀顒傜矓閺屻儱鐒垫い鎺嗗亾闁稿﹤娼￠妴浣糕枎閹惧磭顦悷婊冪箻钘濇い鏍ㄧ〒缁犻箖寮堕崼婵嗏挃闁诡喛鍋愰惀顏堫敇閻愰潧鐓熼悗娈垮枤椤牓顢橀崗鐓庣窞濠电姴瀚烽崯鍥⒑閸濆嫷妲搁柣妤€妫欓弲鑸电鐎ｎ亞鐣洪梺缁樻尭鐎垫帒銆掓繝姘厽闁绘柨鎲＄欢鏌ユ煛閸℃岸鍝洪柕鍥у椤㈡﹢鍩勯崘顏傗偓濠囨⒑閸︻厽鍤€閻庢矮鍗抽獮鏍亹閹烘垶宓嶅銈嗘尵閸嬫稖鈪搁梻?
            }

            // 5. 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗霉閿濆浜ら柤鏉挎健濮婃椽顢楅埀顒傜矓閻㈢纾婚柨鐔哄У閻撴瑩鏌熼婊冾暭妞ゃ儱顦伴〃銉╂倷椤忓嫮浼堥梺鍝勮嫰缁夌懓鐣烽锕€绀嬫い鎰枎娴滃墽鎲搁悧鍫濈瑨缂佺嫏鍥ㄧ厵闂傚倸顕崝宥夋煃闁垮娴柡灞剧〒娴狅箓骞戦幇顒夋闂備線鈧偛鑻晶顕€鏌熼懞銉х煉闁糕斁鍋撳銈嗗笂缁€渚€宕甸鍕厱闁规儳顕ú鎾煕閳规儳浜炬俊鐐€栫敮濠囨嚄閸洘鍋傛い鏍仦閻撴洘淇婇妶鍕槮闁崇粯娲橀〃?(婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｅΟ娆惧殭缂佺姴鐏氶妵鍕疀閹炬惌妫ょ紓浣插亾濠电姴娲﹂悡鍐喐濠婂牆绀堟慨妯块哺瀹曞弶绻涢幋鐐垫噧缂佸墎鍋ら幃妤呮晲鎼粹€茬敖濡炪倧缂氶崡鎶藉箖濡も偓閳绘捇宕归鐣屽蒋闂備胶顭堥鍛存晝閵夛妇鈹嶅┑鐘叉处閸ゅ姊婚崼鐔恒€掔紒鎰仦缁绘繈鎮介棃娴躲垽鏌涙繝鍌涘暈缂佸倸绉瑰畷濂稿即閻斿弶瀚藉┑鐐舵彧缂嶁偓婵炲拑绲块弫顔尖槈閵忥紕鍘搁柣蹇曞仩椤曆勬叏閸屾侗娈介柣鎰嚟婢у灚銇勯姀鈩冪闁轰礁鍊婚幃浼村灳閸忓懎顥?Helper)
            // 闂?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧潡鏌熺€电孝缂佽翰鍊濋弻锕€螣娓氼垱锛嗛悷婊呭鐢帞澹曟總鍛婄厽闁归偊鍨伴惃娲煟濞戞牕鍔氶柍瑙勫灦楠炲﹪鏌涙繝鍐╃妤犵偛绻掗埀顒婄秵閸犳牠寮告笟鈧弻娑㈠焺閸愬墽鍔风紓浣叉閸嬫挸鈹戦悩鍨毄濠殿喗鎸冲畷鎰磼濡粯鐝峰┑鐐村灟閸ㄦ椽鎮″☉銏＄厱婵犲ň鍋撶紒鈧担瑙勬珷妞ゆ牜鍋為悡娆忋€掑顒備虎濠碘€冲悑閵囧嫰顢曢敐鍥╃厜閻庤娲栧畷顒勨€旈崘顔肩鐟滃繐鈻旈崸妤佲拻闁稿本鐟чˇ锕傛煟閵堝懏鍠樻い銏′亢椤︽挳鏌熼獮鍨仼妞ゎ偅绮撻崺鈧い鎺嗗亾妞ゆ洩绲剧换婵嗩潩椤撶喐鐝冲┑鐘灱閸╂牜绮欓幘鍓佺煓闊洦鎼╁〒濠氭煏閸繃顥滈柛褍锕弻娑氣偓锝庡亝鐏忣參鏌嶇憴鍕伌闁搞劑绠栭幖褰掝敃椤厽妯婇梻鍌欐祰椤曟牠宕伴弴鐘插灊婵炲棙鎸堕埀顑跨閳藉螣闁垮鏉搁梻浣规偠閸庢彃锕㈣ぐ鎺戜紶婵°倕鎳忛埛鎺戙€掑锝呬壕闂侀€炲苯澧伴柛瀣洴閹崇喖顢涘☉娆愮彿婵炲鍘ч悺銊╂偂濞嗘挻鐓ｉ煫鍥风到娴滄繈鎮樿箛搴″祮闁哄矉绻濆畷銊╁级鐠恒劌甯块梻浣筋嚃閸ㄥ崬螞閸愵喖鏄ラ柨鏇炲€搁悞鍨亜閹烘垵顏╅柛鎴犲█閺岋繝宕橀妸褍顤€闂佺粯鎸婚悷鈺侇嚕閸洖閱囬柕澹懏姣囨繝纰夌磿閾忓酣宕抽敐澶婅摕鐎广儱顦伴悡銉╂倵閿濆骸浜芥俊顐㈠暣濮婃椽宕崟顒佹嫳闂佺儵鏅╅崹浼搭敋閿濆绠绘い鏂挎閳哄懏鐓忓璇″灠閸婂摜鈧灚鐓″濠氬磼濞嗘帒鍘″銈冨灩閿曘儵骞堥妸鈺佄ч柛姘ュ€曢幖顐︹€﹂妸鈺佸窛妞ゆ洖鎳忕紞妤呮⒒娴ｅ憡璐￠柛搴涘€濋獮鎰板传閵夛富鍋ㄩ梺缁樺姈缁佹挳寮ㄦ禒瀣厽婵☆垵顕х徊濠氭煟濠靛洦顥堥柡灞炬礉缁犳稓鈧綆浜栭崑鎾诲冀椤撶喎浜楅梺缁樻煥閸氬鎮￠崘顔界厓閺夌偞澹嗛ˇ锕傛煛閸℃瑥鏋涢柡宀€鍠栧畷姗€宕ｆ径濠冪亷闂備礁鎼径鍥礈濠靛绠柛娑欐綑娴肩娀鏌曟径瀣闁搞劋绮欏濠氭晲婢跺娅滈梺绯曞墲閻熝囨偪閸曨垱鈷戠紒顖涙礃閺夊綊鏌涚€ｎ偅灏い顏勫暣婵″爼宕卞Δ鍐噯闂佽瀛╅崙褰掑礈閻旂厧绠栨慨妞诲亾闁圭厧缍婇、鏇㈡晬閸曨厾鏆板┑锛勫亼閸婃牠鎮уΔ鍐╁床闁稿瞼鍋涚憴锔炬喐閻楀牆绗氶柣鎾冲暣閺岋綁鎮㈢粙娆炬闁哄稄绱曠槐鎾存媴閾忕懓绗＄紓浣筋嚙閻楀棜鐏嬮梺鍛婂姂閸斿危閸喓绠鹃柛鈩冾殘缁犲弶銇勮箛瀣偓婵嗩潖缂佹ɑ濯撮柦妯侯槸閹偤姊洪崫銉バ㈡俊顐ｇ箓閻ｉ鎲撮崟顓ф祫闁诲函缍嗘禍锝夊箺閺囩偐鏀介柣鎰綑閻忥附銇勯鐐测偓鍧楀箖閵忋倕绀傞柣鎾崇凹缁ㄧ敻姊洪悷鏉挎倯闁伙綆浜畷鍦磼濡⒈娲搁梺鍝勮癁閳ь剟寮ㄦ禒瀣厽婵妫楁禍婵嗏攽椤栨瑥宓嗛柡灞剧洴瀵挳鎮欓崗鍝ラ┏闂備焦鐪归崐鎾舵濮樿泛绠栨俊銈傚亾闁崇粯鎹囧畷褰掝敊閻ｅ奔澹曢梻鍌欐祰濡椼劌霉閸ヮ剦鏁嬬憸鏃堝箖妤ｅ啯鍊荤紒娑橆儐閺呮繈姊洪幐搴㈢５闁稿鎸剧槐鎺楀焵椤掑倵鍋撻敐搴′簴濞存粍绮撻弻鐔煎箥閾忣偅鐝旈梺閫炲苯澧繛鑼枛閹即顢氶埀顒勫春閳ь剚銇勯幒宥堝厡缂佲檧鍋撻梻浣圭湽閸ㄨ棄顭囪缁傛帡鏁冮崒娑氬幈闂侀潧顭堥崕鎶藉春閿濆棭娈介柣鎰綑婵秵顨ラ悙杈捐€挎い銏＄懇閹虫牠鍩＄€ｎ剙鑰块梻鍌氬€烽懗鍫曞箠閹惧瓨娅犻柣锝呰嫰閸ㄦ繃銇勯弽顐沪闁?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弴鐐测偓鍝ュ鐠恒劉鍋撶憴鍕婵炶绠戦悾鐑藉蓟閵夛妇鍘甸梺缁樺灦閿曗晛鈻撻弮鍫熺厽闁靛牆娲ゆ禍楣冩煏閸パ冾伃妤犵偛娲畷婊勬媴閻戞ɑ顔忕紓鍌氬€风拋鏌ュ磻閹炬剚鐔嗛悹铏瑰劋濠€浼存煕閻樺啿濮夐柍褜鍓欑粻宥夊磿闁单鍥敍閻愭潙浜楀┑鐘绘涧閺嬬銇愰幒鎾充汗閻庣懓澹婇崰鏍礈娴煎瓨鈷戠紓浣姑粭姘繆閻愭壆鐭欑€殿喛顕ч埥澶愬閻樼數鏉搁梻渚€娼ч…顓㈡⒔閸曨垱鍋熼柡宥庡幗閳锋垵霉閸忚偐鎳呯紒澶樺墯缁绘盯宕ㄩ鐣岊槰缂備礁鐭佹ご鍝ユ崲濠靛鐐婇柤绋跨仛濞呭洭姊绘担鐟邦嚋缂佽鍊歌灋婵炴垯鍨圭粈鍕煥閻斿搫校闁绘挾鍠栭獮鏍庨鈧悘鈺呮煕閵堝骸澧撮柡灞剧洴婵℃悂濡疯閻撶喖姊烘潪鎵妽闁告梹鐟╅獮鍐ㄢ枎韫囷絽鏅犲銈嗘煥閸氬宕愰姘ｆ斀闁绘﹩鍠栭悘杈ㄧ箾婢跺娲存い銏＄墵瀹曞崬顪冪紒妯尖偓娲⒑閸濆嫮鈻夐柛妯圭矙閹繝鎮㈤懖鈺佸絼闂佹悶鍎崝宥囩矆閳ь剚绻涚€电袥闁哄懐濞€瀵鈽夊锝呬壕闁挎繂楠告禍婊冣攽椤旂⒈妲虹紒杈ㄥ浮椤㈡瑩鎮剧仦鎯ф珮闂備礁缍婇ˉ鎾寸箾閳ь剟鏌熼姘卞ⅵ妞ゃ垺顨婇崺鈧い鎺戝閻撯偓闂佹寧绻傞幊鎰板汲閿曞倹鐓曟い鎰剁稻缁€鈧柟顖滃枛閹嘲顭ㄩ崘顏嗩啋闂佽鍠楅崕宕囧弲濡炪倕绻愰幊鎰板储娴犲鐓欓柤鍦瑜把呯磼鏉堛劍绀冪紒鍌涘笒閳藉鈻庨幇顒€浼庡┑鐘垫暩婵挳宕愰懡銈囩煋闁绘垶锕╁▓浠嬫煟閹邦剙绾фい銉ｅ灮閳ь剚顔栭崳顕€宕抽敐鍛殾闁绘挸绨堕弨浠嬫煕閳╁喚娈橀柕鍫櫍濮婂宕掑▎鎺戝帯缂備緡鍣崹璺虹暦濠靛鍗抽柕蹇娾偓鏂ュ亾閼稿灚鍙忔俊顖涘绾墽绱掗埀顒傗偓锝庘偓顓熸閺佹劙宕ㄩ鐔割唹闂備焦濞婇弨杈╂暜閹烘违闁圭儤鍩堝鈺傘亜閹哄秶鍔嶉柟顔界懄缁绘稓鈧稒顭囬惌瀣磼鐠囨彃鏆炵紒宀冮哺缁绘繈宕惰閻撴垶绻濋姀锝嗙【闁挎洩绠撻、鏍磼濮橈絾鏂€闂佺粯鍔曞鍫曀夐幘缁樼厱闁靛鍊楅惌娆撴煏閸℃洜绐旂€殿喗鎸虫慨鈧柍鈺佸暞閻濇娊姊绘担瑙勫仩闁稿氦宕靛濠冦偅閸愨晛鈧爼鏌涢幇闈涙灍闁抽攱甯掗妴鎺戭潩閿濆懍澹曢梻渚€鈧偛鑻晶浼存煕鐎ｎ偆娲撮柟宕囧枛椤㈡稑鈽夊▎鎰娇闂備礁婀遍搹搴ㄥ窗濡ゅ懏鍋?
            net.minecraft.util.RandomSource random = net.minecraft.util.RandomSource.create();
            random.setSeed(player.getEnchantmentSeed());

            EnchantmentHelper.enchantItem(random, targetStack, enchantPower, false);
            this.setItemSlot(targetSlot, targetStack);

            // 闂?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧潡鏌熺€电孝缂佽翰鍊濋弻锕€螣娓氼垱锛嗛悷婊呭鐢帞澹曟總鍛婄厽闁归偊鍨伴惃娲煟濞戞牕鍔氶柍瑙勫灦楠炲﹪鏌涙繝鍐╃妤犵偛绻掗埀顒婄秵閸犳牠寮告笟鈧弻娑㈠焺閸愬墽鍔风紓浣叉閸嬫挸鈹戦悩鍨毄濠殿喗鎸冲畷鎰磼濡粯鐝峰┑鐐村灟閸ㄦ椽鎮″☉銏＄厱婵犲ň鍋撶紒鈧担瑙勬珷妞ゆ牜鍋為悡娆忋€掑顒備虎濠碘€冲悑閵囧嫰顢曢敐鍥╃厜閻庤娲栧畷顒冪亙闂侀€炲苯澧扮紒顔碱煼閹煎綊宕烽鐙呯闯濠电偠鎻紞浣虹磽濮橆剦鐎堕柟闂寸劍閻撴洟鏌曟繛鍨姢闁糕晪绲块埀顒侇問閸犳牠鈥﹂悜钘夋瀬闁瑰墽绮崑鎰版煠绾板崬澧剧紒鍗炲级缁绘繈鎮介棃娑楁勃闂佹悶鍔岄悥濂稿极閸愵喖鐓涘ù锝呭閻╊垰鐣烽崡鐐╂婵炲棙鍨甸獮妤呮⒒娓氣偓濞佳呮崲閸℃稑鐤炬繛鎴欏灪閸婂爼鏌曟径娑橆洭缂佺娀绠栭弻娑橆煥閸愩劍娈剁紓浣割樈閸ｏ綁寮诲☉銏犵厴闁诡垎鍌氼棜婵犵绱曢崑鎴﹀磹閺嶎偅鏆滈柟鐑橆殔绾惧湱鎲搁悧鍫濈瑨闁告艾缍婇弻宥堫檨闁告挻姘ㄩ幑銏犫攽鐎ｎ亞鍘遍梺閫炲苯澧寸€规洘锕㈤、姘跺川椤忓嫪澹曞┑掳鍊曢幊蹇涙偂閸愵亞纾藉ù锝堝亗閹存繄鏆﹂悘鐐佃檸濞堜粙鏌ｉ幇顒佲枙闁稿孩妫冮弻鈩冩媴缁嬪簱鍋撴繝姘疅闁圭虎鍠楅弲鏌ユ煕閳╁喚娈樻俊鍙夋そ濮婂宕掑顑藉亾妞嬪海鐭嗗〒姘ｅ亾妤犵偛顦甸崹鍓ф惥娴ｈ銇濋柡浣稿暣瀹曟帒顫濋鍌楀亾椤撱垺鈷戦悷娆忓閸旇埖淇婇銏狀伀缂侇喛顕х叅妞ゅ繐鎳愰崢鎼佹⒑閹肩偛鍔楅柡鍛☉閺嗏晝绱撴担鐟板姢濠⒀傜矙瀹曘垼顦归柍銉閹瑰嫰濡搁敃鈧壕顖炴⒑缂佹顣叉繛鍏肩懄閹便劌鈽夐姀鈥斥偓鍨箾閹寸偟鎳呯紒鐘靛仦閹?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲梺姹囧€ら崰妤呭Φ閸曨垰绠涢柍杞拌兌閸旀挳姊洪幖鐐测偓鏍洪悢鐓庤摕婵炴垯鍩勯弫鍐煥濠靛棙顥滄い锔规櫊濮婄儤娼幍顕呮М濠碘槅鍋呴悷褔骞戦姀鐘闁靛繒濮烽娲⒑缂佹ê濮囨い鏇ㄥ幖閳绘捇濡舵径瀣ф嫼濠电偠灏褔鐛Δ鍛厵闁归棿鑳堕悾娲煕閳规儳浜炬俊鐐€栧濠氬磻閹惧墎纾奸柣妯垮皺鏁堥悗瑙勬礃濞茬喖寮婚崱妤婂悑闁告侗鍨抽弸鍐⒒娴ｅ憡璐″褎顨呴…鍨熼懖鈺€绗夐梺鎯х箰閸樻粓宕戦幘鑽ゅ祦闁割煈鍠栨慨搴♀攽閳藉棗浜濋柣鐔叉櫅閻ｇ兘鏁愰崼銏㈡澑闂佸搫鍟崐濠氭儊閸儲鈷掗柛灞炬皑婢ф稓绱掔€ｎ偄娴柡浣哥Т椤撳吋寰勭€ｎ剙骞楅梻浣烘嚀婢т粙宕戦妸鈺佺；闁靛繈鍊栭悡娑氣偓鍏夊亾閻庯綆鍓涢惁鍫ユ⒑缁洘鏉归柛?
            player.onEnchantmentPerformed(targetStack, costLevels);

            // 6. 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈠姊绘笟鈧褔鏁嶈箛娑樺窛妞ゆ牗绮岀敮顒勬⒑閼姐倕鏋戠紒顔煎閺呰泛螖閸愨晜娈伴梺鎼炲労閸撴瑩鎮?(婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繐霉閸忓吋缍戦柛銊ュ€搁湁闁绘ê妯婇崕蹇涙煟閹烘垹浠涢柕鍥у楠炴帒顓奸崼婵嗗腐闂備礁鐤囧Λ鍕囬柆宥呯劦妞ゆ帒鍠氬鎰版煙閸濄儺鐒鹃摶鐐寸節闂堟侗鍎忛柦?+ 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亜顒㈡い鎰矙閺屻劑鎮㈤崫鍕戙垻绱掗幇顓ф畷濞ｅ洤锕俊鍫曞川椤撶喐顔夐梻浣告惈濡瑧鍒掗幘璇茶摕闁绘柨鍚嬮崐缁樻叏濡も偓濡瑩鎮鹃悜鑺モ拺?+ 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗霉閿濆浜ら柤鏉挎健瀵爼宕煎顓熺彅闂佹悶鍔嶇换鍐Φ閸曨垰鍐€妞ゆ劦婢€缁墎绱撴担鎻掍壕婵犮垼娉涢鍕崲閸℃稒鐓忛柛顐ｇ箖閸ｆ椽鏌涢敐鍥ㄥ殌妞?
            this.playSound(SoundEvents.ENCHANTMENT_TABLE_USE, 1.0f, 1.0f);
            if (this.level() instanceof ServerLevel serverLevel) {
                // 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴濐潟閳ь剙鍊块幐濠冪珶閳哄绉€规洏鍔戝鍫曞箣濠靛牃鍋撻鐑嗘富闁靛牆鎳愮粻浼存煟濡も偓濡稓鍒掗崼銉ラ唶闁绘棁娅ｉ惁鍫ユ⒒閸屾氨澧涚紒瀣尰閺呭爼骞囬悧鍫㈠幈闁诲函缍嗛崑鍛焊椤撶喆浜滄い鎰剁悼缁犵偞銇勯姀鈽呰€块柟顔规櫊瀹曟﹢宕ｆ径灞介叡濠电姷鏁告慨鐢割敊閺嶎厼绐楅柡宥庡幗閺呮繈鏌ㄥ┑鍡樻悙闁搞劍绻冪换娑㈠幢濡ゅ啰顔婇梺鍝勬４缁犳捇寮婚敐澶婄睄闁稿本顨嗙€氭盯姊烘潪鎵槮缂佸鏁搁幑銏犫攽閸モ晝鐦堥梺绋挎湰閸戣绂掓ィ鍐┾拺闁告縿鍎遍弸鎴炰繆閻愯埖顥夋い顐㈢箳缁辨帒螣鐠囧樊鈧捇姊洪崨濠勨槈闁挎洏鍊濆鎶藉醇閵夛腹鎷洪梺鐓庮潟閸婃洖鈻嶉幇顔剧＜闁绘ê鍟块悘鎾煃閵夘垳鐣电€规洖缍婇、姘跺川椤旇偐绱﹂梻鍌欑窔閳ь剛鍋涢懟顖涙櫠閹绢喗鐓熸繛鎴濆船閺嬬喓绱掔紒妯肩疄鐎规洘鍎奸ˇ鏌ユ煠閺夎法浠㈤柍瑙勫灴閹瑩寮堕幋鐘辨婵＄偑鍊ら崢鐓幟洪鐐垫殾闁规壆澧楅崐鐑芥煟閹寸們姘跺箯濞差亝鈷戦梻鍫氭櫅閻︽粓鏌涘▎灞戒壕婵犵绱曢崑鎾诲箖閸岀偛钃熸繛鎴欏灪閺呮煡骞栫划鐟板⒉闁诲繐鐗撻弻褔鎳￠妶鍛埛闂佺懓寮堕幃鍌氼嚕椤曗偓瀹曠厧鈹戞繝鍐╁暫濠电姷鏁搁崑鐐哄垂閸洘鏅濋柍杞扮贰閻掍粙鏌嶉崫鍕偓鑸电濠婂牊鐓欓柟瑙勫姈绾儳霉閻樻瑥鍘捐ぐ鎺撳亼闁逞屽墴瀹曞湱鎹勬笟顖涚稁濠电偛妯婃禍婊冾啅濠靛棌鏀介柣妯诲絻閺嗗﹪鏌熷畡閭︾吋婵﹥妞藉畷顐﹀Ψ閵夋劧缍侀弻锝呂旀担鍦槹濡炪們鍨哄畝鎼佸极閹邦厼绶為悗锝庝簷缂傛捇姊绘担鍛婂暈闁瑰摜顭堥锝夊醇閺囩偟鏌ч梺闈涚箞閸婃牠鍩涢幋鐘电＜閻庯綆鍋勯婊勭節閳ь剟骞嶉鍓э紲闁诲函缍嗛崑鍛暦瀹€鈧埀顒侇問閸犳绻涙繝鍥х畺闁冲搫鍟扮壕鍏间繆椤栨粌甯舵鐐搭殜濮婃椽鎮烽弶鎸庡€梺浼欑秵娴滎亜鐣风憴鍕瘈婵﹩鍓涢崢鎰版⒑閸濆嫭宸濋柛鐘叉缁傚秴顭ㄩ崼鐔哄帾婵犵數鍋涢悘婵嬪礉閵堝拋鐔嗙憸婵嬫⒔閸曨垰桅闁告洦鍨伴～鍛存煥濞戞ê顏╂い顐庡洦鈷戦柣鐔告緲濡插鏌熼搹顐€顏堟偩閻戠瓔鏁冮柨鏇楀亾缂佲偓鐎ｎ偁浜滈柟鎵虫櫅閳ь剚鎹囧畷鐗堢節閸ャ劉鎷婚梺绋挎湰閻熝囁囬敂鐣岀瘈闁逞屽墴閺屽棗顓奸崨顖ょ吹闂備線娼ч悧鍡浰囬鐐插瀭闁稿本绮嶉崰鎰版煟濡も偓閻楀棛绮幒鏃傜＜?
                serverLevel.sendParticles(ParticleTypes.ENCHANT, this.getX(), this.getY() + 1.8, this.getZ(), 30, 0.5, 0.5, 0.5, 0.1);
            }

            String msg = String.format("闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗ù锝堟缁€濠傗攽閻樿弓杩规繛鎴炵瀹曞鏌曟繝蹇曠暠閹兼潙锕ら埞鎴︻敊閽樺鐟ㄩ梺娲诲幖閸婃悂锝炶箛鏃傜瘈婵﹩鍓涢敍婊冣攽椤旀枻渚涢柛蹇旓耿瀹曟垿骞樼拠韫炊闂侀潧顦崹瑙勭閻愵剚鍙忔俊顖滃帶鐢泛顭胯閸楁娊寮诲鍫闂佸憡鎸诲畝鎼佸箚瀹€鍕垫晪闁逞屽墮閻ｇ兘鏁撻悩鑼唴闂佽姤锚椤﹂亶鎮鹃崫鍕ㄦ斀闁绘劕寮堕埢鏇灻瑰鍕疄鐎规洘鍨垮畷鐔碱敍濞戞艾骞楅梻浣筋潐瀹曟ê鈻嶉弴銏犵闁挎繂妫庢禍婊堟煙閹呮憼闁靛洦绻冮幈銊︾節閸モ晝绐楅梺闈涙处閸旀瑩鐛幒妤€绠ｆ繝濠傚暞閻庢娊姊婚崒娆戭槮闁硅绻濋獮鎰節濮橆厼浠梺鍐叉惈閹冲繘寮查弻銉︾厽闁归偊鍠栭崝瀣煕?濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌熼梻瀵割槮缁炬儳顭烽弻锝夊箛椤掍焦鍎撻梺鎼炲妼閸婂潡寮婚敐澶婎潊闁绘ê鍟块弳鍫ユ⒑缁嬫鍎忔い鎴濐樀瀵鏁愭径濠勭杸濡炪倖甯婇悞锕傚磿閹惧墎纾?%d 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎电濡介梺绋款儏椤戝懘鍩為幋锔藉亹闁圭粯甯╂禒楣冩⒑閸濆嫭顥炵紒顔芥崌瀵濡搁埡鍌氫簻闂佸憡绻傜€氬懘濮€閵堝棌鎷婚梺绋胯閸婃洟鎮橀悩缁樻嚉闁哄稁鍘介悡銉︾節闂堟稒顥為柛锝呯秺閺岋繝宕卞▎蹇庢闂?%d 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛濠傛健閺屻劑寮崹顔规寖闂佹椿鍘介悷鈺呭蓟閻斿皝鏋庨梽鍥敋瑜嶇叅闁挎洍鍋撴い顓炴穿缁犳稑鈽夐幒鍡椾壕闁挎洖鍊哥粻锝夋煟閹存繃顥滈柡?-> %s (Lv.%d)",
                costLevels, costLevels, targetStack.getHoverName().getString(), enchantPower);
            player.sendSystemMessage(Component.literal(msg));

            return InteractionResult.SUCCESS;
        }

        // ==================== 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰鍐€闁靛ě鍛帓闂備焦妞块崢鐓幬涘┑瀣摕婵炴垯鍩勯弫鍐煟濡绲诲┑顔芥礋濮?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ弬娆炬祲濠㈣埖鍔曠粻娑㈡煛婢跺孩纭堕柨娑欑洴濮婇缚銇愰幒鎴滃枈闂佸憡锚婢х晫鍒掔紒妯稿亝闁告劏鏅濋崢鎾绘偡濠婂嫮鐭掔€规洘绮撻幃銏ゆ偂鎼淬倖鎲伴柣搴＄畭閸庨亶鎮у鍐剧€堕柕濞炬櫆閳锋垹绱掔€ｎ厽纭剁紒鐘崇叀閺岋綁鍩℃繝鍌滀桓濡ょ姷鍋涢崯鎾箖濞嗘挻鍊绘俊顖滅帛閻濇牕鈹戦悙鑸靛涧缂佽弓绮欓獮澶愬灳閺傘儲鐏侀梺鍝勮閸庢煡鍩涢幒妤佺厱閻忕偛澧介幊鍡涙煕韫囨挻婀伴柕鍥у椤㈡洟濮€閳轰礁澹庨柣搴ゎ潐濞叉粓宕伴弽褏鏆︾憸鐗堝俯閺佸啴鏌曢崼婵囶棡妞ゆ梹妫冨濠氬磼濮橆兘鍋撳畡閭︽富闁圭儤姊归～鏇熴亜閺冣偓閸庡磭娆㈤妶鍛斀闁绘ê鐤囨竟妯肩磼閳ь剚寰勯幇顒傤啇濠电儑缍嗛崜娆愪繆閼测晝纾奸柣姗€娼ч弸鎴澢庨崶褝韬┑鈥崇埣瀹曘劑顢欓崗纰变哗闂佽娴烽幊鎾诲箟閿涘嫭宕查柛鏇ㄥ幗椤洟鏌熼悜姗嗘闁轰礁锕弻锝夊箛闂堟稑顫╁┑鐐茬墕閺堫剛鎹㈠☉姘ｅ亾濞戞瑯鐒介柣顓熷笧缁辨帡鎮╁畷鍥р拰閻庢鍠栭…鐑藉极閹剧粯鍋愰柤纰卞墻濡茶淇婇悙顏勨偓鏍礉閹达箑纾规俊銈呮媼閺佸﹤鈹戦悩鍙夊闁?====================
        if (item.getItem() == ExampleMod.TELEPORT_UPGRADE_MODULE.get()) {
            if (!this.hasTeleportModule()) {
                if (!this.level().isClientSide) {
                    int emptyModuleSlot = findFirstEmptyModuleSlot();
                    if (emptyModuleSlot < 0) {
                        player.sendSystemMessage(Component.literal("濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴濐潟閳ь剙鍊块幐濠冪珶閳哄绉€规洏鍔戝鍫曞箣濠靛牃鍋撻鐑嗘富闁靛牆鎳愮粻浼存煟濡も偓濡繈骞冮悙鍝勫瀭妞ゆ劗濮崇花濠氭⒑閸︻厼鍔嬮柛銊ф暬瀵娊鎮欓悜妯煎幗濠电姴鐏氶崝鎺楁焽椤栫偞鐓涢悘鐐插⒔閵嗘帡鏌嶈閸撱劎寰婃繝姘鐎光偓閸曨偆顦┑鐘诧工閸欏洦鎯旈妸銉у€為悷婊勭箞閻擃剟顢楅崟顒傚幍閻庤娲栧ú銈夊煝閸儲鐓欓柧蹇ｅ亞閻﹪鏌嶇紒妯诲磳妤犵偞鍔栭幆鏃堫敊缁涘顥夐梻鍌氬€搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偛顦甸弫鎾绘偐閸欏袣濠电姷鏁告慨瀵糕偓姘煎幖閻ｇ兘宕ｆ径宀€鐦堥梻鍌氱墛娓氭宕曡箛娑欑厸?/ Module slots are full"));
                        return InteractionResult.FAIL;
                    }
                    ItemStack installedModule = item.copy();
                    installedModule.setCount(1);
                    this.inventory.setItem(emptyModuleSlot, installedModule);
                    checkTeleportModule();
                    this.playSound(SoundEvents.BEACON_ACTIVATE, 1.0f, 1.0f);
                    // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗霉閿濆浜ら柤鏉挎健濮婃椽顢楅埀顒傜矓閻㈢绠氶柣鎰惈缁犺绻涢敐搴″濠碘€炽偢閺屾稓浠︾拠鎻掝瀳闂傚洤顦甸弻锝呂熼悜妯锋灆闂佺楠哥换鎴炵┍婵犲浂鏁冮柨娑崇秵娴滎亜锕㈡笟鈧娲箰鎼达絿鐣甸梺鐟板暱缁绘﹢鐛崱娑橀唶闁靛濡囬崢閬嶆⒑闂堟侗鐓┑鈥虫川缁鎮欓悜妯煎幐閻庡厜鍋撻柍褜鍓熷畷浼村冀椤撶偟鐣哄┑鐘诧工閸氭﹢鎮㈤崗鍏煎劒闂備緡鍋呯粙鎺楀磻閸涘瓨鈷掗柛灞剧懆閸忓本銇勯姀鐙呭伐閾荤偤鏌涢弴銊ュ箻闁活厽鎸鹃幉鎼佹偋閸繄鐟ㄩ梺钘夊暟閸犳牠寮诲澶婄厸濞达絽鎲″▓鍙夌節濞堝灝鐏￠柟鍛婂▕瀵鈽夊Ο閿嬫杸闂佸憡娲﹂崑鍕叏鎼粹槅娓婚柕鍫濆暙閳ь剚鍔欏畷鎴﹀箻缂佹ǚ鎷?
                    if (this.level() instanceof ServerLevel serverLevel) {
                        serverLevel.sendParticles(ParticleTypes.FIREWORK, this.getX(), this.getY() + 1.5, this.getZ(), 5, 0.2, 0.2, 0.2, 0.05);
                    }
                    if (!player.getAbilities().instabuild) {
                        item.shrink(1);
                    }
                    player.sendSystemMessage(Component.translatable("message.examplemod.module_installed", this.getDisplayName()));
                }
                return InteractionResult.SUCCESS;
            } else {
                if (!this.level().isClientSide) {
                     player.sendSystemMessage(Component.translatable("message.examplemod.module_already_installed", this.getDisplayName()));
                }
                return InteractionResult.CONSUME;
            }
        }

// ==================== 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰绠涢柛鎾茬劍閸嬔呯磽娴ｅ搫鈻堢紒鐘崇墵瀵鈽夐姀鐘栥劍銇勯弮鍌氬付妞ゎ偒浜?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣椤愯姤鎱ㄥ鍡楀⒒闁绘帞鏅幉绋款吋閸澀缃曞┑鐘垫暩閸嬫稑螞濞嗘挸绠伴柛婵勫劤閻棗顭跨捄渚剮缂佽妫濋弻鏇㈠醇濠靛洤娅ゆ繝娈垮灠閵堟悂寮婚埄鍐╁缂佸顑欐导鍐⒑閸濆嫭婀伴柣鈺婂灡娣囧﹪鎮滈懞銉︽珳闂佸憡渚楅崣搴ㄦ倵閻戣姤鈷掑ù锝呮憸閿涘秶绱掗鍛仸鐎殿喖顭锋俊鎼佸煘闁款垰浜鹃柨鏃傚亾瀹曞鏌曟繝蹇曠暠缁剧虎鍨辩换娑㈠箻閺夋垵姣堥梺鎼炲妺閸楀啿鐣峰鍕╁亝闁告劏鏂侀幏娲⒑閸涘﹦鈽夐柨鏇樺劦閹繝濡烽埡鍌氣偓鍨叏濮楀棗浜滅€规挸妫涢埀?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎾跺Х閸橆垶姊绘担鍛婃儓缂佸绶氶幃妯衡槈濡攱顫嶉梺闈涚箳婵兘藝閺夋娓婚柕鍫濇婢ь剚鎱ㄥΟ绋垮闁诡喗鍎崇叅妞ゅ繐鎳夐幏娲⒑閸涘﹦绠撻悗姘煎弮瀹曟帡濡搁埡鍌滃幈闂侀潧顭梽鍕Φ濠靛牃鍋撶憴鍕闁搞劌缍婇崺鈧い鎺戯功缁夌敻鏌涢悩鎰佹疁鐎规洘鍔欏畷濂稿即閻斿搫骞楅梻浣筋潐婢瑰棙鏅跺Δ鈧埥澶庮槻闂囧绻濇繝鍌滃ⅱ闁伙絾妞介弻鈥崇暆鐎ｎ剛鐦堥悗瑙勬礋娴滃爼宕洪埄鍐╁闁告縿鍎冲澶愭⒒閸屾瑧顦﹂柟纰卞亰瀵敻顢楅崒婊呯厯闂佺鎻拋锝囩礊閺嶃劎绡€闂傚牊渚楅崕娑㈡煛娴ｅ憡顥㈤柡灞剧〒娴狅箓鎸婃径鍡椾壕闁硅揪绠戦悙濠囨煏婵炑冨暙缁楁岸姊洪懡銈呮瀾缂侇喖绉堕崚鎺楀箻瀹曞洦娈惧┑鐘诧工閸犳艾顭囬埡鍌樹簻闁瑰瓨姊瑰▍鏃傜磽瀹ュ嫮绐旈柣娑卞櫍楠炴帒螖閳ь剛鐚惧澶嬬厓鐟滄粓宕滈悢绗衡偓?(闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃繘鍩€椤掍胶鈻撻柡鍛█閵嗕礁鈻庨幘鍐插敤濡炪倖鎸鹃崑鐔兼偘閵夆晜鈷戦柛婵嗗閳诲鏌涘Ο鍨汗缂侇喛宕甸幉鎾礋閳衡偓缁ㄥ姊虹憴鍕凡濠⒀冮叄閹箖鏌嗗鍡欏幐闂佸憡娲嶉弲娑㈠礉濠婂叇搴ㄥ炊瑜濋煬顒€鈹戦垾宕囧煟鐎规洏鍔戦、娆撳礂绾板彉鍝楃紓鍌氬€搁崐鐑芥嚄閼搁潧鍨旀い鎾卞灩閸ㄥ倿鏌涢锝嗙闁藉啰鍠栭弻鏇熺箾閻愵剚鐝旂紓渚囧亜缁夊綊寮诲☉銏犖ㄦい鏃€鍎崇敮銉モ攽閳藉棗浜滈悗姘緲椤? ====================
        if (item.getItem() == Items.NAME_TAG) {
            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈢粯淇婇悙顏勨偓鏍偋濡ゅ啰鐭欓柟鐐湽閳ь剙鎳樺畷锝嗗緞瀹€鈧惁鍫ユ⒒閸屾氨澧涚紒瀣浮閺佸秹寮崼鐔哄幘闂佸搫顦冲▔鏇熺閵忋倖顥嗗鑸靛姈閻撱儲绻濋棃娑欘棡濠殿垰鍚嬬换娑㈡嚃閳轰焦鐎婚梻鍥ь槹缁绘繃绻濋崒姘缂備礁顦板浠嬪蓟閳ュ磭鏆嗛柍褜鍓熷畷浼村冀椤撶姴绁﹂梺纭呮彧缁犳垹绮诲☉娆嶄簻闁规崘娉涘瓭濠电偞鍤崶銊㈡嫽婵炶揪缍€椤宕戦悩缁樼厱濠电姴鍟版晶閬嶆煛娓氬洤娅嶉柡浣规崌閹晠鎳犻懜鍨暫濠电姷鏁搁崑鐐哄垂閸洘鏅濋柍杞扮贰閻掍粙鏌嶉崫鍕偓鑸电濠婂牊鐓欓柣鎴灻悘銉╂煃瑜滈崜姘跺礉濞嗘劒绻嗛柛顐ｆ礀濡炶棄霉閿濆懏鎯堥柡浣规倐閺岋綁鎮㈤崫銉х厐濠电偛顕崗姗€鐛幋锕€顫呴柕鍫濇嚇閸炲爼姊洪棃娑辨Ф闁稿孩濞婇幃鐐偅閸愨斁鎷洪梺纭呭亹閸嬫盯宕濋幘顔界厱闁圭偓娼欓崫铏光偓瑙勬礃閸ㄥ灝鐣烽悢纰辨晬婵炴垶鑹鹃獮妤呮⒒娴ｇ儤鍤€妞ゆ洦鍙冨畷鏇㈠箛閻楀牆鈧灝霉閻樺樊鍎愰柣鎾寸洴閺屾盯鍩勯崘顏呭櫑闂佸疇顕ч悧濠囧箞閵婏妇绡€闁告劏鏂傛禒銏ゆ倵鐟欏嫭澶勯柛瀣工閻ｇ兘鎮㈢喊杈ㄦ櫍闂佺粯鍨靛Λ娆徯掗崶褉鏀介柨娑樺娴滃ジ鏌涙繛褍鎳夐崑鎾绘濞戞氨鍔悗瑙勬礀缂嶅﹤鐣锋總绋垮嵆闁绘灏欓妶锕傛⒒娴ｅ憡鍟為柛鏃撶畵瀹曚即寮介鐐殿攨闂佽鍎兼慨銈夋偂閻斿憡鍙忔俊銈傚亾婵☆偅顨嗙粋宥咁煥閸忕姷鎳撻…銊╁川椤撴繂顥氱紓鍌欒兌缁垶鎯勯鐐靛祦閻庯綆鍠楅崐鐑芥煕椤垵浜滄繛鍛囧嫮绡€闁汇垽娼ф禒婊堟煟濡も偓閿曘倗鍙呭┑鈽嗗灥瀹曠敻鍩炲鍛斀闁绘ê寮舵径鍕煕婵犲嫬鍘撮柡宀€鍠撶槐鎺懳熼崫鍕秹闂備胶顭堥鍡涘箲閸パ呮殾缂佸顕抽弮鍫濈闁靛ě浣镐喊闂備浇顕ф鍝ョ不瀹ュ纾块梺顒€绉寸粻顖炴倵閿濆骸鏋涢悷娆欑畵閹鏁愭惔鈩冪亶闂佺粯鎸诲ú鐔煎蓟閺囩喎绶炴繛鎴炶壘閸╁本绻濆鏋€曡缂備胶绮惄顖氱暦閵娾晩鏁冮柕蹇ｆ線缁辨瑦绻?
            if (item.hasCustomHoverName()) {
                String newName = item.getHoverName().getString();
                if (!applyPlayerBaseName(newName)) {
                    return InteractionResult.CONSUME;
                }

                // 4. 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌熼梻瀵割槮缁炬儳顭烽弻锝夊箛椤掍焦鍎撻梺鎼炲妼閸婂潡寮婚敐澶婎潊闁绘ê鍟块弳鍫ユ⒑缁嬫鍎忔い鎴濐樀瀵鎮㈤崗鐓庝罕闂佸壊鍋嗛崰鎾诲礄閿熺姵鈷戠紓浣姑粭鎺楁煟韫囨柨鍝哄┑锛勬暬瀹曠喖顢涘槌栧敽闁诲骸绠嶉崕鍗灻洪埡鍐幓婵°倐鍋撻柍瑙勫灴閹瑩鎳犻鈧·鈧梻浣瑰绾板秹濡甸崟顖ｆ晣闁炽儱鍟挎慨宄邦渻閵堝繒鐣辩€殿喖澧庨幑銏犫槈濮橆偆鍓ㄩ梺鍝勭Р閸婃洘绂嶉崜褉鍋撶憴鍕婵炶绠戦埢鎾诲箚瑜滃〒濠氭煏閸繃顥滃┑顔ㄥ懐纾奸柤纰卞墮娴滈箖鏌涢幒鎴姛闁逞屽墯缁嬫帟鎽梺鍛婄懃缁绘垹鎹㈠┑瀣棃婵炴垶鐟Λ銉╂煟鎼淬垻鐓柛妤佸▕瀵鏁愰崨顏呮杸闂佸綊鍋婇崜娑欑缁嬪簱鏀芥い鏃傘€嬮弨缁樹繆閻愯埖顥夐柣锝囧厴閹粎绮电€ｎ偅娅嶉梻浣规灱閺呮盯宕板璺虹劦妞ゆ帊绶″▓婊勬叏婵犲啯銇濈€规洏鍔嶇换娑㈠箳閺囩偘姹楅梺鍛婂笚鐢帡鍩㈡惔銈囩杸闁挎繂鎳忛鎸庝繆閻愵亜鈧牜鏁繝鍥ㄥ殑闁割偅娲橀崑锛勬喐閻楀牆绗氶柣鎾冲暟閹茬顭ㄩ崼婵堫槶濠电偛妫欑敮鐐寸闁秵鈷掑ù锝呮啞閸熺偟绱掔€ｎ偄鐏撮柟顔芥そ婵℃悂鍩℃担铏规毎闂備胶绮崝鏍偩椤忓懐顩叉繝濠傜墛閻撴瑩鏌℃径濠勪虎妞わ絽纾槐鎺斺偓锝庝憾閻撳ジ鏌?
                this.playSound(SoundEvents.ANVIL_USE, 1.0f, 1.0f);
                if (!player.getAbilities().instabuild) item.shrink(1);

                return InteractionResult.SUCCESS; // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缂佺姷濞€閺岀喖骞戦幇闈涙闂佸憡鑹剧紞濠囧蓟閳ユ剚鍚嬮幖绮光偓宕囶啈闂備焦濞婇弨鍗炍涢崘顔艰摕婵炴垯鍨归崡鎶芥煏婵炲灝鍔ゅù鐘櫊濮婃椽宕崟顐淮闂佺娴烽弫璇差嚕鐠囨祴妲堟俊顖炴敱椤秴鈹戦悙鍙夘棡闁告梹顨堢划娆撳炊椤掍讲鎷虹紓浣割儓閸庡锝為敃鍌涚厱闁哄啠鍋撻柛銊ョ仢椤曪絾绻濆顓熸珳婵犮垼娉涢敃銉┧夊┑瀣拺闁革富鍙庨悞楣冩倵濞戞帗娅婄€规洘娲熼獮姗€骞囨担鐟扮槣闂備線娼ч悧鍡欐崲閹烘绀嗗ù鐓庣摠閻撳繘鏌涢鐘茬労闁绘帞鍋撻妵鍕敃閵忋垻顔囬柣鎾卞€栭妵鍕疀閹剧紟锝夋煛閸涱喚绠炴慨濠冩そ楠炴劖鎯旈敐鍥╂殼婵犵妲呴崑鎺楀储婵傜硶鈧箓宕堕浣规珫闂佸憡娲﹂崢楣冩晬?
            }
            return InteractionResult.CONSUME;
        }

        // ==================== 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰绠涢柍杞拌閸嬫挸螖娴ｈ　鏋?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰缁顢涢悙鏉戔偓鐢告煥濠靛棝顎楅柡瀣洴濮婂宕掗妶鍛桓闂佸搫琚崝宀勫煘閹达箑骞㈤柍鍝勫€愰敃鍌涒拺缂備焦锚缁楁帡鏌ｈ箛鏂垮摵濠碉紕鏁诲畷鐔碱敍濮橀硸鍞洪柣搴＄畭閸庡崬螞濞戙垹围闁绘鐗忕弧鈧梺闈涢獜缂嶅棗顭囬幇顓滀簻妞ゆ挾鍋為崰妯活殽閻愬樊妯€妤犵偞鐗楅幏鍛存偡妫颁胶缍嶉梻鍌欑婢瑰﹪宕戦崱娑樼獥閹兼番鍔岄悞鍨亜閹哄秶顦﹀┑顔肩Ч閺?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缂佺姷濞€閺岀喖宕滆鐢盯鏌涙繝鍛厫闁逛究鍔岃灒闁圭娴烽妴鎰磽娴ｅ搫小闁告濞婂璇测槈濡攱鏂€闂佸憡娲﹂崑鍕叏閺囩儐娓婚柕鍫濋娴滄繃绻涢懠顒€鏋涚€殿喖顭烽幃銏ゅ川婵犲嫮肖濠德板€х徊浠嬪疮椤栫儐鏁佺€广儱顦伴埛鎴︽煙閼测晛浠滈柍褜鍓氶悧鏇犲弲濠碘槅鍨伴崥瀣暦閸欏绡€闂傚牊绋掑婵堢磼閳锯偓閸嬫捇姊绘担渚劸闁哄牜鍓涢崰濠傤吋閸涱亝鐏佸銈嗘尵婵澹曢挊澹濆綊鏁愰崱妤冪シ婵?/ 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎺嶇劍椤斿洭姊绘担鍛婅础闁稿簺鍊濆畷闈涱潩椤戠偞妞介、鏃堝川椤旂晫褰囬梻鍌欑窔閳ь剛鍋涢懟顖涙櫠閹绢喗鐓欐い鏇楀亾缂佺姵鐗犻獮鍐煥閸喎鐧勬繝銏ｆ硾閻牓宕禒瀣拻濞达絿鍎ら崵鈧紓浣哄Т缁夌懓鐣峰┑鍥ㄥ劅闁靛鍎抽悰銉╂⒑閸濆嫮鈻夐柛妯恒偢瀹曞綊宕掗悙瀵稿幍濡炪倖鐗曞Λ妤呭箠韫囨挴鏋斿Δ锝呭暞閳锋垿鏌熼懖鈺佷粶闁告梹顨婇弻锟犲川椤忓懏鐝氶悗? ====================
        // 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫鍐煥閺囨浜鹃梺姹囧€楅崑鎾舵崲濞戙垹骞㈡俊顖濐嚙闂夊秹姊洪幖鐐测偓鏇犫偓姘嵆瀵鏁撻悩鏌ュ敹闂侀潧绻嗛崜婵喰掗崟顖涒拺闁告繂瀚鈺呮煕婵犲倻浠㈡い?TurretInteractionHandler闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弮鍫熸殰闁稿鎸剧划顓炩槈濡娅ч梺娲诲幗閻熲晠寮婚悢鍛婄秶濡わ絽鍟宥夋⒑閹肩偛鈧牠宕濋弽顓炍﹂柛鏇ㄥ灠閸愨偓濡炪倖鍔﹀鈧繛宀婁邯濮婅櫣绮欏▎鎯у壘婵炲瓨绮犳禍顏勵嚕鐠囨祴妲堥柕蹇曞Т瀹撳棝姊洪棃娑辩劸闁稿氦娅曠粋鎺楊敇閵忊檧鎷虹紓浣割儐椤戞瑩宕曢幇顔剧＜閻犲洦褰冮埀顒€鐏濋敃銏＄瑹閳ь剙顫忓ú顏勭闁兼祴鏂傞崑鐐烘⒑閸濆嫭鍣介柛瀣Т铻為柕蹇嬪€栭埛鎺懨归敐鍕劅闁绘帞鍋撻妵鍕箣濠靛浂妫﹀Δ鐘靛仦閸ㄥ灝鐣烽幆閭︽闂佹悶鍊栧ú鐔煎蓟閻旈鏆嬮柟娈垮枤娴煎洭姊哄Ч鍥р偓鎰板磻閹剧粯鈷掑ù锝呮啞閹牊绻涚仦鍌氬鐎规洘鍨块幃銏㈠枈鏉堛劍娅嗛柣鐔哥矌婢ф鏁Δ鍛厱闁圭儤鍤氳ぐ鎺撴櫜闁告侗鍠栭弳鍫ユ⒑閸濄儱鏋旈柛瀣ㄥ€濆璇测槈閵忕姷鐫勯梺閫炲苯澧悡銈夋煟閺冨洤浜圭€规挷绀侀埞鎴︽偐閸欏鎮欑紓浣哄Т椤兘骞冨Δ鍛棃婵炴垶锕╁Λ灞解攽?(Entity-Centric Architecture)

        if (!this.level().isClientSide && hand == InteractionHand.MAIN_HAND) {
            if (player instanceof ServerPlayer serverPlayer) {
                updateInfoBookAndSlots();
                NetworkHooks.openScreen(serverPlayer, new SimpleMenuProvider(
                        (id, inv, p) -> new TurretMenu(id, inv, this, this.inventory),
                        this.getDisplayName()
                ), (buf) -> buf.writeInt(this.getId()));
            }
            return InteractionResult.SUCCESS;
        }

        return super.mobInteract(player, hand);
    }

    @Override
    public InteractionResult interactAt(Player player, net.minecraft.world.phys.Vec3 hitVec, InteractionHand hand) {
        if (player.isShiftKeyDown()) {
            // 闂?mobInteract 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧潡鏌熺€电孝缂佽翰鍊濋弻锕€螣娓氼垱锛嗗┑鐐叉▕娴滄繈寮插鍫熺厽闁逛即娼ф晶顕€骞栭弶鎴含婵﹥妞藉畷銊︾節閸屾鏇熺箾鐎涙鐭嬮柣妤冨Т閻ｇ兘骞嬮敃鈧粻濠氭偣閸ャ劌绲婚柣搴幖椤啴濡堕崱妤€衼缂備礁寮跺浠嬬嵁韫囨稑鎹舵い鎾跺Х閿涙繃绻涙潏鍓у埌濠㈢懓锕畷鏇＄疀閺傝绨婚梺鎸庢⒒閸嬫捇寮抽鍌楀亾鐟欏嫭绀冩俊鐐扮矙瀹曟椽鍩€椤掍降浜滈柟鍝勭Ч濡惧嘲霉濠婂嫮鐭掗柡宀€鍠栭幃婊兾熼搹閫涙樊婵＄偑鍊曞ù姘椤忓牆钃熸繛鎴欏灩鍥撮梺鍛婄矊閸熸娊宕ラ锔藉€垫繛鍫濈仢閺嬫盯鏌ｉ弽顐㈠付闁伙絿鍏橀幃鈩冩償濡粯鏉搁梻浣虹《閳ь剙纾粻鏌ユ倵閸偆澧辩紒杈ㄦ崌瀹曟帒鈻庨幋婵嗩瀴闂備礁鎲″褰掓偋閻樿违闁告劦鍠栭獮銏＄箾閸℃ê濮囬幖鏉戯工閳规垿鎮欓弶鎴犱户闂佹悶鍔屽﹢杈╁垝閸儱纾奸柣鎰嚟閸樻儳鈹戦悙瀛樼稇妞ゆ垵妫楅埢宥夊炊椤掍胶鍘介梺瑙勫劤閸熷潡顢旈埡鍌樹簻妞ゅ繐瀚弳锝呪攽閳ュ磭鍩ｇ€规洘锕㈡俊姝岊槺闁汇儺浜缁樻媴鐟欏嫬浠╅梺鍛婃煥閻倿骞冨Ο琛℃斀閻庯綆鍋勬禒濂告⒑缂佹ê鐏卞┑顔哄€濆鏌ュ箵閹烘繄鍞甸柣鐘烘鐏忋劑宕濋悢鎼炰簻闁哄倹瀵ч崵鍥ㄦ叏婵犲啯銇濈€规洘顨婂鑽ゅ鐎ｎ亞鍔甸梻鍌欒兌椤牏鈧稈鏅為妵鎰板礃椤旇偐鍘洪梺鍦亾濡炲潡寮鍡欑闁瑰鍋為惃鎴炪亜閺冣偓濞茬喎顫忓ú顏勪紶闁告洖鐏氭晥闂備焦鎮堕崝搴ㄥ极婵犳氨宓侀柛鎰靛枛缁狅綁鏌ㄩ弮鍌涙珪闁告瑥妫楅埞鎴︻敊缁涘鍔搁梺绯曟櫆閻楃娀骞冮敓鐘插嵆闁绘柨澧庣粻姘渻閵堝棛澧紒璇插€垮畷銉ㄣ亹閹烘挾鍘撳銈嗙墬缁嬫帞绮堥崼銏㈢＜閺夊牄鍔屽ù顔锯偓瑙勬礃鐢帡锝炲┑鍠版帒鈻嶇拠鎻掓殜闁衡偓娴犲鐓冮柕澶堝劤閿涘秹鏌涢埡瀣偧闁逞屽墲椤煤閺嶎厽鍋夊┑鍌滎焾閺勩儵鏌ㄩ悢鍝勑㈢紒鈧€ｎ偁浜滈柟鎵虫櫅閳ь剚娲熼悰顕€鍩€椤掑嫭鈷掗柛灞捐壘閳ь剚鎮傚畷鎰槹鎼达絿鐒兼繛杈剧秮濞煎鎳撻崸妤佲拺妞ゆ巻鍋撶紒澶嬫尦閹繝寮撮姀锛勫幈濡炪倖鍔楁慨鎾礉濮樿京纾奸柍褜鍓熷畷濂告偄閾忓湱妲囬梻鍌氬€搁悧濠勭矙閹惧瓨娅犳繛鎴炲焹閸嬫挾鎲撮崟顒傤槷闁诲繐绻戦悷鈺呭春閳ь剚銇勯幒鍡椾壕缂備胶濮寸粔鐟扮暦閺囥垺鐒肩€广儱鎳愰悿鍛攽椤斿浠滈柛瀣崌閺岀喖顢欓崫鍕紙閻庤娲橀〃濠傜暦濡ゅ懎绀傞柤娴嬫櫅瀵ゆ椽姊婚崒姘偓椋庣矆娓氣偓楠炲鍨剧搾浣规そ閺佸啴宕掑顒€浜跺┑掳鍊х徊浠嬪疮椤栫偛纾婚柛灞惧搸閳ь剚甯掗～婵嬫晲閸涱剙顥氬┑?            return InteractionResult.PASS;
        }
        return super.interactAt(player, hitVec, hand);
    }



    // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗霉閿濆浜ら柤鏉挎健濮婃椽顢楅埀顒傜矓閻㈢纾婚柨鐔哄У閻撴瑩鏌熼婊冾暭妞ゃ儱顦伴〃銉╂倷椤忓嫮浼堥梺鍝勮嫰缁夌懓鐣烽锕€绀嬫い鎰枎娴滃墽鎲搁悧鍫濈瑨缂佺嫏鍥ㄧ厵闂傚倸顕崝宥夋煃闁垮绗掗棁澶愭煥濠靛棙鍣洪柛鐔哄仱閺屾盯鎮㈤崫鍕勃闂侀潧娲ょ€氱増淇婇幖浣肝ㄩ柨鏇楀亾婵炲拑缍侀弻锝夊箻閸楃偐鍋撳┑瀣摕闁哄洨鍠撶弧鈧棅顐㈡处閹告儳危閿濆應鏀?
    private void performUpgrade(int newTier) {
        setTier(newTier);

        this.entityData.set(UPGRADE_PROGRESS, 0);

        this.entityData.set(IS_BRUTAL, false);
        this.entityData.set(DATA_HEAT, 0);
        this.shotCounter = 0;
        this.overheatCooldown = 0;

        updateStatsAndEquip();

        if (this.level() instanceof ServerLevel level) {
            ItemStack fireworkItem = new ItemStack(Items.FIREWORK_ROCKET);
            CompoundTag tag = fireworkItem.getOrCreateTagElement("Fireworks");
            ListTag explosions = new ListTag();
            CompoundTag explosion = new CompoundTag();
            explosion.putByte("Type", (byte)4);
            explosion.putIntArray("Colors", new int[]{0xFF0000, 0x00FF00, 0x0000FF, 0xFFFF00});
            explosion.putBoolean("Trail", true);
            explosions.add(explosion);
            tag.put("Explosions", explosions);
            tag.putByte("Flight", (byte)1);

            FireworkRocketEntity rocket = new FireworkRocketEntity(level, this.getX(), this.getY(), this.getZ(), fireworkItem);
            level.addFreshEntity(rocket);

            this.playSound(SoundEvents.UI_TOAST_CHALLENGE_COMPLETE, 1.0f, 1.0f);
        }

        String newAbility = getNewAbilityDesc(newTier);
        this.level().players().forEach(p -> {
            if (p.distanceToSqr(this) < 400) {
                p.sendSystemMessage(Component.literal("[Upgrade] " + this.getDisplayName().getString() + " tier upgraded."));
                p.sendSystemMessage(Component.literal("闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗ù锝堟缁€濠傗攽閻樿弓杩规繛鎴炵瀹曞鏌曟繝蹇曠暠閹? 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煟閵忋埄鐒剧紒鎰殜閺岀喖骞嶉纰辨毉闂佺顑戠换婵嗩嚕閸洖閱囨慨姗嗗幗閻濇牜绱撴担鎻掍壕婵犵數濮撮崐鍫曞焵椤掍礁绗掓い顐ｇ箞閺佹劙宕ㄩ鈧ˉ姘舵⒑鐠囨彃顒㈡い鏃€鐗犲畷浼村箻鐠囪尙顦梺纭呮彧缁犳垿寮告笟鈧弻鐔兼焽閿曗偓楠炴牜绱掗崜浣镐槐闁诡喗顨婇弫鎰償濠靛牆鍤梻浣风串缂嶄焦绂嶇捄渚綎缂備焦蓱婵挳鏌﹀Ο鐚寸礊闁瑰墽绮悡銉︽叏濮楀棗骞戝ù婊勭矒閺屻劑寮崶璺烘闂佽楠忕粻鎾诲蓟? " + newAbility));
            }
        });
    }

    public String getNewAbilityDesc(int tier) {
        return switch (tier) {
            case 1 -> "Unlock: crowd-control pulse (short knockback).";
            case 2 -> "Unlock: armor-piercing rounds.";
            case 3 -> "Unlock: tactical overdrive burst.";
            case 4 -> "Unlock: multi-shot suppression + evasive weave.";
            case 5 -> "Unlock: legendary protocol (all modules empowered).";
            default -> "No new ability.";
        };
    }


    // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犵厱婵﹩鍘介妵婵嗏攽闄囬崺鏍ь嚗閸曨厸鍋撻敐搴濈胺婵″弶鍔欏缁樼瑹閳ь剙顭囪婢ф繈姊洪崫鍕櫤闁烩晩鍨堕獮蹇涘箣閿旇棄浜滈柣蹇撶箣閻掞箓寮埀顒勬⒒娴ｈ櫣甯涢拑杈╂喐閺夊灝鏆ｆい銏℃椤㈡棃宕奸悢鍝勫箞闂備胶绮濠氣€﹂崼銉﹀€堕柟缁㈠枟閻撴盯鎮橀悙鎻掆挃闁宠棄顦甸弻宥夋寠婢舵ɑ鈻堥悗瑙勬穿缁绘繈骞冨▎鎾崇闁圭儤绻傛俊褎绻濋悽闈浶㈤柣銉ヮ樀婵″爼宕ㄩ娑卞殑闂傚倷娴囧銊х矆娓氣偓閳ワ箑鐣￠柇锕€娈ㄩ柣鐘叉处缁佹潙危閸喐鍙忔俊銈傚亾婵☆偅鐩畷锝夊幢濞戞瑢鎷洪梺鍛婄☉閿曘倖鎱ㄩ敃鍌涚厱婵☆垱浜介崑銏°亜閵忊剝顥堟い銏★耿婵偓闁抽敮鍋撻柟宄版惈閳规垿鎮欑捄楦挎暱濡炪倖娉﹂崟顓ф锤濠电娀娼ч鍡涙偂閵夆晜鐓涢柛銉厑椤忓牊鍊堕柤纰卞厴閸?
    public void updateStatsAndEquip() {
        int tier = getTier();
        updateCustomName();

        double maxHp = 20.0;
        this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.HEAD, ItemStack.EMPTY);
        this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.CHEST, ItemStack.EMPTY);
        this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.LEGS, ItemStack.EMPTY);
        this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.FEET, ItemStack.EMPTY);

        switch (tier) {
            case 0: // D闂?- 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ帒顦伴弲顏堟偡濠婂啰绠绘鐐村灴婵偓闁靛牆鎳愰娲⒑缂佹ê濮夐柡浣圭摃閵囨劖銈ｉ崘鈹炬嫼缂備緡鍨卞ú鏍ㄦ櫠閼碱剛纾奸悗锝庡亜閻忊晛顭?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁逞屽墾缁犳挸鐣锋總绋款潊闁炽儱鍟跨花銉╂⒒娴ｇ顥忛柛瀣╃窔瀹曟洘娼忛埡鍐劶婵犮垼娉涙径鍥磻閹捐绀傚璺猴梗婢规洟姊绘担鍛婂暈婵炴彃绉瑰顒佺瑹閳ь剙鐣烽幋锕€绠婚悹鍥皺椤︺劌顪冮妶搴″箺闁搞劌缍婂畷锝夊幢濞戞瑢鎷洪梺鍛婃尰瑜板啯绂嶉悙鐑樼厱闁绘ɑ鐓￠崣鍕偓瑙勬礃缁捇銆佸鈧幃婊堝幢濡櫣妲ｉ梻鍌欑窔濞佳囨偋閸℃あ娑樷枎閹惧磭鍘遍梺鍦劋椤ㄥ棝鎮￠弴銏″€甸柨婵嗛娴滄繄鈧娲栭惉濂稿焵?
                maxHp = 20.0;
                this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.HEAD, new ItemStack(Items.LEATHER_HELMET));
                this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.CHEST, new ItemStack(Items.LEATHER_CHESTPLATE));
                this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.LEGS, new ItemStack(Items.LEATHER_LEGGINGS));
                this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.FEET, new ItemStack(Items.LEATHER_BOOTS));
                break;

            case 1: // C闂?- 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴濐潟閳ь剙鍊块幐濠冪珶閳哄绉€规洏鍔戝鍫曞箣閻欏懐骞㈤梻鍌欑濠€閬嶅磿閵堝鈧啴宕ㄩ婊呭箵濠德板€撻悞锕傚矗韫囨柧绻嗘い鏍ㄥ搸娴犳帡鏌涘鐓庝簽缂佽鲸甯￠崺鈧?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁逞屽墾缁犳挸鐣锋總绋款潊闁炽儱鍟跨花銉╂⒒娴ｇ顥忛柛瀣╃窔瀹曟洘娼忛埡鍐劶婵犮垼娉涙径鍥磻閹捐绀傚璺猴梗婢规洟姊绘担鍛婂暈婵炴彃绉瑰顒佺瑹閳ь剙鐣烽幋锕€绠婚悹鍥皺椤︺劌顪冮妶搴″箺闁搞劌缍婂畷锝夊幢濞戞瑢鎷洪梺鍛婃尰瑜板啯绂嶉悙鐑樼厱闁绘娅曞畷宀€鈧娲╃紞浣哥暦閻旂⒈鏁嗛柛灞剧矤閸熷酣姊洪崫鍕垫Ц闁绘妫欓弲鑸电鐎ｎ亞鐣烘繝闈涘€搁幉锟犳偂閺囥垹绠归悗娑欘焽閳藉鏌嶈閸撴氨鎹㈤崒鐑嗘晪?
                maxHp = 50.0;
                this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.HEAD, new ItemStack(Items.IRON_HELMET));
                this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.CHEST, new ItemStack(Items.IRON_CHESTPLATE));
                this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.LEGS, new ItemStack(Items.IRON_LEGGINGS));
                this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.FEET, new ItemStack(Items.IRON_BOOTS));
                break;

            case 2: // B闂?- 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌熼梻瀵割槮缁炬儳顭烽弻锝夊箛椤掍焦鍎撶紓浣哄С閸楁娊寮婚悢鐓庣畾闁绘鐗滃Λ鍕磽閸屾瑨顔夐柡鍛Т椤曪綁宕奸弴鐐哄敹濠殿喗锕╅崢浠嬫偟閺嶎偆纾?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁逞屽墾缁犳挸鐣锋總绋款潊闁炽儱鍟跨花銉╂⒒娴ｇ顥忛柛瀣╃窔瀹曟洘娼忛埡鍐劶婵犮垼娉涙径鍥磻閹捐绀傚璺猴梗婢规洟姊绘担鍛婂暈婵炴彃绉瑰顒佺瑹閳ь剙鐣烽幋锕€绠婚悹鍥皺椤︺劌顪冮妶搴″箺闁搞劌缍婂畷锝夊幢濞戞瑢鎷洪梺鍛婃尰瑜板啯绂嶉悙鐑樼厱闁绘娅曞畷宀€鈧娲忛崹浠嬬嵁閹烘嚦鏃€鎷呴崣澶婎伖闂傚倷娴囧畷鐢稿窗閺嶎厼纾诲┑鐘叉搐閸氬綊鏌ｉ弬璺ㄦ闁衡偓閼恒儯浜滈柡鍐ㄥ€告禍楣冩煛閸♀晛澧伴柍?
                maxHp = 100.0;
                this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.HEAD, new ItemStack(Items.GOLDEN_HELMET));
                this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.CHEST, new ItemStack(Items.GOLDEN_CHESTPLATE));
                this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.LEGS, new ItemStack(Items.GOLDEN_LEGGINGS));
                this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.FEET, new ItemStack(Items.GOLDEN_BOOTS));
                break;

            case 3: // A闂?- 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箳閳ь剙绠嶉崕鍗炍涘▎鎰灁閻庨潧鎽滅壕鍏笺亜閺嶃劎鈯曠紒鈧埀顒佺箾鐎涙鐭岄柛瀣尰缁岃鲸绻濋崶顬囨煕濞戝崬鏋涙繛鍜冪悼缁?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁逞屽墾缁犳挸鐣锋總绋款潊闁炽儱鍟跨花銉╂⒒娴ｇ顥忛柛瀣╃窔瀹曟洘娼忛埡鍐劶婵犮垼娉涙径鍥磻閹捐绀傚璺猴梗婢规洟姊绘担鍛婂暈婵炴彃绉瑰顒佺瑹閳ь剙鐣烽幋锕€绠婚悹鍥皺椤︺劌顪冮妶搴″箺闁搞劌缍婂畷锝夊幢濞戞瑢鎷洪梺鍛婃尰瑜板啯绂嶉悙鐑樼厱闁绘娅曞畷宀€鈧娲╃紞浣哥暦濮椻偓椤㈡瑧鎲撮敐鍡楊伖闂傚倷鑳剁划顖炲箰閸濄儮鍋撻崹顐㈢瑨妞ゎ厼娲幃銏ゅ礂閼测晛骞堝┑鐘垫暩婵挳宕悧鍫熸珷闁汇垻顣介崑?
                maxHp = 150.0;
                this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.HEAD, new ItemStack(Items.DIAMOND_HELMET));
                this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.CHEST, new ItemStack(Items.DIAMOND_CHESTPLATE));
                this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.LEGS, new ItemStack(Items.DIAMOND_LEGGINGS));
                this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.FEET, new ItemStack(Items.DIAMOND_BOOTS));
                break;

            case 4: // S闂?- 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弴鐐测偓鍝ュ鐠恒劉鍋撶憴鍕婵炶绠戦悾鐑藉蓟閵夛妇鍘甸柣搴㈢⊕椤洨绮婚妷锔剧閻忓繑鐗楀▍濠囨煛鐏炵偓绀冪紒缁樼洴閹瑩顢楁担鍝勭到闂?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁逞屽墾缁犳挸鐣锋總绋款潊闁炽儱鍟跨花銉╂⒒娴ｇ顥忛柛瀣╃窔瀹曟洘娼忛埡鍐劶婵犮垼娉涙径鍥磻閹捐绀傚璺猴梗婢规洟姊绘担鍛婂暈婵炴彃绉瑰顒佺瑹閳ь剙鐣烽幋锕€绠婚悹鍥皺椤︺劌顪冮妶搴″箺闁搞劌缍婂畷锝夊幢濞戞瑢鎷洪梺鍛婄☉閿曘儲寰勯崟顖涚厱婵☆垳绮崐鎰偓娈垮枟閹倸顕ｆ禒瀣垫晣闁绘柨鎼獮妤呮⒑閻熸澘鎮戦柟顖氱焸瀹曠懓鐣烽崶鈺冪厠闂佹眹鍨归幉锟犳偂閺囥垺鐓欓柛鎾楀本顥撴繝銏ｎ潐閿曘垽寮诲鍥ㄥ珰闁肩⒈鍎疯閳ь剚顔栭崰妤呭箰閾忣偅鍙忛柍褜鍓熼弻銊モ槈濡警浠煎Δ鐘靛仜閻楀﹦鎹㈠┑鍡忔灁闁割煈鍠楅悘宥夋⒑閹稿孩纾甸柡鍛Т閻ｅ嘲顭ㄩ崘锝嗩潔濠电偛妫欓崝鏍偟閻戣姤鈷戦柟绋垮缁€鈧梺绋匡工缂嶅﹪骞?
                maxHp = 250.0;
                this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.HEAD, new ItemStack(Items.NETHERITE_HELMET));
                this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.CHEST, new ItemStack(Items.NETHERITE_CHESTPLATE));
                this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.LEGS, new ItemStack(Items.NETHERITE_LEGGINGS));
                this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.FEET, new ItemStack(Items.NETHERITE_BOOTS));
                break;

            case 5: // L闂?- 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐偓锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫晲閸涱剙顥氶梻鍌欐祰椤曟牠宕锕€骞㈡繛鍡樺灦濠㈡垶绻濋悽闈涗沪闁搞劌鐖奸垾锕傚炊椤?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁逞屽墾缁犳挸鐣锋總绋款潊闁炽儱鍟跨花銉╂⒒娴ｇ顥忛柛瀣╃窔瀹曟洘娼忛埡鍐劶婵犮垼娉涙径鍥磻閹捐绀傚璺猴梗婢规洟姊绘担鍛婂暈婵炴彃绉瑰顒佺瑹閳ь剙鐣烽幋锕€绠婚悹鍥皺椤︺劌顪冮妶搴″箺闁搞劌缍婂畷锝夊幢濞戞瑢鎷洪梺鍛婄☉閿曘儲寰勯崟顖涚厱婵☆垳绮崐鎰偓娈垮枟閹倸顕ｆ禒瀣垫晣闁绘柨鎼獮妤呮⒑閻熸澘鎮戦柟顖氱焸瀹曠懓鐣烽崶鈺冪厠闂佹眹鍨归幉锟犳偂閺囥垺鐓欓柛鎾楀本顥撴繝銏ｎ潐閿曘垽寮诲鍥ㄥ珰闁肩⒈鍎疯閳ь剚顔栭崰妤呭箰閾忣偅鍙忛柍褜鍓熼弻銊モ槈濡警浠煎Δ鐘靛仜閻楀﹦鎹㈠┑鍡忔灁闁割煈鍠楅悘宥夋⒑閹稿孩纾甸柡鍛Т閻ｅ嘲顭ㄩ崘锝嗩潔濠电偛妫欓崝鏍偟閻戣姤鈷戦柟绋垮缁€鈧梺绋匡工缂嶅﹪骞?+ 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈢粯淇婇悙顏勨偓鏍偋濠婂牆纾绘繛鎴欏灩閸ㄥ倿鏌涘畝鈧崑鐐烘偂閻斿吋鐓忛煫鍥ь儏閻掓椽鏌ｉ幒鎴濃挃缂佽鲸甯￠崺鈧い鎺戝绾惧吋绻涢幋鐐垫噧鐎殿喖鐏濋埞鎴︽晬閸曨偂鍝楀銈嗘肠閸曨収娲告俊銈忕到閸燁垶鍩涢幋锔藉仯闁搞儻绲洪崑鎾崇暦閸ワ箑鎽嬮梻鍌欑閹芥粓宕伴幇顒夌劷婵炲棙鎸婚崑鈺呮煟閹达絽袚闁稿瀚惀顏堝箯瀹€鍕懙闂佸搫鎷嬮崜娆撳煘閹达附鍋愰柟闈涚Т閻楁挸鐣烽幋锕€绠婚柛鎾茶兌閿涙粓姊洪棃娑辩劸闁告柨鏈粋宥夊捶椤撶姷锛滈柡澶婄墑閸斿秴鐣峰畝鈧埀顒冾潐濞叉鏁幒妤嬬稏婵犻潧顑呯涵鈧梺缁樺灥濡瑥袙閸ヮ剚鈷掗柛灞剧懆閸忓矂鏌熼搹顐ｅ磳鐎规洦鍨抽幑鍕Ω閿曗偓鎼村﹤鈹戦埥鍡楃仴婵炲拑缍佸鎶芥晜閻愵剙鏋戦梺缁橆殔閻楀棛绮幒妤€绠氶柣鏂垮悑閳锋垿鎮楅崷顓炐ｉ柕鍡楀暣閺屻倝宕橀懠顒€鐓熼柦妯荤箘閹叉悂寮▎鐐稁濠电偛妯婃禍婊勫閻樼粯鐓曢柡鍥ュ妼楠炴牠鏌嶉鍫滄喚婵﹦鍎ゅ顏堝箥椤旂厧顬夐梻浣筋嚃閸犳牠宕愰崹顕呭殨闁哄嫬娴氬Ο鍕倵鐟欏嫭绀冮悽顖ょ節楠炲啫鈻庨幘宕囬獓闂佺懓鐡ㄧ划搴ㄥ极閻愵剛绡€闁汇垽娼ф禒鈺呮煙濞茶绨界€垫澘锕ョ粋鎺斺偓锝庝簽閻ゅ懘姊虹捄銊ユ灁濠殿喗鎸冲畷銉ㄣ亹閹烘挾鍘遍梺闈涱樈閸犳牗鏅堕鐐寸厽?
                maxHp = 500.0;
                this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.HEAD, new ItemStack(Items.NETHERITE_HELMET));
                this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.CHEST, new ItemStack(Items.NETHERITE_CHESTPLATE));
                this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.LEGS, new ItemStack(Items.NETHERITE_LEGGINGS));
                this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.FEET, new ItemStack(Items.NETHERITE_BOOTS));
                break;
        }

        // 闂?缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐偓锝庝簼閹癸絿绱掗埀顒佺節閸ャ劎鍘撻悷婊勭矒瀹曟粓鎮㈤悡搴ゆ憰濠电偞鍨崹褰掑础閹惰姤鐓忓┑鐐茬仢閸旀瑩鏌ら崜韫盎闁宠鍨块崺銉╁幢濡炴儳顥氱紓鍌欒兌缁垳鎹㈤崒鐑囩稏闊洦鎷嬪ú顏嶆晜闁告洦浜為悙濠囨⒒娴ｅ憡鍟炴繛璇х畵瀹曟垿宕ㄩ弶鎴炶緢闂侀潧绻堥崐鏍煕閹达附鐓曟繛鎴烇公瀹搞儱鈹戦鍡欑暠闂囧绻濇繝鍌氼伀闁活厽甯￠幐濠傗攽鐎ｎ偆鍘撻梺鍛婄箓鐎氼參宕冲ú顏呯厓闂佸灝顑呭ù顕€鏌＄仦鍓с€掑ù鐙呯畵楠炴垿骞囬澶嬵棨濠碉紕鍋戦崐鏇犳崲閸℃稑鐤鹃柣妯款嚙缁犳牗淇婇妶鍌氫壕濡炪値鍋呯换鍫ャ€侀弴銏狀潊闁绘鍋ｉ崑鏍⒒閸屾瑦绁版い鏇熺墵瀹曟澘螖閳ь剟鈥旈崘鈺冾浄閻庯綆浜為悾娲⒑闂堟稓绠為柛濠冩礈缁牓宕掗悙瀵稿幘濠电偞娼欓鍡椻枍閸涱厸鏀芥い鏃€鍎抽崢瀛樻叏婵犲嫮甯涢柟宄版嚇瀹曘劍绻濋崘銊ュ闂備浇顕х€涒晠宕欒ぐ鎺戠婵炴垯鍨圭粻鏌ユ煏韫囧鈧洜绮婚幎鑺ョ厸闁告劧绲芥禍楣冩⒑?
        ItemStack oldBow = this.getItemBySlot(net.minecraft.world.entity.EquipmentSlot.MAINHAND);
        ItemStack newBow = new ItemStack(Items.BOW);
        if (oldBow.isEnchanted()) {
            newBow.setTag(oldBow.getTag());
        }
        this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.MAINHAND, newBow);

        // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰级閻ゅ嫬鈹戞幊閸娧呭緤娴犲鐤い鎰╁€愰崑鎾愁潩椤掑效闂侀潧娲ょ€氫即鐛幒妤€绠ｆ繝鍨姃缁辨繈姊绘担鑺ャ€冪紒鈧担鑲濇稑鈹戠€ｎ亣鎽曢梺鎸庣箓椤︻垳绮诲☉娆嶄簻闁瑰搫妫楁禍楣冩⒑鐠団€虫灆闁绘帪濡囬幑銏犫槈濡吋娈曟繝鐢靛С缁舵岸宕戝Δ鍛拺闁告繂瀚悞璺ㄧ磽瀹ュ嫮绐旈柣娑卞櫍瀹曞爼顢楁径瀣珦闂備胶顭堢换鎰邦敄閸涙鍥偨缁嬭儻鎽曞┑鐐村灦閸╁啴宕戦幘缁樻櫜閹肩补鈧尙鍑归柣搴ゎ潐濞叉牜鈧凹鍙冩俊鐢稿礋椤栨稒娅嗛梺浼欑到閼活垰顕ｉ妸鈺傗拺?Attribute 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亜顒㈡い鎰矙閺屻劑鎮㈤崫鍕戙垽鏌涢妸銉モ偓鍨潖婵犳艾閱囬柣鏃€浜介埀顒佸浮閺岋繝宕遍鐘垫殼闂佸搫鐭夌紞浣规叏閳ь剟鏌曢崼婵囶棡闂佹鍙冨?(缂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙闁诡垳鍋ら獮鏍庨鈧俊濂告煟椤撶噥娈滄鐐寸墪鑿愭い鎺嗗亾濠德ゅ亹缁辨帡骞囬褎鐤侀梺鍝勭焿缁绘繂鐣烽崼鏇炵厸濞达絽娴勭徊鍧楀焵?UI 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犖ч柛灞剧煯婢规洖鈹戦绛嬬劷闁告鍕珷妞ゆ牜鍋為悡娑㈡煕濞戞瑦绶查柣鎾村姉缁辨帡宕掑☉妯碱儌闂侀€炲苯澧剧紓宥呮閸┾偓妞ゆ帒顦鍧楁⒒閸曨偄顏鐐茬墦婵℃悂濡烽钘夌紦闂備胶纭堕崜婵嬨€冮崨鏉戠厱闁圭儤鍨熼弨浠嬫煟閹邦喖鍔嬮柨娑氬枛閺屾稑螖娴ｇ硶鏋欓悗娈垮枛椤攱淇婇幖浣肝ㄩ柕蹇婂墲閺夋悂姊绘担铏广€婇柛鎾寸箞閳ワ箓宕堕锕€娲弻鍡楊吋閸″繑瀚?
        // 1. 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弴鐐测偓褰掑磿閹寸姵鍠愰柣妤€鐗嗙粭鎺楁煕閵娿儱鈧悂鍩為幋锔藉亹閻庡湱濮撮ˉ婵堢磽娴ｇ懓濮堟い銊ワ躬閻涱噣寮介‖銉ラ叄椤㈡鍩€椤掍椒绻嗛柤娴嬫櫇绾惧ジ鏌ｅ鈧褔鍩㈤崼銉︾厸閻忕偠顕ф慨鍌炴煙椤斿搫鐏茬€规洦鍋婂畷鐔煎箣椤栨粎袦闂?
        Objects.requireNonNull(this.getAttribute(Attributes.MAX_HEALTH)).setBaseValue(maxHp);
        this.setHealth((float) maxHp);

        // 2. 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ巻鍋撴潻婵嬫⒑闁偛鑻晶鎾煛鐏炲墽銆掗柍褜鍓ㄧ紞鍡涘磻閸涱厾鏆︾€光偓閸曨剛鍘靛銈嗘閸嬫劗绮旈搹鍏夊亾鐟欏嫭绀€闁绘牕鍚嬫穱濠囧箹娴ｈ倽銊ф喐韫囨稑围闂佸灝顑囩弧鈧┑鐐茬墕閻忔繂鈻嶅▎鎴犵＜闂婎偒鍘鹃惌娆撴煛娴ｇ鏆ｅ┑陇鍩栧鍕偓锝庡墰閺嗐垻绱撻崒姘偓鎼佸磹閻戣姤鍊块柨鏇炲€堕埀顒€鍟村畷銊╁级閹寸媭鍟囨俊鐐€栭崝褏绮婚幋锔藉€块柛顭戝亖娴滄粓鏌熼崫鍕ら柛鏂跨Ф缁辨帡鍩€椤掑倵鍋撻敐搴′簴濞?(4 + tier * 5)
        double dmg = getWeaponDamageForTier(tier);
        if (this.getAttribute(Attributes.ATTACK_DAMAGE) != null) {
            this.getAttribute(Attributes.ATTACK_DAMAGE).setBaseValue(dmg);
        }

        // 3. 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缂佺姷濞€閺岀喖骞戦幇闈涙闁荤喐鐟辩粻鎾诲箖濡ゅ懏鏅查幖绮光偓鎰佹交闂備焦鎮堕崝宥囨崲閸儳宓侀柡宥庣仈鎼搭煈鏁嗛柍褜鍓氭穱濠囨嚃閳哄啯锛?闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ巻鍋撴潻婵嬫⒑闁偛鑻晶鎾煛鐏炲墽銆掗柍褜鍓ㄧ紞鍡涘磻閸涱厾鏆︾€光偓閸曨剛鍘靛銈嗘閸嬫劗绮旈搹鍏夊亾鐟欏嫭绀€闁绘牕鍚嬫穱濠囧箹娴ｈ倽銊ф喐韫囨稑围闂佸灝顑囩弧鈧┑鐐茬墕閻忔繂鈻嶅▎鎴犵＜闂婎偒鍘鹃惌娆撴煛娴ｇ鏆ｆい銏℃瀹曠厧鈹戞繝鍐╁暫闂傚倷绶氬褔鎮ч崱娴板洦瀵奸弶鎴狅紱闂佺鐬奸崑娑氱不閸︻厾纾兼い鏃傚亾閸も偓婵犫拃鍐ㄧ骇缂佺粯鐩畷濂割敃閵忕姷顔愰梻?
        double range = getAttackRange();
        if (this.getAttribute(Attributes.FOLLOW_RANGE) != null) {
            this.getAttribute(Attributes.FOLLOW_RANGE).setBaseValue(range);
        }

        // Keep physics in sync with profile after any tier/equipment recompute path.
        this.refreshMobilityProfileFromTier();
    }

    public void incrementKillCount() {
        this.entityData.set(KILL_COUNT, this.entityData.get(KILL_COUNT) + 1);

        // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱樈閸犳顕欏ú顏呪拺缂侇垱娲栨晶鍙夈亜閵娿儲鍤囬柛鈺傜洴楠炴帡骞嬮弮鈧弬鈧梻浣虹帛閸旀浜稿▎蹇ヨ€块柟缁㈠枟閻撴洖鈹戦悩鎻掓殶缂佺姷鍋熼埀顒侇問閸犳牠鈥﹂悜钘夋瀬鐎广儱顦粈瀣煏婵炲灝鍔欏瑙勬礋濮婃椽骞愭惔锝囩暤婵°倗濮撮幉锛勭矉瀹ュ鍊烽柣鎴烆焽閸樿棄顪冮妶鍡樺暗闁稿孩鍔欏畷鏇㈠箛椤戙垹閰ｅ畷鎯邦檪闂婎剦鍓熼弻鐔风暦閸パ€鏋呭銈冨灪椤ㄥ棗顕ラ崟顓濇勃闁芥ê锛嶉鍫熲拻闁稿本鐟х粣鏃€绻涙担鍐插悩濞戞ǚ鏋庨柟瀵稿仦濞堜即姊洪悙钘夊姎缁剧虎鍙冨鎶芥晝閸屾稓鍘繝鐢靛仧閸嬫挸鈻嶉幘缁樼厸濞达絽鎲￠崰姗€鏌″畝瀣М妤犵偛顑呴埞鎴﹀炊閼哥绱掗梻鍌欑劍鐎笛呯矙閹扮増鍊块柨鏃傚亾瀹曞弶绻濋棃娑氬闁哄鐗婃穱濠囶敍濞戞瑣浠у┑鐐插悑閸ㄥ灝顫忓ú顏勭闁肩⒈鍓欑敮銉︾箾鐎涙鐭ゅù婊庝簻閻ｅ嘲煤椤忓嫮鍔﹀銈嗗笂闂勫秵绂嶅鍫熺厵闁告繂瀚ˉ婊兠瑰鍐ㄢ挃缂佽鲸甯″畷婊嗩樁婵＄偓鎮傞弻娑樜熺拠鎻掑Б闂佸疇妫勯ˇ鐢稿箖閻ｅ瞼鐭欓悹鎭掑妼婵附淇婇悙顏勨偓鏍暜閹烘柡鍋撳鐓庡籍闁糕晜鐩獮瀣晜閻ｅ苯骞嶇紓鍌欑椤戝棛鈧瑳鍥х闁挎繂顦伴悡鍐煢濡警妯堟俊顖楀亾闂備礁鎼悮顐﹀磹閺囩姴寮查梺鑽ゅТ濞测晝浜稿▎鎰浄闁冲搫鎳忛埛鎴澝归崗鑲╂噮闁诡喖銈搁弻娑滅疀閺冩捁鈧寧顨ラ悙鎻掓殻濠殿喒鍋撻梺闈涚墕閹虫劙藝瑜斿铏圭磼濡纰嶇紓浣靛妼閵堢顕ｉ崼鏇ㄦ晣闁绘柨澧庣粻姘舵⒑缂佹ê濮﹀ù婊勭矒閸┾偓妞ゆ帊鑳舵晶閬嶆煛娓氬洤娅嶆鐐村笒铻栭柍褜鍓涚划锝呂旀担鐟板伎濠碘槅鍨辩€笛呮兜妤ｅ啯鐓犵紒瀣硶缁夋椽鏌＄仦鍓ф创妞ゃ垺娲熼弫鎰板幢濞嗘ɑ袨闂?
        if (this.isPurgeActive()) {
            this.purgeKillCount++;
        }

        checkKillUpgrade();
    }

    @Override
    public void awardKillScore(Entity killedEntity, int scoreValue, DamageSource damageSource) {
        super.awardKillScore(killedEntity, scoreValue, damageSource);

        if (this.level().isClientSide) {
            return;
        }
        if (!(killedEntity instanceof LivingEntity living)) {
            return;
        }
        if (!shouldCountForUpgrade(living)) {
            return;
        }
        incrementKillCount();
    }

    private boolean shouldCountForUpgrade(LivingEntity target) {
        if (target == this) return false;
        if (target instanceof Player) return false;
        if (target instanceof SkeletonTurret) return false;
        if (target instanceof net.minecraft.world.entity.decoration.ArmorStand) return false;
        if (target instanceof IronGolem) return false;
        if (target.getPersistentData().getBoolean("IsFriendlyZombie")) return false;
        if (target.getPersistentData().getBoolean("IsFriendlyCreeper")) return false;
        return true;
    }
    // 闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃繘鍩€椤掍胶鈻撻柡鍛█閵嗕礁鈻庨幘鍐插敤濡炪倖鎸鹃崑鐔兼偘閵夆晜鈷戦柛锔诲幖閸斿銇勯妸銉﹀櫧濠㈣娲樼换婵嗩潩椤撶姴骞嶉梻浣告啞閹稿棝宕ㄩ鐙€鍋ч梻鍌欒兌缁垶骞愮拠瑁佸搫顫滈埀顒勭嵁閸儱惟闁靛娴烽崰鏍箖閳╁啯鍎熼柍銉ㄥ皺鐢盯姊婚崒娆愮グ妞ゆ泦鍕垫闊洦娲橀～鏇㈡煛閸モ晛校妞ゎ偅娲熼弻鐔兼倻濮楀棙鐣跺┑鈽嗗亝钃辩紒缁樼洴瀹曞崬螖閳ь剟鍩涢弮鍫熺厱婵﹩鍓﹂崕鏃堟煙椤旂瓔娈橀柟鍙夋尦瀹曠喖顢楅崒銈喰炵紓鍌氬€风欢锟犲窗濡ゅ懎绠查柛銉墯閸嬫ɑ銇勯弴妤€浜惧Δ鐘靛仜濞差參鐛澶樻晩闁兼祴鏂傞崑濠囨⒒閸屾瑨鍏岀紒顕呭灦閳ワ箓宕奸悢渚锤濡炪倖甯掗崐濠氭偝婵犳碍鐓涢柛鎰╁妿婢ф盯鏌?(闂?ExampleMod 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箻閺岀喓绱掗姀鐘崇彯闂佽桨绀佺€氫即寮诲☉妯锋婵炲棙鍔楃粙鍥⒑濮瑰洤鈧倝宕伴弽顓熺畳闂備胶顭堢换鎰板触鐎ｎ剛绀婇柟杈鹃檮閻?
    public void startPurgeMode(float angle) {
        this.entityData.set(IS_PURGE_ACTIVE, true);
        this.purgeKillCount = 0; // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓闁搞劌鍊块弻娑㈩敃閿濆棛顦ョ紓浣哄С閸楁娊骞冭ぐ鎺戠倞鐟滃酣鍩㈤弴鐔虹閻忓繑鐗楀▍濠囨煛鐏炵偓绀冪紒缁樼洴閹瑩顢楁担鍝勭到婵犵數鍋熼ˉ鎰板磻閹邦厽鍙忛柛顭戝亞閳瑰秴鈹戦悩鍙夋悙閸ユ挳姊洪崨濠佺繁闁告瑥瀛╃粋鎺斺偓娑欘焽缁犻箖鎮楀☉娆樼劷闁活厼锕︾槐鎾愁吋閸滃啳鍚悗娈垮枛椤兘骞冮姀銈呯闁绘挸绨堕崑鎾剁磼濡寮垮┑掳鍊愰崑鎾翠繆椤愶絿鎳囬柟顔惧亾椤︾増鎯旈敐鍥风闯?
        this.purgeSearchAngle = angle; // 婵犵數濮烽弫鍛婃叏閻戝鈧倿鎸婃竟鈺嬬秮瀹曘劑寮堕幋鐙呯幢闂備礁鎲℃笟妤呭矗鎼淬劍鍋勯柛鈩兠肩换鍡樸亜閺嶃劎鎳呯紒澶嬪缁绘盯骞嬮悜鍡欏姱闂佸搫鍟悧鍡欑矆鐎ｎ喗鐓冮悶娑掆偓鍏呭婵犳鍠涢～澶愩€冩繝鍌ゆ綎婵炲樊浜滅粈鍫ユ煙缂佹ê绗傜紒銊ょ矙濮婃椽宕妷銉愶綁鏌熼悷鐗堝枠濠碘剝鎸冲畷銊р偓娑櫭埀顒€顭烽弻銈夊箒閹烘垵濮庢繛瀵稿閸ㄨ泛顫忓ú顏勭闁绘劖褰冩慨宀勬⒑閸涘﹥鐓ラ柣顒傚帶椤曘儲绻濋崟顓狅紲濠碘槅鍨堕弲鑼姳鐠囧樊娓婚柕鍫濇婵鈹戦鑺ュ唉闁糕斁鍋撳銈嗗笂閼冲墎绮婚悙纰樺亾濞堝灝鏋涙い顓犲厴瀵偊骞樼紒妯轰汗闂佽偐鈷堥崜銊ф閸欏绡€闁汇垽娼у瓭闂佹寧娲忛崐妤呭焵椤掍礁鍤柛鎾寸懇閸┿垽骞樺畷鍥ㄦ畷闂佸憡娲﹂崗姗€骞?
        this.setCommandScavenging(false); // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁逞屽墾缁犳挸鐣锋總绋课ㄦい鏃囧Г濞呭牓姊绘担铏广€婇柛鎾寸箞閹兘濡烽埡浣哥€┑鐘绘涧閻楀啴宕戦幘鑽ゅ祦闁割煈鍠栨慨搴☆渻閵堝繒绱扮紒顔界懃椤曪綁顢曢敃鈧獮銏′繆椤栨繂浜规い鏃€娲熷娲偡閹殿喗鎲奸梺鑽ゅ枂閸庣敻骞冨鈧崺锟犲礃椤忓棴绱查梻浣虹帛閿氱痪缁㈠弮瀹曪綁鍩€椤掑嫭鈷戦柛婵嗗鐎氭壆绱掓径搴綈濞ｅ洤锕幃婊堟寠婢光斂鍔庨幉绋库攽閸噥娼熼梺缁樺姉閸庛倝鍩涢幋锔解拺妞ゆ劑鍊曟禒婊堟煠濞茶鐏￠柡鍛板煐缁绘繂顫濋鐘插箞闂備焦瀵х换鍌滄崲閹烘梻鐭撴い鏃堟暜閸?


// 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紓浣哄Х婵炩偓妤犵偞鐗楀蹇涘礈瑜忚摫闁诲氦顫夊ú姗€鎮￠敓鐘茶摕闁绘棁銆€閸嬫挸鈽夊▎妯煎姺婵犵鈧櫕鍠橀柡宀嬬節閸┾偓妞ゆ帒瀚弲婵嬫煕鐏炲墽銆掗柛妯绘崌閹嘲顭ㄩ崟顓犵厜閻庤娲樼划鎾诲箖閵忥紕闄勫璺侯儑缁嬩焦绻濋悽闈涗粶婵☆垰锕ョ粋宥夊醇閺囩偞鐎梺鍛婂姦閸犳鎮¤箛娑氬彄闁搞儜宥嗘暰濠电偛鎳庡Λ婵嗙暦椤栫偛浼犻柕澹拑绱抽梻浣侯焾閺堫剟鎮疯瀹曟繂顓奸崱妯哄伎婵犵數濮撮崐鑽ょ矓閻戞﹩娈介柣鎰綑婵秶鈧娲橀敃銏ゅ箠閻樻椿鏁嗗ù锝堫嚃閸熷酣姊婚崒娆戝妽閻庣瑳鍛床闁稿瞼鍊涢崶顒夋晬婵﹩鍘藉▓浼存⒒閸屾艾鈧娆㈠顒夌劷鐟滄棁妫熷銈嗘尪閸ㄥ湱澹曢崸妤佺厽闁靛繈鍩勯悞楣冩煟椤撶噥娈滈柡灞诲姂閹垽宕崟鎴秮閺?
        String quote = PURGE_QUOTES[this.random.nextInt(PURGE_QUOTES.length)];

        // 闂?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧潡鏌熺€电孝缂佽翰鍊濋弻锕€螣娓氼垱锛嗛悷婊呭鐢帞澹曟總鍛婄厽闁归偊鍨伴惃娲煟濞戞牕鍔︽慨濠冩そ瀹曨偊宕熼娑欑€遍梻浣告啞钃辨俊顐㈠暙閻ｇ兘宕奸弴銊︽櫌闂侀€炲苯澧撮柟閿嬪灴閹垽宕楅懖鈺佸妇濠电姰鍨奸崺鏍儎椤栨凹鐎舵い鏃傛櫕缁犻箖鏌涘☉鍗炴灓濠⒀屼邯閺屽秶鎲撮崟顐や紝濡炪們鍨洪悷褏鍒掗悽纰樺亾閿濆骸澧┑顔惧帶閳规垿鏁嶉崟顐℃勃濠电偛鍚嬮悷鈺呯嵁濡も偓椤劑宕奸悢宄板⒒婵＄偑鍊曠换鎰版偋濠婂牆鏋佺€广儱顦伴悡鐔兼煙闁箑澧婚柛銈囧枛閺屾稑螣閸忓吋姣堝┑顔硷龚濞咃綁骞忛悩璇茬伋闁告劘灏欓鎴︽⒑濮瑰洤鐒洪柛銊ㄤ含閺侇噣鍨惧畷鍥ㄦ濠电娀娼уΛ顓烆焽閳哄懎绾ч柛顐ｇ☉婵″ジ鏌＄€ｎ偄鐏存慨濠冩そ瀹曨偊宕熼崹顐嶏箓姊虹拠鑼缂佽鐗撳畷娲焵椤掍降浜滈柟鐑樺灥閺嗘瑩鏌涘鎰佹綈濞ｅ洤锕畷锝嗗緞婵犲偆娼氭俊銈囧Х閸嬬偟鏁敓鐘靛祦閻庯綆鍠栫猾宥夋煃瑜滈崜鐔煎箖濡や胶绡€婵﹩鍘鹃崢鐢告⒑閻撳孩璐″褎顨夐妵鎰槾缂佽鲸甯楀蹇涘Ω閿旂虎妲梺鍛婎殜娴滃爼寮婚妸銉㈡斀闁糕剝锕╁Λ銈囩磽娴ｅ搫鈻堢紒鐘崇墵楠炲啫螖閳ь剟鍩ユ径濞炬瀻婵☆垳鍘ф慨娲⒒娴ｈ銇熼柛妯恒偢閹矂宕掗悙鑼暫濠碘槅鍨靛▔鏇㈡偪閳ь剟鏌ｆ惔顖滅У濞存粍绮撻垾鏍偓锝庝簴閺€浠嬫煃閵夈儱鏆辩紒鐙欏洦鐓曢柡鍐ｅ亾婵炶尙鍠栧畷娲倷閸濆嫮顓洪梺鎸庢磵閸嬫捇鏌ｉ幇顒婅含闁哄苯绉瑰畷鐑筋敇閻愭澘顥氶梻浣筋嚙缁绘劙宕幘顔艰摕闁挎繂妫欓崕鐔兼煥濞戞ê顏柡鍡樼洴濮婅櫣绮欓崸妤€寮版繛瀛樼矊閻栧ジ鎮伴鐣岀瘈闁告劏鏅涢崝鍛存⒑闂堟侗鐒鹃柛搴㈠▕瀵槒顦查柍瑙勫灴閹瑩宕ｆ径妯伙紒闂備礁婀遍…鍫モ€﹂悜钘夌畺闁跨喓濮撮崡鎶芥煏韫囥儳纾块柛娆忔濮婃椽宕崟顐熷亾閸︻厸鍋撶粭娑樻搐缁犳岸鏌涢锝囧闁衡偓娴犲鐓冮柕澹啩缂撻梺绋款儍閸ㄤ粙寮婚敍鍕勃闁绘劦鍓涢ˇ浼存倵鐟欏嫭绀冮柛搴°偢钘濋柟鎯板Г閻撴洟鏌ｅΟ纰卞姕闁兼澘娼￠弻鈥崇暆閳ь剟宕版惔銊﹀仼闁绘垼妫勯悙濠勬喐婢舵劕鍑犻柛娑樼摠閸婄敻鎮峰▎蹇擃仾缂佲偓閸愵喗鐓ラ柡鍥悘顏勄庨崶褝韬鐐寸墬閹峰懐鎲撮崟顒傚絾闂傚倷娴囬鏍垂鎼淬劌绀冮柍鍝勫暞琚犻梻鍌氬€搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柤纰卞墻濡茬兘姊绘担鍛婃儓婵炲眰鍨藉畷褰掑捶椤撶姳绗夐梺缁橆焾椤曆呯不瑜版帒绾ч柛顐ｇ箓閳锋棃鏌熼鎯у付闁宠棄顦甸獮妯虹暦閸ュ棎鍊濋弻宥堫檨闁告挻鐟х划璇差吋婢跺﹦锛熼梻渚囧墮閸楁洟宕堕妸銉殼闂佸搫顦伴崹褰掑蓟?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲梺姹囧€ら崰妤呭Φ閸曨垰绠涢柍杞拌兌閸旀挳姊洪幖鐐测偓鏍洪悢鐓庤摕婵炴垯鍩勯弫鍐煥濠靛棙顥滄い锔规櫊濮婄儤娼幍顕呮М濠碘槅鍋呴悷褔骞戦姀鐘闁靛繒濮烽鍝勨攽閻愬弶顥滅紒缁樺笚缁傛帗绺介崨濞炬嫼濠电偠灏褔鐛Δ浣典簻闁靛鍎婚煬顒傗偓娈垮枛椤兘骞冮姀銏″仒闁炽儱鍘栨竟鏇炩攽閻愭潙鐏﹂柣鐕佸灦閹偞绂掔€ｎ偆鍘藉銈嗘尵閸嬬喖鎮為幖浣圭厸鐎光偓鐎ｎ剛袦闂佽鍠撻崹钘夌暦椤愶箑唯鐟滃繘寮舵禒瀣拻濞达絽鎲￠幆鍫ユ煛閸偄澧撮柟顖氬椤㈡盯鎮欓棃娑氥偊闂佽鍑界紞鍡涘窗濡ゅ懎纾婚柟鎵閻撴瑧绱撴担濮戭亞绮幒鎾变簻妞ゆ巻鍋撴俊顐ｇ懅閹?
        if (!this.level().isClientSide && this.ownerUUID != null) {
            Player owner = this.level().getPlayerByUUID(this.ownerUUID);
            if (owner != null) {
                // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犖ч柛銉㈡櫇閸樼娀姊绘担绋款棌闁稿鎳庣叅闁哄稁鍘肩壕濂告煏婵炑冨閺嬫垿妫呴銏″闁瑰嘲缍婇弫鎰緞婵犲嫮鏉搁梻浣虹帛椤ㄥ懘鎮ф繝鍌楁瀺闁靛繈鍊栭埛鎴犵磽娴ｇ櫢渚涢柣鎺斿亾缁绘盯宕ㄩ鐣岊槬闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁逞屽墾缁犳挸鐣锋總绋款潊闁炽儱鍟跨花銉╂⒒娴ｇ瓔娼愬鐟版閺呰泛螖閸涱厾锛涢柣搴秵閸犳鎮″▎鎾寸厵閻熸瑥瀚慨锕傛煕閵堝棛鎳呯紒杈ㄦ尰閹峰懘宕ｆ径瀣綃闁诲孩顔栭崰鏍偉閻撳海鏆﹂柣鎾冲瘨濞尖晜銇勯幘璺烘灁鐟滄澘鍟村缁樻媴閾忕懓绗￠柣銏╁灡鐢繝寮崘顕呮晜闁割偆鍠庢禍妤€顪冮妶鍡楀Ё缂佺姵鍨块幃娆愮節閸ャ劎鍘繝鐢靛€埀顒勫磻閹炬枼鏀芥い鏂垮悑閸犳﹢鏌? 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ巻鍋撴潻婵嬫⒑闁偛鑻晶鎾煛鐏炲墽銆掗柍褜鍓ㄧ紞鍡涘磻閸涱厾鏆︾€光偓閸曨剛鍘靛銈嗘閸嬫劗绮旈搹鍏夊亾鐟欏嫭澶勯柛瀣工閻ｇ兘鎮㈢喊杈ㄦ櫌婵炶揪绲块…鍫熺珶瀹ュ鈷掗柛灞剧懆閸忓瞼绱掗鍛仸妤犵偞鍔欓獮鏍ㄦ媴閸濄儻绱梻浣侯潒閸曞灚鐣堕梺钘夊暟閸犳牠寮婚敐澶婄睄闁搞儺鐓堟禒鈺呮⒑濞茶骞楅柣鐔叉櫊瀵鎮㈤搹鍦厯闂佸湱顭堢€涒晛鐣烽幎鑺モ拺缂備焦蓱鐏忎即鏌涢妸銉т虎妞ゎ偄绻橀幖鍦喆閸曨偄骞戦梻浣告啞娓氭宕规导瀛樺亱婵鍩栭埛鎴犵磼鐎ｎ亜鐨￠柡鈧懡銈囩＜閻犲洩灏欐晶鏇熴亜閺囶亞绉い銏℃礋婵偓闁宠桨鐒﹂崐顖炴⒒娴ｈ鍋犻柛搴☆煼濮婁粙宕熼姘鳖槹闂佸憡鍔︽禍鐐靛娴犲鐓曢悘鐐插⒔閹冲洦淇婇崜褍鍘撮柡灞剧洴婵℃悂鈥﹂幋鐐电Х濠电儑绲藉ú銈夋晝閵娾敡鍥╂喆閸曨剙寮挎繝鐢靛Т閸燁垶濡靛┑鍥︾箚妞ゆ劑鍨归弳锝夋煕閳哄绡€鐎规洜鍠栭、妯款槼閺佸牓姊婚崒姘偓椋庣矆娓氣偓楠炲鏁撻悩鑼舵憰闂侀潧臎閸涱垳鍘犻梻浣告啞閹搁绮堟笟鈧畷鐟扳攽鐎ｎ偆鍘撻梺鍛婄箓鐎氼剟鍩€椤掑啫鍚圭€殿啫鍥х劦妞ゆ巻鍋撻柍瑙勫灴椤㈡瑩寮妶鍕繑闂備礁鎲￠幐濠氭嚌妤ｅ啯鍋╅梻鍫熶緱閸氬顭跨捄渚剬闁圭柉娅ｇ槐鎾诲磼濞嗘垵濡藉銈庡幖閻楀﹦绮╅悢鑲虹喎效閸ワ妇鐩庨梻浣告惈濞层垽宕濆畝鍕祦婵☆垯璀﹂悢?
                owner.sendSystemMessage(Component.literal("<" + this.getDisplayName().getString() + "> " + quote));
            }
        }
        this.playSound(SoundEvents.RAVAGER_ROAR, 1.0f, 1.0f); // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿垂妤ｅ啫绠涘ù锝囨嚀閸忓﹪姊绘笟鈧褑澧濋梺鍝勬噺閻╊垰鐣烽幒妤€惟鐟滃酣宕伴幇鐗堢厵閺夊牆澧介悾鍗烆浖閸涘瓨鈷戦柛锔诲幖椤ｅ吋绻濋姀鈭╂垿宕曢锔解拻濞达絿顭堥弳閬嶆煙绾板崬浜扮€规洘鍨垮畷鍗烆渻閵忥紕娲寸€规洏鍔庨埀顒佺⊕鑿ら柟閿嬫そ濮婅櫣鎷犻垾宕団偓濠氭煕閺囥劌寮炬繛鎻掔埣濮婄粯鎷呮笟顖滃姼濡炪倖鍨甸幊姗€鐛繝鍐╁劅闁靛鍎抽崢?
    }

    // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁逞屽墾缁犳挸鐣锋總绋课ㄦい鏃囧Г濞呭牓姊绘担铏广€婇柛鎾寸箞閹兘濡烽埡浣哥€┑鐘绘涧閻楀啴宕戦幘鑽ゅ祦闁割煈鍠栨慨搴☆渻閵堝繒绱扮紒顔界懃椤曪綁顢曢敃鈧獮銏′繆椤栨繂浜规い鏃€娲熷娲偡闁箑娈堕梺绋匡攻閸ㄧ敻鈥﹂妸鈺侀唶婵犻潧鐗嗘慨锔戒繆閻愵亜鈧牜鏁繝鍕焼濞达綀顕氳ぐ鎺濇晩闂佹鍨版禍楣冩偡濞嗗繐顏痪鐐倐閺屾盯寮埀顒勫垂閸ф违濞达絽澹婂銊╂煃瑜滈崜鐔肩嵁閸愵煈鐓ラ柛顐ｇ箓閼板灝鈹戦绛嬫當闁绘绻掓竟鏇㈠礂閼测晝鐦堥梺姹囧灲濞佳冩毄婵＄偑鍊х紞鈧俊顐㈠瀹撳嫰姊洪崨濠勨姇婵炲吋鐟╁畷褰掑磼濞戞牔绨婚棅顐㈡处閹哥偓鏅堕弴銏＄厽闁圭儤鍨规禒娑㈡煏閸パ冾伃妤犵偞甯″畷鍗烆渻閹屾缂傚倸鍊风粈浣规櫠娴犲鎯為幖娣妼閸屻劑鏌熼鍡忓亾婵℃彃鐗撻弻锝夊閵忊晝鍔搁梺?
    public void stopPurgeMode() {
        if (!isPurgeActive()) return;

        this.entityData.set(IS_PURGE_ACTIVE, false);

        // 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣銏犲閺佸﹪鏌″搴″箹缂佹劖顨嗛幈銊ノ熼幐搴ｃ€愮紓浣哄Х婵炩偓闁哄瞼鍠栭獮鎴﹀箛椤斞勭矋缁绘稑顔忛鑽ゅ嚬闂佸搫鎳忕划鎾诲蓟閵堝绠掗柟鐑樺灥婵酣鎮楀▓鍨灈婵炲皷鈧剚娼栨繛宸簼椤ュ牊绻涢幋鐐跺妞わ絽鎼—鍐Χ韫囨挾妲ｉ梺鎼炲妼绾绢參宕氶幒鎾剁瘈婵﹩鍘藉▍婊堟⒑缁洖澧叉繛鍙夌矌缁顫濋澶嬪瘜闂侀潧鐗嗗Λ娑欐櫠椤掑倻纾奸悹鍥ㄥ絻閳ь剙鐏濋悾鐑藉Ψ閳哄倸浠梺?
        if (this.ownerUUID != null && !this.level().isClientSide) {
            Player owner = this.level().getPlayerByUUID(this.ownerUUID);
            if (owner != null) {
                owner.sendSystemMessage(Component.literal("[Purge End] " + this.getDisplayName().getString() + " eliminated " + this.purgeKillCount + " targets."));
            }
        }
        this.purgeKillCount = 0;
    }



    public int getKillCount() { return this.entityData.get(KILL_COUNT); }
    // ==========================================
    // 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞鐟滃寮稿澶嬬厸闁搞儮鏅涜ⅴ闂佺顑嗛幐鍓у垝椤撶偐妲堟俊顖濐嚙椤︹晠姊虹粙娆惧劀缂佺粯绻傞锝夊醇閺囩偤鍞跺┑顔斤供閸樹粙鎮甸弽顐ょ＝?闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑鏅悷婊冪箻楠炴垿濮€閵堝懐鐤€濡炪倖妫佸Λ鍕償婵犲洦鈷戠憸鐗堝笒娴滀即鏌涢悩鍐叉诞鐎规洘鍨块獮姗€骞囨担鐟板厞闂備胶绮幐鍝モ偓娑掓櫊閹潧鈹戠€ｎ偀鎷虹紓渚囧灡濞叉﹢寮跺ú顏呯厱闁靛鍔嶉鐘电磽閸屾稒灏扮紒鍌涘笧閳ь剨缍嗘禍婊呯玻濞戞瑧绡€闁汇垽娼у瓭闁诲孩鍑归崜娑㈠极椤旇姤鍎熼柕濠忓閸樹粙鏌熼懝鐗堝涧缂佽鲸娲熼幃楣冾敇閵忥紕鍘遍柟鑲╄ˉ閳ь剙鐤囬崺鐐烘煟閹惧崬鈧繈寮婚弴鐔虹闁绘劦鍓氶悵鏃堟⒑閸涘﹤鐏╁┑鐐╁亾闂佸搫鏈粙鎴︽偩濠靛鐒垫い鎺戝绾惧鏌ｉ幇顔煎妺闁?(濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴濐潟閳ь剙鍊块幐濠冪珶閳哄绉€规洏鍔戝鍫曞箣濠靛牃鍋撻鐑嗘富闁靛牆鎳愮粻浼存煟濡も偓濡稓鍒掗崼銉ラ唶闁绘棁娅ｉ惁鍫ユ⒒閸屾氨澧涚紒瀣尰閺呭爼骞囬悧鍫㈠幈闁诲函缍嗛崑鍛焊椤撶喆浜滄い鎰剁悼缁犵偞銇勯姀鈽呰€块柟顔规櫊瀹曟﹢宕ｆ径灞介叡闂傚倷娴囬褏鈧稈鏅犻、娆撳冀椤撶偤妫烽梺鎸庣箓閹峰鎮為悾灞惧枑闁哄啫鐗勯埀顑跨铻ｉ柤濮愬€濆顔剧磽娴ｅ壊鍎忛柣蹇旂箘缁絽鈽夊鍡樺瘜闂侀潧鐗嗗Λ娆戔偓鍨懇閺屾盯寮撮妸銉ょ盎闂佹眹鍔庨崰鏍ь潖婵犳艾纾兼慨姗嗗厴閸嬫挻顦版惔銏╁仺濠殿喗锕╅崜锕傛倿娴犲鐓犲┑顔藉姇閳ь剚娲滃▎銏ゅΧ閸涱亝鏂€闂佺粯锚閻ゅ洦绔熷Ο鑲╃＜闁逞屽墯瀵板嫰骞囬鐘插箥闂佸搫顦悧鍡樻櫠娴犲鍋╅梺顒€绉甸悡鏇㈡倶閻愰鍤欏┑顔煎€块弻锛勪沪閻愵剛顦伴悗瑙勬礈閸樠囧煘閹达箑绠涙い鎾筹紡閸ャ劉鎷?闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ帒锕︾粙蹇旂節閵忥絾纭炬い鎴濇喘閵嗗懘骞撻幑妤€缍婇幃鈺侇啅椤旂厧澹堢紓浣哄亾閸庡啿顭囬垾鎰佸殨闁割偅娲栭柋鍥ㄣ亜閹板灚绶氱紒銊ョ摠缁?
    // ==========================================
    private static final Map<Integer, Double> RANGE_CONFIG = new HashMap<>();
    static {
        RANGE_CONFIG.put(1, 20.0);
        RANGE_CONFIG.put(2, 32.0);
        RANGE_CONFIG.put(3, 64.0);
        RANGE_CONFIG.put(4, 128.0);
        RANGE_CONFIG.put(5, 256.0);
    }

    // 闂?闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑鏅悷婊冪箻楠炴垿濮€閵堝懐鐤€濡炪倖妫佸Λ鍕償婵犲洦鈷戠憸鐗堝笒娴滀即鏌涢悩鍐叉诞鐎规洘鍨块獮姗€骞囨担鐟板厞闂備胶绮幐鍝モ偓娑掓櫊閹潧鈹戠€ｎ偀鎷虹紓渚囧灡濞叉﹢寮跺ú顏呯厱闁靛鍔嶉鐘电磽閸屾稒宕岄柟顔藉劤閻ｆ繈鍩€椤掑嫭鍎楁繛鍡樻尰閸嬶絽銆掑鐓庣仯闁告ɑ鐩弻娑㈡倷鐎涙ǜ浠㈤梺鍝勭焿缂嶄線骞冮姀銈呬紶闁靛／鍛笌缂傚倸鍊风粈渚€藝闁秴绠犻柟鍓х帛閸?
    public int getRangeLevel() {
        return getTier() + 1;
    }


    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犵厱婵﹩鍘介妵婵嗏攽闄囬崺鏍ь嚗閸曨厸鍋撻敐搴濈胺婵″弶鍔欏缁樼瑹閳ь剙顭囪婢ф繈姊洪崫鍕櫤闁烩晩鍨堕獮蹇涘箣閿旇棄浜滈柣蹇撶箣閻掞箓寮埀顒勬⒒娴ｈ櫣甯涢拑杈╂喐閺夊灝鏆ｆい銏℃椤﹀磭绱掔紒妯尖槈闁伙絾绻冪换婵囩瑹閳ь剟宕戝Δ鍛拺闁告繂瀚悞璺ㄧ磽瀹ュ嫮绐旈柣娑卞櫍瀹曞爼顢楁径瀣珦闂備胶顭堢换鎰邦敄閸涙鍥偨缁嬭儻鎽曞┑鐐村灦閸╁啴宕戦幘缁樻櫜閹肩补鈧尙鍑归柣搴ゎ潐濞叉牜鈧凹鍙冩俊鐢稿礋椤栨稒娅囬梺閫炲苯澧撮柟顔芥そ婵℃瓕顦崇€规洖寮剁换娑㈠箣濞嗗繒浠奸梻浣稿船濞差參寮婚敐澶婄睄闁割偒鍋呴ˉ鏍ㄧ箾鐎电甯堕柣顓炲€块獮鍐ㄎ旈崘鈺佹瀭闂佸憡娲﹂崜娑⑺囬妸銉富闁靛牆鍟俊濂告煥閺囥劋閭柣娑卞枛铻栧ù锝囨嚀閸斿懘姊洪棃娑辩劸闁稿孩濞婇弫宥咁煥閸愶絾鏂€闂佺粯顭堥婊冾啅閵夆晜鐓欓柛娆忣槺濞插瓨銇勯姀鈩冾棃鐎规洖銈搁幃銏ゅ传閸曨偆顔戦梻鍌欒兌椤㈠﹪宕戦幇顔藉仒闁靛鏅涚粈鍫熺節闂堟稓澧涢悗姘煼閺屻劑鎮㈤崫鍕戯綁鏌ｉ幘瀛樼闁诡喗顨婇弫鎰償閳ユ剚娼婚梻浣告惈椤戝棝鎯勯鐐茶摕?
    public void updateRangeAttribute() {
        double range = getAttackRange();

        // 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙闁诡垳鍋ら獮鏍庨鈧俊濂告煟椤撶噥娈滄鐐寸墪鑿愭い鎺嗗亾濠德ゅ亹缁辨帡骞囬褎鐤侀梺鍝勭焿缁绘繂鐣烽崼鏇炵厸濞达絽娴勭徊鍧楀焵椤掑喚娼愭繛鍙夌墪椤曪綁宕奸弴鐐电杽闂侀潧顭堥崕娆撴偄閻撳簼绱堕梺鍛婃处閸樻崘鈪垫繝鐢靛Х閺佹悂宕戝☉銏″剹闁割偆鍠撻々鍙夈亜韫囨挾澧曢柦鍐枛閺屻劌鈹戦崱鈺傂︾紓浣哄У缁嬫帡濡甸崟顖氭闁割煈鍠栭懘顖涚節閵忥絽鐓愰柛鏃€鐗犻幃锟犲即閵忊€斥偓鐢告煥濠靛棝顎楀ù婊勭箘閳ь剝顫夊ú鏍偓姘煎弮婵＄敻宕熼娑欐珕闂佷紮绲介懟顖氼嚕閵娾晜鈷戦柛婵嗗閻掕法绱撳鍕妽濞ｅ洤锕畷濂稿即閻愯尙鐛╂俊鐐€栭幐鍡涘磼濠婂嫸绱＄紓鍌氬€搁崐鎼佸磹閻戣姤鍊块柨鏇炲€堕埀顒€鍟村畷濂稿Ψ閵壯呭炊闂備浇顫夊畷姗€顢氳閹偤宕归鐘辩盎闂佸湱鍎ら崺濠囧礉閻旇櫣纾煎鑸靛姈濞懷囨婢跺绡€濠电姴鍊归崳鐟懊归悩娲摵妞ゃ劊鍎甸幃娆撳箹椤撶喓鏉归梻浣筋嚃閸犳帡寮插┑鍫燁潟闁圭儤鍤﹂悢鍏煎亗閹肩补鍓濇潏?
        var attributeInstance = this.getAttribute(Attributes.FOLLOW_RANGE);
        if (attributeInstance != null) {
            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈢粯淇婇悙顏勨偓鏍偋濡ゅ啰鐭欓柟鐐湽閳ь剙鎳樺畷锝嗗緞瀹€鈧惁鍫ユ⒒閸屾氨澧涚紒瀣浮閺佸秹寮崼鐔哄幘闂佸搫顦冲▔鏇熺閵忋倖鐓忛柛鈩兠粭鎺撱亜椤愶絿绠為柡浣瑰姍瀹曘劑顢楅埀顒勊夊鑸碘拺閻犲洦褰冮銏°亜閺冣偓閻楃姴鐣烽幎绛嬫晪闁逞屽墮閻ｇ兘骞嬮悙鐢电槇闂佺琚崐鏇炩枔閵娾晜鈷戦柤娴嬫櫓閻掗箖鏌ｈ箛鏂垮摵鐎规洘娲熼幃銏ゅ礂閼测晛骞嶉梻浣筋嚃閸ㄥ酣宕橀妸褜鍎撴繝鐢靛О閸ㄥジ锝炴径濞掓椽鎮㈡總澶嬬稁婵犵數濮甸懝鍓у閸忓吋鍙忔慨妤€妫楅崢鎾煕鐎ｎ偅宕屾鐐寸墬缁楃喖宕堕妸锔界彣濠碉紕鍋戦崐鏍箰閸洖鍨傛繛宸簻绾惧鏌嶉埡浣告殶缂佲檧鍋撻梻鍌氬€搁悧濠冪瑹濡ゅ懎纾块柟鎵閻撶喖鏌熼幆褏鎽犵紒鈧崘顔界厵濞撴艾鐏濇俊鍏笺亜椤愶絿鐭掔€规洖宕灃闁逞屽墴閿濈偤顢旈崟銊︽杸闂佺粯锕╅崑鍕妤ｅ啯鈷戠紓浣癸供濞堟棃鏌ｅΔ鈧幊鎰板箲閵忋倕骞㈡繛鎴炵懅閸樹粙姊鸿ぐ鎺戜喊闁告鍋愬濠冪節濮橆厾鍘撻悷婊勭矒瀹曟粌鈻庤箛锝囧姺闂佽法鍠撴慨鐢稿磻濡眹浜滈柡鍐ㄥ€甸幏锟犳煕濮橆剦鍎旈柡灞剧☉椤劑鍩€椤掑倻鐭嗗〒姘ｅ亾妤犵偛鍟撮獮瀣晜鐟欙絾瀚肩紓鍌欑贰閸ㄥ崬煤閺嶃劍娅犻柛娆忣槶娴滄粍銇勯幘璺轰沪闁哥姵顭囬埀顒冾潐濞叉﹢鎮烽敂鍓х焿闁圭儤鏌￠崑鎾绘晲鎼粹€茬爱闂?(闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柟缁樺笧閳ь剦鍙冨鍝勑ч崶褏浠奸梺璇茬箲閼归箖鎮鹃悜钘夎摕闁靛濡囬崢鐢告⒑鐟欏嫷鍟忛柛鐘崇墵閵嗗倹绺介崨濠勫幈闁硅壈鎻槐鏇熺墡闂備線娼уú銈団偓姘緲椤曪絾绂掔€ｎ€晝鎲歌箛娑欏亗闁稿本绮庣壕鐓幬旈敐鍛殶闁伙綀娅ｇ槐鎺楁偐瀹曞洤鈷岄悗娈垮枛椤兘骞冮姀銏″仒闁炽儱鍘栨竟鏇㈡⒑濮瑰洤鐏い鏃€鐗犻幃鐐淬偅閸愩劎鏌堥梺褰掓？閻掞箓鍩涢幋鐘垫／妞ゆ挾鍋炴刊鍏肩箾閸忕厧濮堢紒缁樼洴閹崇娀顢楅埀顒勫几濞戞埃鍋?
            if (Math.abs(attributeInstance.getBaseValue() - range) > 0.01) {
                attributeInstance.setBaseValue(range);
            }
        }
    }

    public double getAttackRange() {
        int level = getRangeLevel();

        // 4. 闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃繘鍩€椤掍胶鈻撻柡鍛█閵嗕礁鈻庨幘鍐插敤濡炪倖鎸鹃崑鐔兼偘閵夆晜鈷戦柛婵嗗閳诲鏌涘Ο鍨汗濠㈣娲濋妵鎰板箳閹捐泛骞嶉梻鍌氬€搁崐鎼侇敋椤撱垹绀夌€广儱顦伴悡鏇㈡倵閿濆簼鎲炬俊顖楀亾闂備礁鎼悮顐﹀磹濠靛宓侀柡宥冨妽婵挳鎮峰▎蹇擃伃闁轰緡浜炵槐鎾诲磼濞嗘埈妲繝鈷€鍐弰鐎规洘鍨挎俊鑸靛緞婵犲懏鎲版繝鐢靛仦閸垶宕硅ぐ鎺戠闁规儼濮ら悡蹇撯攽閻愯尙浠㈤柛鏃€姘ㄧ槐鎺楁偐閾忣偁浠㈠┑顔硷龚濞咃絿鍒掑▎鎾崇闁炽儱鍟块～鐘绘⒒娴ｄ警鐒炬い鎴濆暣瀹曟劕鈹戦崱鈺佹婵犵數濮甸懝鐐劔闂備線娼чˇ顓㈠垂濞差亷缍栫€广儱鎳夐弨浠嬫煟閹邦剙绾фい銉у仱閹粙顢涘☉妯昏癁闁芥鍠愮换婵嬫濞戞瑱绱炲┑鐐存尭椤兘寮婚弴銏犻唶婵犻潧妫岄崑鎾广亹閹烘垶杈堝┑顔姐仜閸嬫捇鏌＄仦鍓ф创濠碉紕鍏橀獮瀣攽閸℃ɑ顔勬繝鐢靛仜閻楀嫰宕愰弽顐ｅ床婵犻潧顑嗛崑銊╂⒒閸喎鍨侀柕蹇嬪€栭悡銉╂煛閸ヮ煁顏堝焵椤掍胶绠炴鐐插暢椤﹀湱鈧娲栧畷顒勫煝鎼淬劌绠涙い鎾跺櫏閸炲爼姊虹拠鍙夊攭妞ゎ偄顦叅闁哄稁鐏愬ú顏勎╃憸宥壦夊顑炲綊鎮╁顔煎壉闂佺粯鎸诲ú鐔煎蓟閻斿吋鐒介柨鏇楀亾妤犵偞鐗犻弻娑㈠棘鐠囨祴鍋撳┑瀣摕闁挎稑瀚ч崑鎾绘晲閸愩劌顬堥梺閫炲苯澧い銊ワ躬瀹曟椽鍩€椤掍降浜滈柟鐑樺灥閺嬨倖绻涢崗鐓庡闁哄矉缍侀崺鍕礃閳哄喚妲伴梻渚€娼уú锕€顫忛懡銈呭灊婵炲棗绻嗛弸搴ㄦ煙椤栧棗瀚烽崬顐︽⒒閸屾瑧顦﹂柟娴嬧偓瓒佹椽鏁冮崒姘€梺瑙勵問閸犳碍绋夊澶嬬厽闁哄倸鐏濋幃鎴︽煕婵犲嫭鏆柡灞诲妼閳规垿宕卞☉鎵佸亾濡も偓椤儻顦村褎顨婃俊鐢稿礋椤栨稒娅嗛柣鐘叉搐瀵爼鎮靛┑瀣拺闁告繂瀚悞璺ㄧ磽瀹ヤ礁浜剧紓鍌欒兌婵敻鎯勯鐐靛祦婵せ鍋撶€规洘绮嶇粭鐔煎炊瑜庨弳顓犵磽閸屾艾鈧悂宕愬畡鎳婂綊宕堕澶嬫櫔閻熸粌绉烽悘瀣攽閻樼粯娑фい鎴濇噽缁顫濋閿亾閹烘埈娼╅柨婵嗘噸婢规洘淇婇悙顏勨偓鎴﹀垂濞差亝鍎庢い鏍仜缁犳牗绻涢崱妯诲鞍闁搞倖鍨堕妵鍕箳閸℃ぞ澹曢梻渚€鈧偛鑻晶浼存煕鐎ｃ劌鈧洟锝炶箛娑欐優闁革富鍘鹃敍婊冣攽閳藉棗鐏犻柟纰卞亰閿濈偤骞嬮敂瑙ｆ嫼闂傚倸鐗婄粙鎺椝夐幋锔界厱閻庯綆鍋呭畷灞炬叏婵犲懏顏犵紒顔界懃閳诲酣骞嗚婢瑰姊绘担鍛婅础闁硅櫕鎸哥叅妞ゆ挾鍋熼弳锔界箾瀹割喕绨婚柣?
        if (!RANGE_CONFIG.containsKey(level)) {
            System.err.println("[Error] Missing range config for level " + level + ", using default.");
            return 20.0; // 婵犵數濮烽弫鍛婃叏閻㈠壊鏁婇柡宥庡幖缁愭淇婇妶鍛殲闁哄棙绮嶆穱濠囧Χ閸涱厽娈堕梺娲诲幗閻熲晠寮婚悢鍏煎€绘俊顖炴櫜缁爼姊洪柅鐐茶嫰婢у墽绱掗悩铏碍闁伙綁鏀辩缓鐣岀矙鐠囦勘鍔嶉妵鍕籍閸ヮ灝鎾寸箾閸涱厾孝闁宠鍨块幃鈺呭垂椤愶絾鐦庡┑鐘愁問閸犳岸寮幖浣哥獥濠电姴鍋嗛崥瀣熆鐠虹尨鍔熼柡?
        }

        return RANGE_CONFIG.get(level);
    }

    public int getTier() {
        return this.entityData.get(TIER);
    }

    private static double getWeaponDamageForTier(int tier) {
        return 1.0 + (Math.max(0, tier) * 0.5);
    }

    public TurretMobilityProfile getMobilityProfile() {
        return this.mobilityProfile;
    }

    private TurretMobilityProfile resolveMobilityProfileForTier(int tier) {
        return tier >= 3 ? TurretMobilityProfile.HEAVY_MECH : TurretMobilityProfile.SCOUT_BOT;
    }

    private void refreshMobilityProfileFromTier() {
        TurretMobilityProfile resolved = resolveMobilityProfileForTier(getTier());
        this.mobilityProfile = resolved;
        syncMobilityPhysicsAttributes(resolved);
    }

    private void syncMobilityPhysicsAttributes(TurretMobilityProfile profile) {
        if (this.getAttribute(net.minecraftforge.common.ForgeMod.STEP_HEIGHT_ADDITION.get()) != null) {
            this.getAttribute(net.minecraftforge.common.ForgeMod.STEP_HEIGHT_ADDITION.get()).setBaseValue(profile.stepHeight());
        }
        if (this.getAttribute(Attributes.JUMP_STRENGTH) != null) {
            this.getAttribute(Attributes.JUMP_STRENGTH).setBaseValue(profile.jumpStrength());
        }
    }

    public void setTier(int tier) {
        this.entityData.set(TIER, tier);
        if (this.getAttribute(Attributes.ATTACK_DAMAGE) != null) {
            this.getAttribute(Attributes.ATTACK_DAMAGE).setBaseValue(getWeaponDamageForTier(tier));
        }
        this.updateRangeAttribute(); // Auto-update range
        this.refreshMobilityProfileFromTier();
    }

    @Override
    public void addAdditionalSaveData(CompoundTag tag) {

        tag.putBoolean("FollowMode", this.isFollowMode());
        // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣椤愯姤鎱ㄥ鍡楀⒒闁绘帞鏅幉绋款吋閸澀缃曞┑鐘垫暩閸嬫稑螞濞嗘挸绠伴柛婵勫劤閻棗顭跨捄渚剮缂佽妫濋弻鏇㈠醇濠靛洤娅ゆ繝娈垮灠閵堟悂寮婚埄鍐╁缂佸顑欐导鍐⒑閸濆嫭婀伴柣鈺婂灡娣囧﹪鎮滈懞銉︽珳闂佸憡渚楅崣搴ㄦ倵闁垮绻嗛柣鎰典簻閳ь剚鍔欏鎻掝煥閸喎浜楅梺璺ㄥ枔婵挳鎷戦悢鍏肩叆闁绘柨鎼瓭缂備讲鍋撻柛鎰靛枟閻撱儲绻濋棃娑欘棡闁革絿顭堥…璺ㄦ喆閸曨剛顦ㄦ繛锝呮搐閿曨亪骞冨▎鎿冩晜闁告洏鍔屾禍楣冩煛瀹ュ骸浜濋柡鍡樼矋娣囧﹪濡堕崨顔兼濠碉紕鍋樼划娆撳蓟閳ユ剚鍚嬮幖绮光偓宕囶啈闂?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧潡鏌熺€电孝缂佽翰鍊濋弻锕€螣娓氼垱锛嗗┑鐐叉▕娴滄繈寮插鍫熺厽闁逛即娼ф晶顕€骞栭弶鎴含婵﹨娅ｇ划娆戞崉閵娧傜礃闂備胶顭堥鍥磻閵堝懐鏆﹂柟杈剧畱鍥存繝銏ｆ硾椤戝洭宕㈤鍛瘈闁汇垽娼ф禒褔鏌涚€ｎ偅灏柍璇茬Ч瀹曘劑顢欓懡銈囩暰婵＄偑鍊栭崝褏绱為崶顒佸殌闁秆勵殕閻撴盯鎮橀悙娈跨劸濠⒀嗗皺閳ь剙鐏氬妯尖偓姘煎幘閹广垹鈹戠€ｎ亞顦板銈呯箰濞诧箓顢撳Δ鍐＝闁稿本鑹鹃埀顒佹倐瀹曟劙宕妷褏鐓嬮悗瑙勬礀濞诧箓顢曢懞銉﹀弿婵☆垱瀵х涵楣冩煢?
        tag.putInt("UnitID", this.entityData.get(UNIT_ID));
        // RangeLevel not saved (derived)
        tag.putString("CustomBaseName", this.entityData.get(SYNC_BASE_NAME));
        tag.putBoolean("PlayerNameLocked", isPlayerNameLocked());
        tag.putInt("XpBuffer", this.xpBuffer);
        tag.putInt("UpgradeProgress", this.entityData.get(UPGRADE_PROGRESS));
        tag.putInt("DeathPlaqueFatalHitCount", this.entityData.get(DEATH_PLAQUE_FATAL_HIT_COUNT));
        tag.putBoolean("IsSquadMember", this.entityData.get(IS_SQUAD_MEMBER));
        // Save Teleport Module Data
        tag.putBoolean("HasTeleportModule", this.hasTeleportModule());
        tag.putInt("TeleportCooldown", this.teleportCooldown);

        super.addAdditionalSaveData(tag);
        tag.putInt("TurretTier", getTier());
        tag.putBoolean("IsFollowing", this.entityData.get(IS_FOLLOWING));
        tag.putInt("KillCount", getKillCount());
        tag.putBoolean("IsBrutal", this.entityData.get(IS_BRUTAL));
        tag.putInt("BrutalTimer", brutalityActiveTimer);
        tag.putInt("BrutalCD", brutalityCooldown);
        tag.putBoolean("IsCaptain", this.entityData.get(IS_CAPTAIN));

        if (ownerUUID != null) tag.putUUID("OwnerUUID", ownerUUID);

        ListTag itemList = new ListTag();
        for (int i = 0; i < inventory.getContainerSize(); i++) {
            ItemStack stack = inventory.getItem(i);
            if (!stack.isEmpty()) {
                CompoundTag itemTag = new CompoundTag();
                itemTag.putByte("Slot", (byte) i);
                stack.save(itemTag);
                itemList.add(itemTag);
            }
        }
        tag.put("Inventory", itemList);
    }
    // ==================== 闂?濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌熼梻瀵割槮缁炬儳顭烽弻锝夊箛椤掍焦鍎撶紓浣哄С閸楁娊寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磽娴ｅ搫啸濠电偐鍋撳Δ鐘靛仦閻楁洝褰佸銈嗗坊閸嬫捇鏌ｈ箛锝呮珝闁哄矉绲介埞鎴炵節閸屾粌甯跨紓鍌欒兌缁垶鎯勯姘辨殾闁告鍊ｉ弮鍫濈妞ゅ繐妫楃€氬酣姊婚崒娆掑厡缂侇噮鍨伴～蹇旂節濮橆剙鍋嶉悷婊勬楠炲啫螣閾忚娈鹃梺鎼炲劵缁茶姤绂嶆ィ鍐╁仭婵炲棗绻愰顏嗙磼閳ь剟鍩€椤掆偓閳规垿鎮欓懠顒佸嬀闂佸憡姊归崹鎸庝繆鐎涙鐟归柍褜鍓欓悾鐑藉Ω瑜夐崑鎾斥槈濞呰鲸宀搁獮蹇撁洪鍛嫼闂佸憡绋戦敃锔剧不閹剧粯鍊垫慨妯煎帶閺嬶箓鏌涙繝鍌滄憼濞ｅ洤锕幃娆擃敂閸曘劌浜鹃柕鍫濐槸閸屻劌鈹戦崒姘暈闁稿顑夐悡顐﹀炊閵婏妇顦紒鎯у綖缁瑩寮婚悢鍏煎€锋い鎺戝€瑰▓顒勬⒑缁嬫鍎忛柟铏耿瀵鈽夐姀鐘电杸闂佸疇妗ㄧ粈渚€鈥栫€ｎ喗鈷戠紓浣股戠亸浼存煕閵娧勬毈闁糕晝鍋ら獮瀣晜缂佹ɑ娅撳┑鐘愁問閸犳宕濋幒鏂垮灊闁割偅娲橀埛鎴犵磼鐎ｎ偒鍎ラ柛搴㈠姍閺岀喖鎮烽悧鍫濇灎閻?====================
    // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犖ч柛灞剧煯婢规洖鈹戦鐭亜鐣烽鍕偍閻庣數纭堕崑鎾舵喆閸曨剛顦銈庡亜椤﹂亶鍩€椤掑嫭娑ч柕鍫㈩焾椤曪綁宕奸弴鐐殿吅闂佺粯锚閻忔艾袙鎼淬垻绡€闁汇垽娼ф禒鈺呮煙濞茶绨界€垫澘锕畷绋课旈埀顒傜不閻樼粯鐓欓柟瑙勫姇閻撴劖銇勯幇顏嗙煓闁哄矉缍侀獮鍥敊閻撳骸顬嗛梻浣虹帛閹歌煤閻旂厧钃熼柨鐔哄Т閻愬﹪鏌曟径鍫濆姎妞ゎ剙妫涚槐鎾存媴闂堟稑顬嗙紓渚囧枟閻熲晛顕ｆ繝姘у璺猴攻瀹撳秴顪冮妶鍡樺暗闁稿蓱缁旂喖寮撮悩鐢碉紳婵炶揪缍€濞咃絿鏁☉銏＄厽闁冲搫锕ら悘锕傛煟濞戝崬鏋涙い顐ｇ矒閸┾偓妞ゆ帒瀚粻鍦喐閻楀牆淇柡浣稿暣閺屾洝绠涙繝鍐炬綉婵炲濮弲婊呮崲濠靛鍋ㄩ梻鍫熷垁閻愮儤鐓曢柕濞垮劘閸嬨垽鏌ㄥ┑鍫濅沪鐎垫澘瀚伴獮鍥敇閻愭壆鏁鹃梻鍌欑窔濞佳囁囬銏犵閹兼番鍨婚々鎻捗归悩宸剱闁抽攱甯掗湁闁挎繂鎳忛幆鍫澝归悩铏仢闁哄本绋掗幆鏃堝Χ閸曨偅鍎撳┑鐘灱椤煤閻旂鈧礁顫滈埀顒勫箖閳哄懎绀冮柟缁樺笒缁犳煡姊?
    public boolean isPurgeActive() {
        return this.entityData.get(IS_PURGE_ACTIVE);
    }
    // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫆闁芥ê顦純鏇熺節閻㈤潧孝闁挎洏鍊濋幃褔宕卞▎鎴犵劶闂佸壊鍋嗛崰鎰板矗韫囨梹鍙忔俊鐐额嚙娴滄儳顪冮妶鍐ㄢ偓鏇㈠磹閸噮鍤曟い鎰剁畱缁€鍐┿亜閺冨倹娅曢柛妯圭矙濮婅櫣鎲撮崟顐㈠Б缂佸墽铏庨崣鍐嚕娴兼潙纾奸柣鎰嚟閸樻捇鎮峰鍕煉鐎规洘绮岄～婵囨綇閵婏附顔囬梻浣哄仺閸庤京澹曢銏犳辈闁挎洖鍊归悡蹇撯攽閻愰潧浜炬繛鍛崌閺屸剝鎷呴崨濠傛灎闂佸搫鐭夌紞渚€鐛€ｎ亖鏀介柛銉ㄥ煐閿涗線姊绘担鐟邦嚋缂佸鍔楀▎銏狀潩椤掑缍庣紓鍌欑劍钃卞┑顖涙尦閺屾稑鈽夊鍫熸暰闂佺瀛╅幐鎼佲€旈崘顔嘉ч煫鍥ㄦ尵濡诧綁姊虹粙娆惧剰闁挎洏鍊濋幃楣冩倻閽樺顓洪梺鎸庢磵閸嬫挾绱掗悩宸吋闁诡喗妞介獮鎺戭吋閸繂甯梻浣侯攰濞呮洟骞戦崶顒€鐏抽柨鏇炲€告儫闂佸疇妗ㄩ懗鍫曀囬妸鈺傗拺闁告劕寮堕幆鍫ユ煥閺囨ê鍔﹂挊鐔兼煥濠靛棙顥欑紒璇叉閺岋綁骞囬崗鍝ョ泿闂侀€炲苯鍔柛娑卞灟缁楀姊洪崷顓炲妺闁搞劎鍠栧鎼佸冀椤撶喓鍘搁梺鎼炲劗閺呮盯寮搁弮鈧妵鍕煛閸屾粌寮ㄩ梺鍝勭灱閸犳牕顫忛懡銈傚亾闂堟稑顥忔俊宸枤缁辨挻鎷呴崫鍕碘偓鎾剁磼閹绘帒鈷旈柟骞垮灩閳规垿宕堕埡鍐闂備胶顭堥張顒傚垝瀹€鍕┾偓鍌炲传閸曘劍鏂€?
    public int purgeKillCount = 0;
    // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缂佺姷濞€閺岀喖宕滆鐢盯鏌涚€ｃ劌鈧繈寮婚弴鐔虹闁绘劦鍓氶悵鏃堟⒑閹肩偛濡奸柛濠傛健瀵鏁愭径瀣簻缂備礁顑嗛娆徫涙惔銊︹拺闁告繂瀚烽崕鎰繆椤愩垹鏆ｇ€殿喖顭烽幃銏ゅ川婵犲嫮肖闂備礁鎲￠幐鍡涘川椤旂瓔鍟呯紓鍌氬€搁崐鐑芥嚄閼稿灚鍙忓Δ锝呭枦缂嶆牕顭跨捄鐑樻拱鐎规洖寮剁换婵嬫濞戞瑥绐涚紓浣叉閸嬫捇姊绘担渚劸闁哄牜鍓涚划娆撳箣濠靛啯鐎洪梺鎸庣箓椤︿即鍩涢幋鐘电＜閻庯綆鍋掗崕銉╂煕鎼达紕绠崇紒杈ㄥ笚瀵板嫭绻濋崟顓夈劌螖閻橀潧浠滈柛鐕佸亰閹箖鏁撻悩鑼吋闂佹儳娴氶崑鍡涘焵椤掆偓椤嘲顫忔ウ瑁や汗闁圭儤鍨抽崰濠囨⒑閸涘﹥灏伴柣鈺婂灦楠炲啴鎮滈挊澹┾晠鏌嶉崫鍕偓濠氬储?(0-360闂?
    private float purgeSearchAngle = 0.0f;

    // 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞鐟滄粌霉閺嶎厽鐓忓┑鐐靛亾濞呭棝鏌嶉柨瀣拻闁逞屽墮缁犲秹宕曢柆宓ュ洭顢涢悙鎻掔€梺绋挎湰缁嬫挾绮婚崜褉鍋撻悷鏉款棌闁哥姵娲熼獮澶嬨偅閸愨晝鍘告繛杈剧到閹诧繝藟閵忋倖鐓涚€光偓閳ь剟宕伴幘鑸殿潟闁圭儤顨呴～鍛存煟濡櫣锛嶅ù婊冪埣濮婄粯鎷呴悷鎵虫灆闂佽　鍋撻梺顒€绉寸粻鏌ユ煕閵夘喖澧柦鍐枛閺屻劌鈹戦崱鈺傂﹀┑鈽嗗亝閿曘垽寮诲☉鈶┾偓锕傚箣濠靛洨浜舵繛瀛樼矋閻╊垰顫忔繝姘＜婵炲棙鍔﹀Ο鍌炴⒑閸涘娈欐繛鍛礈缁顓兼径濠囧敹闂佸搫娲ㄩ崑鐔兼偩濞差亝鍋℃繝濠傛噹椤ｅジ鎮介娑樻诞闁诡喗鐟︾换婵嬪礋椤掆偓閺嬫垿妫呴銏″闁规悂绠栭獮妤呭Ψ瑜忕壕?(50闂?
    private static final String[] PURGE_QUOTES = {
            "Purge order acknowledged.",
            "Sector cleansing in progress.",
            "No hostile escapes this zone.",
            "Purge protocol online.",
            "No active hostiles allowed in this sector.",
            "Hunt window has opened.",
            "Full salvo, blanket fire.",
            "Obstacles cleared."
    };

    @Override
    public void readAdditionalSaveData(CompoundTag tag) {

        if (tag.contains("IsFollowing") || tag.contains("FollowMode")) {
            // Prefer the newer IsFollowing field for backward-compatible save migration.
            boolean follow = tag.contains("IsFollowing")
                    ? tag.getBoolean("IsFollowing")
                    : tag.getBoolean("FollowMode");
            this.setFollowMode(follow);
        }
        // RangeLevel derived from Tier, ignored from tag

        if (tag.contains("UnitID")) {
            this.entityData.set(UNIT_ID, tag.getInt("UnitID"));
        }
        if (tag.contains("DeathPlaqueFatalHitCount")) {
            this.entityData.set(DEATH_PLAQUE_FATAL_HIT_COUNT, tag.getInt("DeathPlaqueFatalHitCount"));
        } else if (tag.contains("DropCount")) {
            this.entityData.set(DEATH_PLAQUE_FATAL_HIT_COUNT, tag.getInt("DropCount"));
        }
        if (tag.contains("CustomBaseName")) {
            this.entityData.set(SYNC_BASE_NAME, normalizeBaseName(tag.getString("CustomBaseName")));
        } else if (tag.contains("TurretBaseName")) {
            // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯锋嫼閻熸粎澧楃敮鎺撶娴煎瓨鐓曢柟鎯ь嚟閹冲啯銇勯弴顏嗗埌闁伙綇绻濋弻鍥晜閽樺妲ｉ梻鍌欑窔濞佳囨偋閸℃あ娑樷槈濞嗘劖鐝峰銈嗗笒閸婅崵澹曟總鍛婂€甸柨婵嗛娴滄粍绻涢幖顓炴珝闁哄备鍓濋幏鍛村传閵夋劑鍊濋弻宥堫檨闁告挶鍔庣槐鐐哄幢濞戞鐛ュ┑掳鍊曢幊搴ｅ瑜版帗鐓曟い顓熷灥娴滅偟绱掗悩鑽ょ暫闁哄瞼鍠撻埀顒傛暩椤牓宕滈崡鐏诲綊鎮℃惔銏╂＆闂佸搫鐬奸崰鎰焽韫囨稑绀堢憸蹇涘汲閻樿绾ч柍鍝勫€荤粻鐐存叏婵犲懏顏犵紒顔界懅閹瑰嫰濡歌缁辨﹢姊绘担渚劸妞ゆ垵娲畷鎴﹀Χ閸滀礁娈ㄩ梺鍝勮閸庢椽寮崱娑欑厱闁哄洢鍔屾晶顕€鏌嶈閸撴瑩鎮ユ總绋胯摕闁挎繂顦粻娑欍亜閹捐泛鏋旂紒瀣喘濮婃椽宕ㄦ繝鍐幗闂佺锕ョ换鍫ユ偘椤曗偓瀹曞崬鈽夊▎蹇庣盎闂備胶顭堢换鎰版儍閻戣棄绠繛宸簼閳锋垿鏌涘☉姗堝姛缂佺姵鎹囬幃妤€顫濋悡搴♀拫閻庢鍣崑濠囩嵁鎼淬劍鍤嶉柕澹啫绠為梻鍌欒兌椤㈠﹪宕洪崶顒€绀夌€广儱鎳夐弸宥夋煕濞戞鎽犻柣鎾冲暟閹茬顭ㄩ崼婵堫槶濠殿喗锕╅崢鍓х不閹€鏀介柣妯哄级閹兼劗绱掗悩宕囧濞ｅ洤锕俊鍫曞磼濮橆偄顥氶梻鍌欑閻ゅ洤螞閸曨垁鍥敍閻愯尙鍘洪柟鑲╄ˉ閸ㄩ箖鎮㈤崗鐓庢闂侀潧鐗嗗Λ娆撴儊濠婂懐纾介柛灞捐壘閳ь剚鎮傚畷鎰槹鎼淬埄鍋ㄥ┑顔筋焾娴滎剛澹曢懞銉﹀弿婵☆垱瀵х涵鍓х棯閹岀吋闁哄瞼鍠栭弻鍥晝閳ь剟寮稿☉銏＄厱闁靛濡囩粻鐐烘煛瀹€瀣瘈鐎规洘锕㈡俊姝岊槻妞わ絾妞藉娲川婵犲嫭鍣ч梺鎸庢处娴滎亪骞冮敓鐙€鏁冮柨鏇楀亾闁绘劕锕弻鏇熺節韫囨搩娲銈忓瘜閸欏啫顫忛悜妯侯嚤婵炲棙鍨硅摫婵犵绱曢崑鐘参涢崟顖ょ稏?
            this.entityData.set(SYNC_BASE_NAME, normalizeBaseName(tag.getString("TurretBaseName")));
        }
        if (tag.contains("PlayerNameLocked")) {
            setPlayerNameLocked(tag.getBoolean("PlayerNameLocked"));
        }
        if (tag.contains("TurretBaseName")) {
        }
        this.squadJoinTime = tag.getLong("SquadJoinTime");
        super.readAdditionalSaveData(tag);
        setTier(tag.getInt("TurretTier"));
        this.xpBuffer = tag.getInt("XpBuffer");
        this.entityData.set(KILL_COUNT, tag.getInt("KillCount"));
        this.entityData.set(IS_BRUTAL, tag.getBoolean("IsBrutal"));
        brutalityActiveTimer = tag.getInt("BrutalTimer");
        brutalityCooldown = tag.getInt("BrutalCD");
        this.entityData.set(IS_CAPTAIN, tag.getBoolean("IsCaptain"));
        this.entityData.set(IS_SQUAD_MEMBER, tag.getBoolean("IsSquadMember"));

        // Read Teleport Module Data
        if (tag.contains("HasTeleportModule")) {
            this.setHasTeleportModule(tag.getBoolean("HasTeleportModule"));
        }
        if (tag.contains("TeleportCooldown")) {
            this.teleportCooldown = tag.getInt("TeleportCooldown");
        }

        if (tag.hasUUID("OwnerUUID")) ownerUUID = tag.getUUID("OwnerUUID");

        if (tag.contains("Inventory")) {
            ListTag itemList = tag.getList("Inventory", 10);
            for (int i = 0; i < itemList.size(); i++) {
                CompoundTag itemTag = itemList.getCompound(i);
                int slot = itemTag.getByte("Slot") & 255;
                if (slot < inventory.getContainerSize()) {
                    inventory.setItem(slot, ItemStack.of(itemTag));
                }
            }
        }
        updateStatsAndEquip();
    }

    // ==========================================
    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犖ч柛銉㈡櫇閸樼娀姊绘担绋款棌闁稿鎳庣叅鐎广儱顦悞鍨亜閹烘埊鍔熼柣锝囨暩閳ь剝顫夊ú鏍Χ閸涘﹥鍙忛柍褜鍓熼弻鏇＄疀鐎ｎ亞浠煎銈忚吂閺呮盯鍩為幋鐐茬疇闂佺臎閸涱厾绛忔繛瀵稿Т椤戝懘鎮块濮愪簻闁哄稁鍋勬禒婊堟煟閵堝洤浜鹃柕鍥у楠炴帒顓奸崶褍顬夐梻浣告啞閻熴儳鎹㈤幋锕€绠為柕濞垮剻閺冨牆鐒垫い鎺嗗亾閾荤偞淇婇妶鍕厡妞も晜鐓￠弻锝夊箛椤旂厧濡洪梺缁樻尵閸犳劙濡甸崟顖氱閻庨潧鎽滈悡鈧梻渚€鈧偛鑻晶顖滅磼鐠囪尙澧﹂柣娑卞櫍瀹曟﹢顢旈崨顓熺€梻浣告啞濞诧箓宕滃▎鎿冩晛闁瑰墽绮悡鐔兼煟閺傛寧鎲搁柟鍐插暣閹顫濋悡搴㈢彎閻庤娲橀悷鈺呭极瀹ュ绀嬫い鎾跺缁辨娊姊绘担渚劸闁哄牜鍓欓～婵嬪Ω閵壯勬噧缂傚倸鍊搁崐椋庣矆娓氣偓钘濋梺顒€绉寸粻鐘绘煙閸撗呭笡闁稿鏅犻弻锝夊箣閿濆憛鎾绘煛閸涱喗鍊愰柡宀嬬到铻ｉ柛顭戝枤濮ｃ垽姊洪崨濠冣拹闁圭鍟块～蹇撁洪鍕獩婵犵數濮撮崐鎼佀夐崼銉︹拺闁告稑锕ゆ慨鍌炴煕閺傚灝顒㈢紒鍌氱Ч閹囧醇閵忋垻妲囬梻浣圭湽閸ㄨ棄顭囪閳兘姊绘担瑙勫仩闁告柨閰ｅ畷銏ｎ樄闁糕斂鍨藉顒佹償閹炬惌娼旀繝娈垮枟椤牊绂嶉鍕亗閻庯綆鍠楅埛鎴︽煕閿旇寮ㄦ俊鐐倐閺屾盯鎮╅幇浣圭杹閻庤娲橀崹鍧楀春閿熺姴纾兼俊顖氭贡閻╁酣姊绘担鍛婅础闁稿簺鍊濆畷褰掓偨閸撳弶鏅滈梺鍐叉惈閹冲繘鎮″☉銏″€甸柨婵嗗€瑰▍鍥╃磼閹邦厽顥堥柡宀€鍠栭、娆戠驳鐎ｎ偆鏆ラ梻浣哥枃濡嫰藝椤栫偛鐓濈€广儱顦伴幆鐐淬亜閹扳晛鐏ù鐘虫尦濮婂搫鐣烽崶鈺佺闂佸湱鎳撳ú銈夋偩闁垮闄勭紒瀣仢瀹撳棝姊虹紒妯荤叆闁圭⒈鍋勯?(Phase 3)
    // ==========================================
    public void restoreFromRecord(CompoundTag dataTag) {
        // 1. 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼妽闁稿繑绮撻弻娑㈩敃閿濆棛顦ラ梺姹囧€濈粻鏍蓟閿濆绠涙い鎾跺О閸嬬偤姊洪崫鍕靛剰缂佸缍婂濠氬Ω閵夈垺鏂€闂佺硶妾ч弲婊嗗€撮梻鍌欑窔閳ь剛鍋涢懟顖炲储閸濄儳纾奸柤闀愮祷婢规﹢鏌ｉ敐鍥у幋濠碘剝鎮傞崺鈩冪節閸愨晜鐝┑鐘垫暩閸嬫稑螞濞嗘挸绀夐柡鍥╁枎閸ㄦ柨霉閻撳海鎽犻柍閿嬪笒闇夐柨婵嗙墛椤忕娀鎮介娑氭创闁哄本鐩俊鎼佸煛閸屾盯鏁梺缁樻尪閸婃繈寮婚妸鈺佺睄闁割偆鍠愬▓浼存⒑?
        if (dataTag.contains("UnitID")) this.entityData.set(UNIT_ID, dataTag.getInt("UnitID"));
        if (dataTag.contains("Tier")) this.setTier(dataTag.getInt("Tier"));
        if (dataTag.contains("Heat")) this.entityData.set(DATA_HEAT, dataTag.getInt("Heat"));
        // Level is derived from Tier
        if (dataTag.contains("XP")) this.entityData.set(DATA_XP, dataTag.getInt("XP"));
        if (dataTag.contains("IsBrutal")) this.entityData.set(IS_BRUTAL, dataTag.getBoolean("IsBrutal"));
        if (dataTag.contains("UpgradeProgress")) this.entityData.set(UPGRADE_PROGRESS, dataTag.getInt("UpgradeProgress"));
        if (dataTag.contains("KillCount")) this.entityData.set(KILL_COUNT, dataTag.getInt("KillCount"));

        // 1.1 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ帒顦伴弲顏堟⒑閸濆嫮鈻夐柛妯恒偢瀹曟帡濡歌閸犳劙鏌ｅΔ鈧悧鍡欑箔閹烘鐓曢柕濞垮劚閳ь剙顭烽獮澶愬箹娴ｇ懓浜遍梺鍓插亝缁诲倿骞嗛悙鐑樷拺闁硅偐鍋涢崝鎾煕閹惧鎳囬柟顖氳嫰铻栭柍褜鍓熼垾锔炬崉閵婏箑纾梺鍛婄箓鐎氬嘲危閻㈠憡鈷戦柛婵嗗閸庢劙鏌ｅΔ鍐ㄢ枅鐎殿喖顭烽弫鎰緞鐎ｎ亙姹楅梺鍝勵槸閻楀嫰宕濇惔銊ノч柡澶婄氨閺€浠嬫煟閹邦剙绾ч柛锝囧劋缁绘盯鎳犻鈧弸娑欘殽閻愬弶顥㈢€规洖鐖兼俊姝岊檨婵炴潙瀚伴弻锝嗘償椤栨粎校闂佺顑呭Λ婵嗙暦閵忋倕纭€闁绘劏鏅滈弬鈧梻浣虹帛椤牓顢氬鍐惧晠闁靛鏅滈悡鏇㈡煟閺冨牜妫戦柨娑樼Ч閺屽秷顧侀柛鎾村哺閹矂顢氶埀顒€鐣烽敓鐘茬闁芥ê顦抽幗鏇㈡⒑缂佹ɑ鈷掗柍宄扮墦瀵偅绻濋崶銊у幘闂佽鍘界敮鎺楀礉閵堝棎浜滈柨鏂跨仢瀹撳棙鎱?
        if (dataTag.hasUUID("OwnerUUID")) {
            this.ownerUUID = dataTag.getUUID("OwnerUUID");
            this.entityData.set(OWNER_UUID_SYNC, Optional.of(this.ownerUUID));
        }
        if (dataTag.contains("BaseName")) {
            this.entityData.set(SYNC_BASE_NAME, normalizeBaseName(dataTag.getString("BaseName")));
        }
        // 闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃繘鍩€椤掍胶鈻撻柡鍛█閵嗕礁鈻庨幘鍐插敤濡炪倖鎸鹃崑鐔兼偘閵夆晜鈷戦柛婵嗗閳诲鏌涘Ο鍨汗缂侇喛宕甸幉鎾礋閳衡偓缁ㄥ姊虹憴鍕凡濠⒀冮叄閹箖鏌嗗鍡欏幐闂佸憡娲嶉弲娑㈠礉濠婂叇搴ㄥ炊瑜濋煬顒€鈹戦垾宕囧煟鐎规洏鍔戦、娆撳礂绾板彉鍝楃紓鍌氬€搁崐椋庢媼閺屻儱纾婚柟鍓х帛閻撴洟鏌嶉埡浣告殶闁愁垱娲熼弻宥夋煥鐎ｎ亞浼岄梺鍝勬湰閻╊垶鍨鹃敃鍌氱婵犻潧娲ㄨぐ顖炴⒒娴ｄ警鐒鹃悗娑掓櫊瀹曟繂鈻庨幘瀹犳憰闂佹寧绻傞ˇ顖滅不缂佹ǜ浜滈柡宥冨妿閻擃垰顭跨憴鍕闁宠鍨块幃鈺呭垂椤愶絾鐦庨梻浣侯焾椤戝洭宕戦妶鍛殾鐟滅増甯掗柋鍥煛閸モ晛浠фい鏂挎喘濮婃椽宕烽鈩冾€楅梺鍝ュУ閻楁粍绔熼弴鐔虹瘈婵﹩鍘鹃崢鐢告⒑鐠団€崇€婚悘鐐跺Г椤斿秶绱撻崒娆掑厡濠电偐鍋撶紓浣哄У閻楃姴顕ｇ拠娴嬫闁靛繒濮锋导瀣倵鐟欏嫭绀€婵炲眰鍔戦幃鐐偅閸愨斁鎷虹紓浣割儐椤戞瑩宕曢幇鐗堢厵闁荤喓澧楅崰妯活殽閻愬澧抽柕鍥ㄥ姍楠炴帒鈹戦崶銊︾彇闂傚倷绀侀崯鍧楁倶閸儱鐤炬繛鎴炵懅椤╂彃螖閿濆懎鏆為柣鎾寸懇閺岀喖顢涘☉娆戝嚒閻炴碍宀稿?
        updateCustomName();

        // 2. 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ帒顦伴弲顏堟⒑閸濆嫮鈻夐柛妯恒偢瀹曟帡濡歌閸犳劙鏌ｅΔ鈧悧鍡欑箔閹烘鐓曢柕濞垮劚閳ь剙顭烽獮澶愬箹娴ｇ懓浜遍梺鍓插亝缁诲倿骞嗛悙鐑樷拺闁硅偐鍋涢崝鎾煕閹惧鎳囬柟閿嬪灴閹垽宕楅懖鈺佸妇濠电姰鍨奸崺鏍矙閹剧粯鍋╅弶鍫涘妿缁犻箖鏌涢銈呮瀻闁诲繑鎸抽弻鈥崇暆鐎ｎ剛袣缂備胶濮甸惄顖氼嚕閹绢喗鍊烽柡澶嬪閹层垹鈹戦悩娈挎毌婵℃彃鎳樺畷鎴﹀礋椤撴稑浜炬慨姗嗗亜瀹撳棙顨?
        this.inventory.removeAllItems();
        if (dataTag.contains("Inventory")) {
            ListTag inventoryList = dataTag.getList("Inventory", 10);
            for (int i = 0; i < inventoryList.size(); i++) {
                CompoundTag itemTag = inventoryList.getCompound(i);
                int slot = itemTag.getByte("Slot") & 255; // Use getByte to be safe
                if (slot >= 0 && slot < this.inventory.getContainerSize()) {
                    this.inventory.setItem(slot, ItemStack.of(itemTag));
                }
            }
        }

        // 3. 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ帒顦伴弲顏堟⒑閸濆嫮鈻夐柛妯恒偢瀹曟帡濡歌閸犳劙鏌ｅΔ鈧悧鍡欑箔閹烘鐓曢柕濞垮劚閳ь剙顭烽獮澶愬箹娴ｇ懓浜遍梺鍓插亝缁诲倿骞嗛悙鐑樷拺闁硅偐鍋涢崝鎾煕閹炬潙鍝虹€规洜鏁婚獮瀣倷椤忓啰鐩庨梻浣烘嚀閹碱偆绮旈崼鏇€鍥晝閸屾稓鍘搁梺鍛婁緱閸犳牠鍩㈤弴鐔稿弿濠电姴鍟妵婵堚偓瑙勬磸閸斿秶鎹㈠┑鍥ㄥ闁惧繐婀遍悾鎶芥⒒閸屾瑧顦﹂柟璇х節閹兘濡烽敂缁橆啍缂備礁顑呴悘婵堢矈椤愶附鈷掑ù锝囶焾椤ュ繘鏌ｉ幘宕囧ⅵ鐎规洘鍨垮畷鎺戭煥閸曨偄绨ラ梻浣虹《閸撴繄绮欓幒妤佸亗闁哄洨鍠撶粻楣冩煕閳╁喚娈曠紒鍌氼儐娣囧﹪宕ｆ径瀣偓鎰版煛瀹€瀣К缂佺姵鐩獮娆撳礋椤愩埄娼紓?
        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁逞屽墾缁犳挸鐣锋總绋款潊闁炽儱鍟跨花銉╂⒒娴ｇ瓔娼愬鐟版閺呰泛螖閸涱厾锛涢柣搴秵娴滄牠寮ㄦ禒瀣厽婵☆垵顕х徊缁樸亜韫囷絽浜伴柡灞剧☉铻栧ù锝囶焾閹界敻姊洪崫鍕潶闁稿﹥鐗犻獮鍫ュΩ閳轰胶鐤€濡炪倖鍨煎Λ鍕閻愵兛绻嗛柕鍫濇噺閸ｆ椽鏌涙惔銏╂畷闁逛究鍔岃灒闁割煈鍠氶崢顐︽⒑缂佹ɑ鎯堢紓宥勭窔閹繝顢曢敃鈧悙濠囨煏婵犲繐顩い锔哄姂濮婃椽骞栭悙娴嬪亾閹版澘纾婚柟鎯у绾句粙鏌涚仦鍓ф噯闁稿繐鑻埞鎴︻敊閻愵剚姣堥梺璇″灠鐎氫即銆佸☉銏″€烽柤鑹板煐閹蹭即姊绘担鑺ョ《闁哥姵鎸婚幈銊╁箻椤旂晫鍘戦梺鎼炲劘閸斿海寮ч埀顒勬⒑閸撹尙鍘涢柛瀣閹便劑宕煎┑鎰〃闂佹悶鍎崝瀣崲閸℃稒鐓熼柟鏉垮悁缁ㄥ鏌嶈閸撴岸宕归崹顔炬殾闁哄洢鍨洪悞鑲┾偓骞垮劚濡瑥鈻嶉崶褜娓婚柕鍫濇噽缁犱即鏌ｅΔ鈧Λ婵嗩嚕?(婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾剧粯绻涢幋娆忕労闁轰礁顑嗛妵鍕箻鐠虹儤鐎鹃梺鍛婄懃缁绘劙婀侀梺绋跨箰閸氬绱為幋鐘垫／闁诡垎鍕淮濠殿喖锕ら…宄扮暦婵傚憡鍋勭€瑰嫭婢樼粻顖炴⒒娴ｇ懓顕滅紒璇插€哥叅闁靛ě鍐炬闂佺绻樺Λ璺ㄦ崲閸℃ǜ浜滈柡宥冨妽閻ㄦ垶鎱ㄩ敐鍥т槐闁哄矉绱曢埀顒婄秵閸嬪棙鏅堕崹顐ｅ弿濠电姴鍟妵婵囶殽閻愬澧甸柟顔界懇楠炴捇骞掗幊韬插劚閳规垿鎮╁▓鎸庢瘜闂侀€炲苯澧叉繛鍛礋瀹曟澘螣濮瑰洣绨?
        for (net.minecraft.world.entity.EquipmentSlot slot : net.minecraft.world.entity.EquipmentSlot.values()) {
            this.setItemSlot(slot, ItemStack.EMPTY);
        }

        if (dataTag.contains("Equipment")) {
            ListTag equipmentList = dataTag.getList("Equipment", 10);
            for (int i = 0; i < equipmentList.size(); i++) {
                CompoundTag equipTag = equipmentList.getCompound(i);
                String slotName = equipTag.getString("SlotName");
                net.minecraft.world.entity.EquipmentSlot slot = net.minecraft.world.entity.EquipmentSlot.byName(slotName);
                if (slot != null) {
                    this.setItemSlot(slot, ItemStack.of(equipTag));
                }
            }
        }

        // 4. 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎺嶇劍椤斿洭姊绘担鑺ョ《闁哥姵鎸婚幈銊р偓闈涙憸绾惧ジ鏌嶉崫鍕櫤闁抽攱鍨堕妵鍕箳閸℃ぞ澹曠紓鍌欑椤︿即骞愰幎钘夌闁硅揪闄勯崑鍕倶韫囧海鍔嶉柡鍌楀亾闂傚倷鑳剁划顖濇懌閻熸粍婢橀崯鎾€侀弮鍥舵Ъ缂備胶绮粙鎴︽偩濠靛洨绡€濞撴埃鍋撻柛瀣殜濮婃椽宕崟顓犲姽缂傚倸绉崇欢姘舵偘椤旈敮鍋撻敐搴濈按闁衡偓娴犲鐓曢柕澶嬪灥閺堫剝鈪搁梻?
        this.updateStatsAndEquip();

        // 5. [Fix] 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼槮闁搞劍绻冮妵鍕冀椤愵澀绮舵俊妤€鎳庨埞鎴︽倷閺夋垹浠ч梺鎼炲妼缂嶅﹪骞冮崸妤佸€锋い鎺戝€婚惁鍫ユ⒒閸屾氨澧涘〒姘殜瀹曟洝绠涢弴鐘碉紲闂佺粯锚绾绢厽鏅堕鍫熺厓閻熸瑥瀚悘鎾煙椤旇娅婄€规洩绲惧鍕節鎼粹懣鐔兼⒒閸屾瑨鍏屾い顓炵墦椤㈡牠宕卞☉妯碱槷濠电偛妫欓幐鎼佹嫅閻斿吋鐓忛柛顐ｇ箥濡茬霉閼测晛鈻堥柡灞炬礃瀵板嫬螣閻戞浜舵繝娈垮櫙缁蹭粙鎯岄崒姘兼綎闁惧繐婀遍惌娆愮箾閸℃ê鍔ら柛鎾讳憾濮婅櫣鎲撮崟顓熸啓閻庤娲滈弫鎼佸礆閹烘鏁囬柕蹇娾偓鍏呯盎闂備胶绮幐绋棵归悜钘夌闁挎洍鍋撴い顏勫暣婵″爼宕卞Δ鍐噯闂佽瀛╅崙褰掑礈閻斿娼栧┑鐘冲嚬閺佸秹鏌ｉ幇顒夊殶闁告鏁诲濠氬磼濮橆兘鍋撻幖渚囨晪妞ゆ挶鍨圭粈澶屸偓骞垮劚椤︿即鎮?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲梺姹囧€ら崰妤呭Φ閸曨垰绠涢柍杞拌兌閸旀挳姊洪幖鐐测偓鏍洪悢鐓庤摕婵炴垯鍩勯弫鍐煥濠靛棙顥滄い锔规櫊濮婄儤娼幍顕呮М濠碘槅鍋呴悷褔骞戦姀鐘闁靛繒濮烽娲⒑缂佹ê濮囬柣蹇斿哺瀹曞疇顦寸紒杈ㄦ尰閹峰懐绮欏▎鐐闂備胶顭堥鍥窗閺嶎厼鏄ラ柍褜鍓氶妵鍕箳閸℃ぞ澹曠紓鍌欒兌婵绮旈悷鎵殾闁哄洢鍨圭涵鈧梺缁樺姇缁夌數绮欓幋锕€鐓濋幖娣妼缁犵粯绻濋姀鐘差伒缂佺姵鎹囧濠氭晲婢跺﹥顥濋梺鍓茬厛閸犳宕愰鐐粹拺缂備焦蓱鐏忕増绻涢崣澶涜€挎鐐茬墦婵℃悂濡烽钘夌紦闂備胶纭堕崜婵嬨€冮崨杈剧稏闁宠桨绶″〒濠氭煏閸繃顥滅紒鏃堢畺閺屾盯濡搁妶鍥╃厯閻庢鍠涢褔鍩ユ径濠庢僵闁挎繂鎳嶆竟鏇㈡⒑閹稿海绠撳Δ鐘叉啞缁傚秴鈹戦崼姘壕閻熸瑥瀚粈鈧梺娲诲幖閸婂灝顕?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墴閹潡顢氶埀顒勫蓟閿濆憘鏃堝焵椤掑嫭鍋嬮煫鍥ㄦ礈娑撳秴螖閿濆懎鏆為柣鎾冲暟閹茬顭ㄩ崼婵堫槶闂佺粯姊婚崢褔鎷戦悢鍝ョ闁瑰瓨鐟ラ悘顏堟煛閸涱喚鍙€闁哄本鐩崺鍕礂閻欌偓娴滎亪宕洪埀顒併亜閹哄秶顦﹀┑顔肩Ч閺?
        this.setNoGravity(false);
        this.resetFallDistance();
        this.setDeltaMovement(0, -0.1, 0); // 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻锝夊箣閿濆憛鎾绘煕婵犲倹鍋ラ柡灞诲姂瀵挳鎮欏ù瀣壕鐟滅増甯掔壕濠氭煥閻斿搫校闁绘挸绻橀弻娑㈩敃閿濆洨鐣虹紓浣歌嫰閻忔繈鍩為幋锔绘晩闁芥ê顦弸娆撴⒑閸濆嫯顫﹂柛鏂跨焸閸╃偤骞嬮敃鈧獮銏′繆椤栨瑨顒熼柍褜鍓氶惄顖氼潖濞差亜绠归柣鎰ゴ閸嬫捇寮介婧惧亾閸愵喖骞㈡繛鎴烆焸閿曞倹鐓曢柡鍥ュ妼閻忕姷绱掗銏⑿ч柡灞剧洴婵＄兘骞嬪┑鍡忓亾瑜版帗鍎撻煫鍥ㄦ⒒缁♀偓濠电偛鐗嗛悘婵嗏枍濞嗘垹纾奸棅顐幘閻瑩鏌熼銊ユ搐缁犲鎮归崶顏勮敿闁硅姤娲栭埞鎴︽倷閺夋垹浠搁梺鎸庢磵閺呮盯鈥﹂崶顒€鐓涢柛灞久肩花濠氭⒑鐟欏嫬绀冩繛澶嬬⊕缁傛帟顦查棁澶愭煟濞嗗苯浜鹃梺鎼炲妼绾绢厼危閹版澘绠婚悗娑櫭鎾绘煟閻樺弶绀岄柛鎾寸箞閹箖宕奸弴鐔叉嫼缂佺虎鍘奸幊蹇涙偟椤忓牊鐓ラ柡鍥悘鈺傘亜閺囶亞绋荤紒缁樼箓椤繈顢楅埀顒傜玻濞戙垺鐓熼幖娣灮閳洟鏌ㄥ顑炵懓顭ㄩ崟顓犵厜闂佽鍠楅〃濠囧箖閻戣棄绾ф繛鍡楀綖缁辨棃姊绘担渚劸妞ゆ垵鎳橀弫鍐敂閸曨厽娈惧銈嗗坊閸嬫捇鎮￠妶鍡愪簻闊洦鎸婚崳浠嬫煕濡湱鐭欐慨濠呮缁辨帒螣閼姐倕寮抽梻浣侯攰婵倗鍒掗幘鑽ゅ祦濠电姴娲ら崡鎶芥煟濡吋鏆╅柨娑欑矒濮婅櫣绱掑Ο蹇ｄ邯瀹曨垶宕稿Δ浣糕偓鍫曟⒑椤掆偓缁夌敻鎮¤箛娑欑厱闁靛绲芥俊鐓庘攽椤旇偐肖闁逞屽墲椤煤濡吋鏆滈柨鐔哄Т缁犳牗绻涢崱妯诲鞍闁搞倖鍨堕妵鍕箳閹搭厽笑闂佽桨妞掔划娆忣潖婵犳艾纾兼繛鍡樺灩閻涖垹鈹戦悙鏉垮皟闁搞儰绀佸ú顓€佸鈧慨鈧柣妯碱暜缁辩敻姊绘担鍛婃儓閻炴凹鍋婂畷鏇熸綇閳哄啰鐒奸柣搴秵閳ь剦鍘藉Λ鍐极閹版澘宸濇い鎾跺枑椤斿姊绘担铏瑰笡闁规瓕顕х叅闁绘梻鍘ч拑鐔兼煟閺冨倸甯跺ù鑲╁█閺屾盯寮撮姀鈩冮敪闂佸憡鎸烽崡鍐差潖濞差亝鐒婚柣鎰蔼鐎氭澘顭胯閸ㄥ爼寮婚敐鍛傛棃宕橀妸鎰╁灪閵?
        this.setOnGround(true); // 婵犵數濮烽弫鍛婃叏閻戝鈧倿鎸婃竟鈺嬬秮瀹曘劑寮堕幋鐙呯幢闂備礁鎲℃笟妤呭矗鎼淬劍鍋勯柛鈩兠肩换鍡樸亜閺嶃劍鐨戞慨锝囧仱閺屾稓鈧綆鍋呯亸顓熴亜椤愶絿绠為柟顔瑰墲閹棃鏁愰崟顒夋晣婵犵绱曢崑鎴﹀磹閹达箑鍨傛繛宸簼閸嬶繝鏌嶆潪鎵窗闁搞倖娲熼弻鐔虹磼閵忕姵鐏嶉梺绋款儏鐎氫即骞冪捄琛℃闁圭儤鍨甸埛澶愭⒑鐠囪尙绠伴柛鐔告綑椤繒绱掑Ο璇差€撻梺鎯х箳閹虫挾绮敓鐘斥拺闁硅偐鍋涙俊濂告煟閺嵮佸仮鐎殿噮鍋嗛埀顒婄秵閸嬪棛寮ч埀顒勬⒑闂堟盯鐛滅紒鎻掑⒔濞戠敻宕滆绾剧厧顭跨捄鐚村姛缂佸娅ｉ埀顒侇問閸犳盯顢氳閸┿儲寰勯幇顒夋綂闂佹枼鏅涢崯顖炴偟閺囥垺鈷掑ù锝堟琚氶梺鎸庣閵囧嫰鏁冩担璇℃闁捐崵鍋ら弻娑㈠焺閸愬墽鍔风紓浣叉閸嬫挻绻濋悽闈涗粶闁绘妫濋幃妯衡攽鐎ｎ亜鍤戦梺缁樻煥閸氬鎮″▎鎰╀簻闁哄啫鍊哥敮鍫曟煃瑜滈崜娆忣焽閿熺姴绠栧ù鍏兼儗閺佸鏌嶈閸撶喎鐣峰ú顏勭劦妞ゆ帊闄嶆禍婊堟煙閸濆嫭顥滃ù婊堢畺濮婃椽妫冨☉娆樻！闁汇埄鍨辩敮锟犳晲閻愭祴鏀介悗锝呯仛閺呫垺绻濋悽闈浶㈤柛濠冩倐閿濈偤鎮╅悽鐢碉紳闂佺鏈悷銊╊敊婢舵劖鐓曢悗锝庡亝鐏忣厽銇勯鐐村仴闁硅櫕绮撳Λ鍐ㄢ槈濮楀棙缍岄梻鍌欒兌缁垶骞愭ィ鍐ㄧ獥闁哄稁鍘奸拑鐔兼煛閸ラ纾块柣銈傚亾闂佽鍑界紞鍡樼閻愬顩烽柛鎾楀懐锛濇繛杈剧到閹碱偄鏆╅梺鑽ゅ仦濮樸劌銆掔粵鎾⒒閸屾艾鈧悂宕愰幖浣哥９闁归棿绀佺壕鐟邦渻鐎ｎ亜顒㈡い鎰矙閺屻劑鎮㈤崫鍕戙垻鐥幆褜鐓奸柡灞剧☉閳藉宕￠悙鑼洿闂備焦瀵х换鍌炈囬婊呬笉闁规儼濮ら悡娑㈡煕閹板墎鍒板ù婊勫劤椤啴濡堕崱妤€顫戞繝娈垮枔閸婃繃淇婇悽绋跨妞ゆ牗姘ㄩ悿鈧梻浣告啞閹哥兘鎮為敃鍌氱；鐟滄柨顫忛崫鍕殾闁搞儯鍔屽▓宀€绱撴担鍓叉Ш闁轰胶绮穱濠囨偨缁嬭法顦板銈嗙墬濮樸劑鎯堥崟顖涒拺缂佸瀵у﹢鎵磼椤旇偐效妤犵偛顦～婊堝焵椤掆偓椤繐煤椤忓嫬绐涙繝鐢靛Т閸熶即宕㈤幖浣光拺?
    }

    @Override protected boolean isSunBurnTick() { return false; }

    // ==========================================
    // 闂?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧潡鏌熺€电孝缂佽翰鍊濋弻锕€螣娓氼垱锛嗛悷婊呭鐢帞澹曟總鍛婄厽闁归偊鍨伴惃娲煟濞戞牕鍔︽慨濠冩そ瀹曨偊宕熼娑欑€遍梻浣告啞钃辨俊顐㈠暙閻ｇ兘宕奸弴銊︽櫌闂侀€炲苯澧撮柟閿嬪灴閹垽宕楅懖鈺佸妇濠电姰鍨奸崺鏍儎椤栨凹鐎舵い鏃傛櫕缁犻箖鏌涘☉鍗炴灓濠⒀屼邯閺屽秶鎲撮崟顐や紝濡炪們鍨洪悷鈺侇嚕椤掑嫬围闁告洦鍙€缁绘垿姊婚崒娆掑厡妞ゎ厼鐗撻、鏍川閺夋垹鐤囧┑鈽嗗灥濞咃綁寮抽敃鍌涚叆婵犻潧妫涙晶銏ゆ煟閵堝倸浜惧┑鐘垫暩閸嬬偤宕归崼鏇熷仭鐟滄柨鐣烽姀銈呯濞达絽鍘滈幏娲⒒娓氬洤浜為柛瀣洴閹崇喖顢涘☉娆愮彿闁诲海鏁哥涵鍫曞磻閹捐埖鍠嗛柛鏇ㄥ墰椤︻參姊虹粙璺ㄧ闁挎洏鍨芥俊瀛樻媴閸撳弶寤洪梺閫炲苯澧存鐐插暣婵偓闁靛牆鎳庣粣娑欑節閻㈤潧孝缂併劌銈搁獮瀣倻閼恒儮鎷婚梺绋挎湰閼归箖鍩€椤掑倸鍘撮柟铏殜瀹曟粍鎷呯粙璺ㄤ喊婵＄偑鍊栭悧婊堝磻濞戞瑯鏀板┑鐘垫暩閸嬬偤宕归鐐插瀭鐟滅増甯楅崑顏堟煟閹伴潧澧扮紒鐘荤畺閺岀喓鈧稒顭囬幊鍐煟韫囷絼閭柡灞剧⊕閹棃濮€閳ユ娊鐎洪梻渚€鈧稓鈹掗柛鏂跨焸閳ユ棃宕橀鍛彴闂傚鍋掗崢濂杆夊顑芥斀閹烘娊宕愬Δ浣瑰弿闁绘垼妫勭壕濠氭煙閻楀牊绶茬痪鎯ь煼閺岀喖宕滆鐢盯鏌涚€Ｑ冨⒉缂佺粯绻冪换婵嬪磼濮橀棿绱戠紓鍌欒兌婵絻鎽繛锝呮搐閿曨亜鐣烽敐鍡楃窞濠电姴鍋嗗鎾绘⒒娴ｅ摜鏋冩い顐㈩樀瀹曠銇愰幒鎴犲姦濡炪倖甯掗敃锔剧矓閻㈠憡鐓曢悗锝庝簻椤忊晠鏌嶇紒妯诲碍閾绘牠鏌涘☉鍗炴灓闁告ê鎲＄换婵嬪閿濆棛銆愰梺鎸庢穿闂勫嫰寮查崼鏇炵疀闁绘鐗忛崢鎼佹⒑閸涘﹣绶卞ù婊勭箓閳诲秵绻濋崶銊у幍濡炪倖姊婚悺鏂库枔濠婂嫷娈介柣鎰摠瀹曞本顨ラ悙鏉戠仴閾绘牠鏌涢幇銊︽珔婵炲牆鑻—鍐Χ鎼粹€崇闂佸憡姊归崹鍧楁偘椤曗偓瀹曞爼顢楁径瀣珦闂備浇顫夐崕鎶藉箠閹版澘瑙﹂悷娆忓缁♀偓闂佹眹鍨藉褎绂掗敂鐣岀闁稿繗鍋愰幊鍥┾偓瑙勬磸閸庢娊鍩€椤掑﹦绉甸柛鎾村哺瀵啿顭ㄩ崼鐔哄帗闂侀潧顦崕鎶芥晬瀹ュ鐓涢柛鈽嗗弮濡绢噣鏌熸笟鍨閾伙綁鏌熺粙鎸庢崳闁靛棙鍔欓弻娑㈠Ψ閿旇棄鍞夊┑顔硷攻濡炶棄鐣烽妸锔剧瘈濞达綀娅ｇ粻鎺楁⒒娴ｈ鍋犻柛鏂胯嫰閻ｇ兘顢楅崘鐐瘞?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁逞屽墾缁犳挸鐣锋總绋款潊闁炽儱鍟跨花銉╂⒒娴ｅ憡璐￠柛搴涘€濋妴鍐川閺夋垹锛滈梺闈浤涢崟顐ｇ€鹃梻浣告惈閸燁偊鎮ч崟顖氱劦妞ゆ垼娉曢ˇ锕傛煃鐠囨煡鍙勬鐐疵悾鐑藉炊閳哄倹绶繝纰夌磿閸嬫垿宕愰弽顓炲瀭闁稿繐鍚嬮崣蹇涙煏閸繍妲归柛瀣€块弻鏇＄疀鐎ｎ亖鍋撻弽顓炵厱闁硅揪闄勯悡鐔兼煙閹冩毐闁伙负鍔嶇换娑㈡嚃閳轰焦鐏堥梺鍝勬湰缁嬫帞鎹㈠┑瀣妞ゅ繐瀚ч幏浼存⒒娴ｇ瓔鍤冮柛鐘愁殜閺佸顪冮妶鍡樺碍闁靛牏顭堥悾鐑芥焼瀹ュ懎宓嗛梺缁橆焽閺佹悂寮抽弶搴撴斀闁挎稑瀚禍濂告煕婵犲啰澧甸柟顔ㄥ洤绠婚悹鍥皺閿涙瑥鈹戞幊閸婃洟宕位澶婎潩閼搁潧浠梺璇″幗鐢帗淇婄捄銊ф／?
    // ==========================================
    @Override
    public net.minecraft.world.entity.MobType getMobType() {
        // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑鏅悷婊冪箻楠炴垿濮€閵堝懐鐤€濡炪倖妫佸Λ鍕償婵犲洦鈷戠憸鐗堝笒娴滀即鏌涙惔銊︽锭闁宠棄顦灒闂佸灝顑愬鏃堟⒒娓氣偓濞佳呮崲閹烘挻鍙忛柣銏犳啞閸婂灚銇勯幒鎴濐仾闁抽攱鍨块弻锝夋偄閸涘﹦鍑￠梺鎶芥敱濮婅崵妲愰幒妤婃晪闁告侗鍘炬禒鎼佹倵鐟欏嫭绀冮柛銊ョ秺閸┾偓妞ゆ帒锕︾粔鐢告煕閻樻剚娈滈柟顕嗙節瀹曟﹢顢欓悾灞藉箞婵犵數濞€濞佳兾涘Δ鍜佹晜闁冲搫鎳忛悡娑㈡煕閳╁啫濮囬柣蹇ｄ邯閺屾洟宕惰椤忣厽銇勯姀鈩冪妞ゃ垺顨婂畷鎺戭煥閸曨剦鍟岄梻鍌氬€风粈渚€骞栭锕€瀚夋い鎺戝閸庡孩銇勯弽銊р棩缂佽妫濋弻鐔兼⒒鐎靛壊妲柛鐑嗗灠椤啴濡堕崱妯锋嫽闂佸憡顭嗛崟顓犲骄闂佺硶鍓濋悷褏澹?UNDEAD(婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾剧粯绻涢幋娆忕仾闁稿鍊濋弻鏇熺箾瑜嶉崯顐︽倶婵犲洦鈷戦柟绋挎捣缁犳挻绻涚拠褏鐣甸柨婵堝仱瀵挳濮€閿涘嫬骞愰梻浣规偠閸庮噣寮插☉銏犲嚑閹兼惌娼挎禍? 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ巻鍋撴潻婵嬫⒑闁偛鑻晶鎾煛鐏炲墽銆掗柍褜鍓ㄧ紞鍡涘磻閸涱厾鏆﹂悘鐐靛亾閸欏繐鈹戦悩鎻掓殲闁靛洦绻冮妵鍕閳╁啰顦伴梺杞扮劍閸旀瑥鐣烽崼鏇炵濞达綁顥撶粈鍐磽閸屾艾鈧悂宕愭搴㈠闁哄被鍎辩壕?UNDEFINED(闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墴閹潡顢氶埀顒勫蓟閿濆憘鏃堝焵椤掑嫭鍋嬪┑鐘叉搐閻鐓崶銊р姇闁绘挻鐟х槐鎾存媴闂堟稓浠奸梺鍝勵儑閸犳牠寮诲☉娆愬劅闁靛繆鈧娊鐎洪梻渚€鈧稓鈹掗柛鏂跨焸閳ユ棃宕橀鍛彴闂傚鍋掗崢濂杆夊鑸碘拻?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫆闁芥ê顦純鏇㈡⒒婵犲骸浜滄繛璇у缁瑩骞嬮悩宸闂佺鍕垫畷闁绘挸绻橀弻娑㈩敃閿濆洨顓煎┑锛勫珡閸涱垳锛濋悗骞垮劚濡稒鏅堕鍕厪闁搞儜鍐句純濡ょ姷鍋涘ú顓炵暦婵傜鍗抽柣鏇氳閸嬫挸顓兼径瀣ф嫼闂佸憡绻傜€氼厽鍒婃總鍛婄厱闁规儳顕ú鎾煕閳规儳浜炬俊鐐€栧濠氬磻閹剧粯鐓曟俊顖濆吹閻帞鈧娲橀崹鍧楃嵁濡偐纾兼俊顖滃帶鐢鏌ｉ悢鍝ョ煁缂侇喗鎸搁悾宄邦煥閸愶絾顫嶉梺闈涚箳婵兘鎮鹃崫鍕垫富闁靛牆妫欑壕鐢告煕鐎ｎ偅灏伴柕鍥у婵偓闁斥晛鍟伴ˇ浼存⒑鏉炴壆鍔嶉柛鏃€鐟ラ悾鐑筋敂閸涱喖顎撻梺鍛婄☉椤剟宕仦瑙ｆ斀闁绘ê鐏氶弳鈺佲攽閻愨晛浜炬繝鐢靛仒閸栫娀宕惰閿涙瑩姊鸿ぐ鎺擄紵缂佲偓娴ｈ櫣涓嶉柣鏂垮悑閻撱儵鏌ｉ弬鎸庢儓鐎涙繄绱撴担鍝勑ｇ€光偓閹间礁钃熸繛鎴烆焽閺嗗棝鏌嶈閸撶喎鐣烽幋锔藉€烽柣鎴灻禍妤呮⒑閸濆嫭鍌ㄩ柛銊︽そ瀹曟劙宕奸弴鐔哄幗闂佸綊鍋婇崣搴ㄥ疮韫囨稒鐓熼柟鐑樻尭閸斻倝妫佹径瀣瘈濠电姴鍊绘晶銏ゆ煟閿濆洤鍔嬮柟?
        // 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫鍐煥閺囨浜鹃梺姹囧€楅崑鎾舵崲濠靛洨绡€闁稿本绮岄·鈧梻浣侯焾椤戞垹鎹㈠┑瀣摕闁靛ň鏅涢崡鎶芥煟閹邦厾銈撮柛瀣崄閵囨劙骞掗幋鐙呯幢闂佽鍑界紞鍡涘窗濡ゅ懎鐓曢柟瀵稿亼娴滄粓鏌熼崫鍕棞濞存粌澧界槐鎾存媴閸撳弶笑濡炪倖娲﹂崢楣冨礆閹烘挾绡€婵﹩鍎甸妸鈺傜厓闁告繂瀚埀顒€顭峰畷銏ゅ箻缂佹ê浠┑鐘诧工鐎氼噣鎯岄幒鏂哄亾鐟欏嫭绀冪紒顔芥崌楠炲啴濮€閿涘嫰妾繝銏ｆ硾閿曘儵顢橀崸妤佲拻濞达絿顭堥ˉ蹇涙煟閹惧磭澧︾€规洘鍨垮畷鐔碱敇閻曚礁浠洪梻浣虹帛閸旀宕曢妶澶婄９闁割偅娲橀悡鐔兼煙闁箑骞栫紒鎻掝煼閺屽秹鏌ㄧ€ｎ偒妫冮梺鍝勭焿缁绘繂鐣烽崡鐐╂瀻鐎甸偊鍨崹浠嬪蓟瀹ュ洦鍠嗛柛鏇ㄥ亞娴煎矂姊虹拠鈥虫灍闁荤啿鏅犻獮濠囨偐濞茬粯鏅㈤梺绋挎湰閼规崘鈪烽梻鍌欐祰椤曆冾潩閿曞偊缍栧璺衡姇閸濆嫷鐓ラ柛顐ｇ箖閻庮剟鏌ｉ悩鍙夋悙婵☆垰锕畷鐢稿即閵忥紕鍘甸梻鍌氬€搁顓㈠礉瀹ュ鐓曢悗锝庝簻椤忣參鏌熼绛嬬劸缂佺姵绋掗幆鏃堟晲閸涱収鐎撮梻鍌欐祰椤曆呮崲閹版澘鐤柡澶嬪焾濞兼牗绻涘顔荤盎濞磋偐濞€閺屾盯寮撮妸銉ヮ潻缂備焦鍔栭惄顖氼潖濞差亜浼犻柕澶堝剾閿濆鐓曢柡鍐ｅ亾闁荤啿鏅涢锝嗙節濮橆厽娅囬梺绋挎湰濮樸劑宕㈤幖浣光拺闁告稑锕ｇ欢閬嶆煕閻樺啿鍝虹€规洏鍨介、鏃堝醇閻斿弶瀚肩紓鍌欑贰閸ㄥ崬煤閺嶃劍娅犻柛娆忣槺缁犻箖鏌涘▎蹇ｆШ闁活厽甯為埀顒冾潐濞叉鎹㈤崒鐑嗘晣濠靛倻顭堝婵囥亜韫囨挻濯兼繛鍏兼濮婄粯鎷呯粵瀣秷闂佺楠哥壕顓熺珶閺囥埄鏁囬柣鏂挎啞閻濃剝绻濆閿嬫緲閳ь剚顨嗛幈銊╂倻閽樺锛涘┑鐐村灦閳笺倕煤椤忓秵鏅ｉ梺缁樺姇閻忔艾鈻撻悙顒傜瘈闂傚牊绋戦埀顒佹倐楠炲鏁撻悩鑼煣闂佸搫琚崕鏌ユ偂閺囥垺鐓冮柍杞扮閺嬨倖绻涢崼鐔哥叆妞ゎ叀鍎婚ˇ鍙夈亜椤撶偛妲绘い顐㈢箳缁辨帒螣鐠囧樊鈧挾绱撴担鍦槈妞ゆ垵鎳庨埢鎾活敇閻愨晜鏂€闂佺粯鍔樼亸娆撳箺閻樼鍋撻崗澶婁壕缂備礁顑堝▔鏇㈠汲閿曞倹鐓欓弶鍫濆⒔閻ｈ鲸顨ラ悙顏勭仾缂佺粯鐩獮瀣倷閸偄娅戝┑鐐差嚟婵炩偓濞存粏娉涢～蹇撁洪鍛画闂備緡鍙忕粻鎴濃枔閼哥數绡€婵炲牆鐏濋弸鐔封攽閻愯韬鐐插暣閹瑧鈧潧鎽滈惁鍫ユ⒑閹肩偛鍔橀柛鏂块叄瀹曘垽宕￠悙鈺傛杸闂佺粯鍔曞鍫曀夐悙鐑樼厱闁哄啯鎸鹃悾鐢告煙椤旀儳浠遍柟顔藉劤閻ｆ繈鍩€椤掑倸顥氬┑鍌氭啞閻撴瑩姊洪銊х暠鐎殿喚鍋撶换娑㈠醇閻斿壊妫冮梺鍝勮嫰缁夊綊骞愭繝鍐ㄧ窞婵☆垳鍎甸弸鍛繆閵堝洤啸闁稿鍋ら弫鍐閵堝懐顔愰悷婊呭鐢晠寮崘顔界叆婵犻潧妫欓崳鐟邦熆閻熸壆效婵﹤顭峰畷鎺戔枎閹板灚鈻婄紓鍌欑窔绾悂宕板顒夊殫濠电姴娲ょ粻浼村箹濞ｎ剙鐏╃€殿喖娼″娲捶椤撯剝顎楅梺闈╃秵閸ㄥ磭妲愰悙鍝勫唨妞ゆ挾鍠撻崢顏堟椤愩垺鎼愭い鎴濇嚇閸┾偓妞ゆ帊鑳舵晶鐢碘偓娈垮枟閻撯€愁嚕婵犳艾唯闁挎梹鍎抽獮鍫熺節閻㈤潧浠﹂柛銊╂涧閻ｇ兘顢楅崟顒€鈧爼鏌ｅΟ鑲╁笡闁绘挾鍠栭弻鐔兼倷椤掍胶绋囬梺璇茬箰閻°劑骞堥妸锔剧瘈闁告劏鏂傛禒銏ゆ倵鐟欏嫭纾搁柛鏂跨Ф閹广垹鈹戠€ｎ亞顦ㄩ梺鎸庣箓濡顢旈悜妯肩瘈闁汇垽娼ф牎濡炪倖姊归悧鐘茬暦閹惰姤鏅查柛銉㈡櫃缁楀姊洪崫鍕枆闁告澹堢换姘攽閻愬瓨灏伴柛鈺佸暣瀹曟垿骞橀崹娑樹壕閻熸瑥瀚壕鎼佹煕閺傚潡鍙勯柛鈹惧亾濡炪倖甯婇懗鍫曞煀閺囥垺瀚呴弶鍫涘妿缁犻箖鏌涘☉鍗炴灓濠⒀呮暬閺岀喖顢欑粵瀣杹閻庤娲橀〃鍡楊嚗閸曨剛绡€濞达絽澹婂Λ婊堟⒒閸屾艾鈧绮堟笟鈧獮澶愭晸閻樿尙顦悷婊冪箰椤曘儲绻濋崶銊ユ疅闂侀潧锛忕仦楣冩暅婵犲痉鏉库偓褏寰婃禒瀣柈妞ゆ牜鍋涚壕褰掓煕椤愶絾绀冮柣鎾跺枛閺岀喖鏌囬敃鈧悘锛勭棯椤撶喎鍔ら棁澶嬬節婵犲倸鏆熺紒澶嬫そ閺屸€崇暆鐎ｎ剛袦闂佽鍠撻崹钘夌暦椤愶箑唯鐟滃繘寮舵禒瀣拻濞达絽鎲￠幆鍫ユ煟椤撶儐妲洪柟骞垮灩閳规垿宕卞▎鎰啎闂備胶绮弻銊╁触鐎ｎ啟澶愬醇閻旇櫣顔曢梺鐟邦嚟閸嬬喖鎮￠娑楃箚婵°倓鐒﹀畷灞炬叏婵犲嫮甯涚紒妤冨枛閸┾偓妞ゆ帒瀚悞鍨亜閹烘垵鈧憡绂掑鍫熺厾婵炶尪顕ч悘锟犳煛閸涱厾鍩ｇ€殿喛鍩栭幆鏃堝箻鐎涙ɑ婢戝┑锛勫亼閸婃牕顫忔繝姘；闁规崘顕уЧ鍙夈亜閹烘垵鈧敻宕戦幘鑸靛枂闁告洦鍓涢ˇ顓㈡⒑绾懏鐝柟鐟版喘閺佹劙鎮欏ù瀣杸闁诲函绲介悘姘跺疾閿濆鈷戠紓浣姑悘銉︿繆椤愶綆娈旈柍缁樻尰缁轰粙宕ㄦ繛鐐濠电偞鎸婚崺鍐磻閹惧绠惧ù锝呭暱濞诧箓宕戠€ｎ喗鐓曢柍鈺佸暟閳藉绱掗悪鈧崹鍫曞箖濡ゅ懏鏅查幖绮瑰墲閻忓牓姊洪崗鑲╂憙妞ゎ偄顦遍幑銏犫槈濮楀棗鏅犲銈嗘瀹曠敻宕欒ぐ鎺撯拺?
        return net.minecraft.world.entity.MobType.UNDEFINED;
    }

    // ==========================================
    // 闂?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧潡鏌熺€电孝缂佽翰鍊濋弻锕€螣娓氼垱锛嗛悷婊呭鐢帞澹曟總鍛婄厽闁归偊鍨伴惃娲煟濞戞牕鍔︽慨濠冩そ瀹曨偊宕熼娑欑€遍梻浣告啞钃辨俊顐㈠暙閻ｇ兘宕奸弴銊︽櫌闂侀€炲苯澧撮柟閿嬪灴閹垽宕楅懖鈺佸妇濠电姰鍨奸崺鏍儎椤栨凹鐎舵い鏃傛櫕缁犻箖鏌涘☉鍗炴灓濠⒀屼邯閺屽秶鎲撮崟顐や紝濡炪們鍨洪悷鈺侇嚕椤掑嫬围闁告洦鍙€缁绘垿姊婚崒娆掑厡妞ゎ厼鐗撻、鏍川椤撳洦绋戦埥澶婎潩椤掆偓閻忓﹦绱撻崒娆戝妽妞ゎ厼娲妴鍛存倻閼恒儱鈧敻鏌ㄥ┑鍡涱€楀ù婊呭仱閺屾稑螣閸︻厾鐓撳┑顔硷攻濡炰粙鐛幇顓熷劅闁挎繂娲ㄩ弳銈嗙節绾版ɑ顫婇柛瀣嚇閹嫰顢涢悙闈涚ウ婵犵數濮村ú銈囩矆鐎ｎ偁浜滈柟鐑樺灥閳ь剙顭烽幆渚€宕奸妷锕€浠┑鐘诧工閸犳艾螣閳ь剟鎮楃憴鍕闁搞劌娼￠悰顔碱潨閳ь剙顕ｉ鍕ㄩ柨鏃囧Г濠㈡垵鈹戦敍鍕杭闁稿﹥鐗曢～蹇旂節濮橆儵銉╂倵閿濆骸鏋ら柛娆愭礃閵囧嫰骞掑澶嬵€栨繛瀛樼矋缁捇寮婚妸銉㈡斀闁糕剝鐟ч鍥ь渻閵堝倹娅撻柛鎾寸〒濡叉劙骞掗幘瀵哥Ф闂佸疇妗ㄥ鎺楀箣閻戣姤鈷戦梺顐ゅ仜閼活垱鏅堕崜褏纾界€广儱鎳忛ˉ銏⑩偓瑙勬礃濠㈡鐏冮梺鍛婁緱閸橀箖鏁嶉悢鍏煎€垫鐐茬仢閸旀碍銇勯敂鍨祮闁诡噯绻濆鎾閿涘嫬骞愰梻浣规偠閸庮垶宕曟潏銊ょ箚闁绘挸瀵掗悢鍡欐喐韫囨梹娅犳俊銈勮兌閳瑰秴鈹戦悩鍙夋悙闁活厽顨呴…璺ㄦ崉娓氼垳鍙曞┑鈽嗗亜濡稓妲愰幘瀛樺濞寸姴顑呴幗鐢告煟閵忊晛鐏℃い銊ユ嚇閳ワ箓宕堕鍡欐澑濠电偞鍨堕…鍥储閸涘﹦绠鹃弶鍫濆⒔閸掔増绻涢弶鎴濐伀婵″弶鍔欏鎾偐閹颁焦缍楅梻浣告贡閸庛倝宕甸敃鍌氱睄闁割偅绻勯崝锕€顪冮妶鍡楃瑨閻庢凹鍓涢埀顒佽壘椤︿即濡甸崟顖氱闁瑰瓨绻嶆禒鎾⒑闁偛鑻晶顕€鏌涢悤浣镐喊闁炽儻绠撴俊鎼佸煛娓氣偓閸炶泛鈹戦悩顔肩労濞存粍顨婂畷婵嬪箣閿曗偓閽冪喓鈧箍鍎遍ˇ浼村磻閿熺姵鐓欐繛鍫濈仢閺嬫瑩鏌ц箛鎾愁劉缂佺粯绋撻埀顒傛暩椤牓鍩㈤崼銏㈢＜闁绘ê纾晶顏呫亜椤愩垻绠婚柟鐓庣秺瀹曠兘顢橀悩闈涘箚闂備浇宕垫慨鍨娴犲绀夐幖鎼厛閺佸﹪鏌涢妷銏℃珖缁炬崘妫勯湁闁挎繂鎳庨ˉ蹇斾繆閸欏鍊愰柡宀嬬秮瀵粙顢曢姀鐘辩帛婵?
    // ==========================================
    @Override
    public boolean canBeAffected(net.minecraft.world.effect.MobEffectInstance effectInstance) {
        net.minecraft.world.effect.MobEffect effect = effectInstance.getEffect();
        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墴閹潡顢氶埀顒勫蓟閺囩喓绠鹃柣鎰靛墯閻濇棃姊洪幖鐐插闁稿﹥鎮傞崺鐐哄箣閿旇棄浜归柣搴℃贡婵挳藟濠靛牏纾藉ù锝嗗絻娴滅偓绻濋姀锝嗙【闁哄牜鍓熷畷浼村箛閺夎法顔愰柡澶婄墕婢т粙骞冩總鍛婄厽妞ゆ挾鍠撻幊鍐┿亜椤撯剝纭堕柟鐟板缁楃喖顢涘鍐ㄧ稻闂傚倷绀侀幉锟犳嚌妤ｅ喚鏁勫鑸靛姇閽冪喐绻涢幋鐐冩艾危閸儲鐓曟俊銈呭暙娴犳粎绱掗悩鍙夋儓闁宠鍨块幃娆撳矗婢跺﹥顏犻梻浣告憸閸犳劕顭囧▎鎿勭稏闊洦鎷嬪ú顏嶆晜闁告洦浜為悙濠囨⒒娴ｅ憡鍟炴繛璇х畵瀹曟垿骞掗幘鎰佸殼閻庡厜鍋撻柛鏇ㄥ厴閹锋椽姊洪崨濠冨磩閻忓繑鐟╁畷銏犫槈閵忥紕鍘遍梺闈浥堥弲娆撳箟妤ｅ啯鐓忛柛鈩冾殔閺嗭絽鈹戦敍鍕幋闁糕斁鍓濋幏鍛瑹椤栨碍娅嶅┑鐘垫暩閸嬬娀骞撻鍡楃筏闁秆勵殔缁犵娀鏌熼幑鎰靛殭闁绘帒鐏氶妵鍕箳閸℃ぞ澹曞┑鐘媰閸愵喖寮伴梺璇″灙閸嬫挸顪冮妶鍛闁绘妫涢惀顏囶槼缂佺粯鐩畷鍗炩枎韫囧骸顥氬┑掳鍊栧鑽ゆ閹捐纾兼繛鍡樺俯閸炲綊姊虹粙娆惧剱闁瑰憡鎮傞垾锕傚锤濡や礁娈濋梻鍌氱墛缁嬫垿锝炲澶嬧拺缂備焦蓱鐏忎即鏌ｉ悢鍙夋珚妤犵偛鍟灃闁逞屽墴閸┿儲寰勬繛鐐€哄銈嗘寙閸岀偛浠愰梻浣筋嚃閸犳鏁冮姀銈呮瀬闁圭増婢橀獮銏＄箾閸℃ê鐏╂俊鎻掓搐閳规垿鎮╅崹顐ｆ瘎婵犳鍠楅幐鍐茬暦椤栫儐鏁冮柨鏃囨閳ь剙鐖奸幃妤€鈽夊▍顓″亹閹广垽宕卞Ο闀愮盎闂佽婢樻晶搴ｅ鐠恒劎纾奸柟閭﹀幗椤ュ牓鏌＄仦鍓ф创闁糕晝鍋ら獮鍡氼槺濠㈣娲栭埞鎴︽晬閸曨偂鏉梺绋匡攻閻楁粓寮鈧獮鎺懳旈埀顒傚閸︻厽鍠愰柣妤€鐗嗙粭鎺楁煟閵堝骸娅嶉柡灞剧☉閳规垿宕卞缁樼亞闁荤喐绮庢晶妤冩暜濡ゅ懎鐤鹃柡灞诲劜閻撴洟鏌曟径娑氬埌濠碘€冲悑缁绘盯宕煎┑濠傤伃濡炪値浜滈崯瀛樹繆閸洖绀冮柕濞垮灩娴滈箖鏌熼幑鎰厫妞ゆ劘濮ら幈銊ノ熼幐搴ｃ€愰梺钘夊暟閸犳劗鎹㈠☉銏犵婵炲棗绻掓禒鐓庘攽閳藉棗浜濋柨鏇樺灲楠炲啳銇愰幒鎴犲€為梺闈涱焾閸庡磭绮婂畡閭︽富闁靛牆楠告禍婊堟煙閸愭煡鍙勯柍銉︽瀹曟﹢顢欓崲澹洦鐓曢柍鈺佸枤閻掍粙鏌涘Ο缁樺€愭慨濠呮缁瑥鈻庨幆褍澹夐梻浣告贡閹虫挸煤椤撶儐鍤曞┑鐘崇閺呮煡鏌涢埄鍏狀亪宕濋崨瀛樷拺闁圭娴风粻鎾翠繆椤愶綆娈旈柍缁樻尭閻ｆ繈宕熼鑺ュ闂備礁鎲＄缓鍧楀磿閸楃偐鏋嶉煫鍥ㄧ⊕閻撴洟鎮楅敐搴濇倣鐎规悶鍎甸弻锝夋晲閸パ冨箣婵犳鍠掗崑鎾绘⒑闂堟稓澧曢柟鍙夘焾椤﹀弶銇勯鈩冪《闁圭懓瀚粭鐔碱敍濮橆剙顥嶆繝鐢靛仜椤曨厽鎱ㄩ悽绋跨？闁规儼袙閳ь剚妫冨畷姗€顢欓崲澹洦鐓曢柍鈺佸枤濞堟棃鎮介锝勯偗婵﹥妞藉Λ鍐ㄢ槈濮橆剦鏆梻浣烘嚀閸熷灝霉妞嬪骸鍨濆┑鐘宠壘缁狅綁鏌ｉ幇顔芥毄闁伙箑鐗嗛埞鎴︽倷閼碱剙顣洪梺璇茬箲缁诲倿鍩㈠鍛瀻闁瑰濮烽敍婊堟⒑閸︻厾甯涢悽顖涘浮閸╂盯寮崼鐔哄幐婵炴挻鑹惧ú銈呪枍瀹ュ棭娈介柣鎰綑缁楁帡鎽堕弽顓熺厓鐟滄粓宕滃☉姘灊濠电姵鍑归弫宥夋煟閹邦剦鍤熼柛妯挎閳规垶骞婇柛濠冨姍瀹曟垿骞樼紒妯煎幗濠德板€撻懗鍫曟儗婵犲洦鐓冪紓浣股戠亸浼存倵娴ｅ啫浜归柍褜鍓氱粙鎺椻€﹂崶顒€鍌ㄦい蹇撴噽缁♀偓闂侀潧楠忕徊鍓ф兜閻愵兛绻嗘い鎰剁悼閹冲洨鈧鍠涘▔娑氬弲濡炪倕绻愰幊鎰板储闁秵鐓熼幖鎼灣閸掍即鏌涘锝呬壕闂傚倷绶￠崣搴ㄥ垂閸洖钃熼柨娑樺濞岊亪鎮归崶銊ョ祷妞ゎ剙鐗撳铏光偓鍦У椤ュ銇勯敂璇茬仴闁诲繑甯″铏圭磼濡纰嶉柣搴＄仛鐢€愁嚕閹剁瓔鏁冮柨婵嗘川閻﹀牓姊哄Ч鍥х伈婵炰匠鍕浄婵犲﹤鎳夐崑鎾斥枔閸喗鐏堟繝鈷€鍐弰鐎规洘宀搁獮鎺楀箣椤撶偞鍊梻浣规偠閸庮噣寮插┑瀣亗闁规儳顕弧鈧梺闈涢獜缁蹭粙鎮￠幇鐗堢厱闁哄啠鍋撴繛鍙夘焽閳ь剟娼ч妶鎼佸箖閳哄啰纾兼俊顖滃帶楠炲牓姊绘担鍛婃儓婵炲眰鍨藉畷婵嗙暆閸曨厼绁﹀┑掳鍊撻懗鍓佺不妤ｅ啯鐓曟い鎰╁€曢弸鏃堟煟椤撶喎绗氶柟渚垮妽缁绘繈宕橀埞澶歌檸闁诲氦顫夊ú锕傚磻婵犲倻鏆﹂柣鏃傗拡閺佸啯銇勯幇鍓佺？缂佲偓婢舵劖鈷掗柛灞剧懅椤︼箑顭块悷甯含闁诡噯绻濆畷濂稿Ψ閵夈儳鈧參鎮楃憴鍕婵炲眰鍊濆畷鐟扳攽鐎ｎ偆鍘撻梺鍛婄箓鐎氼參宕抽崷顓犵＜闁绘鏁哥敮娑㈡煏閸パ冾伃鐎殿噮鍣ｅ畷鎯邦槺婵顨婂铏圭磼濡闉嶉梺鎼炲妼閻忔繈锝炶箛娑欐優闁革富鍘鹃敍婊冣攽椤旂瓔娈旀俊顐ｇ懇閹箖宕奸弴鐔叉嫼缂傚倷鐒﹂敃鈺佲枔閺冨牊鐓ラ柡鍥朵簽閻ｇ敻鏌熷畷鍥т槐鐎规洩绻濋幃婊堝幢濡搫鍘炲┑锛勫亼閸婃牠骞愭ィ鍐ㄧ獥閹肩补妲呴崵鏇㈡煙缁嬫寧鎹ｇ紒鈾€鍋撻梻浣圭湽閸ㄨ棄顭囪閻☆參姊绘担渚劸闁挎洏鍊濋獮妤€顭ㄩ崼鐔锋疅闂備緡鍓欑粔鐢稿吹閹烘鐓忛柛顐ｇ箖瀹告繈鏌?
        if (effect == net.minecraft.world.effect.MobEffects.POISON ||
            effect == net.minecraft.world.effect.MobEffects.HUNGER) {
            return false;
        }
        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁逞屽墾缁犳挸鐣锋總绋款潊闁炽儱鍟跨花銉╂⒒娴ｇ儤鍤€闁宦板妿閹广垽骞囬悧鍫濇畬闂佺鍕垫畷闁绘挻娲熼弻銊╁籍閸ヨ泛娈Δ鐘靛仦閻楃娀寮诲☉銏犖╅柨鏂垮⒔閻ｆ椽姊洪棃娑欐悙閻庢矮鍗抽悰顕€骞掑Δ鈧粻锝嗙節閸偄濮冮柣銉邯濮婄粯鎷呮笟顖滃姼濡炪倖鍨靛Λ婵嗙暦濠靛棌鏋庨柟鎯х枃閹芥洟姊洪棃娑氬妞わ富鍨辩€靛ジ鎮╃紒妯煎帾婵犮垼鍩栭敋闁哄鍠愰幈銊╂晲閸涱垳鍔┑顔硷龚濞咃絿鍒掑▎蹇婃瀻闁诡垎鍐棊闂傚倷绀佸﹢閬嶁€﹂崼銉⑩偓锕傛倻閻ｅ苯绁﹂棅顐㈡处缁嬫垵顔忓┑鍥ヤ簻闁哄秲鍔庨埥澶愭煛鐎ｎ亜鈧灝顫忓ú顏勫窛濠电姴鍟ˇ鈺呮⒑閸涘﹥灏扮紒瀣墵婵＄敻骞囬鑺ョ€婚梺鐟板⒔鐞涖儵骞忕紒妯肩閺夊牆澧介崚浼存煙鐠囇呯瘈妤犵偛妫濆畷濂告偄缂堢姷鐩庨梻浣烘嚀閻°劎鎹㈤崘顔㈠鎮╃紒妯煎幈闂佸湱鍎ら幐鍝ョ箔閳哄啰纾奸柣妯虹－閳藉鏌嶉挊澶樻Ц闁宠閰ｉ獮鍥敆娴ｅ湱褰鹃梻鍌氬€峰ù鍥敋瑜斿畷娆撴偩瀹€鈧粈濠囨煕閳╁啰鈽夌紒鎰殜閺屸€愁吋鎼粹€崇缂佺偓鍎抽妶鎼佸蓟閺囩喓绠鹃柣鎰靛墯閻濇洟姊虹紒妯诲暗闁哥姵鐗犲濠氭晸閻樿尙锛滃┑鐐村灦閿曗晠宕电€ｎ喗鈷戦悹鍥ｂ偓宕囦哗闂佺粯顨呴敃顏呬繆閻㈢绀嬫い鏍ㄧ⊕濞呮粓姊洪幖鐐插妧闁告剬鍛婵犵绱曢崑鎴﹀磹閵堝纾婚柛娑欑暘閳ь剙鍟村畷銊╁级閹寸姴寮ㄥ┑鐘灱濞夋稖澧濋梺鍝勵儏鐎涒晜绌辨繝鍥舵晬婵犲﹤鍟禒妯荤節濞堝灝鏋涢柛姘儐缁岃鲸绻濋崶銊モ偓閿嬨亜韫囨挸顏ら柛瀣崌瀵粙顢橀悙娈垮敹闂備礁缍婂Λ璺ㄦ媼閺屻儱鐒垫い鎺戯功閻ｇ敻鏌熼鐣岀煉闁圭锕ュ鍕償閵忊€虫毇闂傚倸鍊风粈渚€骞夐敍鍕煓闁圭儤鍩堥悞鑺ョ箾閸℃ɑ灏柣顓燁殔閳规垿鎮╅崣澶婄獩闂佸憡鐟﹂幑鍥蓟濞戙垹唯闁挎繂鎳庨‖澶岀磽娴ｆ彃浜鹃梺閫炲苯澧扮紒?
        return super.canBeAffected(effectInstance);
    }

    @Override
    public void move(net.minecraft.world.entity.MoverType type, net.minecraft.world.phys.Vec3 pos) {
        if (!this.isFollowing() && type == net.minecraft.world.entity.MoverType.SELF) {
            super.move(type, new net.minecraft.world.phys.Vec3(0.0D, Math.min(0.0D, pos.y), 0.0D));
            return;
        }
        super.move(type, pos);
    }

    @Override
    public void knockback(double strength, double x, double z) {
        if (!this.isFollowing()) {
            return;
        }
        super.knockback(strength, x, z);
    }

    @Override
    public void push(double x, double y, double z) {
        if (!this.isFollowing()) {
            return;
        }
        super.push(x, y, z);
    }

    @Override
    public boolean isPushedByFluid() {
        return this.isFollowing() && super.isPushedByFluid();
    }

    @Override
    public boolean isPushable() {
        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缂佺姷濞€閺岀喖宕滆鐢盯鏌涙繝鍛厫闁逛究鍔岃灒闁圭娴烽妴鎰磽娴ｅ搫校濠㈢懓妫涘Σ鎰板箳閺傚搫浜鹃柨婵嗛楠炴鐥鐐靛煟闁哄矉绻濆畷閬嶅箛椤戣棄浜炬繝闈涱儏閽冪喐绻涢幋娆忕仼缂佺姵鐩弻鏇熺節韫囨稒顎嶉梺缁樼箖閻楃姴顫忛崫鍕殾闁搞儮鏅涚粭鈥斥攽椤旂》宸ョ紓宥咃攻娣囧﹪鎮界粙璺槹濡炪倖鐗楀銊╊敊閹烘鐓熼幖娣妽濞懷囨煙閼恒儳鐭掗柟顔惧亾缁轰粙宕ㄦ繛鐐闂備胶鍘ч～鏇㈠磹閺囥垹鍑犻柟瀵稿Х绾惧ジ鎮归崶顏勭毢濠⒀嶅閳ь剚顔栭崰鏍€﹂柨瀣╃箚闁兼悂娼х欢鐐测攽閻樻彃顏存俊鑼缁绘繈鎮介棃娑楁勃濠电偛鍚嬮悷鈺呫€侀弽顓炲窛妞ゆ梻铏庡ú鍛婁繆閵堝繒鍒伴柛鐕佸灦閹繝鎮㈤崗鑲╁幐闂佹悶鍎崝宥夋儍閹达附鐓曢柡鍌濇硶鏁堥梺鍝勭焿缁犳捇鐛€ｎ亖鏀介柟閭﹀幐閺嬪懏绻?
        if (getPrintState() != 0) return false;
        return this.entityData.get(IS_FOLLOWING);
    }

    // ==========================================================
    // 闂?闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃繘鍩€椤掍胶鈻撻柡鍛█閵嗕礁鈻庨幘鍐插敤濡炪倖鎸鹃崑鐔兼偘閵夆晜鈷戦柛婵嗗閳诲鏌涘Ο鍨汗缂侇喛宕甸幉鎾礋閳衡偓缁ㄥ姊虹憴鍕凡濠⒀冩捣缁瑦绻濆顓犲幈濠电偛妫楃换鎺旂不婵犳碍鐓熼柟鍨暙娴滄壆鈧娲栭悥鍏间繆閹间焦鏅滈柟顖嗗啰顔戝┑鐘垫暩閸嬫盯顢氶鐔稿弿闂傚牊绋撻弳鍡涙煙闂傚顦︾紒鐘崇墱閹叉悂鎮ч崼婵堢懆闂佺粯鍔曢敃銉╁Φ閸曨喚鐤€闁圭偓鍓氭导鈧繝娈垮櫙缁插宕归挊澶樻綎婵炲樊浜滄导鐘绘煕閺囥劌澧绘俊顐節濮婃椽鎮烽悧鍫熷枑缂備緡鍣崹宕囧垝濮橆厽缍囬柕濞у懐妲囬梻浣规偠閸庢挳宕洪弽顓炵柧妞ゆ巻鍋撻柍瑙勫灴閺佸秹宕熼鈥虫憢婵＄偑鍊栧▔锕傚礋椤撗勯敜闂備礁鎲￠幐鍡涘焵椤掑嫬纾婚柟鎹愬煐閸犲棝鏌涢弴銊ュ妞わ负鍎遍埞鎴︽倷閼碱剚鍕鹃梺鍛婃⒐閸ㄦ寧淇婄€涙鐟归柍褜鍓欓悾鐑藉Ω瑜夐崑鎾斥槈濞呰鲸宀搁獮蹇撁洪鍛嫼闂侀潻瀵岄崣搴ㄦ倿閻愵剛绠鹃悗鐢殿焾閸樻挳鏌涢埡渚婅含鐎殿喗鎸抽幃鈺咁敃椤厼顥氶梻浣侯焾缁绘劙藝椤栨稓顩查柛鎾楀懐锛濇繛杈剧到婢瑰﹪宕曢幘娣簻闁哄洨鍠庨埢鏇㈡煛娴ｇ懓濮嶇€规洖鐖兼俊鎼佸Ψ瑜嶉柊鍗炩攽閻樺灚鏆╅柛瀣仜椤洤鈻庨幙鍐╂櫈闂佺硶鍓濋崘鑽ょ礊閺嶎偀鍋撻獮鍨姎妞わ缚鍗抽崺娑㈠箣閿旂晫鍘遍梺鍦亾濞兼瑧寰婄拠瑁佺懓顭ㄩ崟顓犵暭缂備浇椴哥敮锟犲箖濠婂吘鐔哥瑹椤栨碍鐤傜紓?+ 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦缂冩洟姊绘担鍛婃儓婵炲眰鍨藉畷褰掑捶椤撶姳绗夐柣鐔哥懃鐎氥劍绂嶅鍫熺厵闁逛絻娅曞▍鍛存煟閹烘挻銇濋柡宀嬬秮楠炴帒顓奸崶鈺冨幆闂備礁鎼懟顖滅矓鐟欏嫪绻嗛柣鎴ｅГ閺呮繈鏌嶈閸撴岸寮查崼鏇ㄦ晬闁绘劕顕崢閬嶆⒑闂堟稓澧曟俊顐ｇ懅缁牏鈧綆鍠楅悡娑㈡倶閻愭彃鈷旈柍钘夘樀閺屽秶鎲撮崟顐や紝閻庤娲栧畷顒冪亙婵犵數濮抽悞锕傚磻閸涱厸鏀介柨娑樺娴滃ジ鏌涙繛鍨偓婵嗙暦閹达箑绠婚柛鎾茶兌椤︻垱绻涢幘鏉戠劰闁稿鎸鹃埀?
    // ==========================================================



// ==========================================================
    // 闂?闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃繘鍩€椤掍胶鈻撻柡鍛█閵嗕礁鈻庨幘鍐插敤濡炪倖鎸鹃崑鐔兼偘閵夆晜鈷戦柛婵嗗閳诲鏌涘Ο鍨汗缂侇喛宕甸幉鎾礋閳衡偓缁ㄥ姊虹憴鍕凡濠⒀冩捣缁瑦绻濆顓犲幈濠电偛妫楃换鎺旂不婵犳碍鐓熼柟鍨暙娴滄壆鈧娲栭悥鍏间繆閹间焦鏅滈柟顖嗗啰顔戝┑鐘垫暩閸嬫盯顢氶鐔稿弿闂傚牊绋撻弳鍡涙煙闂傚顦︾紒鐘崇墱閹叉悂鎮ч崼婵堢懆闂佺粯鍔曢敃銉╁Φ閸曨喚鐤€闁圭偓鍓氭导鈧繝娈垮櫙缁插宕归挊澶樻綎婵炲樊浜滄导鐘绘煕閺囥劌澧绘俊顐節濮婃椽鎮烽悧鍫熷枑缂備緡鍣崹宕囧垝濮橆厽缍囬柕濞у懐妲囬梻浣规偠閸庢挳宕洪弽顓炵柧妞ゆ巻鍋撻柍瑙勫灴閺佸秹宕熼鈥虫憢婵＄偑鍊栧▔锕傚礋椤撗勯敜闂備礁鎲￠幐鍡涘焵椤掑嫬纾婚柟鎹愬煐閸犲棝鏌涢弴銊ュ妞わ负鍎遍埞鎴︽倷閼碱剚鍕鹃梺鍛婃⒐閸ㄦ寧淇婄€涙鐟归柍褜鍓欓悾鐑藉Ω瑜夐崑鎾斥槈濞呰鲸宀搁獮蹇撁洪鍛嫼闂侀潻瀵岄崣搴ㄦ倿閻愵剛绠鹃悗鐢殿焾閸樻挳鏌涢埡渚婅含鐎殿喗鎸抽幃鈺咁敃椤厼顥氶梻浣侯焾缁绘劙藝椤栨稓顩查柛鎾楀懐锛濇繛杈剧到婢瑰﹪宕曢幘娣簻闁哄洨鍠庨埢鏇㈡煛娴ｇ懓濮嶇€规洖鐖兼俊鎼佸Ψ瑜嶉柊鍗炩攽閻樺灚鏆╅柛瀣仜椤洤鈻庨幙鍐╂櫈闂佺硶鍓濋崘鑽ょ礊閺嶎偀鍋撻獮鍨姎妞わ缚鍗抽崺娑㈠箣閿旂晫鍘遍梺鍦亾濞兼瑧寰婄拠瑁佺懓顭ㄩ崟顓犵暭缂備浇椴哥敮锟犲箖濠婂吘鐔哥瑹椤栨碍鐤傜紓?+ 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦缂冩洟姊绘担鍛婃儓婵炲眰鍨藉畷褰掑捶椤撶姳绗夐柣鐔哥懃鐎氥劍绂嶅鍫熺厵闁逛絻娅曞▍鍛存煟閹烘挻銇濋柡宀嬬秮楠炴帒顓奸崶鈺冨幆闂備礁鎼懟顖滅矓鐟欏嫪绻嗛柣鎴ｅГ閺呮繈鏌嶈閸撴岸寮查崼鏇ㄦ晬闁绘劕顕崢閬嶆⒑闂堟稓澧曟俊顐ｇ懅缁牏鈧綆鍠楅悡娑㈡倶閻愭彃鈷旈柍钘夘樀閺屽秶鎲撮崟顐や紝閻庤娲栧畷顒冪亙婵犵數濮抽悞锕傚磻閸涱厸鏀介柨娑樺娴滃ジ鏌涙繛鍨偓婵嗙暦閹达箑绠婚柛鎾茶兌椤︻垱绻涢幘鏉戠劰闁稿鎸鹃埀?
    // ==========================================================

    // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箻閺岀喖骞嗛弶鍟冩捇鏌涙繝鍌涘仴闁哄被鍔戝鏉懳旈埀顒佺閹屾富闁靛牆楠搁獮鏍煟韫囨梻绠氶柣蹇斿浮濮婃椽宕楅懖鈹垮仦闂佸搫鎳忕换鍫ｆ濡炪倖鐗滈崑鐐哄磹閸偒娈介柣鎰皺娴犮垽鏌涢弮鈧喊宥嗙┍婵犲浂鏁冮柨婵嗘处閸掓盯姊虹化鏇熸澓闁搞劏妫勯锝夘敆娴ｇ懓鍔呴梺瑙勫劤閻°劑寮堕幖浣光拻濞达綀娅ｇ敮娑欍亜椤撶偟澧㈤柛鎺撳笚閵堬綁宕橀妸褜妲梺璇茬箳閸嬫﹢宕熷Ο鑽ゎ洸婵犲﹤鐗忛崣鎾绘煕閵夛絽濡奸柛婵囨そ閺屾稑鈹戞繝鍐句哗缂備浇椴哥敮鐐垫閹烘嚦鐔煎礂閻撳骸鐏￠梺璇叉唉椤煤濠靛牆鍨濋柛鎾楀懍绗夊┑鐐村灟閸ㄥ湱绮绘繝姘厸闁稿本锚閸旀粓鎮楀鍗炴瀾缂佺粯绻堥幃浠嬫濞磋埖鐩弻鐔风暋閺夋寧娈婚悗瑙勬礃閿曘垽銆侀幘娲绘晬闁糕剝顨嗛崳鎶芥煕鐎ｎ偅灏甸柟鍙夋尦瀹曠喖顢楅崒銈喰ら梻鍌欒兌椤牏鎹㈤幋锝嗘噷濠电儑绲藉ú銈夋晝閵堝缍栭柕蹇曞Х閺嗗棗鈹戦悩鎻掓暘妞ゅ繐鐗婇埛鎺懨归敐澶樻濞戞捁灏欑槐鎾愁吋閸曨厼濡界紓浣稿€哥粔鐟扮暦婵傜鍗抽柣鎰煐閹茬増绻濋悽闈涗沪闁割煈鍨跺畷纭呫亹閹烘垹顦ㄩ梺閫炲苯澧撮柟顔煎槻椤劑宕橀鐓庡強婵°倗濮烽崑娑樜涘┑鍡欐殾濠靛倸鎲￠崑鍕煣韫囨凹鍤冮柛鐔烽叄濮婅櫣鎷犻懠顒傤唶缂備胶绮崹鍧楀箖瑜斿鎾偄閸涘﹦褰块梻浣告惈鐞氼偊宕曢弻銉﹀亗婵炲棙鍨熼崑鎾绘偡閺夋浼€婵犫拃鍕垫疁鐎规洖纾幉鎾礋閳衡偓缁ㄥ姊洪悷鏉库挃闁稿鍔戝畷鎴﹀閳垛晛浜鹃悷娆忓缁€鈧梺缁樼墪閵堢鐣峰ú顏呮櫢闁绘灏欓敍婊冣攽閻樻瑥瀚崝銈吤?(闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫鍐煥閺囨浜鹃梺姹囧€楅崑鎾舵崲濠靛洨绡€闁稿本绮岄·鈧梻浣侯焾椤戞垹鎹㈠┑瀣摕闁哄洢鍨归柋鍥ㄧ節閸偄濮堥弫鍫ユ⒒娴ｈ櫣甯涢柟鍛婃倐瀹曟劙宕烽鐔峰簥濠电娀娼уú銊у姬閳ь剟姊虹粙鎸庢拱缂侇喖鐭傞妴鍌毭洪鍛嫼濠电偠灏褔鐛Δ浣典簻闁靛鍎查ˉ銏☆殽閻愯尙澧﹀┑鈩冩倐婵＄兘顢欓挊澶屾В闂備浇宕垫慨鏉懨洪埡渚囧殨闁规儳顕悵鍫曟煛閸ャ儱鐏柍閿嬪笒閵嗘帒顫濋敐鍛婵犵數鍋犳竟鍫濈暦閻㈠灚顫曢柣鎰摠婵挳鏌ц箛鎾磋础闁挎稒绻傞埞鎴︻敊缁涘鍔告繛瀛樼矤閸撴氨绮欐径濠庡悑闁糕剝鐟ч鏇㈡⒑閻熸壆鎽犻柣鐔村劦閹﹢鍩￠崘锝呬壕闁荤喓澧楅崯鐐电磼鐠囨彃鏆熼柟骞垮灩閳藉濮€閳╁啯鐝抽梺纭呭亹鐞涖儵鍩€椤掆偓閸熻法绮婚敐澶嬧拻濞达絼璀﹂悞鐐亜閹存繃顥㈡鐐村灦閹峰懘鎼归柅娑氱憹婵犵數鍋為崹顖炲垂瑜版帒纭€闁惧浚鍋傜换鍡涙煏閸繂鈧憡绂嶉悙顒傜閻庢稒顭囬惌鎺旂磼閻樺磭澧垫鐐插暙閻ｏ繝骞嶉搹顐も偓濠氭椤愩垺澶勯柟灏栨櫆鐎靛ジ鍩€椤掑嫭鈷掑ù锝堟鐢盯鏌熺亸鏍ㄦ珚鐎规洜鎳撻悾鐑藉炊椤垶缍楅梻浣告贡閸庛倝銆冮崱娑樼；闁规壆澧楅埛鎺楁煕椤愩倕鏋旈柍顖涙礋閺岋綀绠涢幘璺衡叺闂佽鍠楅〃鍫ュ箟閹绢喖绀嬫い鎺戝亞濡插爼姊绘担渚劸缂佺粯鍨奸幗顐ｇ箾閿濆懏鎼愰柨鏇樺€濋敐鐐哄閻樺灚娈曟繝鐢靛Т閸熺娀寮搁崱妞绘斀闁挎稑瀚禍濂告煕婵炲灝鈧繂鐣烽幋锕€绠婚柛鎾叉缁楀姊洪崷顓炰壕闁告挻鑹鹃…鍥冀閵娧咁啎閻庣懓澹婇崰鏇犺姳閼姐倗纾奸柣妯虹仛閺嗩剟鏌″畝鈧崰鏍箖濠婂吘鐔兼倻閳哄倸顏洪梻鍌欑閹诧繝寮婚妸銉€块弶鍫氭櫆椤洟鏌熼幆褏鎽犲┑顖涙綑闇夐柣妯烘▕閸庡繘鏌熼悾灞炬毄缂佽鲸鎸婚幏鍛驳鐎ｎ亝顔勯梻浣告憸閸ｃ儵宕瑰畷鍥у灊婵﹩鍘界紞鍥煏婵炑冩噽濡插洭姊绘担瑙勫仩闁稿孩绮撳畷顏堝礃椤忓嫮鍝庡┑鐘垫暩婵兘寮幖浣哥；闁绘劕鎼崹鍌炴煕椤愶絾绀冮柛搴㈩殕閵囧嫰寮村Δ鈧禍楣冩倵鐟欏嫭绀冮柣鐔叉櫊楠炲﹪鎮欓崫鍕庛劎鎲歌箛娑辨晩闁哄洢鍨洪悡娑橆熆鐠虹尨鍔熷褎娲栭…鑳槺缂侇喗鐟╅悰顕€宕橀钘変簵闁圭厧鐡ㄨ摫闁哄倵鍋撳┑锛勫亼閸婃牕顫忔繝姘偍鐟滄棃宕哄☉銏犵睄闁割偆鍠撻崢闈浳旈悩闈涗粶闁诲繑绻堥幃姗€鎳犻钘変壕婵炲牆鐏濋弸鐔兼煙閸涘﹤鈻曟鐐插暙閳诲酣骞樺畷鍥у箰闂備胶顭堥張顒傚垝鐏炵瓔鍤曟い鏇楀亾婵﹤顭峰畷鎺戔枎閹烘垵甯梻浣侯焾椤戝啴宕濋幋婵堟殾闁哄洨鍠愮紞鍥煃鏉炴壆璐版俊顐ｇ矊椤啴濡堕崱妯鸿敿闂佹悶鍔庨幊鎾存櫏闂佸搫琚崕鏌ユ偂濞戞﹩鐔嗛悹铏瑰皑閸旂喐鎱ㄥΟ绋垮濞ｅ洤锕獮鎾诲箳閺傚簱鍙洪梻浣告惈閻鎹㈠┑鍡欐殾闁圭儤鍨熷Σ鍫ユ煕濡ゅ啫浠滃┑鈥冲悑缁绘繄鍠婃径宀€锛熼柣搴㈣壘缁绘ê鐣烽妸鈺婃晬婵犲﹥鍔楁惔濠囨⒒娴ｅ憡鎯堟い锔诲灦閹囧礋椤栨氨顦柟鑹版彧缁叉寧绋夊鍡樺弿婵＄偠顕ф禍楣冩⒑閸濆嫮鐏遍柛鐘冲姍钘濋柣妤€鐗婇崕鐔兼煃鏉堛劌绔鹃柛銊ょ矙瀵鏁愭径瀣珳闂婎偄娲﹀ú婊堟儊閸儲鍊垫繛鍫濈仢閺嬫稑顭胯闁帮綁鐛幋锕€绀嬫い鏍ㄣ仜閸嬫捇鏁冮崒姘鳖吅濠电娀娼уú锕€顭块幋锔解拻闁稿本鑹鹃埀顒佹倐瀹曟劖顦版惔锝囩劶婵炴挻鍩冮崑鎾搭殽閻愬澧垫い銏℃礋閺佸啴鍩€椤掑倸顥氶柛锔诲幘绾惧ジ鎮楅敐搴′壕缂佹墎鏅滅换娑橆啅椤旇崵鍑归梺鍝勬噺閻擄繝寮诲☉妯锋闁告瑦顭囬崙褰掓⒑鐠囨煡顎楁い顓炲槻椤繐煤椤忓拋妫冨┑鐐村灦濮樸劑鎮块崟顖涒拺缂佸灏呴弨缁樼箾閸欏鐭掗柛鈹惧亾濡炪倖甯婂ù鍥ㄧ珶濡眹浜滈柨鏃傚亾閺嗩剛鈧鍠涢褔顢樻總绋块唶妞ゆ劧缍嗛埀顒€娲缁樻媴閸涘﹤鏆堥梺瑙勭摃椤曆囷綖濠靛惟鐟滃秹宕瑰┑鍥╃闁糕剝锚婵洨绱掗崜浣镐槐闁诡喗顨婇弫鎰償閳ユ剚娼鹃梻浣风串缁犳垿鎮ч幘鎰佹綎婵炲樊浜滅粻褰掓煟閹邦厼绲诲┑顔肩焸濮婃椽宕ㄦ繝鍐弳缂備礁顦抽～澶嬬┍婵犲洤绠绘い鏃囧亹椤︺劌顪冮妶鍡樷拻闁哄拋鍋婂畷銏＄鐎ｎ偆鍘甸梺绋跨箺閸嬫劙寮冲鈧弻娑欑箾閸喒鍋撻弴鈶┾偓锕傚炊椤掆偓缁犳盯鏌ｅΔ鈧悧蹇涘储閽樺娓婚柕鍫濇鐎垫瑩鏌涢幇銊︽珖濞存粌澧界槐鎾诲磼濞嗘垼绐楅梺鍝ュУ閻楃娀鍨鹃敃鍌涘€婚柦妯侯槺閻ｆ椽姊洪棃娑氱疄闁稿﹥娲滅划鍫ュ磼閻愬鍘遍棅顐㈡处閹告悂骞冮幋鐐簻?
    // private net.minecraft.world.level.ChunkPos keptChunkPos;
    // (婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯煎幗闁瑰吋鎯岄崹宕囩矓閻㈠憡鐓曢悗锝庝簻椤忣厽銇勯姀鈩冨磳妤犵偞顭囩槐鎺懳熼柨瀣伖缂傚倸鍊搁崐鐑芥倿閿曞倹鏅濋柍鍝勬噺閸婂潡鏌熼锝囦汗闁荤喖鍋婇悡銉╁箹缁厜鍋撻弬銉﹀闂傚倷娴囬鏍窗濮樿泛绀傛慨妞诲亾闁绘侗鍣ｅ畷鍫曨敆娴ｉ晲缃曢梻浣稿閸嬪懐鍠婂鍥ｅ亾濮橆偆鐭欐慨濠勭帛閹峰懐绮欏▎鐐棏闂備胶顭堥鍛村箠閹邦喖鍨濇繛鍡樻尭缁狅綁鏌ㄩ弮鍥棄闁逞屽墮閻栧ジ寮诲澶婁紶闁告洦鍓欏▍銈夋⒑缂佹ɑ灏版繛鑼枛瀵鎮㈤悡搴ｎ啇濡炪倖鎸鹃崑鐔哥椤栨粎纾奸柣鎰靛墮缁€鍐╃箾婢跺绀堟俊鍙夊姍楠炴帡骞樼€靛摜肖闂備線娼ч…鍫ュ磿閹剁瓔鏁勯柛鏇ㄥ幘绾捐棄霉閿濆懏鎯堥弽锟犳⒑閻戔晜娅撻柛銊ョ埣閹即顢欑喊杈ㄥ缓闂侀€炲苯澧存鐐诧工椤劑宕煎┑鍡欌偓顓烆渻閵堝棗濮傞柛濠冪墳椤も偓婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓闁搞劌鍊块弻娑㈩敃閿濆棛顦ラ梺钘夊暟閸犳牠寮婚弴鐔虹闁绘劦鍓氬▓婵嬫⒑閹肩偛鍔撮柛鎿勭畵瀵偅绻濋崶銊у幍闁荤喐鐟ョ€氼剚鎱ㄩ崶鈺€鐒?keptChunkPos闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弮鍫熸殰闁稿鎸剧划顓炩槈濡娅ч梺娲诲幗閻熲晠寮婚悢鍛婄秶濡わ絽鍟宥夋⒑閹肩偛鈧牠宕濋弽顓炍﹂柛鏇ㄥ灠閸愨偓闂侀潧顭堥崕鍗炐掗崼婵冩斀闁绘劘灏欏В鐐烘煛閸涱垰鈻堢€殿喖顭峰鎾偄閾忓湱妲囬梻濠庡亜濞诧箓骞栭埡浼辨椽顢橀姀鈾€鎷洪悗瑙勬礀濞层劎鏁☉娆愬弿濠电姴鍋嗛悡濂告煕閳规儳浜炬俊鐐€栧濠氬磻閹惧墎纾奸柣妯垮皺鏁堥悗瑙勬礃濞茬喎鐣烽敓鐘冲€剁紓浣股戦妵婵嬫煛娴ｇ鏆ｇ€规洘甯掗～婵嬵敇閿涘嫬褰傞梻鍌氬€搁…顒勫磻閸曨個娲晝閳ь剛鍙呭┑鐘诧工閹冲酣藟濮橆兘鏀介柛灞剧閸熺偤鏌ｉ幘璺烘瀾濞ｅ洤锕、娑橆煥閸愩劌顬嗛梻渚€娼荤徊鍧楀礂濮椻偓瀵鈽夊▎鎴犵槇闂佸憡鍔楅崑鎾绘偩閼测晝纾藉〒姘搐閺嬬喐淇婇崣澶婃诞濠碉紕鏁婚獮鍥级鐠侯煈鍞洪梻浣筋潐閸庢娊宕㈤弽顓炰紶婵°倓鑳剁弧鈧梺姹囧灲濞佳勭閿曞倹鐓曢柕濠忕畱閸斿爼鏌熺粵瀣簻闁宠鍨块幃鈺咁敃椤厼顥氭繝鐢靛仜椤曨參宕㈣閹椽濡搁埡鍌氫簵濠电偞鍨堕埣銈堛亹閹烘挻娅滈梺鍛婁緱閸犳宕曢幘瀵哥閻庣數顭堥埢鍫澝瑰鍐煟鐎?

    @Override
    public boolean removeWhenFarAway(double distanceToClosestPlayer) {
        return false; // 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣銏犲閺佸﹪鏌″搴″箹缂佹劖顨嗘穱濠囧Χ閸涱喖娅ら梺鍝勬噺缁诲牓寮婚弴锛勭杸閻庯綆浜栭崑鎾诲即閵忊€充痪婵°倧绲介崯顖炴偂閻樼數妫柡澶婄仢閼哥懓顭胯婢瑰棛妲愰幒妤佸亹闁惧浚鍋嗛崣鍡楊渻閵堝骸寮ㄦ繛澶嬫礋楠炴垿宕熼姘辩厬閻庣懓瀚竟鍡樻櫠閺囥垹纭€闂侇剙绉甸悡鏇熴亜閹邦喖孝闁告梹绮撻弻锝夊箻鐎涙顦ㄩ梺闈涙搐鐎氫即鐛崶顒€绀堝ù锝囨嚀娴犲湱绱撻崒姘偓鎼佸磹瑜版帗鍤屽Δ锝呭暞缁?
    }

    @Override
    public void aiStep() {
        super.aiStep();
        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈢粯淇婇悙顏勨偓鏍偋濡ゅ啰鐭欓柟鐐湽閳ь剙鎳樺畷锝嗗緞瀹€鈧惁鍫熺節閻㈤潧孝闁稿﹥鎮傚鎼佹晝閸屾稓鍘鹃梺缁橆殔閻楀棝顢氬鍫熺厪闁搞儜鍐句紓缂備胶濮甸惄顖炵嵁濡吋宕夊〒姘煎灡濮ｅ洭姊绘担绛嬪殭閻庢稈鏅犻幊婵囥偅閸忣垰娲弻鍡楊吋閸涱垰濮︽俊鐐€栧濠氬磻閹惧墎纾奸柣妯垮皺鏁堥悗瑙勬礃濞茬喖寮婚崱妤婂悑闁告侗鍨抽弸鍐⒑閻熸澘鎮戦柟顖氱焸閹剝寰勫畝鈧粈濠囨煛瀹ュ骸骞楅柣鎾崇箻閺屾盯顢曢敐鍥╃暫閻庣懓鎲＄换鍕儉椤忓牆绠氱憸瀣磻閵忋倖鐓涚€光偓鐎ｎ剛鐦堥悗瑙勬礃閿曘垽宕洪埄鍐╁閺夌偟澧楀Ο濠囨⒒閸屾瑦绁版い鏇嗗懏宕查柛鈩冪☉閻掑灚銇勯幒宥囶槮濠⒀屽灦閺岋綁寮幐搴￥闂佺灏欓…鍫ユ偩濠靛鐒垫い鎺戝缁€鍡涙煙閻戞ê鐏嶉柡瀣叄閺岀喖骞戦幇顓犲涧闂?
        if (!this.level().isClientSide && this.tickCount % 20 == 0) {
            net.minecraft.world.level.ChunkPos currentPos = this.chunkPosition();
            ServerLevel sl = (ServerLevel) this.level();

            if (keptChunkPos == null || !keptChunkPos.equals(currentPos)) {
                if (keptChunkPos != null) {
                    sl.setChunkForced(keptChunkPos.x, keptChunkPos.z, false);
                }
                sl.setChunkForced(currentPos.x, currentPos.z, true);
                keptChunkPos = currentPos;
            }
        }
    } // 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰鏍箒闂佺绻愰崥瀣礊閹达附鐓?闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫鍐煥閺囨浜鹃梺姹囧€楅崑鎾舵崲濠靛洨绡€闁稿本绮岄·鈧梻浣侯焾椤戞垹鎹㈠┑瀣摕鐎广儱顦导鐘绘煕閺囥劌澧繛鍜冪秮濮婂宕掑顑跨敖闂佹悶鍔岄悥鐓庮嚕婵犳碍鏅插璺猴功椤撴椽姊洪幐搴ｇ畵闁瑰弶鐩獮妯肩磼濡厧骞?} 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂磋閳ь剨绠撻、妤呭礋椤愩倧绱遍梻浣告啞濞诧箓宕愮€ｎ€㈡椽顢旈崟骞喚鐔嗛悹铏瑰皑閸旂喖鏌ｉ妶鍛悙闁宠鍨块、娆愭叏閹邦亞鎹曢梻浣侯焾椤戝棝骞愰幖浣哥厴闁硅揪闄勯弲顒勬煕閺囩偟浠涙い銉︽尵缁辨挻鎷呴崫鍕戯絿绱掔€ｎ偄鐏撮柛鈹垮劜瀵板嫭绻涢姀銏犳灈闁圭厧缍婇幃鐑藉箥椤旀嫎婊勭節閻㈤潧啸闁轰礁鎲￠幈銊﹀閺夋垵鐎繝闈涘€婚…鍫ュ及閵夆晜鐓涚€广儱楠告禍鐐烘煟椤撶喓鎳囬柡宀€鍠栭獮鎴﹀箛椤撶姰鈧劕顪冮妶鍐ㄥ姕鐎光偓閹间礁钃熼柕鍫濇偪閸︻厸鍋撻敐搴′簼闁绘繃鐗滅槐鎺楁倷椤掆偓缁€鍐╀繆椤愩垹顏繝鈧笟鈧娲箰鎼达絿鐣甸梺缁橆殕缁矂鈥﹂崶顒€绠涢柣妤€鐗嗛埀顒€鐖奸悡顐﹀炊閵婏妇顦ュ銈忕秬閸嬫劗妲?aiStep 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洟鎮烽幊濠傜秺閹晛顔忛鐓庡Η缂傚倸鍊哥粔鐢告偋閺団懇鈧妇鎹勯妸锕€纾梺缁樺灦钃遍柟鐑戒憾濮?

    @Override
    public void remove(RemovalReason reason) {
        if (!this.level().isClientSide && keptChunkPos != null) {
            ((ServerLevel) this.level()).setChunkForced(keptChunkPos.x, keptChunkPos.z, false);
            keptChunkPos = null;
        }
        super.remove(reason);
    } // 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰鏍箒闂佺绻愰崥瀣礊閹达附鐓?闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫鍐煥閺囨浜鹃梺姹囧€楅崑鎾舵崲濠靛洨绡€闁稿本绮岄·鈧梻浣侯焾椤戞垹鎹㈠┑瀣摕鐎广儱顦导鐘绘煕閺囥劌澧繛鍜冪秮濮婂宕掑顑跨敖闂佹悶鍔岄悥鐓庮嚕婵犳碍鏅插璺猴功椤撴椽姊洪幐搴ｇ畵闁瑰弶鐩獮妯肩磼濡厧骞?} 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂磋閳ь剨绠撻、妤呭礋椤愩倧绱遍梻浣告啞濞诧箓宕愮€ｎ€㈡椽顢旈崟骞喚鐔嗛悹铏瑰皑閸旂喖鏌ｉ妶鍛悙闁宠鍨块、娆愭叏閹邦亞鎹曢梻浣侯焾椤戝棝骞愰幖浣哥厴闁硅揪闄勯弲顒勬煕閺囩偟浠涙い銉︽尵缁辨挻鎷呴崫鍕戯絿绱掔€ｎ偄鐏撮柛鈹垮劜瀵板嫭绻涢姀銏犳灈闁圭厧缍婇幃鐑藉箥椤旀嫎婊勭節閻㈤潧啸闁轰礁鎲￠幈銊﹀閺夋垵鐎繝闈涘€婚…鍫ュ及閵夆晜鐓涚€广儱楠告禍鐐烘煟椤撶喓鎳囬柡宀€鍠栭獮鎴﹀箛椤撶姰鈧劕顪冮妶鍐ㄥ姕鐎光偓閹间礁钃熼柕鍫濇偪閸︻厸鍋撻敐搴′簼闁绘繃鐗滅槐鎺楁倷椤掆偓缁€鍐╀繆椤愩垹顏繝鈧笟鈧娲箰鎼达絿鐣甸梺缁橆殕缁矂鈥﹂崶顒€绠涢柣妤€鐗嗛埀顒€鐖奸悡顐﹀炊閵婏妇顦ュ銈忕秬閸嬫劗妲?remove 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洟鎮烽幊濠傜秺閹晛顔忛鐓庡Η缂傚倸鍊哥粔鐢告偋閺団懇鈧妇鎹勯妸锕€纾梺缁樺灦钃遍柟鐑戒憾濮?

    // 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰鍐€妞ゆ劦婢€缁爼姊?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓闁搞劌鍊块弻娑㈩敃閿濆棛顦ョ紓浣哄С閸楁娊寮婚悢鍏尖拻閻庡灚鐡曠粣妤呮⒑鏉炴壆顦﹂悗姘煎墴閳ワ妇鎹勯妸锕€纾繛鎾村嚬閸ㄦ娊宕ｉ弴銏♀拺缂備焦锚缁楀倻绱掗鐣屾噰鐎殿喖顭烽弫鎰板川閸屾稒顥堥柛鈹惧亾濡炪倖甯掔€氼參宕戠€ｎ亖鏀介柣妯哄级閹兼劗鐥幆褎鍋ラ柡宀嬬秮瀵剟宕归钘夆偓顖炴⒑缂佹ɑ灏伴柣鈺婂灦瀵鈽夐姀鐘电杸闂佸疇妗ㄧ粈渚€鈥栨径宀€纾藉ù锝囨焿椤斿鏌￠崨顖氣枅鐎殿喛顕ч埥澶愬閻樻爠鍥ㄧ厱婵犲ň鍋撻柣鎺炵畵閸┿垽宕奸妷锔规嫼?TurretFollowGoal闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弮鍫熸殰闁稿鎸剧划顓炩槈濡娅ч梺娲诲幗閻熲晠寮婚悢鍛婄秶濡わ絽鍟宥夋⒑閹肩偛鈧牠宕濋弽顓炍﹂柛鏇ㄥ灠閸愨偓闂侀潧顭俊鍥р枔閵堝鈷戦柛婵嗗閿涙梻绱掗悩铏磳鐎殿喛顕ч埥澶愬閳哄倹娅囬梻渚€娼ч悧鍡涘箠韫囨稒鍊跺〒姘ｅ亾婵﹤鎼悾鐑藉炊閳轰胶顐兼繝纰樻閸嬪嫰宕弶鎴殨閻犲洦绁村Σ鍫ユ煏韫囨洖顫嶉柕濠忚礋娴滄粓鏌″鍐ㄥ闁搞値鍓氱换娑橆啅椤旂厧绫嶅┑顔硷攻濡炰粙骞婇敓鐘参ч柛娑卞枤閳ь剙澧界槐鎾存媴缁涘娈梺缁橆殕閹瑰洭鎮伴鈧畷姗€顢欓挊澶嗗亾婵犳碍鐓㈡俊顖欒濡插摜鈧鎸稿Λ妤呭煘閹达富鏁婇柣顓у亽娴滄粓鎮鹃悜绛嬫晢濞达綁顥撶粻姘舵⒑閸忛棿鑸柛搴＄－瀵囧焵椤掑倻纾奸柛鎾楀喚鏆柤瑁ゅ€濋弻娑氣偓锝庡亝瀹曞矂鏌熼悡搴ｇШ妞ゃ垺娲熼弫鎰板川椤旈敮鍋撴ィ鍐┾拻闁稿本鐟х粣鏃堟煃瑜滈崜娑㈠磻濞戙垺鍤愭い鏍ㄧ⊕濞呯姴霉閻撳海鎽犻柣鎾寸懇閺屟嗙疀閿濆懍绨奸悗瑙勬礀閻ジ鍩€椤掑喚娼愭繛璇х畵瀹曞綊宕奸弴妯峰亾娓氣偓瀵挳濮€閻樻爠鍥ㄧ厱閻忕偛澧介悡顖氼熆鐟欏嫭绀嬫慨濠冩そ瀹曟粓鎳犻鈧敮銉╂⒑缁嬪尅鏀婚柣妤冨█閻涱喚鈧綆浜栭弨浠嬫煙闁箑鏋涘┑顔芥そ濮婃椽鎳￠妶鍛呫垺绻涚拠褍顩紒顔硷躬瀵爼骞婄粵鍦М鐎规洖銈搁幃銏ゅ礈娴ｈ櫣鏆伴梻鍌欑窔濞佳囨偋閸℃稑绠犻幖娣妼濮规煡鏌ｉ弬鍨倯闁绘挻鐟ч埀顒傛嚀婢瑰﹪宕伴弴銏＄劷妞ゆ牗绋掗崣蹇撯攽閻樻彃浜為柣鎾瑰亹閳ь剝顫夊ú妯兼暜閹烘缍栨繝闈涱儏绾偓闂佺粯鍨靛Λ娆忊枔娴犲鈷掗柛灞剧懅閸斿秹鏌熼鑲╁煟鐎规洘绻嗙粻娑樷槈鏉堛劍娅旈柣鐔哥矋濡啫鐣峰ú顏勵潊闁靛牆鎳愰鎺楁煟閻樺弶绌块悘蹇旂懇椤㈡ê煤椤忓應鎷洪梺鍦焾鐎涒晝澹曢悽鍛婄厱閻庯綆鍋呯亸鏉壳庨崶褝韬い銏℃礋閺佹劘绠涘锝呬壕闁秆勵殕閻撴瑦銇勯弮鍌氬付婵℃彃顭烽弻宥囨嫚閸欏鏀紓浣哄У閻╊垶鐛▎鎾崇鐟滃繒澹曟繝姘拻闁稿本鐟х粣鏃€绻涙担鍐插悩濞戞鏃堝川椤旇姤鐝栨俊鐐€曠换鎰偓姘槻椤洭寮介妸褏顔曢悗鐟板閸犳洜鑺遍懡銈囩＜闁绘ê鐏氶弳顒勬煛瀹€鈧崰鏍箖濠婂吘鐔兼倻閳哄倸顏洪梻鍌欑閹诧繝寮婚妸銉€块弶鍫氭櫆椤?

    // ==========================================
    // 闂?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佲枙闁绘帟濮ょ换娑㈠幢濡纰嶉柣鐔哥懕缁犳捇骞冨Δ鍛櫜閹肩补鍓濋悘宥夋⒑閸濆嫭濯煎ù婊庝簻椤繘鎼圭憴鍕彴闂佸搫琚崕娲焵椤掍緡娈滈柡宀嬬秬缁犳盯寮崹顔芥嚈闂備浇顕栭崳顖滄崲濠靛鏋侀柟鍓х帛閸嬫劙鏌涘▎蹇ｆШ闁逞屽墻閸撶喖骞冨Δ鍛祦闁割煈鍠栨慨搴ㄦ⒑閻熸澘妲绘い鎴濇嚇閳ワ箓宕堕鈧悡娑㈡煕鐏炰箙鑲╄姳婵犳碍鈷戦悷娆忓缁€鍐╃箾婢跺鈽夐柍璇茬Х缁犳盯骞樻担鍝ョШ闁诡噮浜崺鈧い鎺戝閻鏌涢幇鐢靛帥婵炲吋鐗楃换娑橆啅椤旇崵鍑归梺绋款儏閸婂潡鐛弽顐㈠灊闁荤喐婢橀埛澶娾攽椤曞棛绋婚柛鏃€鐟ラ～蹇撁洪鍛姷闂佺粯鍔樼亸顏嗏偓姘緲椤儻顦遍柛妤佸▕瀵鈽夐姀鈥充汗闂佹儳娴氶崑鍕閸愬樊娓婚柕鍫濆暙閻忣亪鏌熼悷鐗堝枠鐎规洘妞介崺鈧い鎺嶉檷娴滄粓鏌熼悜妯虹仴妞ゅ浚浜弻?AI (Smart Pathfinding & Decision Making)
    // ==========================================
    static class TurretFollowGoal extends Goal {
        private final SkeletonTurret turret;
        private LivingEntity owner;
        private final double speedModifier;
        private final float startDistance;
        private final float stopDistance;

        // AI State
        private int timeToRecalculatePath;
        private int thinkingTicks;      // 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ帒顦伴弲顏堟⒑閸濆嫮鈻夐柛妯垮亹缁牓宕奸悢绋垮伎濠碘槅鍨板锟犲传閾忓厜鍋撶憴鍕闁绘搫绻濆璇测槈閵忕姷鍔撮梺鍛婂姦娴滄牕危閸儲鈷戠紓浣姑粭鎺楁煟韫囨柨鍝哄┑锛勬暬瀹曠喖顢涘槌栧敽闂備胶纭堕崜婵嬪Φ閻愬鐝堕柡鍥ュ灪閳锋帒霉閿濆懏鍟為柟鍙夋倐閺屾盯鏁愰崘銊ュЕ閻庤娲橀崹鍨暦閵娾晩鏁嶆繝濠傛噽閸斿綊姊绘担鍛婅础闁稿簺鍊濋妴鍐幢濞戞锛涢梺瑙勫婢ф鎮￠悢鍏肩厵闂侇叏绠戦獮鏍煟韫囨搫鍔熺紒杈ㄥ浮婵℃悂濡烽鎯ф倯婵犳鍠栭敃銉ヮ渻閽樺鏆︽俊銈呮噺閸嬪倿骞栫划瑙勵潑婵為棿绮欏缁樻媴鐟欏嫬浠╅梺鍛婃煥閻倹淇婇崜浣虹煓閻犳亽鍔嶅▓楣冩⒑闂堟侗妲撮柡鍛洴閹偤宕归鐘辩盎闂佸湱鍎ら崹鐢割敂椤忓牊鐓?
        private int stuckTimer;         // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛娆忓亰闂勫嫮鎹㈠☉銏犵婵炲棗绻掓禒鑲╃磽娴ｆ彃浜鹃梺鍓插亞閸犳挾寮ч埀顒勬⒒閸屾氨澧涘〒姘殜瀹曟洖鈽夐姀锛勫幐婵炶揪绲介幉锟犓夐姀銈嗙厸鐎光偓閳ь剟宕伴幘鑸殿潟闁圭儤顨呴～鍛存煟濡櫣锛嶅ù婊庝簽缁辨捇宕掑▎鎺濆敼闂佺顑嗛幑鍥蓟濞戙垹鐒洪柛鎰典簴婵洭姊虹紒妯诲碍缂佺粯锕㈠璇测槈閵忊晜鏅濋梺鎸庣箓濞层劑鎮惧ú顏呪拺闂傚牃鏅濈€佃偐绱掗鐣屾噰鐎殿喖顭烽弫鎾绘偐閹绘帟鈧潡姊洪崫鍕窛闁稿绋撶划濠囶敋閳ь剙顫忛搹瑙勫珰闁炽儴娅曢悘鏇烆渻閵堝骸浜滄い锔炬暬閻涱喛绠涘☉妯虹獩闂佸搫顦伴崹褰掝敊瀹€鍕拺闁革富鍘奸崝瀣煕閵娧冩灈妤犵偛绻樻俊鍫曞幢濞嗘垹妲?
        private net.minecraft.world.phys.Vec3 lastStuckCheckPos;
        private int pathFailures;       // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箳閳ь剝顫夊ú鏍洪敂钘夊灁濞寸厧鐡ㄩ悡銉╂煛閸モ晛浠滈柍褜鍓氶幃鍌氱暦瑜版帒纾奸柣鎰嚟閸橀潧鈹戦悙鑼闁诲繑绻堝鎼佹偄閹肩偘绨婚梺褰掑亰娴滅偤鎯屽▎鎾寸厸鐎光偓鐎ｎ剛袦濡ょ姷鍋涘ú顓€佸Δ鍛＜婵炲棙鍨块埞蹇旂節閻㈤潧校妞ゆ梹鐗犲畷瑙勫閺夋嚦褔鏌熼梻瀵割槮闁藉啰鍠栭弻鏇熺箾閸喖濮夊┑鈩冨絻閻楀﹥绌辨繝鍥舵晬婵炲棙甯╅崝鍛箾閺夋垹姣為柛瀣崌濮婂宕掑▎鎴М闂佸湱鈷堥崑鍕亱濡炪倖鎸堕崹鍦矆閸喓绠鹃柛鈩兩戠亸銊╂煃瑜滈崜銊х不閹惧磭鏆︾紒瀣嚦閺冨牆鐒垫い鎺戝€绘稉宥嗘叏濡灝鐓愰柣鎾寸懄缁绘盯宕煎┑鍫滆檸闂佸搫顑冮崐妤冩閹捐閱囬柕澶堝€栭崰姘舵⒑閸濆嫮鐒跨紓宥勭窔楠炲啴濮€閵堝懍绱堕梺闈涱檧缁犳垵鈻撹箛鏇犵＝闁稿本鐟ㄩ崗灞解攽椤旂偓鏆€规洖缍婂畷绋课旈埀顒勫及閵夆晜鐓忛煫鍥э工婢ф煡鏌涙惔锝呮灈闁哄本娲樼换娑㈠垂椤旂厧袘闂備礁鎲″褰掑箰閸愬樊娼栨繛宸簻瀹告繂鈹戦悩鎻掆偓鎼侊綖閸涘瓨鈷戦柛婵嗗閸ｈ櫣绱掗鑺ュ磳闁?
        // private boolean isSprinting;    // Removed unused variable

        // Constants
        private static final int THINKING_DURATION = 15; // 0.75s 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ帒顦伴弲顏堟⒑閸濆嫮鈻夐柛妯垮亹缁牓宕奸悢绋垮伎濠碘槅鍨板锟犲传閾忓厜鍋撶憴鍕闁绘搫绻濆璇测槈閵忕姷鍔撮梺鍛婂姦娴滄牕危閸儲鈷戠紓浣姑粭鎺楁煟韫囨柨鍝哄┑锛勬暬瀹曠喖顢涘槌栧敽闂備胶纭堕崜婵嬪Φ閻愬鐝堕柡鍥ュ灪閳锋帒霉閿濆懏鍟為柟鍙夋倐閺屾盯鏁愰崘銊ュЕ閻庤娲濋～澶屸偓浣冨亹閸掓帡宕楁径濠佸闂佸搫鍟悧鍡欑矆閸愨斂浜滈柡鍐ㄦ搐娴滃綊鏌ㄥ☉娆戠煉婵﹨娅ｇ槐鎺懳熼崫鍕垫綋闂備礁顓介弶鍨瀳闂?
        private static final int MAX_STUCK_TIME = 40;    // 2s 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛娆忓亰闂勫嫮鎹㈠☉銏犵婵炲棗绻掓禒鑲╃磽娴ｆ彃浜鹃梺鍓插亞閸犳挾寮ч埀顒勬⒒閸屾氨澧涘〒姘殜瀹曟洖鈽夐姀锛勫幐婵炶揪绲介幉锟犓夐姀銈嗙厸鐎光偓閳ь剟宕伴幘鑸殿潟闁圭儤顨呴～鍛存煟濡櫣锛嶅ù婊庝簽缁辨捇宕掑▎鎺濆敼闂佺顑嗛幑鍥蓟濞戙垹鐒洪柛鎰⒔閸旈绱撴担鍝勨枅缂佺姵鐗犲璇测槈閵忕姷鍔撮梺绋跨箳婵厽绂嶉鍫濊摕閻庯綆鍠栭悙濠冦亜閹哄秷鍏岄柛妯绘倐濮婃椽骞栭悙鎻掑闂佺閰ｆ禍鍫曞箖濮椻偓閸╋繝宕ㄩ鎯у箺婵＄偑鍊栭幐楣冨闯閵夈儮鏋旀繝濠傜墛閻撴稓鈧厜鍋撻柍褜鍓熷畷浼村箛椤掑鍔烽棅顐㈡处缁嬫垹绮堥崼銏″枑鐎广儱顦弰銉╂倶閻愭彃鈷旂紒鈾€鍋撴繝鐢靛仜閻楀棝鎮樺┑瀣嚑婵炴垯鍨洪埛鎴︽偨椤栵絽鏋ょ紒澶樺枤閳?

        public TurretFollowGoal(SkeletonTurret turret, double speed, float start, float stop) {
            this.turret = turret;
            this.speedModifier = speed;
            this.startDistance = start;
            this.stopDistance = stop;
            this.setFlags(EnumSet.of(Flag.MOVE, Flag.LOOK));
        }

        @Override
        public void stop() {
            this.turret.getNavigation().stop();
            this.turret.setSprinting(false);
            this.thinkingTicks = 0;
            this.stuckTimer = 0;
        }

        @Override
        public boolean canUse() {
            LivingEntity owner = this.turret.getOwner();
            if (owner == null) return false;

            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼槮闁搞劍绻冮妵鍕冀椤愵澀姹楅梺閫炲苯澧剧紒鐘虫尭閻ｉ攱绺界粙璇俱劑鏌曟径娑㈡鐞氾綁姊婚崒娆戭槮闁圭⒈鍋嗙划娆愮瑹閳ь剙鐣烽姀锛勯檮闁告稑锕ら埀顒€娼￠弻娑⑩€﹂幋婵呯按婵炲瓨绮嶇划鎾诲蓟閻斿憡缍囬柛鎾楀惙鎴犵磼缂併垹骞栭柣鏍с偢瀵鈽夐姀鐘愁棟闁荤姵浜介崜閬嶆晲婢跺鍘梺鎼炲劀閸愬彞绱斿┑鐘殿暜缁辨洟宕楀Ο璁崇箚闁绘垼濮ら弲婵嬫煃瑜滈崜娆撳煝閹炬緞鏃堝川椤旇瀚?
            if (!this.turret.isFollowing()) return false;
            if (this.turret.isPurgeActive()) return false;
            if (this.turret.isCommandScavenging()) return false;
            if (owner.isSpectator()) return false;

            // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箻閺岋綁骞嬮敐鍡╂缂佺偓鍎冲锟犲蓟閺囥垹閱囨繝闈涙搐椤︹晠鎮楃憴鍕闁绘搫绻濆璇测槈閵忕姴宓嗛梺闈涱焾閸庤櫕绂掑鑸碘拺闂侇偆鍋涢懟顖涙櫠椤栫偞鐓熸俊銈呭暙瀛濋梺浼欑悼閸忔ê鐣锋總绋垮嵆婵＄偠顕ф禍楣冩煛瀹ュ骸寮鹃柡浣告闇夐柨婵嗘搐閸斿鏌涢幒鎾舵创婵﹨娅ｉ崠鏍即閻斿憡绶梻浣侯焾椤戝棝骞愰幖浣测偓鏃堝礃椤斿槈褔鏌涢埄鍐炬畼闁荤喆鍔戦弻锝嗘償閵忕姴姣堥梺鍛婄懃閸燁偊顢?
            if (this.turret.distanceToSqr(owner) < (double)(this.startDistance * this.startDistance)) return false;

            this.owner = owner;
            return true;
        }

        @Override
        public boolean canContinueToUse() {
            if (!this.turret.isFollowing()) return false;
            if (this.turret.isPurgeActive()) return false;
            if (this.turret.isCommandScavenging()) return false;
            if (this.turret.getNavigation().isDone()) return false;

            return this.turret.distanceToSqr(this.owner) > (double)(this.stopDistance * this.stopDistance);
        }

        @Override
        public void start() {
            this.timeToRecalculatePath = 0;
            this.thinkingTicks = 0;
            this.stuckTimer = 0;
            this.pathFailures = 0;
            this.lastStuckCheckPos = this.turret.position();
        }

        @Override
        public void tick() {
            this.turret.getLookControl().setLookAt(this.owner, 10.0F, (float)this.turret.getMaxHeadXRot());

            // 0. 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ帒顦伴弲顏堟⒑閸濆嫮鈻夐柛妯垮亹缁牓宕奸悢绋垮伎濠碘槅鍨板锟犲传閾忓厜鍋撶憴鍕闁绘搫绻濆璇测槈閵忕姷鍔撮梺鍛婂姦娴滄牕危閸儲鈷戠紓浣姑粭鎺楁煟韫囨柨鍝哄┑锛勬暬瀹曠喖顢涘槌栧敽闂備胶纭堕崜婵嬪Φ閻愬鐝堕柡鍥ュ灪閳锋帒霉閿濆懏鍟為柟鍙夋倐閺屾盯鎮╅搹顐㈤瀺闂佸搫鎳撳▔娑滅亙闂佸憡渚楅崢楣冩偪閸曨垱鈷戦梻鍫熷崟閸儱鐤炬繛鎴炴皑娑撳秹鏌ｉ悢绋挎珵鐟滅増甯楅弲鏌ユ煕椤愵偄浜濈紓宥呯墕閳?(濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴濐潟閳ь剙鍊块幐濠冪珶閳哄绉€规洏鍔戝鍫曞箣濠靛牃鍋撻鐑嗘富闁靛牆鎳愮粻浼存煟濡も偓濡稓鍒掗崼銉ラ唶闁绘棁娅ｉ惁鍫ユ⒒閸屾氨澧涚紒瀣尰閺呭爼骞囬悧鍫㈠幈闁诲函缍嗛崑鍛焊椤撶喆浜滄い鎰剁悼缁犵偞銇勯姀鈽呰€块柟顔规櫊瀹曟﹢宕ｆ径灞介叡闂傚倷娴囬褍顫濋敃鍌︾稏濠㈣泛鈯曢崫鍕垫建闁逞屽墮閻ｇ柉銇愰幒鎾充缓缂備緡鍨卞ú宥夊磻閹剧粯鏅濋柛灞绢嚤閳哄懏鐓冮弶鐐村缁愭棃鏌涢悙鑸电【闁宠鍨块幃娆撳级閹寸姳妗撻梺姹囧焺閸ㄨ京鏁Δ鍐焿鐎广儱妫庨崑鍛存煕閹般劍娅囬柛妯兼暬閺岋絾鎯旈敐鍡樻瘎濡炪値鍘奸悧濠囨偋鎼淬劍鈷掑ù锝呮啞閹茬鈹戦鑺ョ稇閾荤偞绻濋棃娑卞剰闁藉啰鍠愮换娑㈠箣閻愮數鍙濆┑鐐茬焾娴滎亪寮婚敐澶婄疀闂傚牊绋戦～顐⑩攽閻愯尙澧戦柛濠冩礋閸?
            if (this.thinkingTicks > 0) {
                this.thinkingTicks--;
                this.turret.getNavigation().stop();
                return; // 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ帒顦伴弲顏堟⒑閸濆嫮鈻夐柛妯垮亹缁牓宕奸悢绋垮伎濠碘槅鍨板锟犲传閾忓厜鍋撶憴鍕闁绘搫绻濆璇测槈閵忕姷鍔撮梺鍛婂姦娴滄牕危閸儲鈷戠紓浣姑粭鎺楁煟韫囨柨鍝哄┑锛勬暬瀹曠喖顢涘槌栧敽闂備胶纭堕崜婵嬪Φ閻愬鐝堕柡鍥ュ灪閳锋帒霉閿濆懏鍟為柟鍙夋倐閺屾盯鎮㈤柨瀣淮閻庢鍠楅悡锟犲箖閳哄啯瀚氶柤纰卞墰閺嬪啯绻濋悽闈涗粶婵☆偅鐟╅獮鎰板传閵壯傜瑝闂佹寧绻傞ˇ浼存偂閵夆晜鐓涢柛鎰╁妽閹兼劗鎮顑芥斀闁绘劕寮堕崳娲煟濡ゅ啫鈻堢€殿喖顭烽弫鎰板醇閵忋垺婢戦梻浣告惈濞层劑宕戝鈧畷顐⑽旈崨顔规嫼缂備礁顑嗛娆撳磿閹扮増鐓曢柡鍐ｅ亾闁荤啿鏅犻悰顕€宕橀妸褎娈濋梺閫涚祷濞呮洟寮埀顒勬⒒娴ｇ顥忛柛瀣╃窔瀹曡绻濆顓熸珫濠电姴锕ょ€氼喚寮ч埀顒勬⒑闂堟盯鐛滅紒鎻掑⒔濞戝灚銈ｉ崘鈺佲偓鐢告煕椤垵浜滄繛鎼枤閳ь剝顫夊ú鐔奉焽瑜旈崺銏℃償閵堝洨鏉告繝鐢靛Т閸燁垶寮?
            }

            double distSqr = this.turret.distanceToSqr(this.owner);
            double dist = Math.sqrt(distSqr);
            double yDiff = Math.abs(this.owner.getY() - this.turret.getY());

            // 1. 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ弬娆炬祲濠㈣埖鍔曠粻娑㈡煛婢跺孩纭堕柨娑欑洴濮婇缚銇愰幒鎴滃枈闂佸憡锚婢х晫鍒掔紒妯稿亝闁告劏鏅濋崢鎾绘偡濠婂嫮鐭掔€规洘绮撻幃銏ゆ偂鎼淬倖鎲伴柣搴＄畭閸庨亶鎮у鍐剧€堕柕濞炬櫆閳锋垹绱掔€ｎ厽纭剁紒鐘哄皺缁辨帞鈧綆鍋呯亸鐢告煕閹烘挸娴€规洖銈搁幃銏ゆ惞鐟欏嫬娈為梻鍌欑窔閳ь剛鍋涢懟顖涙櫠椤曗偓閺岋綁鏁愭径瀣殸闁诲酣娼ч妶绋款嚕閸洖绠ｆ繝闈涚墢瀹曟椽姊绘担绛嬪殭閻庢稈鏅濈划娆撳箳閺囩喐鍣峰┑?(Priority 1: Teleport)
            // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煟閵忋埄鐒剧紒鎰殜閺岀喖骞嶉纰辨毉闂佺顑戠换婵嗩嚕閸洖閱囨慨姗嗗幗閻濇牗绻涢幋鐐村碍缂佸缍婂濠氭偄閸涘﹦绉堕梺鍛婃寙閸涱偄浠繝鐢靛仜閻°劎鍒掑畝鈧槐鐐寸節閸パ嗘憰濠电偞鍨堕…鍥汲閸℃稒鐓冪憸婊堝礈閻旈鏆﹂柟瀛樼妇濡插牊鎱ㄥΟ鍧楀摵闁挎稑绻橀幃宄邦煥閸曨剦妫冮悗娈垮枦椤曆囶敇閸忕厧绶炲┑鐑嗘娇閸旀垿寮婚弴鐔风窞闁割偅绻傛慨銏′繆閵堝洤孝婵炲眰鍊濋垾鏃堝礃椤斿槈褔鏌涢埄鍐炬當妞ゎ偄鐗忕槐鎾寸瑹閸パ勭亶闂佽崵鍟块弲娑㈩敋閿濆棛绡€婵﹩鍎甸埡鍛厪濠㈣泛鐗嗛悘顏呫亜椤愩垻孝闁宠鍨块幃娆撳矗婢舵ɑ锛侀梻浣虹《閺呮盯鎮ч幘鎰佸殨闁规儼妫勯悘鎶芥煛閸屾ê鍔滈柡鍌楀亾闂傚倷鑳剁划顖炴晝閳哄懎纾婚柛鏇ㄥ墰椤╂煡鏌ｉ幇闈涘缂佺娀绠栧鍫曞醇濠靛棌鎸冪紓浣割樈閸撶喖寮诲☉娆戠瘈濞达綀娅ｉ悡鎾绘⒑鐠団€虫灁闁搞劋绮欓獮鍐焺閸愨晛鍔呴梺鎸庣箓鐎氼喚绮堥崼銉︹拻闁稿本鐟ч崝宥夋煕鎼粹€虫毐闂囧鎱ㄥΟ鎸庣【缁炬儳顭烽弻娑㈠即閵娿儱顫?& (闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛娆忓亰闂勫嫮鎹㈠☉銏犵婵炲棗绻掓禒鑲╃磽娴ｆ彃浜鹃梺鍓插亞閸犳挾寮ч埀顒勬⒒閸屾氨澧涘〒姘殜瀹曟洖鈽夐姀锛勫幐?OR 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箻閺岋綁骞嬮敐鍡╂缂佺偓鍎冲锟犲蓟閺囥垹閱囨繝闈涙搐椤︹晠鎮楃憴鍕闁绘搫绻濆璇测槈閵忕姴宓嗛梺闈涱焾閸庤櫕绂掑鑸碘拺闂侇偆鍋涢懟顖涙櫠椤栫偞鐓熸俊銈呭暙瀛濋梺浼欑悼閸忔ê鐣锋總绋垮嵆闁绘劕绉弲鐘诲蓟閵娾晛绫嶉柍褜鍓涢埀顒傜懗閸パ嗗煘婵犮垼鍩栭崝鏍煕閹烘嚚褰掓晲閸偅缍堥梺绋款儑婵炩偓闁哄本绋掗幆鏃堟晲閸涱厼顬嗙紓鍌欑閸婂摜绮旇ぐ鎺戠畺婵炲棙鎸婚崑銊╂煕韫囨挻鎲搁柣?OR 婵犵數濮烽弫鍛婃叏閹绢喗鍎夊鑸靛姇缁狙囧箹鐎涙ɑ灏ù婊堢畺閺岋繝宕堕妷銉т患缂佺偓鍎冲﹢閬嶅箟閹间焦鍋嬮柛顐ｇ箘閻熸煡姊洪崫鍕濞存粠浜滈～蹇涙惞鐟欏嫬鐝伴梺鍛婄懃椤︽澘鐣烽幎鑺モ拺缁绢厼鎳忛悵顏堟煙閻熺増鎼愰柣锝囧厴椤㈡盯鎮欓弻銉︽殔婵犲痉鏉库偓鏇㈡晝閵夆晛鐤鹃柍鍝勬噺椤ュ﹥銇勯幇鈺佺仾濠㈣泛瀚妴鎺戭潩椤撗勭杹閻庢鍣崑鍛崲濠靛鐐婇柕濞垮劙閸栨牠姊绘担绛嬪殐闁告鏅弫顕€骞掗幘鑼畾闂佺鍕垫畷闁绘挾鍠栭弻銊モ攽閸℃﹩妫￠梺闈涙处缁诲啴骞?
            boolean needTeleport = (this.stuckTimer > MAX_STUCK_TIME)
                                || (dist > 32.0)
                                || (yDiff > 2.5 && dist < 8.0 && !this.turret.getNavigation().isInProgress());

            if (needTeleport && tryTeleport()) {
                return; // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ弬娆炬祲濠㈣埖鍔曠粻娑㈡煛婢跺孩纭堕柨娑欑洴濮婇缚銇愰幒鎴滃枈闂佸憡锚婢х晫鍒掔紒妯稿亝闁告劏鏅濋崢鎾绘偡濠婂嫮鐭掔€规洘绮撻幃銏ゆ偂鎼淬倖鎲伴柣搴＄畭閸庨亶鎮у鍐剧€堕柕濞炬櫆閳锋垹绱掔€ｎ厽纭剁紒鐘崇叀閺岋綁鍩℃繝鍌滀桓濡ょ姷鍋涢崯鎾箖濞嗘挻鍊绘俊顖滅帛閻濇牠姊绘担渚劸闁哄牜鍓熼幊婵囥偅閸愨晛鈧灚銇勯幘璺轰汗闁衡偓閼恒儯浜滈柡鍐ㄥ€婚幗鍌炴煟閹烘柨浜剧紒缁樼⊕瀵板嫮鈧綆鍏欓埀顒佸笧缁辨帡顢欓懖鈺侇杸閻庡灚婢樼€氫即鐛崶顒夋晣闁绘ɑ褰冪粻娲⒒閸屾瑧顦﹂柟纰卞亜鐓ら柕濞炬櫅绾剧粯绻涢幋娆忕仼闁绘帒鐏氶妵鍕箳閹存繃娈梺鍛婅壘濠€杈╂閹烘鏁婇柤娴嬫櫅椤も偓闁诲骸鐏氬妯尖偓姘嵆閻涱噣宕堕澶嬫櫍闂佺粯蓱瑜板啫效?tick 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻锝夊箣閿濆憛鎾绘煕婵犲倹鍋ラ柡灞诲姂瀵挳鎮欏ù瀣壕闁告縿鍎虫稉宥吤归悡搴ｆ憼闁稿缍侀弻娑㈠Ψ閹存繂顏ら柡瀣懇濮?
            }

            // 2. 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋敐鍛闂佽姤蓱缁诲牓寮婚悢鐓庣濞达絿鍎ら幉姗€姊烘潪鎵槮妞ゆ垵娲獮澶愬川婵犲啫鍔呴梺闈涱焾閸庢娊鎮块崟顖涒拺闂傚牊鍗曢崼銉ョ柧婵炴垯鍨洪崑鍌涚箾閹寸偐妫ㄧ憸鐗堝笚閺呮煡鏌涘☉鍗炲季濞村皷鍋撻梻鍌欑閹芥粍鎱ㄩ悽鍛婂亱闁绘灏欓弳锔炬喐閻楀牆绗掔紒鐘虫皑閹叉瓕绠涘☉妯昏緢闂佹寧娲栭崐褰掓偂閺囥垺鐓忓璺虹墕閻忣亝绻涢崨顔藉磳闁哄矉绻濋崺鈧い鎺戝鎯熼梺鍐叉惈閸婄敻骞忕紒妯肩閺夊牆澧介崚浼存煙鐠囇呯瘈鐎规洦鍨堕幃娆撴倻濡桨缂撴俊鐐€栭悧妤冪矙閹寸姷绠旈柟鐑橆殕閸嬪倿鏌曢崼婵愭Ч闁绘挶鍎甸弻锟犲炊椤垶鐣舵繛瀛樼矒缁犳牕顫?(Walk/Sprint)
            // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箻閺岋綁骞嬮敐鍡╂缂佺偓鍎冲锟犲蓟閺囥垹閱囨繝闈涙搐椤︹晠鎮楃憴鍕闁绘搫绻濆璇测槈閵忕姴宓嗛梺闈涱焾閸庤櫕绂掑鑸碘拺?> 8 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犖ч柛銉㈡櫇閸樼娀姊绘担钘夊惞闁哥姵鍔楅埀顒佽壘閻楀棝鍩ユ径濠庢僵妞ゆ挾鍋熼敍蹇涙⒒娓氣偓濞佳嗗櫣闂佸憡渚楅崹鍗炩枔娴犲鈷掗柛灞剧懅椤︼箓鏌熺喊鍗炰簽缂侇喗鐟︾粭鐔煎焵椤掆偓閻ｇ兘骞嬮敃鈧婵囥亜閹捐泛校婵炲牏鍋撶换婵嬪閿濆棛銆愬銈嗗灥閸燁垳绮嬪鍜佺叆闁割偆鍠撻崢鎼佹倵楠炲灝鍔氶柛鐕佸亝娣囧﹥绂掔€ｎ偆鍘介梺闈涱煭缁犳垿鎮橀埡鍐＜閺夊牄鍔屽ù顔筋殽閻愬弶鍠樻い銏＄懇濮婅崵鈧稒锕╁鐔兼⒒閸屾瑧顦﹂柟纰卞亰閹本寰勫畝鈧粈濠傘€掑锝呬壕閻庢鍣崑濠囩嵁閸ヮ剙绾ч柛顭戝枤閻涒晜淇婇悙顏勨偓鏍蓟閵娾晛瑙﹂悗锝庡枟閸嬧晛鈹戦悩宕囶暡闁抽攱甯掗妴鎺戭潩閿濆懍澹曢梻渚€鈧偛鑻晶浼存煕鐎ｎ偆娲撮柟宕囧枛椤㈡稑鈽夊▎鎰娇婵＄偑鍊栭悧妤冨垝鎼粹垾娑㈩敍閻愬鍘告繝銏ｆ硾鐎涒晝娑甸崜浣插亾濞戞瑧绠撴い顏勫暣婵¤埖鎯斿┑鍫㈡晨闂備礁鎽滈崰鎰焽濞嗘挻鍋╅柣鎴ｆ缁犺櫕淇婇妶鍕槮闁逞屽墰閸忔﹢寮婚埄鍐ㄧ窞閻庯綆浜炴禒顖炴⒑濮瑰洤鍔村ù婊庝簻椤繒绱掑Ο璇差€撴繛鎾村嚬閸ㄩ亶寮姘兼富闁靛牆楠告禍婊勩亜閿曞倹娑ч柣锝呭槻閳规垿宕伴鑺ヮ棃鐎规洏鍔戦、娆撴⒒鐎垫悂鎸?
            if (dist > 8.0 && this.turret.getNavigation().getPath() != null) {
                this.turret.setSprinting(true);
            } else {
                this.turret.setSprinting(false);
            }

            // 3. 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箳閳ь剝顫夊ú鏍洪敂钘夊灁濞寸厧鐡ㄩ悡銉╂煛閸モ晛浠滈柍褜鍓氶幃鍌氱暦瑜版帒纾奸柣鎰嚟閸橀潧鈹戦悙鑼闁诲繑绻堝鎼佹偄閹肩偘绨婚梺褰掑亰娴滅偤鎯屽▎鎾寸厸鐎光偓鐎ｎ剛袦濡ょ姷鍋涘ú顓€佸Δ鍛＜婵炲棙鍨块埞蹇涙⒒閸屾瑧顦﹂柟鑺ョ矋閹便劑寮堕幊铏☉閳规垹鈧綆浜ｉ幗鏇炩攽閻愭潙鐏熼柛銊ョ秺瀹曪繝骞庨懞銉у帾婵犵數鍋涢悘婵嬪礉濞嗘垹纾奸柕濞垮労閻撳吋鎱?(LOD & Adaptive Frequency)
            if (--this.timeToRecalculatePath <= 0) {
                // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犖ч柛銉㈡櫇閸樼娀姊绘担铏瑰笡闁搞劌鐖煎鎼佹嚒閵堝洨顦梺鍝勮癁瀹€鈧崬鐢告煟閻樼儤顏犻悘蹇嬪姂瀹曟繈鎮㈤崗鑲╁幐闂佺硶鍓濋崝鏇㈠焵椤掍焦绀嬫繝鈧笟鈧娲箰鎼达絿鐣靛┑鐐茬湴閸婃繂鐣峰┑鍫氬亾閿濆骸鍘撮柛瀣尵閹叉挳宕熼鍌ゆК婵＄偑鍊ч梽鍕珶閸℃稑绠查柕蹇曞Л閺€浠嬫倵閿濆骸浜芥俊顐㈠暙閳规垿鎮欓弶鎴犱桓闂佺厧缍婄粻鏍春濞戙垹閱囬柕澶涜吂閹锋椽鏌ｉ悩鍙夊鐟滄澘鍟撮、妤呭閵堝棛鍘介梺鐟扮仢鐎氼喚寮ч埀顒€螖閻橀潧浠滈柛鐔告綑閻ｇ兘鎮滅粵瀣櫍濠电偞鍨剁湁濠㈣娲熷娲箰鎼达絿鐣电紓浣靛姀閸嬫劙鎳炴潏銊х瘈婵﹩鍘鹃崢鎼佹⒑缁洖澧查柣鐔村劜缁傛帡鏌嗗鍡欏幐閻庡厜鍋撻悗锝庡墰閻﹀牓鎮楃憴鍕濞存粌鐖奸妴浣割潨閳ь剟骞冮埡鍛闂婎偒鍙€缁绘洟姊婚崒姘偓鐑芥嚄閸洖绠犻柟鎹愵嚙鎼村﹪鏌＄仦璇插姶闁轰礁瀚…鍧楁嚋闂堟稑顫岄梺鍝勵儎閼冲爼鍩€椤掆偓缁犲秹宕曢柆宓ュ洭顢涘鍛劶闁诲函缍嗛崑浣圭濠婂牊鐓欓柟瑙勫姈绾箖鏌＄€ｎ偄鐏撮柡宀嬬秮閺佸倿鎳為妷銉ь暡闂備礁鐤囬～澶愬垂閸ф鏄ラ柕澶嗘櫅楠炪垺淇婇悙鎻掆挃闁轰焦鐗曢埞鎴︽偐椤愶絽顎忛梺鍛婃礀閻忔岸鎮挎笟鈧幃妤冩喆閸曨剛顦ョ紓鍌氱Т閿曨亪鐛崘顔藉€婚柤鎭掑劤閸旂兘姊洪幐搴㈢５闁稿鎹囬弻?(LOD)
                // 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫鍐煥閺囨浜鹃梺姹囧€楅崑鎾舵崲濠靛洨绡€闁稿本绋戝▍锝夋⒑閹肩偛濡界紒璇茬墦閹繝顢曢敃鈧悙濠囨煏婵犲繐顩い锔诲弮濮婅櫣绱掑Ο鑲╃厒缂備緡鍣崹鎶藉箲閵忕姭妲堥柕蹇曞Х椤撳搫鈹戦悙鍙夘棞缂佺粯甯楃粋鎺撱偅閸愨斁鎷?>20): 40 ticks (2s)
                // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓闁搞劌鍊块弻娑㈩敃閿濆棛顦ョ紓浣哄Т缂嶅﹪寮诲澶婁紶闁告洦鍓欏▍锝夋⒑濞茶骞楁い銊ワ躬瀵顓奸崼顐ｎ€囬梻浣告啞閹歌崵绮欓幘婢勶綁骞囬弶璺唺濠德板€愰崑鎾剁磼閻樺磭鈯曢柕鍥у楠炴鎹勯惄鎺炵秮閺屾盯骞掗幘鑸靛垱濠?>10): 20 ticks (1s)
                // 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫鍐煥閺囨浜鹃梺姹囧€楅崑鎾舵崲濠靛洨绡€闁稿本绮岄。娲⒑閹肩偛濡奸柛濠傛健瀵濡堕崥銈呮贡閳ь剨缍嗛崑鍛存偟閺嶎厽鈷戠紓浣诡焽閻瞼绱掗鍛仯闁瑰箍鍨归埥澶愬閻樻鍚呮繝鐢靛仜濡鎹㈤幒鎾额浄濡わ絽鍟埛?<10): 10 ticks (0.5s)
                if (dist > 20) this.timeToRecalculatePath = 40;
                else if (dist > 10) this.timeToRecalculatePath = 20;
                else this.timeToRecalculatePath = 10;

                // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑鏅悷婊冪箻楠炴垿濮€閵堝懐鐤€濡炪倖妫佸Λ鍕償婵犲洦鈷戦柣鐔煎亰閸ょ喎鈹戦鈧褔鎮鹃悜钘夎摕闁靛濡囬崢閬嶆⒑閺傘儲娅呴柛鐔跺嵆閸╁﹪寮撮姀锛勫幈闁硅偐琛ュΣ鍕绩婵犳碍鐓忛柛銉戝喚浼冮悗娈垮枙缁瑦淇婂宀婃Ь闂佺粯鎸搁崐鍨潖閸濆娊铏规嫚閹绘帞顔戦梻浣告贡閹虫挸煤椤撱垻宓侀柛鎰靛幑娴滃綊鏌熼悜妯虹仼闁稿﹦鍋ゅ娲濞戣京鍔搁梺绋块绾绢厾鍒掓繝鍥ㄥ€婚柤鎭掑劚娴?
                if (!this.turret.getNavigation().moveTo(this.owner, this.speedModifier)) {
                    // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箳閳ь剝顫夊ú鏍洪敂钘夊灁濞寸厧鐡ㄩ悡銉╂煛閸モ晛浠滈柍褜鍓氶幃鍌氱暦瑜版帒纾奸柣鎰嚟閸橀潧鈹戦悙鑼闁诲繑绻堝鎼佹偄閹肩偘绨婚梺褰掑亰娴滅偤鎯屽▎鎾寸厸鐎光偓鐎ｎ剛袦濡ょ姷鍋涘ú顓€佸Δ鍛＜婵炲棙鍨块埞蹇旂節閻㈤潧校妞ゆ梹鐗犲畷瑙勫閺夋嚦褔鏌熼梻瀵割槮闁藉啰鍠栭弻鏇熺箾閸喖濮夊┑鈩冨絻閻楀﹥绌辨繝鍥舵晬婵炲棙甯╅崝鍛箾閺夋垹姣為柛瀣崌濮婂宕掑▎鎴М闂佸湱鈷堥崑鍕亱濡炪倖鎸堕崹鍦矆閸喓绠鹃柛鈩兩戠亸銊╂煃瑜滈崜銊х不閹惧磭鏆︾紒瀣嚦閺冨牆鐒垫い鎺戝€绘稉宥嗘叏濡灝鐓愰柣鎾寸懄缁绘盯宕煎┑鍫滆檸闂佸搫顑冮崐妤冩閹捐閱囬柕澶堝€栭崰姘舵⒑?
                    this.pathFailures++;

                    // 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫鍐煥閺囨浜鹃梺姹囧€楅崑鎾舵崲濠靛顥堟繛鎴濆船閸撴壆绱掗悙顒€鍔ゆい顓犲厴瀵鏁愭径濠冾棟闂佸壊鐓堥崰妤呭磹椤栫偞鈷戠紒瀣儥閸庡秹鏌涢弬鎸庢崳婵″弶鍔欓獮妯尖偓娑櫭鎾寸節濞堝灝鏋熼柛鈺佺墛缁傚秹鎮欏ù瀣€婚梺闈涚箞閸婃牠宕愰悜鑺ョ厱婵犻潧妫楅顐⑽旈悩鍙夊枠婵﹥妞藉畷婊堝箵閹哄秷鍩呴梻浣侯焾椤戝懐鈧凹鍘剧划瀣吋婢舵ɑ鏅┑鐘诧工鐎氼剚绂?2 闂?-> 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫鍐煥閺囨浜鹃梺姹囧€楅崑鎾舵崲濠靛洨绡€闁稿本绋戝▍褔姊哄ú璇插箺闁荤啿鏅犲濠氭偄閸涘﹦绉堕梺鍛婃寙閸涱喗顔忛梻鍌欑劍濡炲潡宕㈡禒瀣ㄢ偓鍐╃節閸パ嗘憰濠电偞鍨崹褰掓倿濞差亝鐓曢柟鏉垮悁缁ㄥ瓨淇婇幓鎺斿ⅱ缂佽鲸鎸婚幏鍛村传閸曟埊缍侀弻娑㈠Ω閵夈儺鏆㈤梺鐟扮畭閸ㄥ綊鍩為幋鐘亾閿濆骸浜芥俊顐㈠暙閳规垿鎮欑€靛憡娈梺绋块叄娴滃爼骞冭楠炴ê鐣烽崶銊︻啎闂備胶顢婇幓顏嗙不閹寸姷涓嶅┑鐘崇閸嬶綁鏌涢妷顔荤盎闁汇劎鍎ら妵鍕晜閸濆嫬顬堝銈庝簻閸熷瓨淇婇崼鏇炲窛妞ゆ牗绮犻崬鍫曟⒑鐠囨彃顒㈤柤褰掔畺楠炲﹤顫滈埀顒€顕ｉ锕€绀冩い鏃囧亹閿涙粌鈹戦悙鏉戠仸闁艰鍎抽?(濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴濐潟閳ь剙鍊块幐濠冪珶閳哄绉€规洏鍔戝鍫曞箣濠靛牃鍋撻鐑嗘富闁靛牆鎳愮粻浼存煟濡も偓濡稓鍒掗崼銉ラ唶闁绘棁娅ｉ惁鍫ユ⒒閸屾氨澧涚紒瀣尰閺呭爼骞囬悧鍫㈠幈闁诲函缍嗛崑鍛焊椤撶喆浜滄い鎰剁悼缁犵偞銇勯姀鈽呰€块柟顔规櫊瀹曟﹢宕ｆ径灞借拫闂傚倸鍊搁崐鐑芥嚄閸洖绠犻柟鐐墯閸ゆ洟鏌涢锝嗙缂佺姳鍗抽弻娑㈠箛椤栨氨姣㈤梺鍝勬４缁犳捇寮婚悢鍏煎€绘俊顖濇閸旂鈹戦悙鑼癁闁哄懐濮撮锝夊醇閺囩偤鍞跺銈嗗姂閸婃洜鏁妷鈺傗拺闂侇偆鍋涢懟顖涙櫠椤斿浜滈柨鏇炲€瑰☉褎銇勯銏㈢閻撱倖銇勮箛鎾村婵☆偄鍟村娲礃閸欏鍎撻梺鐟板暱缁绘﹢銆侀幘鎰佸悑闁告侗浜濋弬鈧梻浣虹帛閿曗晠宕伴弽顓熷€舵い蹇撶墛閻撱儵鏌￠崶顭嬵亪鎮橀崣澶樻?
                    if (this.pathFailures >= 2) {
                        this.thinkingTicks = THINKING_DURATION + this.turret.getRandom().nextInt(10); // 0.75s - 1.25s
                        this.pathFailures = 0; // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛濠傛健閺屻劑寮村鑸殿€栨繛瀛樼矊缂嶅﹪寮诲☉銏犵疀闁稿繐鎽滈弫鏍⒑濞茶骞楅柟鐟版喘瀵鈽夐姀鈺傛櫇闂佹寧绻傚Λ娑⑺囬妸鈺傗拺缂佸顑欓崕娑樏瑰搴濋偗鐎殿喛顕ч埥澶愬閻橀潧濮堕梻浣告啞閸旓附绂嶅┑瀣棷妞ゆ挾鍠撶弧鈧┑鐐茬墕閻忔繈鎮橀悩缁樼厪闁割偆鍠愰崐鎰偓娈垮枦椤曆囶敇閸忕厧绶炲┑鐘插楠炴劕鈹戦悙鑸靛涧缂佽弓绮欓獮澶愬灳閺傘儲鐏侀梺鍦帛瀹稿寮?
                    }
                } else {
                    // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箳閳ь剝顫夊ú鏍洪敂钘夊灁濞寸厧鐡ㄩ悡銉╂煛閸モ晛浠滈柍褜鍓氶幃鍌氱暦瑜版帒纾奸柣鎰嚟閸橀潧鈹戦悙鑼闁诲繑绻堝鎼佹偄閹肩偘绨婚梺褰掑亰娴滅偤鎯屽▎鎾寸厸鐎光偓鐎ｎ剛袦濡ょ姷鍋涘ú顓€佸Δ鍛＜婵炲棙鍨块埞蹇旂節閻㈤潧校妞ゆ梹鐗犲畷瑙勫閺夋嚦褔鏌熼梻瀵割槮闁藉啰鍠栭弻鏇熺箾閸喖濮夊┑鈩冨絻閻楀﹥绌辨繝鍥舵晬婵炲棙甯╅崝鍛箾閺夋垹姣為柛瀣崌濮婂宕掑▎鎴М闂佸湱鈷堥崑鍕亱濡炪倖鎸堕崹鍦矆閸儲鐓熼柡鍐ㄥ€哥敮鍫曟煢閸愵亜鏋涢柡宀嬬秮瀵噣宕堕妷銏犱壕闁逞屽墴閺屾稓鈧綆鍋呯亸顓㈡煃閽樺妲搁柍璇茬Ч椤㈡顦辩紒銊ャ偢閺岀喐绗熼崹顔碱潎閻庤娲橀崕濂杆囬鈧弻锟犲焵?
                    this.pathFailures = 0;

                    // 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴濐潟閳ь剙鍊块幐濠冪珶閳哄绉€规洏鍔戝鍫曞箣濠靛牃鍋撻鐑嗘富闁靛牆鎳愮粻浼存煟濡も偓濡稓鍒掗崼銉ラ唶闁绘棁娅ｉ惁鍫ユ⒒閸屾氨澧涚紒瀣尰閺呭爼骞囬悧鍫㈠幈?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎电濡介梺绋款儏椤戝鎮￠锕€鐐婇柕濞р偓濡插牏绱掗悙顒€鍔ゆい顓犲厴瀵鏁愭径濠勭杸濡炪倖甯掗崐褰掑礋妤ｅ啯鈷戦梺顐ゅ仜閼活垱鏅堕鐐村仺妞ゆ牓鍊楃弧鈧Δ鐘靛仜閿曘倝鈥﹂妸鈺侀唶闁绘洑鐒﹂ˉ鍫熺節閻㈤潧浠﹂柛銊╂涧閻ｇ兘顢楅埀顒勫煝閹捐绀傞柤娴嬫櫇閻﹀牏绱掗崜褍顣奸拑杈ㄣ亜椤愵澁韬柡灞剧洴婵℃悂鍩￠崒娑㈡暘闂備礁纾划顖毼涢崘顭戝殨闁圭虎鍠栭～鍛存煃閵夈儱甯犵紒銊ヮ煼濮婄粯鎷呴崨濠傛殘缂備礁顑嗛崹鍧楀箖濞差亜惟闁冲搫鍊告禍?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柤纰卞墻濡茬兘姊绘担鍛婃儓婵炲眰鍔嶉幈銊╁箻椤斻垹顦～婵嬵敇濠娾偓缁ㄥ姊虹憴鍕姢鐎规洦鍓熼幃姗€顢旈崼鐔哄幈?(Randomness 15-25%)
                    // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁逞屽墾缁犳挸鐣锋總绋课ㄦい鏃囧Г濞呭牓姊绘担绋款棌闁稿鎳愮紓鎾淬偅閸愩劌鍤戦梺鍝勭Р閸斿海绮绘ィ鍐╃厵閻庢稒顭囬幊鍐煟韫囷絼閭柡灞剧⊕閹棃鏁嶉崟鎳峰洦鐓涚€光偓鐎ｎ剛袦婵犳鍠掗崑鎾绘⒑闂堟稓绠氶柡鍛箞瀹曟繈骞栨担鍏夋嫼闂佸憡绻傜€氱兘宕曟惔锝囩＜闁兼悂娼ч崫铏光偓娈垮枦椤曆囧煡婢跺á鐔兼煥鐎ｅ灚缍岄梻鍌欑閹诧繝銆冮崼銉ョ；闁绘劗鍎ら崐鍫曟煕椤愩倕鏋旂紒鈾€鍋撻梻渚€娼х换鍫ュ垂濞差亜鍚归柍褜鍓熷铏圭磼濮楀棙鐣烽梺鍦嚀濞层倝顢氶敐鍥ㄥ珰婵炴潙顑嗛～宥呪攽椤旀枻鍏紒鑼跺Г缁傚秵銈ｉ崘鈺冨弳濠电娀娼уΛ婵嬵敁濡も偓闇夋繝濠傛噹娴犻亶鏌″畝瀣М妞ゃ垺锕㈤幃銏ゆ煥鐎ｎ厾妾ㄩ梻鍌欑閹碱偊寮甸鈧叅闁绘棃顥撻弳锕傛煕濡ゅ啫鈧綁鎮㈤崗鍏煎劒闂備緡鍋呯粙鎺椼€佸Ο鑲╃＝闁稿本鑹鹃埀顒勵棑缁牊绗熼埀顒勩€侀弽顓炲窛婵縿鍊曞ú顓㈠箖閻ｅ瞼鐭欓柟绋垮琚ｉ梻鍌欑窔閳ь剛鍋涢懟顖涙櫠椤栫偞鐓忛柛銉戝喚浼冨Δ鐘靛仦鐢帡顢樻總绋块唶婵犻潧妫楅懙鎰版⒒閸屾瑧顦︾痪缁㈠幘閸掓帡顢涘В鍏肩洴瀹曟﹢顢欓懖鈺冩毇婵犲痉鏉库偓鏇㈠箠韫囨稑鐤鹃柡灞诲劜閻撴洘绻涢幋婵嗚埞鐎殿噣绠栭弻锟犲幢閹邦剛浼勭紓浣介哺閹稿骞忛崨鏉戠闁瑰搫绉撮ˉ姘節閻㈤潧袨闁搞劌銈稿畷娲冀椤撶偟顦梺鍝勭▉閸樹粙宕戦崒娑氱闁瑰瓨鐟ラ悘顏堟煟閹惧瓨绀嬮柡宀嬬節瀹曞爼濡烽妷銉€冲┑鐘媰鐏炶姤鐝濋梺鍝勬湰閻╊垰顕ｉ鍌涘珰婵炴潙顑呮禍鐐繆閵堝懎鏆炴い顐ｆ礋閺岀喖鎮滃鍡樼暥闂備礁宕ú顓㈠蓟閿熺姴鐐婇柕濞у本娈归梻浣告憸婵潧鐣濋幖浣哥畺婵°倕鍟崰鍡涙煕閺囥劌澧版い锔哄姂濮婇缚銇愰幒鍡椾壕婵炴垶绮岄崢锛勭磽娓氬洤鏋︽い鏇嗗洤鐓″璺号堥弸搴ㄦ煙闁箑澧┑鈩冨▕濮婄粯绗熼埀顒€顭囪閹广垽宕奸妷銉ョ€梺鎯х箳椤㈠﹥鎱ㄩ幎鑺ョ厽闁归偊鍠栭崝瀣煃闁垮绗掗柕鍡樺笒椤繈鏁愰崨顒€顥氬┑鐘垫暩閸嬬姵绔熼崼婵堟殾闁汇垻顭堢粻顖滄喐閻楀牆绗氶柛瀣閺岋綁骞橀搹顐ｅ闯濡炪倧瀵岄崳锝夊蓟閻旂厧绀傞柤娴嬫櫆濞堫剟姊洪幖鐐插婵＄偠妫勯悾鐑芥晲閸垻鏉搁梺鐟板綖缁€浣虹礊婵犲洤绠栭柍杞扮贰閸熷懏銇勯弮鍌氬付濠㈢懓顦靛?
                    if (this.turret.getRandom().nextFloat() < 0.02f) { // 2% 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣銏犲閺佸﹪鏌″搴″箹缂佹劖顨嗘穱濠囧Χ閸涱厽娈查梺鍝勬缁捇寮婚悢鍏煎€绘慨妤€妫欓悾鍓佺磼閻愵剙鍔ょ紓宥咃躬楠炲啳銇愰幒鎴犲€為悷婊冮叄閸┿垽寮撮姀锛勫幈闂佺粯妫冮弨閬嶅闯瑜版帗鐓冮悷娆忓閻忓鈧娲樼敮鎺楋綖濠靛鏁囬柣鎰摠閻ｅジ姊?tick (闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑鏅悷婊冮叄閵嗗啴濡疯閻瑩鏌涢弻顓滃€愰崑鎾诲锤濡や讲鎷哄銈嗗坊閸嬫挾绱掓径濠庡殶濠㈣娲樼换婵嗩潩椤撶姴甯鹃梻浣稿閸嬪懐鎹㈤崘鈺佸灁濠靛倸鎲￠悡鐔煎箹濞ｎ剙鈧洟鎮￠幇鐗堢厪闁搞儜鍐句純閻庢鍠曠划娆撱€侀弴顫稏妞ゆ挾濮靛畷鐔兼⒒閸屾瑧顦︽繝鈧柆宥呯疇闁瑰墽绮崑澶娾攽閸屾粠鐒鹃柦鍐枛閺岋繝宕堕埡浣圭亖缂備胶濞€缁犳牠寮诲☉鈶┾偓锕傚箣濠靛洨浜俊鐐€ら崜娆擃敄婢跺娼栭柧蹇撴贡绾惧吋淇婇婵嗗惞闁告瑥妫濆铏规兜閸涱喚褰ч梺鍛婃⒐閻熲晛鐣峰ú顏勭劦妞ゆ帊闄嶆禍婊堟煙閸濆嫭顥滃ù婊堢畺濮婅櫣鎷犻懠顒傤唹闂佺厧缍婄粻鏍灳閿曞倸鍨傛い鏂诲劤閸犳挻绂嶉幖浣稿唨鐟滃本绔熼弴鐐╂斀妞ゆ梻鐡旈悞浠嬫煕濡姴娲ㄥ畵渚€鏌″搴″箺闁稿鍊块弻鏇㈠醇濠垫劖效闂佺粯鎸诲ú婊堝箟閸涘﹥鍎熼柕濠忕岛閸嬫捇宕橀鐓庣獩濡炪倖鎸稿ú锔剧矙閹达讣缍栨繝濠傜墕閻掑灚銇勯幒鎴濐仼闁藉啰鍠栭弻銊モ攽閸℃ê鏅甸梺鍝勫暙閻楀棝鎮為崹顐犱簻闁圭儤鍨甸顏堟煕鐎ｎ亶鍎忛柍瑙勫灴閹晠宕ｆ径灞烩偓妤呮⒑閹肩偛鍔村ù婊嗘硾铻ｉ柛鏇ㄥ灡閳锋垿鏌涘┑鍡楊仾婵犫偓娴煎瓨鐓熼柍鍝勶工閻忥箓鏌ｅ☉鍗炴珝妤犵偞甯″顒勫传閸曨亜顥氶梻浣瑰缁诲倻鑺遍懖鈺勫С闁圭虎鍠楅悡鏇㈡倵閿濆骸浜濈€规洖鐬奸埀顒侇問閸犳骞愰搹顐ｅ弿闁逞屽墴閺屽秹濡烽妷銉ョ闂?
                         this.thinkingTicks = 10;
                    }
                }
            }

            // 4. 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛娆忓亰闂勫嫮鎹㈠☉銏犵婵炲棗绻掓禒鑲╃磽娴ｆ彃浜鹃梺鍓插亞閸犳挾寮ч埀顒勬⒒閸屾氨澧涘〒姘殜瀹曟洖鈽夐姀锛勫幐婵炶揪绲介幉锟犓夐姀銈嗙厸閻忕偟顭堟晶鑼偓鍨緲鐎氼噣鍩€椤掑﹦绉靛ù婊勭箞椤㈡瑩寮撮悙鈺傛杸闂佺粯鍔栧娆撴倶閻斿吋鐓曢柕濞垮劤缁夋椽鏌熼鎯т槐鐎规洖缍婇、鏇㈡偐鏉堚晝娉块梻鍌欒兌閹虫捇骞栭鈶芥稑螖娴ｄ警娲告俊銈忕到閸燁垶鍩涢幒妤佺厱闁靛鍨甸張顒勫煝閸儲鈷戦悹鍥ｂ偓铏亶濡炪們鍔岄敃顏勵嚕椤愶箑绠涢柡澶庢硶閿涙粌鈹戦悙鏉戠仸闁荤啙鍡愪汗闁搞儺鍓氶埛鎺懨归敐鍫燁棄闁告艾缍婇弻娑㈡偐閸欏妫﹂悗瑙勬礉椤绮嬮幒鏂哄亾閿濆簼娴烽柟鑺ユ礋濮婅櫣鎹勯妸銉︾亖婵犳鍠楀娆擃敊韫囨挴鏀介悗锝庡亜閳ь剛鏁诲濠氬醇閻旇　濮囬梺瑙勫絻閹芥粎妲愰幒妤€绠涙い鎾楀嫮鏉规繝娈垮枛閿曘劌鈻嶉敐鍥у灊婵炲棙鍨跺畷澶愭煏婵炑冭嫰閺佺厧鈹戦敍鍕杭闁稿鍊濆畷銏ゆ偂楠炵喐妞介、姗€濮€閵忕姷銈﹂梻浣侯攰閹活亞绮婚幋鐘电焼閻庯綆鍋佹禍婊堟煙閹屽殶闁宠棄顦湁婵犲﹤鐗忛悾娲煛鐏炲墽娲撮柡浣稿€婚幏鐘诲箵閹烘棏鍟囬梻浣告憸閸犳劙骞冮崒姘兼綎?
            checkStuckAndJump();
        }

        private boolean tryTeleport() {
            if (!this.turret.hasTeleportModule()) return false;
            // 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴濐潟閳ь剙鍊块幐濠冪珶閳哄绉€规洏鍔戝鍫曞箣閻欏懐骞㈤梻鍌欑窔閳ь剛鍋涢懟顖涙櫠閹绢喗鐓涢悘鐐插⒔閵嗘帡鏌嶈閸撱劎绱為崱娑樼；闁告侗鍘鹃弳锔锯偓鍏夊亾闁告洦鍓涢崢鎼佹倵閸忓浜鹃柣搴秵閸撴盯鏁嶉悢鍝ョ閻庣數顭堥鎾斥攽閳ヨ櫕鍠樻鐐茬箻閹晝鎷犻懠顒夊斀闂備礁婀遍崕銈夊春閸繍鐒芥繛鎴欏灪閳锋帡鏌涚仦鍓ф噮妞わ讣绠撻弻鐔兼嚍閵壯呯厑闂侀€涚┒閸旀垿鐛鈧、娆撴偩鐏炶棄绗岄梻鍌欑劍鐎笛呮崲閸岀倛鍥敍閻愭彃鍤?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁逞屽墾缁犳挸鐣锋總绋课ㄦい鏃囧Г濞呭牓姊绘担鍛婂暈濞撴碍顨婂畷婵堟崉婵傝姤妞介、鏃堝礋椤撶偛绠伴梻鍌欑閹诧紕鍒掗崼銉﹀€块柨鏇炲€搁悿?SkeletonTurret 闂?public int teleportCooldown 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缂佺姷濞€閺岀喖宕滆鐢盯鏌涚€ｃ劌鈧繈寮婚弴鐔虹闁绘劦鍓氶悵鏇㈡⒑缁嬫鍎忔い鎴濇婵＄敻宕熼姘鳖啋闂佸憡顨堥崑鐔哥閼测晝纾?getter)
            // 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫鍐煥閺囨浜鹃梺姹囧€楅崑鎾舵崲濠靛洨绡€闁稿本绮岄·鈧梻浣侯焾椤戞垹鎹㈠┑瀣摕鐎广儱顦导鐘绘煕閺囥劌澧繛鍜冪秮濮婂宕掑顑跨敖闂佹悶鍔岄悥鐓庮嚕婵犳碍鏅插璺猴功椤撴椽姊洪幐搴ｇ畵婵☆偒鍘艰灋闁告洦鍘剧壕钘壝归敐鍛儓妞ゅ孩鎸剧槐鎾愁吋閸曨厾鐛㈤悗娈垮枛椤兘骞冮姀銏″仒闁炽儱鍘栨竟鏇炩攽閻愭潙鐏﹂柣鐕佸灦閹偞绂掔€ｎ偆鍘藉銈嗘尵閸庢劙宕曢幋鐘电＜閺夊牄鍔屽ù顔姐亜閵忊€冲摵鐎规洖宕埢搴ㄥ箣閻愭惌鍟呴梻鍌氬€搁崐绋棵洪妶澹﹀洭鎮界粙鑳憰闂侀潧顭堥崕顕€寮ㄦ禒瀣厱闁斥晛鍟伴幊鍐┿亜閵堝倸浜剧紓鍌氬€烽懗鍫曟惞鎼淬劌鍌ㄥ┑鍌氭啞閸嬪鈹戦崒婊庣劸闁藉啰鍠栭弻宥夊煛娴ｅ憡娈叉繝娈垮灡閹稿啿顫忔繝姘唶闁绘棁銆€閺嬫棃姊虹粙娆惧剱闁瑰憡鎮傞崺鐐哄箣閿曗偓楠炪垺绻涢崱妯哄妞ゆ梹娲熷缁樻媴閻熼偊鍤嬬紓浣筋嚙閸婂潡鐛箛鏇楀亾閿濆骸鏋涢悷娆欑畵閹鏁愭惔鈩冪亶闂佺粯鎸诲ú妯兼崲濞戙垹绠ｆ繝闈涙閸╃偤姊虹拠鑼畾闁告挻绻堟俊鐢稿礋椤栨碍顥濋柣鐘充航閸斿酣顢欓幒鎴旀斀妞ゆ梻銆嬮弨缁樹繆閻愯埖顥夐柣锝囧厴婵℃悂鏁傞崜褏妲囬梻浣侯焾閺堫剛鍒掗崼銉ョ畺闁挎繂顦伴埛鎺懨归敐鍕劅闁绘帒澧界槐鎺楀Ω閿斿浠㈤悗瑙勬礃閸旀瑥顕ｉ幘顔肩厬闁宠鍎虫禍楣冩煥閺囩偛鈧悂鎮欐繝鍐︿簻闁瑰搫绉堕ˇ锕€霉閻樿櫕銇濇慨濠冩そ瀹曘劍绻濋崟銊︻潔闂備焦瀵уú蹇涘磹濠靛棛鏆︽繝濠傜墱閺佸洭鏌曡箛濠冾€嗛柟閿嬫そ濮婃椽宕ㄦ繝鍕ㄦ闂佹寧娲忛崕鎻掝嚗閸曨垰绀嬫い鏍ㄧ〒閸橀亶鏌ｆ惔顖滅У濞存粍绻堣棢闁靛繆妲呭▓浠嬫煟閹邦厽鍎楁繛鍫熺矒閺岀喖顢欓崫鍕紙閻庤娲﹂崑濠冧繆閻ゎ垼妾ㄩ梺鍝ュ枎闁帮絽顫忕紒妯诲缂佸顑欏Λ宀勬⒑缁嬫鍎忛柟铏姍楠炴垿濮€閵堝懐顦板銈嗗笒閸嬪棗霉閸曨偀鏀介柣鎰綑閻忕喖鏌涢妸锔姐仢闁诡噯绻濆鎾閿涘嫬甯惧┑鐘垫暩婵鎹㈤幒妤€绀嗛柡澶婄氨閺€鑺ャ亜閺冨倸甯堕柍褜鍓欓…鐑藉春閳ь剚銇勯幒鎴濇灓婵炲吋鍔栫换娑㈠矗婢舵稖鈧法鈧娲栫紞濠傜暦瑜版帩鏁婇柣鎰靛墯椤旀洟姊绘担绋款棌闁稿鎳庣叅闁挎洖鍊搁弸渚€鏌涚仦鎯ь棜闁稿鎹囬悰顕€宕归鐓庮潛闂備胶鎳撻崯璺ㄦ崲閹版澘鐓濈€广儱鎲橀弮鍫濆窛妞ゆ梹鍎抽獮妤呮⒑閻熸澘鎮戦柣锝庝邯瀹曟劙濡堕崪浣哄姺闂佽澹嗘晶妤呮偂閻斿吋鐓冮柍杞扮閺嗙偟绱掗埀顒勫焵椤掆偓椤啴濡堕崱妯尖敍缂傚倸绉崇欢姘舵偘椤斿槈鐔煎礂閻撳海褰撮梻浣藉亹閳峰牓宕滃☉銏犵骇濞寸姴顑嗛埛鎺戙€掑锝呬壕濠电偘鍖犻崶锝傚亾閿曞偆鏁囬柣妯哄悁缁楀姊洪悷閭﹀殶濠殿喚鏁婚、鏇熺鐎ｎ偆鍘介梺褰掑亰閸ｎ噣寮抽鐐寸厱閻庯綆鍋呭畷宀勬煟濞戝崬娅嶇€规洖缍婇、娆撴偂鎼搭喗缍撻梻鍌氬€烽懗鍓佸垝椤栫偑鈧啴宕卞▎蹇撶亰闂佽鍎崇壕顓㈠汲閿斿浜滈柡宥冨妿缁犳﹢鏌ｉ妶鍌氫壕濠电姷鏁搁崑鐐哄垂閸洘鍋￠柕蹇嬪€曠粻顖氣攽閻樺磭顣查柍閿嬪灩缁辨帞鈧綆鍘奸崝鍨亜椤愵剛鐣甸柡灞剧⊕缁绘繈宕橀埡鍐炬Ч闁诲孩顔栭崰妤呭箖閸岀偛绠栭柕蹇嬪€曟导鐘绘煏婢诡垰鑻弲顓㈡⒒閸屾瑨鍏岀紒顕呭灦楠炴劗绮欏Λ闈涚秺閺屻劎鈧綆鍋呴悵鐑芥⒑閹稿孩绀€闁稿﹤缍婇幃?
            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犖ч柛銉㈡櫇閸樼娀姊绘担铏瑰笡闁搞劌鐖煎鎼佹嚒閵堝洨顦梺鍝勮癁瀹€鈧崬鐢告煟閻樼儤顏犻悘蹇嬪姂瀹曟繈鎮㈤崗鑲╁幐闂佺硶鍓濋崝鏇㈠焵椤掍焦绀嬫繝鈧笟鈧娲箰鎼达絿鐣甸梺鐟板暱缁绘帡骞忚ぐ鎺撴櫢闁绘ê纾崢鎾剁磽閸屾瑧鍔嶉拑杈╃磼閳ь剛鈧綆鍠楅悡娆愩亜閺冨倻鎽傛繛鍫熺矒閺屸剝鎷呴悷鏉款潔闂佽鍨遍弻銊╁煘閹达箑閱囬柕蹇婂墲濞呮帗绻濈喊澶岀？闁稿鍨垮畷鎰板箣閿曗偓绾惧綊鏌￠崶銉ョ仼缂佺姷濮甸幈銊ヮ渻鐠囪弓澹曢柣?grep闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弮鍫熸殰闁稿鎸剧划顓炩槈濡娅ч梺娲诲幗閻熲晠寮婚悢鍛婄秶闁诡垎鍛掗梻浣芥〃缁€渚€鏁冮鍫濊摕闁绘柨鍚嬮崵鎺楁煏閸繃澶勬い鏂库€ortCooldown 闂?private 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓闁搞劌鍊块弻娑㈩敃閿濆棛顦ョ紓浣哄С閸楁娊骞冭ぐ鎺戠倞鐟滃酣鍩㈤弴鐔虹闁稿繗鍋愭晶閬嶆煙閸欏鍊愰柟顔ㄥ洤閱囨繝闈涚墢閹虫牠姊绘担渚劸濡ょ姵鎮傝棟闁汇垻顭堥拑鐔哥箾閹寸們姘ｉ崼鐔剁箚妞ゆ牗鑹鹃幃鎴︽煙閹绘帇鍋㈡慨?getter闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弮鍫熸殰闁稿鎸剧划顓炩槈濡娅ч梺娲诲幗閻熲晠寮婚悢琛″亾閻㈡鐒惧ù鐘欏洦鈷掗柛鏇ㄥ亜椤忣參鏌″畝瀣瘈鐎规洘锕㈡俊鎼佸Ψ閵忕姳澹曢梺鍛婄缚閸庢煡顢曟禒瀣厪闁割偅绻冮崯鎺楁煛閸愩劎澧涢柡鍛叀閺屾稑鈽夐崡鐐茬濠电偛鐗婇悡鈥愁潖?setTeleportCooldown
            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缂佺姷濞€閺岀喖宕滆鐢盯鏌涚€ｃ劌鈧繈寮婚弴鐔虹闁绘劦鍓氶悵鏃堟⒑閹肩偛濡奸柛濠傛健瀵鈽夐姀鐘电杸濡炪倖甯婄拋鏌ュ几濞嗘挻鈷戠紓浣股戠亸顏堟煕鎼达絾鏆€殿喖顭烽幃銏ゅ川婵犲嫮肖濠德板€х徊浠嬪疮椤栫儐鏁佺€广儱鎷嬪〒濠氭煏閸繂鏆欓柛鏃€纰嶆穱濠囶敃閿濆洨鐤勯悗娈垮枦椤曆囶敇婵傜閱囨い鎰剁秵閳ь剙娲缁樻媴閸涘﹤鏆堥梺鍦焾椤兘骞嗛崟顖ｆ晬闁绘劙娼х粊锔界節閵忥絽鐓愰柛鏃€鐗犲畷鎴犫偓锝庡枟閻撴洘銇勯幇鈺佲偓鏇㈠几鎼搭潿浜滈幖娣灪瀹曞本鎱ㄦ繝鍕笡闁瑰嘲鎳樺畷顐﹀Ψ閵堝牊顎楀┑锛勫亼閸婃牠宕归悽绋跨疇閹兼惌鐓堥弫瀣煥濠靛棭妲搁梺瑁ゅ€栨穱濠囧Χ閸曨噮鍞归梺?SkeletonTurret 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌熼梻瀵割槮缁炬儳娼￠弻鐔衡偓鐢殿焾鍟哥紓浣插亾濠电姴娲﹂悡鍐喐濠婂牆绀堟慨妯挎硾妗呴梺鍛婃处閸ㄤ即宕￠幎鑺ョ厱闁斥晛鍠氬▓鏃€銇勮箛锝勯偗闁?getTeleportCooldown() 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缂佺姷濞€閺岀喖宕滆鐢盯鏌涚€ｃ劌鈧繈寮婚弴鐔虹闁绘劦鍓氶悵鏇㈡⒑缁嬫鍎忔い鎴濐樀瀵鏁愭径濠勭杸濡炪倖甯婇悞锕傚磿閹剧粯鈷戠紓浣姑粭鎺楁煟韫囨柨鍝哄┑锛勬暬瀹曠喖顢涘槌栧敽闂備胶纭堕崜婵嬪Φ閻愬鐝堕柡鍥ュ灪閳锋帒霉閿濆洤鍔嬮柛銈傚亾闂備礁鎽滈崰搴☆焽閿熺姴钃熷┑鐘叉处閺呮彃顭跨捄鐚村姛闁伙綁绠栧娲川婵犲倸袝闂佸摜濮甸悧鐘绘晲閻愬搫宸濋悗娑欘焽閸樻捇姊洪幖鐐插缂佸甯掗埢宥夊川椤掕偐鎳撻…銊╁川椤撴繂顥氱紓鍌欒兌缁垶鎯勯鐐靛祦閻庯綆鍠楅崐鐑芥煕椤垵浜滄繛鍛囧嫮绡€闁汇垽娼ф禒婊堟煟濡も偓閿曘倗鍙呭┑顔姐仜閸嬫挸鈹戦敍鍕毈鐎规洜鍠栭、娑橆潩椤撗勵棨闂備浇宕垫慨鍨娴犲绀夐幖娣妼缁€澶嬨亜閺嶎偄浠﹂柛濠傜仛缁绘盯宕煎┑鍫滆檸闂佸搫顑嗗Λ鍐蓟濞戙垹绫嶉柍褜鍓熷畷褰掑垂椤曞懎娈ㄦ繝鐢靛У閼规儳顔忓┑鍥ヤ簻闁规儳顕埊鏇熴亜椤愩垻孝闁宠鍨块幃鈺冩嫚瑜嶆导鎰版⒑閻熸澘妲绘い鎴濇噹瀹?public
            // *婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓闁搞劌鍊块弻娑㈩敃閿濆棛顦ョ紓浣哄У瑜板啴婀侀梺鎸庣箓閹冲酣藟韫囨梻绠鹃悗娑欘焽婢х敻鏌＄仦鐐缂佺粯绋栭ˇ鍙変繆椤愶綆娈旈柣顭戝墴濮婂宕掑▎鎴濆闁诲海鐟抽崨顖滅厯闂佺懓顕慨顓㈠磻閹炬剚娼╅柣鎾冲閻濇繈姊虹拠鈥崇仩闁兼椿鍨堕崺銏℃償閵娿儳顔掗柣搴ｆ暩椤牓鐛崼銉︹拻濞达絽鎽滅粔娲煕鐎ｎ亷韬€规洘绮岄埢搴☆嚗椤愶絿鈽夋い顐ｇ矒閸┾偓妞ゆ帒瀚拑鐔兼煥閻斿搫孝闁绘劕锕弻鏇熷緞閸繂濮㈡繛瀵稿█缁犳牕顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏伴柣鈺婂灦瀹曟椽鍩€椤掍降浜滈柟鍝勬娴滈箖姊洪崨濞氭垹鍒掗幘宕囨殾闁硅揪绠戠粻鑽ょ磽娴ｈ鐒介柛姗€浜跺铏规喆閸曨剛鍑￠梺鍛婂焹閸嬫挾绱撴担闈涘濠殿喓鍊濇俊鐢稿礋椤栨氨鐫勯梺閫炲苯澧寸€规洘绻傞埢搴ょ疀閿濆棛绋佺紓鍌氬€烽悞锕佹懌婵犳鍨遍幐鎶藉蓟閿濆鍋勭紒瀣儥濡棛绱撴担鐤厡闁稿繑锚椤繐煤椤忓嫮顦ч梺绋跨箳椤戞洘绂掕濮婃椽骞栭悙鎻掝潊濠电偛顦伴惄顖炲箖妤ｅ啯鍊婚柦妯侯樈濞煎﹪姊虹紒姗堜緵闁稿鎳橀敐鐐差吋婢跺鎷洪梻鍌氱墛缁嬫挾绮诲鑸电厓鐟滄粓宕滃▎鎾冲偍闁哄稁鍋嗙壕浠嬫煙閸撗呭笡闁抽攱甯掗妴鎺戭潩閿濆懍澹曟繝鐢靛仒閸栫娀宕堕敐鍌氫壕闁挎洖鍊搁柋鍥煏婢跺牆鍔ら柨娑氬枛濮婄粯绗熼崶褍顫╃紓浣割槸椤曨厾鍒掗崼銉ョ妞ゆ梻鏅崢鎾绘偡濠婂嫮鐭掔€规洘绮撻幃銏ゆ偂鎼淬倖鎲伴梻浣瑰缁诲倿鎮ц箛娑欏仾闁逞屽墴濮婅櫣鎲撮崟顐㈠Б婵犫拃鍐弰妞ゃ垺鐟╁畷鍫曨敆娴ｅ搫骞楅梺鐟板悑閻ｎ亪宕硅ぐ鎺戝惞妞ゆ帒瀚悡鏇熺箾閸℃绠伴柡鍡樼懇閺岋綁鏁愰崶銊у姽闂侀潧娲﹂崝娆撶嵁閹烘绠犻柡鍌樺劜濞呭﹪鏌＄仦鐣屝х€规洦鍋婂畷鐔碱敃閻旇渹澹曠紓浣割儏缁ㄩ亶寮搁弮鍌楀亾閸忓浜鹃梺鍛婃处閸忔﹢骞忓ú顏呪拺闁告稑锕﹂埥澶愭煥閺囶亞鎮兼繛鍡愬灲閺屽棗顓奸崱娆忓箞婵犵妲呴崹鎶藉磿閵堝绠氶柛顐犲劜椤ュ棗顭块懜闈涘闁绘挾鍠栭弻鐔告綇閸撗冨煂閻炴碍宀稿铏圭矙濞嗘儳鍔€缂備浇寮撶划娆忥耿娓氣偓濮婃椽骞愭惔锝囩暤闂佺懓鍟跨换姗€鐛崱娑橀唶婵犮垺绻勯幊鎾烩€﹂妸鈺侀唶闁靛繈鍨哄В鍥⒒娴ｅ憡鎯堥柡鍫墴閹嫰顢涘☉妤冪畾闂佸綊妫块悞锕傚疾濠婂牊鐓曢柟鐐殔閹冲海鏁妸鈺傗拻闁稿本鐟ㄩ崗灞俱亜閵忕媴宸ラ柍璇茬Ч瀵挳锝為钘変壕闁告劏鏅濈弧鈧梺鎼炲劗閺呮稓绮婇敃鍌涚厽閹兼惌鍨崇粔鐢告煕閻樺磭澧辩紒顔碱煼楠炲酣鎳為妷褍骞嶉梻浣筋嚃閸ㄥ酣宕橀埡鍌滄И婵犵數鍋涢顓㈠储瑜旈弻濠囨晲閸滀焦缍?SkeletonTurret*
            // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑鏅悷婊冮叄閵嗗啴濡疯閻瑩鏌涢弻顓滃€愰崑鎾诲锤濡や讲鎷哄銈嗗坊閸嬫挾绱掓径濠庡殶濠㈣娲樼换婵嗩潩椤撶姴甯鹃梻浣稿閸嬪懐鎹㈤崘鈺佸灁濠靛倸鎲￠悡鐔煎箹濞ｎ剙鈧洟鎮￠幇鐗堢厪闁搞儜鍐句純閻庢鍠曠划娆愪繆濮濆矈妲归梺閫炲苯澧悽顖ょ節瀵顓奸崶鈺冿紲濠碘槅鍨靛畷鐢稿矗閸℃稒鈷戦悗鍦濞兼劙鏌涢妸銉﹀仴妤犵偛鍟撮崺锟犲川椤撶媭鍞介梻浣告贡閸庛倝骞愭繝姘兼晩闁告洦鍨遍埛鎺懨归敐鍥╂憘闁搞倖鐟х槐鎺旂磼濡搫顫掗柦妯荤箞閺岋綁濮€閵忊晝鍔搁梺钘夊暟閸犳劗鎹㈠☉銏犵闁绘劕鍟畝绋款嚕閸涘﹥鍎熸い顐幘缁犳艾顪冮妶鍡欏缂佽鍟撮、鏃堟偐鐟佷礁缍婇幃鈺佲枎韫囨搩浼€缂備胶濞€缁犳牠骞冨Δ鈧埥澶娾枎濡厧濮洪梻浣规た閸樺ジ顢栨径鎰畺濞寸姴顑愰弫宥夋煏閸繃宸濋柣锕€鐗嗚灃闁绘﹢娼ф禒婊勪繆椤愶絿绠撻柣锝囧厴閹垻鍠婃潏銊︽珝婵犵數鍋為崹鍓佹箒婵犮垼顫夊ú鏍煘閹达附鍊烽柡澶嬪灩娴犵顪冮妶鍛濞存粠浜妴渚€寮崼婵嗙獩濡炪倖鎸炬慨鐑芥偘椤曗偓閺岋絾鎯旈敍鍕殯闂佺閰ｆ禍鍫曠嵁閸℃稑绠婚悗娑櫭崝鍛存⒑闂堟侗鐒鹃柛搴㈠▕瀹曟劙鎮欓悜妯煎幗闂佺粯顭囬崕銈夘敂閻樼粯鐓曢幖瀛樼☉閳ь剚绻堥獮鍐ㄎ熸笟顖氭倯婵犮垼娉涢鍌炲箯?SkeletonTurret 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴姘辩Т闂佹悶鍎洪崜锕傚极閸ヮ剚鐓忛煫鍥ㄦ礀鍟搁梺鎸庣〒閸犳牕顫忓ú顏勪紶闁告洦鍣鍫曟⒑缁嬪潡鍙勫ù婊冪埣瀵濡搁埡浣勓囨煕濞戝彉绨奸柡鍌楀亾闂傚倷鑳剁划顖炴晪閻庢鍠栭悥濂哥嵁閺嶎厼绠涙い鏂垮⒔閿涙粓姊洪柅鐐茶嫰婢ь垳鈧灚婢樼€氫即鐛崶顒夋晣闁绘ɑ褰冪粻鍝勨攽閻樻鏆俊鎻掓嚇瀹曞綊骞庢慨鎰ㄥ亾娴ｅ湱绡€闁搞儴鍩栭弲銏ゆ⒑缂佹ɑ鐓ラ柛姘儔閹繝寮撮姀锛勫幗闂佸搫鍟悧婊兾涢幋鐘电＜闁绘鏁哥敮娑㈡煙娓氬灝濡界紒缁樼箞瀹曟帡濡堕崶褎鍊梺璇叉唉椤煤濡吋鏆滈柍鈺佸暕缁诲棝鏌涢锝嗙鐎瑰憡绻冮妵鍕棘閸喚绋忛梻渚囧弾閸ㄤ即鍩為幋锔藉亹闁割煈鍋呭В鍕⒑缁嬫鍎愰柣鈺婂灦閻涱喗绻濋崨顖滄澑闂佸搫娲ㄩ崰鎰枔娴煎瓨鈷戦悹鎭掑妼閺嬫柨鈹戦鑺ュ唉鐎?

            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犵厬闁兼亽鍎抽埥澶愭懚閺嶎厽鐓曟繛鎴濆船楠炴﹢鏌ㄥ☉娆戞噰婵﹥妞介幊锟犲Χ閸涱喚浜梻浣侯焾椤戝懘鏁冮妶澶娢ラ柟鐑樻尵缁♀偓濠殿喗锕╅崢楣冨储闁秵鍊甸柛蹇擃槸娴滈箖姊洪柅鐐茶嫰婢у鈧娲橀崹鐢稿煡婢跺娼╂い鎺戭槹椤モ€斥攽閻樺灚鏆╁┑顔炬暩閸犲﹤顓兼径瀣簵闂佸搫娲㈤崹娲偂韫囨搩鐔嗛柤绋跨繁椤忓牆鍑犳繛鍡樻尰閻撴瑩鏌＄仦璇插姢闁伙絾妞介弻? 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缂佺姷濞€閺岀喖宕滆鐢盯鏌涚€ｃ劌鈧繈寮婚弴鐔虹闁绘劦鍓氶悵鏃堟⒑閹肩偛濡奸柛濠傤煼閸┾偓妞ゆ帒鍠氬鎰箾閸欏澧悡銈夋煥閺囩偛浜扮紓宥嗙墵閺岋繝宕堕妷銉т痪闂佺粯鎸荤粙鎴︹€︾捄銊﹀磯濞撴凹鍨抽崣姘辩磽娴ｇ懓鏁剧紒鐘虫崌閻涱噣寮介妸锔剧Ф闂佸憡鎸嗛崥閿嬪灴閺岋絾鎯旈姀銏╂殹閻庡厜鍋撻柟闂寸閽冪喖鏌ｉ弮鍥仩缁炬儳鍚嬫穱濠囶敍濠靛洢鈧啴鏌涢幒鎴伐闁宠鍨块幃娆戞崉娓氼垱顥嶅┑锛勫仦濞兼瑩骞楀鍫濈闁靛繒濮Σ鍫ユ煏韫囨洖啸妞ゆ挻妞藉铏圭磼濡搫顫嶅┑鐐插悑閻熲晠骞嗛崘顔肩闁挎棁袙閹疯櫣绱撴担鍓插剱妞ゆ垶鐟╁畷鏇㈠箛閻楀牏鍘甸梺鑽ゅ枔婢ф宕板Ο灏栧亾?public int getTeleportCooldown() 闂?SkeletonTurret
            if (this.turret.getTeleportCooldown() > 0) return false;

            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗霉閿濆浜ら柤鏉挎健濮婃椽顢楅埀顒傜矓閻㈢纾婚柨鐔哄У閻撴瑩鏌熼婊冾暭妞ゃ儱顦伴〃銉╂倷椤忓嫮浼堥梺鍝勮嫰缁夌懓鐣烽锕€绀嬫い鎰枎娴滃墽鎲搁悧鍫濈瑨缂佺嫏鍛＜閻庯綆浜炲銊╂煛閳ь剚绂掔€ｎ偆鍘介梺褰掑亰閸欏酣宕箛鏂剧箚妞ゆ劑鍨介崣鍕煛鐏炲墽銆掗柍褜鍓ㄧ紞鍡涘磻閸曨剚鍙忛柛顐犲劜閻撴洟鏌熼悜妯虹厐闂婎剦鍓氶〃銉╂倷鏉堟崘鈧寧銇勯姀锛勬噰闁硅櫕鐗犻崺鈩冪節閸屾稒姣?
            double targetX = this.owner.getX() + (this.turret.getRandom().nextDouble() - 0.5) * 2.0;
            double targetY = this.owner.getY();
            double targetZ = this.owner.getZ() + (this.turret.getRandom().nextDouble() - 0.5) * 2.0;

            // 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛銈呭閺屻倗绮欑捄銊ょ驳闂佸憡鐟ョ换鎴﹀Φ閸曨垰绠婚柛妤冨仧娴犺偐绱掗悙顒€鍔ゆい顓犲厴瀵鎮㈤悡搴ｎ槶閻熸粌绻掗弫顔尖槈閵忥紕鍘介梺瑙勫劤閻°劎绮堥崘銊囧酣宕惰闊剙鈹戦垾宕囧煟鐎规洜鍠栭、姗€鎮欏顔锯偓瀵哥磽閸屾艾鈧鎷嬮弻銉ョ；闁瑰墽绮悡鏇熴亜閹扳晛鈧洟寮搁弮鍌滅＜闁绘宕甸悾娲煛鐏炲墽娲存い銏℃礋婵″爼宕ㄩ閿亾婵犳碍鈷戦悹鍥ㄧ叀閻涙粎绱掗悩铏磳妤犵偛鍟灃闁告侗鍣Λ鍐ㄢ攽閻愭潙鐏﹂柣妤佹礃缁傛帡顢氶埀顒€顫忛搹瑙勫珰闁炽儴娅曢悘鈧梻浣告惈閹虫劖绻涢埀顒侇殽閻愭彃鏆欐い顓滃姂瀹曠厧鈹戦崼婵嗙婵犵數鍋犻幓顏嗗緤娴犲搴婇柡灞诲剸婢跺娼╂い鎴ｅГ閺傗偓闂備胶绮崝鏇㈡偤閵娧傜剨濞寸厧鐡ㄩ悡鏇㈡煃鏉炴壆顦﹂柡鍡悼閳ь剝顫夊ú姗€宕归崸妤冨祦婵☆垵鍋愮壕鍏间繆椤栨粌甯堕悽顖涱殜閺岋綁鎮㈤崫銉х厑缂備緡鍠楅幐鎼佹偩瀹勯偊鐓ラ柛鎰亾閸嶉潧顪冮妶鍡楃亶闁哄拋浜炵槐鐐寸瑹閳ь剟鎮伴鈧獮鎺懳旈埀顒傜尵瀹ュ鐓冪憸婊堝礈閻旂鈧?(闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箻閺岀喓绱掗姀鐘崇彯闂佽桨绀佺€氫即寮诲☉妯锋婵炲棙鍔楃粙鍥⒑濮瑰洤鈧倝宕伴弽顓熺畳闂備胶顭堢换鎰板触鐎ｎ剛绀婇柟杈鹃檮閻撴盯鎮楅敐鍌涙珖缂佹劖妫冮弻锛勪沪閻愵剛顦伴悗瑙勬礈閸樠囧煘閹达箑绠涙い鎾愁檧缁犳挸顫忛搹鍦煓闁兼剚鍨煎鍫曟⒑閸涘﹥鈷愰柛銊ョ仢椤曪絾绻濆顓熸珳婵犮垼娉涢敃銉┧夊┑瀣拺闁革富鍙庨悞楣冩倵濞戞帗娅婄€规洘娲熼獮姗€骞囨担鐟扮槣?randomTeleport 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈠姊绘担鐟邦嚋婵﹤顭峰畷鎴﹀箻閸撲椒绗夐梺鍦劋濮婅崵澹?
            if (this.turret.randomTeleport(targetX, targetY, targetZ, true)) {
                this.turret.notifyTeleport(); // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗霉閿濆浜ら柤鏉挎健濮婃椽顢楅埀顒傜矓閻㈢绠氶柣鎰惈缁犺绻涢敐搴″濠碘€炽偢閺屾稓浠︾拠鎻掝瀳闂傚洤顦甸弻锝呂熼悜妯锋灆闂佺楠哥换鎴炵┍婵犲浂鏁冮柨娑崇秵娴滎亝淇婇幘顔肩闁规惌鍘介崓鐢告⒑閹稿海绠撻柟鍐茬У缁旂喖寮撮姀鈾€鎷绘繛杈剧悼閻℃棃宕甸崘顔界厱闁绘洑绀佹禍鎵偓瑙勬磸閸旀垿銆佸▎鎾崇闁兼祴鏂侀崑鎾活敇閵忊檧鎷绘繛杈剧到閹诧繝宕悙瀵哥閻犲泧鍛殼閻庤娲樼划宀勶綖濠靛鍤嬮梻鍫熺◥閹寸兘姊绘担鑺ョ《闁哥姵鎸婚幈銊╂偨缁嬭法鍘遍梺纭呮彧闂勫嫰鎮￠弴鐔虹闁瑰鍎戦崗顒勬煕閺冨倸鏋涢柡宀嬬秮椤㈡﹢鎮滈崶顏勬儓闂備礁鎼悮顐﹀磹閺囩姴寮查梺鑽ゅТ濞测晝浜稿▎鎰浄闁归棿鐒﹂埛鎴﹀级閻愭潙顥嬫い锔煎缁辨帗寰勬繝鍕ㄩ梺缁樹緱閸ｏ絽鐣烽崼鏇ㄦ晢濞达綁鏅茬純鏇㈡⒒娴ｇ顥忛柛瀣瀹曚即骞囬柇锔芥櫆?

                // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箳閳ь剝顫夊ú鏍洪敃鍌ゆ晝濞寸姴顑嗛悡蹇涙煕椤愶絿绠栧璺哄閵囧嫰顢曢敐鍡欘槹闂佸搫鐭夌换婵嗙暦閸洖唯闁靛／鍌滄／闂傚倷鑳堕…鍫ヮ敄閸岀偛鐤炬繛鎴欏灩閻撴﹢鏌熸潏楣冩闁稿鍔欓幃妤呭捶椤撶倫銏°亜閵夛妇绠撻柍瑙勫灴閸┿儵宕卞鍓у嚬闂備焦瀵уú蹇涘垂閽樺鍤曞┑鐘宠壘閻掓椽鏌涢幇鈺佸缂佹劗鍋炵换婵嬫偨闂堟刀銏ゆ倵濮橀棿閭柟鑹邦潐閹棃濡搁敂瑙勫闂備礁鎲＄换鍌溾偓姘卞厴瀹曟洝绠涘☉娆屾嫼闁汇埄鍨奸崰姘辩矓椤旈敮鍋? 60 - Tier * 10 (Min 10)
                int tier = this.turret.getTier();
                int cooldown = Math.max(10, 60 - tier * 10);
                this.turret.setTeleportCooldown(cooldown);

                this.stuckTimer = 0; // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛濠傛健閺屻劑寮村鑸殿€栨繛瀛樼矊缂嶅﹪寮诲☉銏犵疀闁稿繐鎽滈弫鏍⒑濞茶骞楅柟鐟版喘瀵鈽夐姀鈺傛櫇闂佹寧绻傚Λ娑⑺囬妸鈺傗拺缂佸顑欓崕娑樏瑰搴濋偗鐎殿喛顕ч埥澶愬閻橀潧濮堕梻浣告啞閸旓附绂嶉弽顬綁宕奸姀銏紲缂傚倷闄嶉崹褰掔嵁閹扮増鐓曢悗锝庡亝瀹曞本鎱ㄦ繝鍕笡闁瑰嘲鎳愰幉鎾礋椤撴繄绀冮梻鍌欑閹碱偊骞婅箛娑欏剮妞ゆ牗姘ㄩ弳锕傛煛婢跺鍎ユ繛灏栨櫊閹銈﹂幐搴哗濡?
                this.turret.getNavigation().stop();
                return true;
            }
            return false;
        }

        private void checkStuckAndJump() {
            // 闂?4 tick 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴濐潟閳ь剙鍊块幐濠冪珶閳哄绉€规洏鍔戝鍫曞箣閻欏懐骞㈤梻鍌欑窔閳ь剛鍋涢懟顖涙櫠閹绢喗鐓涢悘鐐插⒔閵嗘帡鏌嶈閸撱劎绱為崱娑樼；闁告侗鍘鹃弳锔锯偓鍏夊亾闁告洦鍓涢崢鎼佹倵閸忓浜鹃柣搴秵閸撴盯鏁嶉悢鍝ョ閻庣數顭堥鎾斥攽閳ヨ櫕鍠樻鐐茬箻閹晝鎷犻懠顒夊斀闂備礁婀遍崕銈夊春閸繍鐒芥慨妯夸含绾句粙鏌涚仦鎹愬闁逞屽墰閸忔﹢骞冮悙鐑樻櫇闁逞屽墴閿濈偠绠涘銉ゆ睏闂佸湱鍎ら崹褰掝敊閸ヮ剚鈷戦悷娆忓閸旇埖淇婇銏狀伃鐎?
            if (this.turret.tickCount % 4 != 0) return;

            net.minecraft.world.phys.Vec3 currentPos = this.turret.position();
            if (this.lastStuckCheckPos != null && currentPos.distanceToSqr(this.lastStuckCheckPos) < 0.01) { // 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋敐鍛闂佽姤蓱缁诲牓寮婚悢鐓庣濞达絿鍎ら幉姗€姊烘潪鎵槮妞ゆ垵娲獮澶愬川婵犲啫鍔呴梺闈涱焾閸庢娊鎮块崟顖涒拺闂傚牊鍗曢崼銉ョ柧婵炴垯鍨洪崑鍌涚箾閹存瑥鐏柣鎾存礃缁绘盯骞嬪┑鍡氬煘濠电偛鎳忚摫濞ｅ洤锕、鏇㈠閻樿櫕顔掓繝娈垮枛閿曘劌鈻嶉敐鍥潟闁圭儤鍤﹂悢鐓庝紶闁告洖鐏氱紞鎴︽⒒娴ｇ瓔鍤欑紒缁樺姉閹广垽骞嬮敂钘変画闂佸疇妗ㄩ懗鍫曞汲閿曞倹鐓曟繝闈涙閻濆鏌￠崘銊у缂佲偓閸愵喗鐓ユ繝闈涙閸ｇ顭跨憴鍕婵﹤鎼晥闁搞儜鍛磿婵＄偑鍊ら崢濂告偋婵犲嫮鐭夌€广儱妫楅閬嶆倵濞戞瑯鐒介柛姗€浜跺铏圭磼濡浚浜炴竟鏇㈩敇閻斿憡鐝烽梺姹囧灩閹诧繝鎮?
                if (this.turret.getNavigation().isInProgress()) {
                    this.stuckTimer += 4;
                }
            } else {
                this.stuckTimer = 0;
                this.lastStuckCheckPos = currentPos;
            }

            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰缁鎮╅崗鍛畾濡炪倖鐗楃换鍌涚閸︻厾妫柟瑙勫姇琚氶梺閫涚┒閸斿矁鐏掗梺鍦焾濞寸兘濡撮幇顔剧＝濞达絾褰冩禍楣冩⒑缁嬫寧婀扮紒瀣姉閹广垽宕卞Ο闀愮盎闂佸搫绉查崝蹇旂珶濮椻偓閺岀喖顢欓挊澶屼患闂侀€炲苯澧叉い顐㈩槸鐓ら柡宥庡帞閸ヮ剚鍋ㄧ紒瀣硶閻ｅ搫鈹戞幊閸婃洟骞婃惔銊ョ闁煎摜鍋ｆ禍婊堟煙閹规劖纭鹃柍褜鍓﹂崑濠冧繆閻戣棄鐓涢柛灞剧矊鐢姊绘担钘夊惞闁哥姵鍔栫粩鐔煎幢濡粯鐝烽梺鎸庢礀閸婂綊鎮″☉銏″€堕柣鎰邦杺閸ゆ瑥鈹戦垾鐐藉仮闁哄苯绉归幐濠冨緞濡亶锕傛⒑鐎圭媭鍤欓梺甯秮閻涱喚鈧綆鍣弫鍥煟閺傚灝顥忛柛鐔锋喘濮婂宕掑顑藉亾妞嬪海鐭嗗ù锝夋交閼板潡姊洪鈧粔顕€鍩€椤掑﹦鐣电€规洖銈告俊椋庘偓锝庝簼閸犳﹢鏌熼鑽ょ煓鐎规洏鍔嶇换婵嬪磼濞嗘垿鎸兼繝纰夌磿閸嬫垿宕愰弽顬稒绗熼埀顒€鐣烽幋锕€绠涢柡澶嬪鏉堝牓姊洪幐搴㈢闁稿﹤缍婇幃锟犲即閵忥紕鍘繝銏ｆ硾閻楀棙淇婃總鍛婄厽闁圭偓娼欐慨鍥懚閺嶎厽鐓熸俊顖濐嚙缁茬粯銇勮箛锝呭箺闁逛究鍔嶇换婵嬪礃閳瑰じ铏庨梻浣筋嚃閸犳岸宕楀Ο渚殨闁肩鐏氶崕鐔兼煙閻愵剚缍戦柣锕備憾濮婂宕掑▎鎺戝帯濡炪値鍘奸悧鎾汇€侀弽顓炲耿婵炴垶宸婚崑鎾绘晝閸屾氨鍊為梺瀹犳〃缁€渚€鎮樻繝鍌ゆ富闁靛牆妫欑亸顏堟煕閵娿儳绉虹€规洘锕㈤崺鈧い鎺嗗亾妞ゎ亜鍟存俊鍫曞幢濡儤娈梻浣侯焾椤戝洭宕戝☉銏″仼闂傚牊渚楅崥瀣熆鐠轰警鍎岄柟閿嬫そ濮婂宕掑鍗烆杸婵炴挻纰嶉〃濠囧箖閻愭番鍋呴柛鎰ㄦ櫇閸橀亶鏌熼崗鑲╂殬闁搞劌顭峰畷锝夊焵椤掑嫭鍊甸悷娆忓缁€鍫ユ煕閻樺啿濮嶅┑鈥崇埣閺佹劖寰勬繝鍕垫О闂備礁鍟块幖顐﹀疮椤愩埄鍤?-> 闂?
            if (this.turret.horizontalCollision && this.turret.onGround()) {
                 this.turret.getJumpControl().jump();
                 // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯锋嫼閻熸粎澧楃敮鎺撶娴煎瓨鐓曢柟鎯ь嚟濞叉挳鏌曢崱鏇犵獢鐎规洏鍔庨埀顒佺⊕鑿ら柟閿嬫そ濮婅櫣绱掑Ο鍝勵潙濠碘槅鍋勭€氭澘鐣峰┑瀣ㄩ柍鍝勫€搁埀顒€鐖奸悡顐﹀炊閵婏腹鎷婚梺鐟板暱閹虫劗妲愰幒妤婃晩闁兼亽鍎哄Λ鍐倵鐟欏嫭绀€闁靛牏顭堥锝夊箻椤旇棄浜滈梺鍛婄箓鐎氼剛绮绘导瀛樷拻闁稿本鐟чˇ锕傛煙鐠囇呯瘈鐎规洘绻堥獮瀣晝閳ь剛绮堟径鎰婵烇綆鍓欐俊濂告煛閸曗晛鍔﹂柡灞诲妼閳规垿宕卞鍡橆棤缂傚倷娴囬褍螞濞嗘挸桅闁告洦鍨扮粻娑㈡煕閹捐尙顦﹂柛鈺佽嫰椤啴濡堕崱妯碱槰缂備緡鍠栫粔鍫曞箲閵忕姭妲堥柕蹇娾偓鍏呯暗闂佺澹堥幓顏嗗緤閸ф鏁婇柟鐑橆殕閸婄敻鎮峰▎蹇擃仾缂佲偓閸愵喗鐓ラ柡鍥悘鏌ユ煏閸℃洜顦﹂柍璇查叄楠炴﹢寮堕幋鐐垫瀫闂傚倷绶氬褔鏁嶈箛娑樼闁瑰鍎戦懓鎸庢叏婵犲偆鐓肩€规洘甯掗埢搴ㄥ箣濠靛棭鐎撮梻浣筋嚙濞寸兘鎮烽幎钘夊窛妞ゆ牗绮庨崢顖炴⒒娴ｄ警鏀伴柟娲讳邯濮婁粙宕熼姘優闂佸綊鍋婇崢瑙勭濠婂牊鐓涚€广儱楠告禍婊兠归悪鍛暤闁哄本绋掗幆鏃堟晬閸曟嚪鍥ㄧ厸閻忕偛澧藉ú瀛橆殽閻愮柕顏囩亙闂侀€炲苯澧伴柍褜鍓氶崙褰掑礈閻旂厧绠栭柛顭戝亜椤曢亶鎮楀☉娅辨岸骞忓ú顏呪拺闁告稑锕︾粻鎾绘倵濮樼厧骞栨い鏂跨箰閳规垹鈧綆鍋嗛崢閬嶆煟鎼搭垳绉甸柛瀣鐓ら柟缁㈠枟閻撱儲绻濋棃娑氬濞寸娀浜堕弻鈩冩媴閻熸澘顫掗悗瑙勬处娴滄繈骞忛崨鏉戜紶闁告洦鍓氬В鍕⒒閸屾艾鈧绮堟担鍦彾濠电姴娲ょ壕濠氭煕閺囥劌鈧姴鈽夊Ο婊勬閸┾偓妞ゆ帒鍟版禍杈ㄧ節閻㈤潧浠﹂柛顭戝灦瀹曞綊宕烽鐑嗘闂佺鍕垫畷闁绘挻鐩幃姗€鎮欐０婵嗘闂佸憡姊圭划鎾诲蓟濞戞埃鍋撻敐鍛暢缂佸鍣ｉ弻锛勪沪閸撗€妲堥梺瀹狀潐閸ㄥ灝鐣烽崡鐐嶆梹绻濇担鐟颁簼闂傚倸鍊风粈渚€骞栭鈶芥稑鈻庨幘鏉戜画闂侀潧顦弲娑㈡偂濮椻偓閺岀喐娼忛幆褏妲ｉ梺杞扮閿曨亪寮婚妶鍚ゅ湱鈧綆鍋呴悵鏍ь渻閵堝棙鈷愰悽顖椻偓鎰佹綎?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亜顒㈡い鎰矙閺屻劑鎮㈤崫鍕戙垻鐥幆褜鐓奸柡灞剧☉閳藉宕￠悙瀵镐壕闂備礁纾幊鎾剁矓瑜版帒钃熺憸鎴犵不濞戞﹩娼╅柛蹇氬亹缁夌兘鏌ｆ惔銈庢綈婵炲弶锕㈤幃锟犳晸閻樿尪鎽曞┑鐐村灟閸ㄥ湱绮诲☉銏＄厱闊洦鎸婚幉鎼佹煛娴ｅ湱澧辩紒杈ㄥ浮閹瑩顢楅埀顒勫礉閵堝鐓曟慨姗嗗墻閸庢垿鏌熼獮鍨仼闁宠棄顦垫慨鈧柣妯垮蔼閳ь剙鐏濋埞鎴炲箠闁稿﹥鎹囬幃鐐烘晝閳ь剟鎮鹃悜钘夌闁兼亽鍎幏铏圭磽娓氬洤鐏℃繛鍙壝埢宥夊川鐎涙鍘遍梺缁樻煥閹诧紕浜搁敂閿亾濞堝灝鏋︽い鏇嗗洤鐓″璺侯煬濞笺劑鏌涢埄鍏狀亪宕楁繝鍐х箚闁绘劦浜滈埀顒佺墵楠炴劖銈ｉ崘銊э紱闂佺粯鏌ㄩ幗婊堛€呴柨瀣ㄤ簻闁哄秲鍔庨惌宀€鐥幑鎰棄闂囧鏌ㄥ┑鍡欏⒈闁搞倕鍟换娑㈠醇閻斿壊妫冮梺鍝勬湰缁嬫帞鎹㈠┑瀣＜婵炴垶眉濞ｎ喗淇婇妶鍥ラ柛瀣☉铻炴繝闈涙閺嗭附鎱ㄥ璇蹭壕濡炪們鍨洪悷鈺呭箠閺嶎厼鐓涘┑鐘插敪瑜嶉埞鎴︽晬閸曨偂鏉梺绋匡攻閻楃娀骞冭铻栭柛娑卞亐閸嬫捇宕橀鐓庣獩濡炪倖姊婚搹搴∶洪崨濠佺箚闁靛牆绻掗崚浼存煕閻曚礁鐏﹂柟顕嗙節閹垽宕楅懖鈺佸箰闂備胶顭堥張顒€顫濋妸锔绢浄闁靛繆鈧尙绠氶梺鑲┾拡閸撴稓鏁☉銏＄厪?
                 if (this.stuckTimer > 20) {
                     this.turret.setDeltaMovement(this.turret.getDeltaMovement().add(0, 0.1, 0));
                 }
            }

            // 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌熼梻瀵割槮缁惧墽绮换娑㈠箣濞嗗繒浠鹃梺绋垮閺屻劑鍩為幋锕€纾兼繝濠傛捣閸斿摜绱撴担鐟板妞ゃ劌锕悰顕€寮介‖銉ラ叄椤㈡鍩€椤掍胶鐝堕柛灞惧嚬閻斿棝鏌ら幖浣规锭濠殿喖娲弻娑㈠箛閵娿儰澹曟繝纰夌磿閸嬫垿宕愰弽顓炵鐟滃繐顕ユ繝鍥ㄥ仼閻忕偟鐡斿Λ婊冾渻閵堝棛澧遍柛瀣仱閹繝鎮㈤悡搴ｎ啇缂備緡鍠氶幊鎾存櫠閺屻儲鍋ｉ柟鑸妷閸嬫捇寮妷锔芥澑婵＄偑鍊栧褰掑磿閹惰棄鍌ㄩ柟缁㈠枟閻撴洟鏌嶉崫鍕殭濞寸姾浜埀顒冾潐濞叉牠濡堕幖浣哥畺闁靛繈鍊曠粈鍫澝归敐鍫燁仩闁哄棙婢橀埞鎴︽晬閸曨偂鏉梺绋匡攻閻楃姴鐣峰┑鍠棃宕ㄩ鐘靛炊闂佺懓鍚嬮悾顏堝垂婵犳哎鈧懘骞撻幑銊︽閺佹劙宕ㄩ鐔割唹闂?(缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛銈呭閺屻倗绮欑捄銊ょ驳闂佸憡鐟ョ换鎴﹀Φ閸曨垰绠婚柛妤冨仧娴犺偐绱掗悙顒€鍔ゆい顓犲厴瀵鎮㈤悡搴ｎ槶閻熸粌绻掗弫顔尖槈閵忥紕鍘介梺瑙勫劤閻°劎绮堥崘銊囧酣宕惰闊剙鈹戦垾宕囧煟鐎规洜鍠栭、姗€鎮欏顔锯偓瀵哥磽閸屾艾鈧鎷嬮弻銉ョ；闁瑰墽绮悡鏇熴亜閹扳晛鈧洟寮搁弮鍌滅＜?
            // 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴濐潟閳ь剙鍊块幐濠冪珶閳哄绉€规洏鍔戝鍫曞箣閻欏懐骞㈤梻鍌欑窔閳ь剛鍋涢懟顖涙櫠閹绢喗鐓涢悘鐐插⒔閵嗘帡鏌嶈閸撱劎绱為崱娑樼；闁告侗鍨悞濠囨煙濞堝灝鏋ょ痪鎹愬亹缁辨挻鎷呯拠锛勫姺濠电偞褰冮顓㈠焵椤掍緡鍟忛柛鐘崇墵閹儲绺介崫銉ョウ闁诲函缍嗛崳顕€寮崶顒佺厽闁归偊鍘肩徊缁樸亜閵夈儳校缂佺粯绻堥幃浠嬫濞磋埖鐩弻鐔风暋閺夋寧娈婚悗瑙勬磸閸旀垿銆佸Ο琛℃婵炲棙鍨熼崑鎾村鐎涙鍘介柟鍏肩暘閸╁嫰宕箛娑欑厱闁挎繂楠稿▍宥団偓瑙勬礃缁矂鍩ユ径鎰潊闁绘鏁搁弸鈧梻鍌欑濠€閬嶆惞鎼淬劌绐楅柡宥庡亞閻棝鎮楅敐搴′簴濞存粍绮撻弻鐔煎箹椤撶偛绠规繛瀛樼矊婢х晫妲愰幒妤佸亹闁惧浚鍋勭壕鎶芥倵濞堝灝鏋︽い鏇嗗洤鐓″璺侯煬濞笺劑鏌涢埄鍏狀亪宕楁繝鍌楁斀閹烘娊宕愯瀵板﹥绂掔€ｎ亞鏌堝銈嗙墱閸庢劙寮担琛″亾楠炲灝鍔氶柟鍐差樀瀵劍绂掔€ｎ偆鍘撻梺瀹犳〃缁€渚€寮冲▎鎴犵＜闁圭粯甯╅悡濂告煛瀹€鈧崰鏍箠閻愬搫唯鐟滃繘鎮￠崒鐐粹拺闁告稑锕ょ粭姘舵偨椤栨稑娴柨婵堝仜閳规垹鈧綆鍋勫▓婵嬫⒒閸屾氨澧涚紒瀣墦瀹曟垿骞橀崜浣猴紲濠碘槅鍨板﹢杈╃不濮橆剦娓婚柕鍫濇婢ь剟鏌よぐ鎺旂暫妤犵偛鍟撮獮瀣晜閻ｅ苯骞楅梻浣瑰濞插秹宕戦幘娣簻妞ゆ挾鍋涘Σ缁樸亜椤愩垻绠伴悡銈嗐亜韫囨挸顏い鏂挎喘閺岀喖鎳濋悧鍫濇锭缂備焦褰冮幖顐㈠祫闂佸壊鍋嗛崰鎾跺姬閳ь剟姊婚崒姘卞缂佸鍨块崺鈧い鎺戝€归崵鈧銈庡亜缁绘﹢骞婇敓鐘参ч柛娑卞幘娴滅増淇婇悙顏勨偓鏍箰閸洖鍨傜憸鐗堝笒缁€鍐煃瑜滈崜鐔奉潖濞差亝顥堟繛鎴ｄ含閸欐氨绱撻崒姘偓褰掓嚌妤ｅ喛缍栨繝闈涱儐閺呮繈鏌嶈閸撶喖宕洪悙鍝勭闁挎棁妫勬禍褰掓煟閻樺弶鍘傞柛鎰屽懐鐓戦梻鍌氬€风粈渚€骞楀鍕弿闁汇垹鎲￠崵宀勬煙椤栧棗鍟伴妶顐︽⒒閸屾艾鈧娆㈤敓鐘茬婵炲棙鍨归惌鎾绘煟閵忕姵鍟為柛瀣€圭换娑㈠箣濞嗗繒浠鹃梺缁樻尰濞叉﹢濡甸崟顖氱疀闁告挷鐒﹂崑褏绱撴担鍝勑為柛搴″级缁岃鲸绻濋崶褏顔岄梺鍦劋濮婄粯顨欓梻鍌欑閹碱偅寰勯崶顒€鐒垫い鎺嗗亾缁剧虎鍙冨鎶藉幢濞戞瑧鍘撻悷婊勭矒瀹曟粓鎮㈡搴㈡婵炴潙鍚嬪娆撳礃閳ь剙顪冮妶鍡樺暗闁稿鍋ら幃?
            // 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫鍐煥閺囨浜鹃梺姹囧€楅崑鎾舵崲濠靛洨绡€闁稿本绮岄·鈧梻浣侯焾椤戞垹鎹㈠┑瀣摕鐎广儱顦导鐘绘煕閺囥劌澧繛鍜冪悼缁辨帡鎮欓鈧崝銈嗙箾绾绡€鐎殿喖顭烽幃銏ゆ惞閸︻叏绱查梻渚€娼х换鎺撴叏閻㈠憡鍊堕柛顐犲灮绾捐棄霉閿濆棗绲诲ù婊堢畺濮婅櫣鍖栭弴鐐测拤缂備礁顑嗙敮锟犲箖閿熺姴鍗抽柕蹇ョ磿閸樻捇姊虹€圭姵銆冪紒鈧笟鈧鎼佸Χ婢跺鍘介梺鍦劋濞叉牞顣垮┑鐑囩到濞层倝鏁冮鍫濈疇闁绘ɑ妞块弫鍡涙煃瑜滈崜鐔风暦閵忊懇鍋撻悽鐢点€婇柛瀣尭閳绘捇宕归鐣屼邯闂備胶绮悧婊堝储瑜旈幃楣冩倻閼恒儱浜楅柟鐓庣摠钃遍柡鍌楀亾闂傚倷鑳剁涵鍫曞礈濠靛﹥鎳屾俊鐐€栭弻銊р偓姘煎幗缁岃鲸绻濋崶銊モ偓閿嬨亜韫囨挸顏ら柛瀣崄椤﹁鎱ㄦ繝浣虹煓鐎规洜鍠栭、娑樷槈濡湱鏆楅梻鍌欒兌閸嬨劑宕曢弻銉ョ婵娉涢崥褰掓煛閸ャ儱鐏柣鎾存礃閵囧嫰骞囬崜浣荷戠紓浣插亾闁逞屽墰缁辨帡鎮欓鈧崝銈夋煏閸喐鍊愮€殿喖顭锋俊鎼佸煛娴ｈ妫熼梻浣稿閻撳牓宕伴幒妤€绠伴柛鎰电厛濞撳鏌曢崼婵堢妞も晩鍓熼弻锟犲焵椤掑倸瀵查柣銊㈠亾illa AI 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亜顒㈡い鎰矙閺屻劑鎮㈤崫鍕戙垻鐥幆褜鐓奸柡灞剧☉閳藉螣閸忓吋鍠栭梻浣规偠閸婃洟鎳熼婵堜簷闂備焦瀵х换鍌炲箠鎼淬劌姹查柣鎰劋閻撴洟鎮楅敐搴濇喚婵☆垪鍋撻梻浣告惈閺堫剟鎯勯鐐偓渚€寮撮姀鈩冩珳闂佺硶鍓濋悷顖毼ｆ导瀛樷拻?PathNavigation 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繐霉閸忓吋缍戦柛銊ュ€块弻锝夊箻瀹曞洤鍝洪梺鍝勵儐閻楁鎹㈠☉銏犵闁绘劘灏欓崝浼存⒑缁嬫鍎愰柟鍛婃倐閿濈偛鈹戠€ｎ偄浜楅柟鍏肩暘閸ㄦ槒銇愭惔顫箚闁靛牆娲ゅ暩闂佺顑嗛惄顖氱暦椤栫儐鏁嶆繝濠傚鎼村﹤鈹戦悩缁樻锭妞ゆ垵鎳愮划鍫⑩偓锝庡亖娴滄粓鏌熼崫鍕棞濞存粌澧界槐鎺楀礈瑜戝鎼佹煕閵娿儳鍩ｇ€殿喖顭烽弫鎰板幢濡搫濡抽梻浣规灱閺呮盯宕畷鍥ㄥ厹闁逞屽墮閳规垿鎮╅幇浣告櫛闂佸摜濮靛畝绋跨暦濡も偓椤粓鍩€椤掆偓閻?
            // 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫鍐煥閺囨浜鹃梺姹囧€楅崑鎾舵崲濠靛洨绡€闁稿本绮岄·鈧梻浣侯焾椤戞垹鎹㈠┑瀣摕鐎广儱顦导鐘绘煕閺囥劌澧繛鍜冪秮濮婂宕掑顑跨敖闂佹悶鍔岄悥鐓庮嚕婵犳碍鏅插璺猴功椤撴椽姊洪幐搴ｇ畵婵☆偒鍘艰灋闁告洦鍘剧壕钘壝归敐鍛儓妞ゅ孩鎸剧槐鎾愁吋閸曨厾鐛㈤悗娈垮枛椤兘骞冮姀銏″仒闁炽儱鍘栨竟鏇炩攽閻愭潙鐏﹂柣鐕佸灦閹偞绂掔€ｎ偆鍘藉銈嗘尵閸庢劙宕曢幋鐘电＜閺夊牄鍔屽ù顔姐亜閵忊€冲摵鐎规洖宕埢搴ㄥ箣閻愭惌鍟呴梻鍌氬€风粈渚€鎮块崶顬盯宕熼鈧崶顒佸仺闁告縿鍎辩粊锕€鈹戦埥鍡楃仩闁汇劎鍏樺畷鎴﹀箻閺傘儲顫嶅┑鐐叉閻熴倗娆㈤棃娑掓斀闁绘劘灏欏В鐐烘煃瑜滈崜姘跺礈濮橆兙鈧帗绻濆顓犲帾闂佸壊鍋呯换鍌炲焵椤掑倹鍤€闁宠绉瑰顕€宕奸悢鍙夊闂備礁鎲″ú锕傚磻閸曨垼鏁傛い鎰╁€楃壕鍏笺亜閺囩偞鍣圭€殿噮鍣ｉ弻鐔碱敊閸濆嫮浼勬繛瀛樼矊閹诧繝骞忛崨顖涘枂闁告洦鍓氱欢顐⑩攽閻樺灚鏆╁┑顔惧厴瀵偊宕ㄦ繝鍐ㄥ伎闁诲海鏁哥涵鍫曞磻閹炬剚娼╂い鎺嗗亾婵℃彃顭烽幃?PathNavigation闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弮鍫熸殰闁稿鎸剧划顓炩槈濡娅ч梺娲诲幗閻熲晠寮婚悢琛″亾閻㈡鐒惧ù鐘欏洦鈷掗柛鏇ㄥ亜椤忣參鏌″畝瀣瘈鐎规洘锕㈡俊鎼佸Ψ閵忕姳澹曢梺鍛婄缚閸庢煡顢曟禒瀣厪闁割偅绻冮崯鎺楁煛閸愩劎澧涢柡鍛叀閺屾稑鈽夐崡鐐茬濠电偛鐗婇悡鈥愁潖?Stuck 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墴閹潡顢欐慨鎰盎闂佸搫绋侀崑鍕濠婂懐妫柟顖嗗嫬浠撮梺鍝勮閸婃洟婀侀柣搴秵閸嬪懘鎮甸弴鐑嗘富闁靛牆妫楁慨鍐磼椤旂晫鎳囩€殿喖顭烽弫鎰緞婵犲嫮娼夐梻浣侯焾閺堫剟鎳濋悙顒傤浄婵☆垵鍋愮壕钘壝归敐鍡楃祷濞存粎鍋撶换婵嬪閿濆懐鍘梺鍛婃⒐閻楃娀骞冮敓鐘茬妞ゆ梻鏅崢鍗炩攽閻樼粯娑ф俊顐ｎ殜椤㈡棃鍩￠崒妯圭盎闂婎偄娴勭徊鑺ョ娴煎瓨鐓涢悘鐐插⒔閳洟鏌熼娑欘棃濠殿喒鍋撻梺闈涚箳婵绱掗埡鍛拻?
        }
    }

    // ==========================================
    // Tactical kiting + ranged fire control
    // ==========================================
    static class TacticalKiteAttackGoal extends Goal {
        private final SkeletonTurret mob;
        private int attackTime = -1;
        private int leapCooldown = 0; // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌熺紒銏犳灍闁哄懏绻堥弻鏇熷緞閸℃ɑ鐝旈梺鎼炲妼閸婂潡寮诲☉銏╂晝闁挎繂妫楅ˇ鈺呮⒑鏉炴壆顦︽俊顐ｇ箞瀵鏁愭径濠勭杸濡炪倖甯婇悞锕傚磿閹惧墎纾藉ù锝嗗絻娴滈箖姊洪崨濠傚Е濞存粍鐗犲畷鎴﹀箻缂佹ê浠梺鍝勵槹椤戞瑦绂掗幆褉鏀介柣姗嗗枛閻忣亝銇勯鐐村窛闁?

        public TacticalKiteAttackGoal(SkeletonTurret mob) {
            this.mob = mob;
            this.setFlags(EnumSet.of(Flag.MOVE, Flag.LOOK));
        }

        @Override
        public boolean canUse() {
            if (mob.overheatCooldown > 0) return false;
            if (mob.postTeleportAttackDelay > 0) return false;
            return this.mob.getTarget() != null && this.mob.getTarget().isAlive();
        }

        @Override
        public void start() {
            super.start();
            this.attackTime = -1;
            this.leapCooldown = 0;
        }

        @Override
        public void tick() {
            LivingEntity target = this.mob.getTarget();
            if (target == null) return;

            double distSqr = this.mob.distanceToSqr(target);
            double attackRange = this.mob.getAttackRange();

            if (distSqr > attackRange * attackRange) {
                this.mob.setTarget(null);
                return;
            }

            this.mob.getLookControl().setLookAt(target, 30.0F, 30.0F);

            // ================= 闂傚倸鍊搁崐鎼佸磹閻戣姤鍤勯柛顐ｆ礀缁犵娀鏌熼崜褏甯涢柛瀣ㄥ€濋弻鏇熺箾閸喖顬夐梺鐟板暱閺堫剛鎹㈠┑瀣仺闂傚牊鍒€濞戙垺鐓曢悗锝庡亝瀹曞矂鏌″畝鈧崰鏍嵁閸℃稒鍋嬮柛顐亝椤ュ绱撻崒娆掑厡濠殿垼鍙冨畷瑙勫缁厜鍋撻敂鐐磯闁靛绠戠壕顖涚箾閹炬潙鍤柛銊ゅ嵆瀹曟粓寮跺▎鐐瘜闂侀潧鐗嗛崯顐﹀礉濮樿埖鐓熸い鎾跺仜閳ь剙鐏濋锝嗙節濮橆剛浼嬮梺褰掝暒缁€渚€骞冮幋锔解拺闁硅偐鍋涢崝姘熆瑜嶉柊锝呯暦濠靛浼犻柕澹拑绱冲┑鐐舵彧缂嶁偓妞ゎ偄顦垫俊闈涒攽閸垻锛滈梺缁樏壕顓熸櫠閻㈢鍋撳▓鍨灈妞ゎ厼鍢查悾鐑藉Ω閳轰胶楠囬梺鐟扮摠缁诲倿骞愰妶澶嬧拻濠电姴楠告禍婊勭箾鐠囇呯暠閻撱倝鏌″搴′簽闁?=================
            if (this.mob.isFollowing()) { // 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偛顦甸弫鎾绘偐閸愯弓鐢绘俊鐐€栭悧妤冪矙閹炬眹鈧懘宕ｆ径宀€鐦堥梻鍌氱墛缁嬫帡鏁嶉弮鍫熺厾闁哄娉曟禒銏ゆ婢舵劖鐓ユ繝闈涙閹兼劙鏌涢弬娆惧剳闁逞屽墲椤煤閺嶎厔鍥偨缁嬭儻鎽曢梺鎸庣箓椤︻垰螞濮椻偓閺屾盯鈥﹂幋婵囩亶闂佺顭崹浼粹€旈崘顔嘉ч柛鈩兠壕鈺侇渻閵堝骸浜滄い锔藉缁碍娼忛妸褏鐦堥梺鎼炲劥閸╂牠寮查鈧埞鎴︽晬閸曨偂鍝楀銈嗘肠閸曨収娲搁梺鍛婃寙閳ь剟宕戦幘鑸靛枂闁告洦鍓涢ˇ銉モ攽閻愯尙婀撮柛鏃€鍨挎俊瀛樼瑹閳ь剙鐣烽妸褉鍋撳☉娅辨岸骞忛搹鍦＝濞达絽澹婇崕鎾寸箾婢跺绀堢紒顔碱煼閺佹劙宕卞▎鎴晭闂備礁鎼ˇ浼村垂閸洖绐楁俊顖涚湽娴滄粓鏌曡箛銉х？闁瑰啿妫涚槐鎺楁偐瀹曞洦鍒涢悗娈垮枟閹告娊骞冮埡鍛仺闂傚牊绋戦懘顖炴⒒閸屾瑦绁扮€规洖鐏氶幈銊╁级閹炽劍妞介弫鍐╂媴閸忓憡鐫忛梻浣告啞閸旓箓宕ｆ惔銊ョ骇?
                if (this.leapCooldown > 0) this.leapCooldown--;

                // 1. 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弴鐐测偓褰掑磿婵犲洦鈷戞い鎺嗗亾缂佸顕划鍫⑩偓锝庡枟閻撳繐鈹戦悙鑼虎闁告梹鐟ラ…璺ㄦ喆閸曨剛顦板┑顔硷攻濡炶棄螞閸愩劉妲堥弶鍫厛閳ь剙妫涚槐鎾存媴閸濆嫅锝夋煕閵娿儲鍋ユ鐐插暙铻ｉ悶娑掑墲椤秹姊洪棃娑㈢崪缂佽鲸娲熷畷銏ゅ箹娴ｅ厜鎷洪梺鍛婃尰瑜板啯绂嶆禒瀣厱閻庯綆浜滈顓㈡煙椤旀枻鑰块柡浣哥Ч瀹曠喖顢橀悪鍛簥濠碉紕鍋戦崐鏍洪弽顬稑鈽夐姀鈥充患闁哄鐗勯崝濠冪?(闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌ｉ姀銏╃劸缂佲偓婢跺绻嗛柕鍫濇噺閸庢澘顭块懜闈涘缂佺姵鐩弻鈩冨緞鎼淬垻銆婂?< 2.5闂?闂?6.25 Sqr)
                if (distSqr < 6.25 && this.mob.onGround() && this.leapCooldown <= 0) {
                    net.minecraft.world.phys.Vec3 jumpDir = this.mob.position().subtract(target.position()).normalize();
                    this.mob.setDeltaMovement(jumpDir.x * 0.6, 0.35, jumpDir.z * 0.6);
                    this.mob.playSound(net.minecraft.sounds.SoundEvents.ARMOR_EQUIP_CHAIN, 1.0f, 1.5f);
                    this.leapCooldown = 40; // 2缂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕闁芥ɑ绻堥弻鐔封枔閸喗鐏嶉梺鍝勬缁捇寮婚悢鍏煎€绘慨妤€妫欓悾鍓佺磽娴ｇ懓濮堟い銊ワ躬閻涱噣寮介‖銉ラ叄椤㈡鍩€椤掍椒绻嗛柤娴嬫櫇濡垱銇勯幘瀵糕槈濞存粓绠栧缁樻媴閸涘﹥鍎撳銈忓瘜閸ㄥ爼骞冭瀹曞崬螣缂佹褰块梻浣风串缁蹭粙鎯夋總鍛婂剹闁糕剝顨忛悢鍡涙煠閹间焦娑у┑顔肩墦閺屽秹鏌ㄧ€ｎ亝璇為梺鍝勬湰閻╊垶鐛崶顒€鐓涘ù锝呭閻庡磭绱撻崒娆掑厡閻庢艾绻樺畷鐔煎煛閳ь剛鑺辨繝姘拺闁革富鍘奸崝瀣煙閹间胶鐣洪柛鈺侊躬瀵挳鎮㈤搹璇″晭闂備胶绮幐鍝モ偓鍨浮閹剝绺介崨濠勫幍濡炪倖姊婚弲顐﹀箠閸ヮ剚鐓欐い鏃囧吹閻瑧鈧娲栫紞濠囥€侀弴銏℃櫜闁糕剝鐟﹁濠电姷鏁告慨鎾儉婢舵劕绾ч幖瀛樻尭娴滈箖鏌″搴′簼鐎规洘鐓￠弻娑㈠焺閸愵亖妲堢紒鐐劤椤兘寮婚悢鍏煎亱闁割偆鍠撻崙鈥斥攽椤旀娼愰柣鎿勭節瀵鈽夊Ο閿嬵潔闂佸憡顨堥崑鐔哥椤撱垺鍊?
                }
                // 2. 闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繒鈧箍鍎遍ˇ顖氼啅濠靛洢浜滈柡鍥╁仦閸ｆ娊鏌涚€ｎ偅宕勭紒鐘崇☉閳藉鈻庣仦鎯ь伖闂傚倷绀侀幉锛勭矙閹达附鏅濋柕濠忓閻濊埖鎱ㄥ璇蹭壕闂佽鍠楅〃鍛村煡婢舵劕绠抽柟鎯ь嚟瑜板淇?(闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偛顦甸弫鎾绘偐椤旂懓浜鹃柛鎰ㄦ櫇缁♀偓闂佸憡鍔︽禍璺好洪幖浣圭厽闁绘宕电槐浼存煏閸″繐浜鹃梻浣告惈椤戝懐绮旇ぐ鎺戣摕闁绘梻鍘х粻鏌ユ煙闁箑澧伴柛姗嗗亰閹鎲撮崟顒傤槬濡炪倧闄勬竟鍡涘箲閵忕姭鏀介悗锝庡亽濡啫鈹戦悙鏉戠仸闁煎綊绠栭崺娑㈠醇閵夛腹鎷?< 6闂?闂?36.0 Sqr)
                else if (distSqr < 36.0) {
                    net.minecraft.world.phys.Vec3 awayPos = net.minecraft.world.entity.ai.util.DefaultRandomPos.getPosAway(this.mob, 5, 4, target.position());
                    if (awayPos != null) {
                        this.mob.getNavigation().moveTo(awayPos.x, awayPos.y, awayPos.z, 1.25); // 濠?.25闂傚倸鍊搁崐鎼佸磹閻戣姤鍤勯柛顐ｆ磵閳ь剨绠撳畷濂稿Ψ閿旇姤鐝栭梻渚€娼ч悧鍡椕洪妸鈺傚剹闁规崘鍩栭崰鎰版煟濡も偓閻楀棛绮幒妤佺厽闁圭儤鍨规禒娑㈡煏閸パ冾伃妤犵偞甯￠獮瀣攽閸愩劋澹曢梺褰掓？缁€渚€宕欓悩璇茬婵烇綆鍓欐俊浠嬫煟閹惧鎳勯柕鍥у瀵噣宕掑鍕晵婵犵數鍋涢悧濠勫垝閹捐钃熼柨娑樺濞岊亪鏌ら幁鎺戝姎婵炲牊顨婂铏瑰寲閺囩喐婢掗梺?
                    }
                }
                // 3. 闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃秹婀侀梺缁樺灱濡嫮绮婚悩缁樼厵闁诡垎鍐╊啈闂佹悶鍎洪崜锕傚极瀹ュ鐓熼柟閭﹀灠閻ㄦ椽鏌ｉ幘鏉戠伌婵☆偄鎳橀、鏇㈠閳ユ剚妲辨繝娈垮枛閿曘倕锕㈡潏鈺傤潟闁绘劕鎼悙濠冦亜閹哄秷鍏岄柛妯兼暬濮婅櫣鎷犻垾宕団偓濠氭煕閹般劍娅嗛柣锔肩稻缁绘繂鈻撻崹顔界彲缂備浇寮撶划娆掓闂佹眹鍨婚…鍫㈢不閺嶎偅鍠愰柣妤€鐗嗙粭姘舵煕婵犲嫮甯涘ǎ鍥э躬椤㈡稑鈹戦崱鏇熺潖闂備椒绱徊鍧楀储瑜旈垾鏃堝礃椤斿槈褔骞栫划鍏夊亾閹颁焦浜ゅ┑鐘垫暩閸嬫稑螣婵犲洤鐭楅柛鎰电厛閸ゆ洘銇勯幇鈺佺労闁告艾顑夐弻娑樷槈閸楃偟浠┑鐐茬墛濞茬喎顫忓ú顏呯劵闁绘劘灏€氭澘顭胯閹告娊寮婚悢纰辨晩闁绘劦鍓氬В鍫濐渻閵堝啫鐏紒瀣灴閿濈偛鈹戠€ｎ亞顦ч梺鍏肩ゴ閺呪晛煤?
                else {
                    this.mob.getNavigation().stop();
                }
            } else {
                // 闂傚倸鍊搁崐鎼佸磹閻戣姤鍤勯柛顐ｆ穿缂嶆牠鎮楅敐搴℃灈缂佲偓鐎ｎ偁浜滈柡鍐ㄥ€甸幏鈩冧繆椤愩倕鏋涙慨濠勭帛閹峰懏顦版惔婵婎洬闂備浇顕栭崗娆撳磿闂堟稓鏆︽俊銈呮噹缁€鍫㈡喐瀹ュ鍑犳繛鎴欏灪閻撴洟鏌曟繝蹇曠暠闁告柣鍊濋弻锝夋晲閸パ冨箣閻庤娲栭悥濂稿春閳╁啰绡€闁告劏鏅滃▓銏ゆ⒒閸屾艾鈧悂宕愰悜鑺ュ€块柨鏃堟暜閸嬫挾绮☉妯诲櫧闁活厽鐟╅弻鐔兼倻濡櫣鍔稿┑鐐茬毞閺呯娀寮婚弴鐔虹鐟滃秹宕锔藉€跺┑鐘插暕缁诲棝鏌ｉ幇顒佲枙闁稿骸绻掔槐鎺楀Ω閵壯冪厽閻庤娲橀崹鍧楃嵁濡偐纾兼俊顖濇〃缂傛挾绱撻崒娆戣窗闁搞劌宕叅闁哄秲鍔庨々鏌ユ煟閹伴潧澧扮紒鐘荤畺閺岀喓鈧數顭堟禒锕傛煟閵婏箑鐏撮柡宀€鍠栭獮鎾诲箳閺冨倐銊モ攽椤旂》鍔熺紒顕呭灣缁參鎮㈤悡搴ｅ€為悷婊冪灱閼洪亶顢氶埀顒€顫?
                this.mob.getNavigation().stop();
            }
            // ==================================================

            // 闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃繘骞戦姀銈呯疀妞ゆ棁妫勬惔濠囨⒑瑜版帒浜伴柛鐘冲浮瀹曟垿骞橀幇浣瑰兊闂佺粯鎸告鎼佸煕鐎ｎ喗鍊甸悷娆忓缁€鍫ユ煛娴ｅ壊鐓奸柕鍡曠椤繄鎹勯搹鐟板Е婵＄偑鍊栫敮鎺斺偓姘煎墴閹锋垿鎮㈤崗鑲╁幈濠电偞鍨堕悷锔剧礊閹达附鐓曟繛鍡楅獜闊剟鏌ｉ幙鍐ㄤ喊鐎规洖鐖兼俊鎼佹晜缂併垺袣缂傚倸鍊烽悞锕傚蓟閵娾晛瑙﹂悗锝庡墯瀹曞弶绻涢幋娆忕仾闁哄懏鐓￠弻娑樷槈閸楃偞鐏堝銈忚吂閺呮繄妲愰幘瀛樺缂佹稑顑呭▓顓㈡⒑閸濄儱鏋嶉柛妤佸▕瀹曟椽鍩€椤掍降浜滈柟鍝勬娴滈箖姊虹拠鑼闁煎綊绠栭敐鐐剁疀濞戞ɑ宓嶅銈嗘尵婵兘鎮￠幘瀵哥瘈闁靛骏绲剧涵鐐亜椤撗冨⒋鐎规洏鍎抽埀顒婄秵閸犳鎮￠弴鐔虹闁瑰瓨绻傞懜瑙勵殽閻愭惌鐒界紒?
            int minCd = (int) mob.getFireDelay();
            if (--this.attackTime <= 0) {
                boolean isClose = distSqr < 36.0;
                boolean isSmart = mob.getTier() >= 2;
                boolean canSee = this.mob.getSensing().hasLineOfSight(target);

                if (canSee || isSmart || isClose) {
                    this.mob.performRangedAttack(target, 1.0F);
                    this.attackTime = minCd;
                }
            }
        }
    }    // ==========================================
    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱槸濞寸兘宕伴弽褏鏆︽い鎰剁畱缁€瀣亜閹捐泛顫戞繝濠傛噽绾句粙鏌涚仦鍓ф噭缂佷焦婢橀—鍐偓娑櫳戦崐鎰偓瑙勬礀缂嶅﹤鐣风粙璇炬棃鍩€椤掑嫭瀚呴柣鏂垮悑閻撶喖鏌￠崘銊モ偓鎼佸礉鐎ｎ兘鍋撶憴鍕妞わ妇鏁诲濠氭晲閸滀焦鍍靛銈嗘尵閸犳挾绮欓崶銊х瘈婵炲牆鐏濋弸鐔兼煟閳哄﹤鐏犳い顐㈢箰鐓ゆい蹇撳缁愭稒绻濋悽闈浶㈤悗姘煎弮瀹曞疇顦规慨濠勭帛閹峰懐绮欑捄銊ф晨缂傚倷娴囧鎾跺垝濞嗘挶鈧礁顫濋懜鍨珳婵犮垼娉涢鍛闁秵鈷戦柛鎾村絻娴滅偤鏌涢悩鏌ュ弰鐎规洘绻堝畷銊р偓娑櫱氶幏娲⒑閸︻収鐒炬繛鎾棑缁骞樺ǎ顑跨盎闂佹寧妫侀褔鎮橀敂閿亾鐟欏嫭纾搁柛銊ョ秺閸┿垺鎯旈妸銉ь啋缂備緡鍠涢～澶屸偓?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙闁稿被鍔庨幉鎼佸籍閸惊銉╂煕閹般劍娅嗛柛搴ｅ枛閺屾洝绠涚€ｎ亞鍔村┑鐐跺皺椤牓鍩為幋锔藉亹閻犲泧鍐х矗闂佽瀛╅崙褰掑矗閸愩劎鏆﹂柨婵嗙墢閻も偓濠电偞鍨堕悷褔宕㈤幘缁樷拺闁告稑锕︾粻鎾绘倵濮樼厧寮€规洘濞婂畷鐑筋敇閻樼绱查梻渚€鈧偛鑻晶瀵糕偓瑙勬礀閵堟悂骞冮姀銏㈢闁绘鏁稿▔鍧楁⒒閸屾瑧顦﹂柟纰卞亞缁棃寮婚妷銉ь槷闁瑰吋鐣崝宀勬偂閳ユ剚鐔嗛悹杞拌閸庡秴霉濠婂嫮鐭掗柡灞炬礋瀹曠厧鈹戦崱鈺€绱戠紓鍌欑劍閸旀牕螞閸愵喖钃熼柣鏃傗拡閺佸鏌嶈閸撶喎顕ｉ妸鈺傜劶鐎广儱鎳愰鍡涙⒑閸涘﹦鈯曟繛鍏肩懃椤斿繐鈹戦崱蹇旀杸闂佺粯蓱瑜板啴鍩€椤掆偓缂嶅﹪銆侀弮鍫熷亹闁稿繐鎳愮粻?
    // ==========================================
    private void manageTorchBehavior() {
        // 1. 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ帒锕︾粙蹇旂節閵忥絽鐓愰柛鏃撶畵瀵偅绻濋崶銊у幐閻庡箍鍎辨鎼佺嵁閺嶎偆妫柟顖嗗瞼鍚嬮梺鍝勬湰缁嬫垿鍩ユ径鎰闁绘劖褰冮婊堟⒒娴ｈ鍋犻柛濠冪墪鐓ら柣鏃傚帶閽冪喐绻涢幋鐐电煠婵¤尙鍘ч—鍐Χ閸愩劌顬堝┑鈽嗗亝缁诲倿鎮鹃悜鑺ュ仺缂佸娉曢ˇ鏉款渻閵堝棛澧紒瀣灴閸┾偓妞ゆ巻鍋撻柣鏍с偢瀵鏁愭径濠勭杸濡炪倖鐗楀銊╁储椤愩埄娓婚柕鍫濆暙閸旀碍銇勯敂鐐毈鐎殿喖顭烽弫鎰緞鐎ｎ偅鐝栭梻渚€鈧偛鑻晶鎾煙椤斿搫鍔滅紒铏规櫕缁瑩鎳楅娑欏暫闂傚倷绶氬褔鈥﹂崼銉ョ？妞ゆ柨妲堥敐澶婇唶闁绘柨澧庣粻姘渻閵堝棛澧紒璇插€圭粋宥夋偡閹冲﹤缍婇幃鈩冩償閵忊剝鍊烽梻浣哥枃椤宕归崸妤€绠栭柍鍝勬媼閺佸啯銇勯顐㈠箹妞ゃ儲宀稿濠氬磼濞嗘埈妲梺纭咁嚋缁辨洜鍒掑▎鎾崇闁规惌鍘鹃崝宄扳攽閻愬弶顥為柛銊у枛瀹曟垿骞橀幇浣瑰兊濡炪倖甯掗ˇ鎵懅濠碉紕鍋戦崐銈夊矗閳ь剚绻涙径瀣妤犵偞鍨垮畷鐔碱敆閸屾粍鍤屾俊鐐€栭悧妤呮嚌閻愵剛鐝堕悗锝庡亞缁♀偓濠电偛鐗嗛悘婵嬪几濞戙垺鐓ラ柡鍥ュ妺缁ㄧ晫绱掗纰辩吋鐎殿喕绮欓、姗€鎮欓懜鍨暫闂傚倷娴囧▔鏇㈠窗閹惧瓨鍙忛柟缁㈠枟閻撲線鏌涢妷锝呭缂佲檧鍋撻梻浣稿閻撳牓宕戦崟顒佸弿闁割偅鎯婇弮鍫濇閹煎瓨鎸婚弬鈧梻浣虹帛閸旀洟鎮洪妸褏绀婇柟杈鹃檮閻撶喖鏌曟繛褍鍟獮瀣倵鐟欏嫭绀冮柛銊ユ健閻涱喖螣閼测晝锛滃┑鈽嗗灦閺€杈┾偓?
        boolean hasTorch = false;
        for (int i = 0; i < inventory.getContainerSize(); i++) {
            if (inventory.getItem(i).is(Items.TORCH)) {
                hasTorch = true;
                break;
            }
        }

        ItemStack currentOffhand = this.getItemBySlot(net.minecraft.world.entity.EquipmentSlot.OFFHAND);

        // 2. 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯锋嫼閻熸粎澧楃敮鎺撶娴煎瓨鐓曢柟鎯ь嚟閹冲洭鏌熼鈧褑鐏掗梺鐓庮潟閸婃鎯侀崼銉︹拺闂傚牊鐩悰婊呯磼閹绘帒鈷旀繛鎴犳暬楠炲棜顦柡鈧禒瀣厱閻忕偛澧介埊鏇㈡煃闁垮绗氬ǎ鍥э躬瀹曪絾寰勬繝鍌ゆ綒婵°倗濮烽崑娑㈩敄婢舵劕鏋侀柛宀€鍋為崑鈺呮倶閻愯埖顥夋慨?
        if (hasTorch) {
            // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯锋嫼閻熸粎澧楃敮鎺撶娴煎瓨鐓曢柟鎯ь嚟濞插瓨銇勯姀鈭╂垹缂撴禒瀣窛濠电姴瀚獮妤呮⒑閻熸澘鎮戦柟顖氱焸瀹曞綊宕橀懠顒佹畷濠电偞鍨崹娲偂濞戙垺鐓曟繛鎴濆船閺嬨倗绱掗悩闈涗槐闁哄瞼鍠栭、娆撳箚瑜嶉獮瀣旈悩闈涗粶婵炲樊鍙冮獮鍐樄鐎规洖銈告慨鈧柣妯垮皺椤撳ジ姊婚崒姘偓鐑芥倿閿曞倹鍎戠憸鐗堝笒绾惧綊鏌曢崼婵愭Ц闁搞劌鍊垮鍫曞醇濮橆厽鐝曢梺绋跨箲缁捇寮婚妶澶婁紶闁靛闄勫В鍕磽娴ｅ搫鈻堢紒鐘崇墵瀵鈽夐姀鈺傛櫇闂侀潧鐗嗛幊蹇涙倵婵犳碍鈷戦悹鍥ㄧ叀閻涙粌鈹戦垾铏窛婵″弶鍔欓獮鎺楀棘閸濆嫪澹曢梺鎸庣箓缁ㄥジ骞夐悙顑跨箚闁圭粯甯楅崯鐐烘煏閸パ冾伃妤犵偞锕㈤幃娆撴寠婢跺鍨濋梺璇叉唉椤煤閺嵮呮殾妞ゆ帒鍟版禍浠嬫⒒娴ｈ櫣甯涢柛銊╂涧鐓ら柕濞炬櫆閸嬧晠鏌ｉ姀鐘冲暈闁绘挻绋撻埀顒€鍘滈崑鎾绘倵閿濆骸澧扮悮锝囩磽閸屾瑨鍏屽┑顔炬暬閹嫰顢涢悙鍙夌€梺鍦濠㈡ê顔忓┑鍥ヤ簻闁圭儤鍨甸埀顒佹倐瀹曠敻顢楁担铏圭槇闂佹眹鍨藉褍鏆╂俊鐐€х徊鑲╁垝濞嗗繒鏆︽繝濠傚暊閺€浠嬫倵閿濆簼绨介柣锝嗘そ濮婅櫣绮欑捄銊т紘闂佺顑嗛惄顖氼嚕閸涘﹥濯撮悶娑掆偓鍏呭濡ょ姷鍋涢悘婵嬪礉濮樿埖鐓欓柧蹇ｅ亜婵秶鈧鍠楁繛濠傜暦閸楃偐妲堟繛鍡樺灥楠炲牓姊绘担绛嬫綈濠㈢懓顑夊鎻掆槈濞嗗海绠氭繝闈涘€搁幉锟犳偂閻旂厧绠归柟纰卞幖閺嬫稑顭胯婢瑰棛妲愰幒鎾寸秶闁靛绠戦棄宥夋⒑閻熸澘妲婚柟铏悾鐑芥倻缁涘鏅ｉ梺缁樻⒐閸ゅ酣宕濋幋婵愭綎婵炲樊浜滃婵嗏攽閻樻彃鏆欐い锔规櫊濮婅櫣绮欏▎鎯у壈闁诲孩鍑归崳锝夊箠閻愮儤鐒肩€广儱鎲橀妸鈺傜厓闁告繂瀚埀顒傛暬楠炲繐煤椤忓應鎷洪梺鐓庮潟閸婃洟寮搁幋婵愮唵闁荤喓澧楅ˉ銏☆殽閻愭惌娈滈柟顔规櫇缁辨帒螣閻撳骸绠為梻鍌欑閹碱偊宕悩璇茬；闁圭偓鐣禍婊堟煏婵炲灝鍔滄い銉у█閺屽秷顧侀柛鎾跺枎椤洩顦瑰┑鈥崇埣楠炴牗鎷呴崨濠冃氶梻渚€鈧偛鑻晶顖炴煏閸パ冾伃妤犵偞甯￠獮瀣攽閹邦亞妫梻?
            if (!currentOffhand.is(Items.TORCH)) {
                this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.OFFHAND, new ItemStack(Items.TORCH));
            }

            // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煟閵忋埄鐒剧紒鎰殜閺岀喖骞嶉纰辨毉闂佺顑戠换婵嬪蓟閺囩喎绶為柛顐ｇ箓婢规柨鈹戦悙鏉戠仸闁挎洍鏅犻幃锟犲Ψ閳哄倻鍘卞銈嗗姦閸嬪嫭鏅堕幍顔剧＜閻庯綆浜炵粻濠氭煛瀹€鈧崰鏍х暦濡ゅ懏鍤冮柍鍝勫€归鍐⒒娴ｅ憡鍟為柡灞诲妿缁棃鎮烽幍顔芥闂佺懓顕慨顓㈠磻閹剧粯鏅查幖绮瑰墲閻忓秹姊虹粙娆惧剬闁告挻绻勯幑銏犫槈閵忕姴鑰垮┑掳鍊曢崯浼搭敊閸パ屾富闁靛牆鎳忕粋瀣瑰鍕畼闁瑰箍鍨归埥澶愬閻樿尙鐛╂俊鐐€栭幐鐐叏閻戠瓔鏁婇柟鐑橆殕閳锋垿鏌涘┑鍡楊伂妞ゎ偓绠撻弻娑㈠棘鐠恒劎鍔梺绯曟杺閸庢彃顕ラ崟顒傜闁绘劦鍓涢埀顒€顭峰铏规喆閸曨剙鍓归梺鍛婎焾濡嫰鍩㈤幘骞夸汗闁圭儤鎸撮幏缁樼箾鏉堝墽绉い銉︽尰缁嬪寮婚妷锕€浠繛鎾磋壘閿曪箓骞冩總鍛婄厵妤犵偛鐏濋悘鈺呮煃鐟欏嫬鐏寸€规洟浜堕崺锟犲磼濠婂應鏋嗗┑鐘茬棄閺夊簱鍋撹瀵板﹥绂掔€ｎ亞鏌堝銈嗗姀閹斥€斥槈濮楀棙寤洪梺閫炲苯澧寸€殿喛顕ч埥澶愬煑閳规儳浜鹃柨鏇炲€哥粻锝嗙節闂堟稒宸濆ù婊嗗煐娣囧﹪鎮欓鍕ㄥ亾閺嶎厼绠插ù锝呮憸閺嗭箓鏌ｉ姀鐘典粵妞ゎ偅娲熼弻鐔煎箚瑜忛幗鐘测攽椤栨稒灏﹂柡灞剧洴楠炴﹢宕橀懠顒勭崜闂佽桨绀侀悧鎾愁潖閸濆嫅褔宕惰閸旀挳姊洪幖鐐插濞存粠鍓熷顐︻敋閳ь剟宕归幆褏鏆﹂柛銉ｅ妽椤旀洘淇婇悙顏勨偓鏍偋濡や胶鐝堕柡鍥ュ灩绾惧鏌熼崜褏甯涢柡鍛叀楠炴牜鍒掗崗澶婁壕闁肩⒈鍓氶弲濂告⒒閸屾瑧顦︾痪缁㈠幘閸掓帡顢涘В鍏肩洴瀹曟﹢顢欓懝鐗堟啺闁诲骸绠嶉崕閬嶆偋濠婂喚鐎堕柕濞炬櫆閳锋垿鏌涘☉姗堟敾閻忓繒鏁婚弻娑㈡偐瀹曞洤鈷岄梺缁樹緱閸ｏ絽鐣峰鈧俊鎼佸閿涘嫧鍋撴繝姘拺閻熸瑥瀚粈鍐╃箾閸涱喗绀€闁伙綁娼ч濂稿椽娴ｇ懓鐦滈梻渚€娼ч悧鍡椢涘▎鎴滅剨闁规鍠氱壕濂告偣閸ャ劌绲绘い蹇ｅ亜椤法鎲撮崟顒傤槰缂備胶绮换鍌烇綖濠靛鏁囨繛鎴炵懃椤忓綊姊婚崒娆戭槮闁硅绱曢幑銏ゅ磼濠ф儳浜炬慨妯煎帶婢у瓨銇勯姀鈩冾棃妞ゃ垺娲熼弫鍌炴偩鐏炶棄绠為梻鍌欑劍鐎笛呮崲閸屾粍宕查柟鎷屽焽閳ь剙鎳橀、妤佹媴妞嬪海鐣鹃梻浣告啞閻熴儵藝椤栨稒鍙忛柛銉墯閻撳啴鎮峰▎蹇擃仼闁诲繐顕埀顒冾潐濞叉牠鎮ラ崗闂寸箚闁归棿鐒﹂弲婊堟煙椤栧棗鍟犻弸蹇涙⒒閸屾艾鈧悂宕愰悜鑺ュ殑闁告挷绀侀崹婵囥亜閺嶎偄浠滅紒鈧径鎰厸鐎广儱楠搁崢闈浢瑰鍐Ш闁哄本鐩獮鍥濞戞瑧褰茬紓鍌氬€哥粔鐢告偋閻樿钃熼柕濞垮劗閺€浠嬫煕閳╁喛渚涙俊顐節濮婃椽宕ㄦ繝鍕櫑缂備胶绮崹鍓佺矚鏉堛劎绡€闁搞儴鍩栭弲顒€鈹戦悩缁樻锭婵☆偅顨婇獮鍡涙倷閻戞ǚ鎷洪柣搴℃贡婵敻藟婢跺浜滈柨鏃囨椤ュ鏌熼獮鍨仼闁宠棄顦垫慨鈧柣妯活問閸炰粙姊绘担鍛婅础闁稿簺鍊濋獮鎰板川婵犲嫷娴勯梺鍦檸閸犳鍩?
            if (this.level().isClientSide && this.tickCount % 10 == 0) {
                double offsetX = -Math.sin(this.getYRot() * ((float)Math.PI / 180F)) * 0.4;
                double offsetZ = Math.cos(this.getYRot() * ((float)Math.PI / 180F)) * 0.4;
                this.level().addParticle(ParticleTypes.FLAME, this.getX() + offsetX, this.getY() + 1.5, this.getZ() + offsetZ, 0, 0, 0);
            }
        }
        // 3. 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欑€靛摜鐦堥梺姹囧灲濞佳勭瑜旈弻娑氣偓锝庡亝瀹曞矂鏌熼鍡欑瘈濠殿喒鍋撻梺闈涚墕濡矂骞忓ú顏呪拺闁革富鍙庨悞鐐箾鐎电鍘撮柛鈹垮劜瀵板嫰骞囬鐐╁亾閸偅鍙忔慨妞诲亾婵☆偉娉曢懞閬嶆嚍閵夈倗绠氶梺鍛婄懃椤︻垱鎱ㄥ鍡╂闁绘劕妯婇崕鏃堟煛娴ｇ鈧潡骞冮崜褌娌柦妯侯槹鏉?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缂佺姷濞€閺岀喖宕滆鐢盯鏌涚€ｃ劌鈧繈寮婚弴鐔虹闁绘劦鍓氶悵鏇㈡⒑缁嬫鍎忔い鎴濐樀瀵鏁愭径濠勭杸濡炪倖甯婇悞锕傚磿閹剧粯鈷戠紓浣姑粭鎺楁煟韫囨柨鍝哄┑锛勬暬瀹曠喖顢涘槌栧敽闂備胶纭堕崜婵嬪Φ閻愬鐝堕柡鍥ュ灪閳锋帒霉閿濆嫯顒熼柡鈧悧鍫㈢闁告侗鍠楃粈瀣偓瑙勬礃缁诲牆顕ｆ禒瀣垫晝闁绘棁娓规竟鏇㈡⒒閸屾氨澧涚紒瀣箻瀹曟垿濮€閵堝棛鍘遍梺瀹狀潐閸庤櫕绂嶉悙顑跨箚闁绘劦浜滈埀顒佺墱閺侇噣骞掗弬鍝勪壕婵鍘у顕€鏌熼鍏夊亾閺傘儲鐎婚梺鍦亾濞兼瑦绂掗鐐粹拺闁诡垎鍛唺闂佺娅曢幑鍥箚閸愵喖绠ｆ繝鍨姈閸嬨儱顪冮妶鍡楀Ё缂佹彃娼￠妴鍌炲蓟閵夛妇鍘梺鎼炲劀閸愬彞绱旀俊鐐€戦崹鍝劽洪悢绗衡偓浣肝旈崨顓狅紲濠电姴锕ょ€氼參顢欓幘鏂ユ斀閹烘娊宕愬Δ浣瑰弿闁绘垼妫勭壕缁樼箾閹寸偟顣茬€规洖寮堕幈銊ヮ渻鐠囪弓澹曟俊銈囧Х閸嬫盯鏁冮妶鍫簷闂備礁鎲＄划鍫ユ倿閿曞倸鐤炬い鎺嗗亾闁宠鍨块幃鈺冪磼濡鏁繝鐢靛仜閻即宕愬┑鍡欐殾闁挎繂顦粻锝夋煥閺冨泦鎺楀箯?
        else {
            // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯锋嫼閻熸粎澧楃敮鎺撶娴煎瓨鐓曢柟鎯ь嚟濞插瓨銇勯姀鈭╂垹缂撴禒瀣窛濠电姴瀚獮妤呮⒑閻熸澘鎮戦柟顖氱焸瀹曞綊宕橀懠顒佹畷濠电偞鍨崹娲偂濞戙垺鐓曟繛鎴濆船閺嬨倗绱掗悩闈涗槐闁哄瞼鍠栭、娆撳箚瑜嶉獮瀣旈悩闈涗粶婵炲樊鍘奸锝夊礈娴ｇ懓纾梺闈浥堥弲婵嗙暦濠婂牊鈷掗柛灞剧懅椤︼箓鏌涢悢閿嬪仴妤犵偞鐗犻、鏇㈡晲閸滀礁娈奸梻浣告啞缁嬫帡骞嗗畝鍕瀬闁稿瞼鍋為悡鏇熴亜閹板墎鎮肩紒鐘筹耿閺屻劌鈽夊▎鎴炲垱濠殿喖锕ュ浠嬬嵁閹邦厽鍎熼柕蹇嬪焺濡差剟姊绘担渚劸闁挎洏鍊濋獮妤€顭ㄩ崟顓犲骄闂佸搫娲㈤崹娲吹閸愵喗鐓冮柛婵嗗閺嗙喖鏌ㄥ☉娆戠畺缂佺粯绋掑蹇涘礈瑜嶉崺灞筋渻閵堝骸浜濋柣妤冨█閵嗕線寮崼婵嬪敹闂佺粯妫佸〒褰掓偨婵犳碍鈷掑┑鐘查娴滄粍绻涚拠褍顩紒顔界懇楠炴帒螖娴ｉ晲绨甸梻浣虹帛濮婂綊骞冮懜鐢殿洸婵犲﹤鐗婇悡娆撴⒑椤撱劎鐣遍柡瀣洴閺岋紕鈧綆浜妤呮婢跺绡€濠电姴鍊绘晶銏ゆ煟閿濆洤鍔嬮柟渚垮妽缁绘繈宕ㄩ鍛摋闂備礁缍婇ˉ鎾寸箾閳ь剛鈧娲╃徊鎯ь嚗閸曨偆鏆嗗┑鐘插暟閸婄偤姊婚崒姘偓鐑芥嚄閸洍鈧箓宕奸妷顔芥櫈闂佸憡绋掑娆戠不閻樿崵鍙撻柛銉ｅ妽閳锋帡鏌嶉悷鎵㈤柍瑙勫灴閹晠宕ｆ径瀣€风紓鍌欒兌婵兘骞婇幘缁樼畳闂備焦瀵х换鍌炴偋濠婂喚鐒介柟閭﹀幘缁犻箖鏌涘☉鍗炴灓濠⒀呮暬閺岀喖顢欑粵瀣杹閻庤娲橀〃鍡楊嚗閸曨剛绡€濞达絽澹婂Λ婊堟⒒閸屾艾鈧绮堟笟鈧獮澶愭晸閻樿尙顦梺纭呮彧缁犳垹绮堟径灞稿亾閸忓浜鹃梺鍛婃处閸撴瑩鍩€椤掆偓閻忔岸濡甸崟顖氱闁瑰瓨绺鹃崑鎾绘嚒閵堝拋妫滈梺鑺ッˉ銏ｃ亹閹烘挻娅滈梺鍛婁緱閸犳稓娑甸埀顒佺節绾版ǚ鍋撻崘鑼獓濠碉紕鍋樼划娆忣嚕鐠囨祴妲堥柕蹇曞Т瀹撳棝姊洪棃娑辩劸闁稿酣浜堕敐鐐侯敂閸曘劍鏂€闂佺粯锕╅崰鏍倶椤忓牊鍋ㄦい鏍ㄣ仜閸嬫捇骞囨担鍦▉?
            if (currentOffhand.is(Items.TORCH)) {
                // 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ帒顦伴弲顏堟⒑閸濆嫮鈻夐柛妯恒偢瀹曟帡濡歌閸犳劙鏌ｅΔ鈧悧鍡欑箔閹烘鐓曢柕濞垮劚閳ь剙顭烽獮澶愬箹娴ｇ懓浜遍梺鍓插亝缁诲倿骞嗛悙鐑樷拺闁硅偐鍋涢崝鎾煕閹惧鎳囬柟閿嬪灴閹垽宕楅懖鈺佸妇濠电姰鍨煎▔娑㈡偋閸℃稑绀夋慨妯垮煐閻撴洟鎮楅敐搴濈敖閺佸牆鈹戦纭烽練婵炲拑绲垮Σ鎰板箳閹冲磭鍠栭幊锟犲Χ閸涱厽杈堥梻鍌氬€烽懗鍫曘€佹繝鍥舵晪婵犲﹤鎳忛～鏇㈡煛閸モ晛孝闁搞劍绻傞埞鎴︽偐鐎圭姴顥濈紓浣哄Ь濞呮洘绌辨繝鍥ч柛鏇ㄥ枛閸橈繝姊洪崨濞掕偐鍒掑▎蹇ｆ綎婵炲樊浜濋ˉ鍫熺箾閹达絼鍚柛鏃€鎮傚铏圭矙閸ф寮版繛瀛樼矊閻栧ジ濡存笟鈧顕€宕奸锝嗘珜濠电偠鎻徊浠嬪触閳ь剛绱掗妸銉吋婵﹥妞藉Λ鍐ㄢ槈鏉堛剱銈夋⒑缁嬪潡顎楁い顓炲槻椤曪綁濡搁埡鍌氭闂侀潧鐗嗛崐鍛婄妤ｅ啯鐓曟い顓熷灥娴滄繄绱掗懜鐢靛弨闁诡喗顨呴～婵嬵敇閻斿搫鍤掗梻浣风串缁插潡宕楀鈧獮濠傤煥閸愶絾鐏侀梺鍦焾瀹糕晞顦归柡宀€鍠栭幊婵嬫偋閸繃閿紓鍌欑劍瑜板啴鎮樺┑瀣仼濡炲娴烽惌澶愭煛閸ャ儱鐏柍?2)婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾剧粯绻涢幋娆忕労闁轰礁顑嗛妵鍕箻鐠虹儤鐎鹃梺鍛婄懃缁绘劙婀侀梺绋跨箰閸氬绱為幋鐘垫／闁诡垎鍕淮闂佸搫鐬奸崰搴ㄥ煝閹捐鍨傛い鏃傛櫕娴滃墽绱撻崒娆掑厡濠殿噣娼ц灋闁告劦鍠栭拑鐔哥箾閹寸偟鐓繛宀婁邯閺屾盯骞樺璇蹭壕婵犳鍠栧ú顓烆潖閾忓湱鐭欓柟绋垮瀹曟娊姊洪崫銉バｉ柣妤冨Т椤曪絾绻濆顓熸闂佺粯顭堢亸娆撍囬妸鈺傗拺闂傚牊渚楅悡顓炩攽閳ヨ櫕鍠樺┑鈥崇埣閸╋繝宕ㄩ瑙勫闂備胶顢婇崑鎰板磻濞戙垹鐒垫い鎺嶇劍缁€瀣寠濠靛鐓熼柕蹇嬪焺閻掗箖鏌﹂崘顏勬灈闁哄矉缍佸顒勫垂椤旇棄鈧垶姊虹粙娆惧剾濞存粍绻堟俊鐢稿礋椤栨艾鍞ㄩ梺闈浤涙担鎻掍壕闁圭儤顨嗛悡蹇涙煕閳╁喚娈ｇ€规悶鍎甸弻宥囨喆閸曨偆浼岄梺璇″枟閻熲晠骞婇悩娲绘晢濞达絿鎳撻弸娑㈡⒒閸屾瑧鍔嶉悗绗涘厾楦跨疀濞戞ê鐎繛瀵稿Т椤戝洤鐣垫笟鈧弻娑㈠箛闂堟稑瀛ｅ┑鈩冨絻椤嘲顫忛悜妯侯嚤婵炲棙鍨硅摫缂傚倷娴囬褏鈧矮鍗冲畷娲焵椤掍降浜滈柟鐑樺煀閸旂喓绱掓径灞炬毈闁哄本鐩獮妯尖偓闈涙啞閸掓盯鏌﹀Ο鑽ょ畺闁靛洤瀚板鏉懳旈埀顒佺閹€鏀芥い鏃傘€嬮弨缁樹繆閻愯埖顥夐柣锝囧厴婵℃悂鏁傞崜褏妲囬梻浣告啞濞诧箓宕戦崨顓涙灁闁革富鍘剧壕浠嬫煕鐏炲墽鎳嗛柛蹇撹嫰閳规垿顢欓悙顒佹瘓閻庤娲栫紞濠傜暦瑜版帩鏁婇柣鎰靛墯椤旀洟鏌ｉ悢鍝ョ煂濠⒀勵殘閺侇噣鍩￠崨顓熺€悗骞垮劚濡稓寮ч埀顒佺節閻㈤潧孝闁稿﹤缍婂畷铏鐎ｎ偆鍘介梺瑙勫劤閻°劑藟閸喐鍙忓┑鐘叉噺椤忕姷绱掓潏銊ョ瑨閾伙綁鏌ц箛娑掑亾濞戞瑯鏁囬梻鍌氬€烽悞锔锯偓绗涘懎鏋堢€广儱顦?
                if (getTier() >= 2) {
                    this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.OFFHAND, new ItemStack(Items.SHIELD));
                } else {
                    this.setItemSlot(net.minecraft.world.entity.EquipmentSlot.OFFHAND, ItemStack.EMPTY);
                }
            }
        }
    }
    // ==========================================
    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱槶閸ㄦ椽寮埀顒勬⒒娴ｈ櫣銆婃俊鐙欏洤鐤炬繝濠傜墱閺佸﹪鏌?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻娑樷攽閸曨偄濮夐梺绋款儐閹告悂锝炲┑瀣亗閹肩补妲呭楣冩⒒娓氣偓閳ь剛鍋涢懟顖涙櫠椤栫偞鐓熸い鎾楀啯鐝濋悗瑙勬穿缁绘繈鐛惔銊﹀癄濠㈣泛鐬奸弳顐ｇ節閻㈤潧浠滄俊顖氾攻缁傚秴鈹戠€ｎ亞锛涢梺鍛婃处閸ㄩ亶鎮￠弴鐔虹瘈闂傚牊绋掗ˉ婊勩亜韫囧﹥娅嗛柕鍥у瀵挳宕卞Δ浣割槱闂佹娊鏀遍崹鍧楀蓟閿濆绠婚柛鎰皺濡叉澘鈹戦悙璺轰汗闁哥姵鐗犲璇测槈濞嗘垹鐦堥梺鍛婂姉閸嬫捇鎮挎笟鈧幃妤冩喆閸曨剛顦ㄥ┑锛勫仒缁瑩鐛崘顔肩厸闁告劏鏅涢悵浼存⒑閼测斁鎷￠柛鎾跺枛閹即骞樼紒妯锋嫽婵炶揪绲块…鍫ニ夎箛娑欑厱閻庯綆浜濋崳浠嬫煙楠炲灝鐏茬€规洘锕㈤、娆愮附閸涘绱梻鍌欐祰瀹曠敻宕伴幇顓犵彾閻庯綆鍠栫紒鈺呮煠閹帒鍔樺ù婊勭矒閺岋繝宕堕埡浣锋勃闂侀潻绲鹃幃鍌氼潖濞差亶鏁囩憸宥夋倶閿濆鐓冪憸婊堝礈濮橀鏁婇柡宥庡幖闂傤垱銇勯弴妤€浜鹃悗瑙勬礃缁矂鍩ユ径鎰潊闁绘鏁搁弸鈧梻鍌欑濠€閬嶆惞鎼淬劌绐楅柡宥庡亞閻棝鎮楅敐搴′簴濞存粍绮撻弻鐔兼倷椤掍胶绋囧銈冨劜瀹€鎼佸蓟?
    // ==========================================

    // 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫宥夋煟閹邦厽缍戝ù婊堜憾濮婅櫣鍖栭弴鐐测拤缂備礁顑嗛崹鍦垝婵犳碍鍋愰悹鍥皺椤旀劕鈹戦悜鍥╃У闁告挻鐟╅幃姗€顢旈崼鐔哄幈濠电偛妫楃换鎺旂不閺屻儲鐓忛柛銉戝喚浼傜紓浣哄У閻╊垶鐛Ο鍏煎磯濞撴凹鍨卞鎴︽⒒閸屾瑧顦﹂柟纰卞亰楠炲繒鈧綆鍠栫粈鍫熸叏濡寧纭剧紒鐘靛仱閺屾洘绻涢崹顔煎闂佺粯姊婚…鍫㈡閻愮數纾奸悗锝庡亜椤曟粓鏌涙惔銏″磳婵﹦绮幏鍛存寠婢跺鐫忔俊鐐€ら崢濂告偋閹捐绠栭柕澶涘闂勫嫮绱掔€ｎ厼鍔甸柟鑺ユ礋濮婅櫣绱掑Ο娲绘⒖濠电偛鎷戠紞渚€骞嗙仦瑙ｆ瀻闁规儳顕崢鐢电磽娴ｅ壊鍎忛柣蹇旂箞椤㈡濮€閵堝棛鍘靛銈嗘⒒閺咁偊骞婇崶銊﹀弿濠电姴瀚崝瀣倵閻㈤潧甯堕柍璇查叄楠炲鎮╁Ο鑽ょ煂缂佽鲸鎸婚幏鍛村传閸曟埊缍侀弻锝呂旈崘銊㈡瀰闂佺粯渚楅崳锝呯暦濮椻偓椤㈡顦抽柍璇茬焸濮婄粯鎷呴搹骞库偓濠囨煛閸屾瑧绐旂€规洘绮岄埞鎴犫偓锝庝簽椤斿棝姊洪崨濠佺繁闁搞劑浜跺畷浼村幢濞戞瑧鍘遍梺鍝勬储閸斿本绂嶅鍐剧唵闁荤喐婢橀弳鐐电磼缂佹绠為柟顔荤矙濡啫霉閼哥數娲撮柡宀€鍠庨悾锟犲级閹稿孩顔掗柣搴ゎ潐濞插繘宕濋幋锔衡偓浣肝熺悰鈩冩杸闂佸壊鍋嗛崰搴ｇ矆鐎ｎ亖鏀?1 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓闁搞劌鍊块弻娑㈩敃閿濆棛顦ョ紓浣哄Т缂嶅﹪寮诲澶婁紶闁告洦鍋€閸嬫挻绻濆銉㈠亾閸涙潙鐭楀璺虹墔缁ㄥ妫呴銏″闁瑰憡鎮傞、鏃堝Χ婢跺鍘搁柣搴秵閸嬪懘藟閸儲鐓涢悘鐐靛亾缁€澶岀磼閻樺磭銆掗柍褜鍓ㄧ紞鍡樼閺嶎厼纾婚柟鎹愵嚙閸楁娊鏌ｅ鍡椾簻濞存粎鍋撻幈銊ヮ潨閸℃鈷掑┑鈽嗗灙閸嬫捇姊绘担鍛婃儓闁活厼顦辩槐鐐寸瑹閳ь剟鎮伴閿亾閿濆骸鏋熼柛濠勫厴閺屾盯鍩勯崗鐙€浜幃姗€骞橀鐣屽幍濡炪倖娲栧Λ娑氬姬閳ь剟姊虹化鏇熸澒闁稿鎸搁—鍐Χ閸℃鐟ㄩ柣搴㈠嚬閸欏啴宕哄☉銏犵婵°倓鑳堕崢閬嶆煟韫囨洖浠︾€规洘蓱缁旂喎螣濮瑰洣绨婚棅顐㈡搐閿曘儱鈻嶆繝鍥ㄧ厵妞ゆ梻鐡斿▓鏃€銇勯锝囩疄妞ゃ垺娲熸慨鈧柣妯煎仯閸嬫牠姊?
    private void addRandomEnchantment(ItemStack stack) {
        if (stack.isEmpty()) return;

        // 1. 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕閻庤娲忛崕鎶藉焵椤掑﹦绉甸柛鐘崇墱婢规洟宕稿Δ浣哄幍闂佽鍨虫晶妤吽夋径鎰闁哄鍩婇煬顒勬煛鐏炶鈧繈骞婂┑瀣妞ゆ棁鍋愭晶顖氣攽閻愯尙鎽犵紒顔肩灱缁辩偞绻濋崶褑鎽曞┑鐐村灟閸ㄧ懓鏁俊鐐€栧Λ浣哥暦閻㈢姹叉俊銈勮兌缁犻箖鎮楀☉娆樼劷闁活厼锕︾槐鎾愁吋閸滃啳鍚悗娈垮枛椤兘骞冮姀銈嗗亗閹艰揪绲块弳浼存煟閻斿摜鐭婄紒澶屾嚀椤曪綁鎼归锝囩Ф闂侀潧顭徊鑲╄姳婵犳碍鈷戦梻鍫熺〒婢ф洟鏌熼崘鑼鐎规洝娅曠粋鎺斺偓锝庡亞閸樻捇鎮峰鍕煉鐎规洘绮岄埢搴ょ疀閵夈劉鍋撻崸妤佲拺妞ゆ巻鍋撶紒澶樺櫍閸┾偓妞ゆ帒锕﹂悾鐢碘偓瑙勬礈閸樠囧煘閹达箑绠涙い鎺嶇贰閸氭瑩姊绘担钘夊惞濠殿喗鍎抽埢宥夋晲閸ワ妇鍓ㄩ梺闈浥堥弲婊堝吹閳ь剟姊洪崜鑼帥闁哥姵鎹囬崺鈧い鎺嶇缁楁帗銇勯锝囩疄闁轰焦鍔欏畷銊╊敆閳ь剟藟濮樿埖鈷掗柛灞剧懄缁佺増銇勯弴鐔哄⒌鐎规洝顫夌€靛ジ寮堕幋鐘崇劸闂備礁鎼ˇ浼村垂瑜版帒姹查柨鏇炲€归悡鐔兼煛閸愩劌鈧敻骞忛敓鐘崇厸濞达絽鎽滄牎缂備胶绮惄顖炵嵁鐎ｎ喗鍊风€瑰壊鍠楀▓娲⒒娴ｄ警鐒炬い鎴濇楠炴劙骞栨笟鍥ㄦ櫍闂佺绻掗崢褏娆㈤悙鐑樺€甸柨婵嗛婢ь喚鈧?
        Map<net.minecraft.world.item.enchantment.Enchantment, Integer> currentEnchants = EnchantmentHelper.getEnchantments(stack);

        // 2. 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾剧粯绻涢幋娆忕労闁轰礁顑嗛妵鍕箻鐠虹儤鐎鹃梺鍛婄懃缁绘﹢骞冨Δ鍛仺闁汇垻鍋ｉ埀顒€锕弻娑氣偓锝庡亝鐏忣參鏌嶉挊澶樻█妤犵偞甯￠獮妯尖偓鐢殿焾缂嶅啴姊婚崒娆愮グ妞ゆ洘鐗犲畷浼村箻鐠囪尙锛熼梻鍌氱墛缁嬫捇寮抽敃鈧埞鎴﹀磼濠婂海鍔搁梺鍛婎殕婵炲﹪寮婚敐澶婄疀妞ゆ挆鍐╂珱闂備礁鎲￠懝楣冨箠濡警娼栫紓浣诡焽缁♀偓闁硅偐琛ラ埀顒冨皺閻╁孩绻濋悽闈涗哗妞ゆ洘绮庣划濠氬箻閹颁礁娈ㄦ繝鐢靛У閼圭偓鍎梻浣哥－閹虫挾鑺遍柆宥呯；闁规崘顕х壕濂告煟閹邦垰钄奸柟鑺ユ礋濮婃椽妫冨☉杈€嗘繝纰樷偓铏枠鐎规洏鍨介獮鏍ㄦ媴閸忓瀚奸梻浣告啞閹告槒銇愰崘鈺冾洸婵犻潧鐗忕壕濂告偣閸ヮ亜鐨虹€涙繈鏌ф导娆戠М闁哄苯绉烽¨渚€鏌涢幘瀵告噰闁糕晝鍋ら獮瀣晜閼恒儲鐝梻浣告啞濞诧箓宕板Δ鍜佹晛婵°倕鎳忛埛鎴︽煕濠靛嫬鍔氶弽鈥愁渻閵堝啫濡奸柨鏇ㄤ簼娣囧﹪骞橀鐓庣獩闂佸搫顦伴崹褰掑储閹间焦鈷戦柛娑橈梗缁堕亶鏌涘Ο鍦煓閽樼喐绻濋棃娑卞剱闁抽攱鍨归惀顏堫敇閻愭潙顎涘┑鐐插悑閸旀瑩寮诲☉銏犵睄闁逞屽墮鐓ら柣鏂垮悑閸嬫ɑ銇勯弴妤€浜鹃梺绯曟杹閸嬫挸顪冮妶鍡楃瑨闁稿﹨宕垫竟鏇熺鐎ｎ偆鍘遍柣蹇曞仜婢т粙骞婇崨瀛樼厱闁哄倽娉曡倴缂備浇椴哥敮鐐哄焵椤掑﹦绉甸柛瀣闇夋い鏇楀亾闁哄瞼鍠栭、娑橆潩椤掑绱旀俊鐐€戦崹娲儎椤栫偛绠栨繛鍡樻尰閸ゆ垶銇勯幒鍡椾壕婵犳鍣梽鍕┍婵犲洦鍊锋い蹇撳閸嬫捇寮借閸熷懎鈹戦悩瀹犲缁炬儳顭烽弻鐔兼倷椤掑倹娈繛瀛樼矋缁捇寮婚妸鈺佺睄闁搞儴娉涘▓顓㈡⒑鐠囨煡鐛滃┑鈥虫喘閸┾偓妞ゆ帒鍠氬鎰箾閸欏鐭掔€殿噮鍋呯换婵嗩潩閵夈垹浜惧ù锝呭濞笺劑鏌嶈閸撴岸骞堥妸鈺佺劦妞ゆ帒瀚悡鍐煏婢跺牆濡介柣婵愪邯閺岋綁鏁愭径澶嬪枤濠殿喖锕︾划顖炲箯閸涱噮妲归幖瀛樼箚椤╊偆绱撻崒娆愮グ鐎殿喗鎸鹃崚鎺戔枎韫囷絽娈ㄩ梺姹囧灩婢瑰﹪寮崱娑欑厱闁哄洢鍔屾禍婵嬪级閸繄澧︽俊顐㈡嚇椤㈡洟濮€閳ユ剚妲辩紓鍌欑椤戝棛鏁敓鐘茬畺?
        List<net.minecraft.world.item.enchantment.Enchantment> possible = new ArrayList<>();
        for (net.minecraft.world.item.enchantment.Enchantment ench : net.minecraftforge.registries.ForgeRegistries.ENCHANTMENTS) {
            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴姘辩Т闂佹悶鍎洪崜锕傚极閸愵喗鐓ラ柡鍥殔娴滈箖姊虹紒妯虹瑨闁诲繑宀告俊鐢稿礋椤栨氨顔婇梺绯曞墲閵囩偞绔熼弴銏＄厽閹兼番鍩勯崯蹇涙煕閻樺磭澧甸柟顔哄劜缁轰粙骞栭悙鈺佷壕濞撴埃鍋撶€殿喗鎸抽幃銏＄瑹椤栨稓銈梻浣筋嚙閸戠晫绱為崱娑樼；闁糕剝绋戦惌妤呮煕閳╁啨浠滈柡鈧禒瀣厽闁归偊鍘界紞鎴︽煟韫囥儳鐣甸柡宀嬬秮閹倝宕掑鍛闂備浇顕栭崹浼村疮閹绢喚宓侀悗锝庝簴閺€浠嬫煙闁箑鏋涢柡浣规倐閺岋綁鎮㈤崫銉х厐缂備礁顦伴幐鎶藉灳閿曞倸鐐婃い鎺嗗亾闁诲繐纾埀顒冾潐濞叉牕煤閿曗偓閳绘捇骞嗚濞撳鏌曢崼婵囶棞濠殿啫鍛＜闁肩⒈鍓欐禍楣冩煕閹烘埊韬鐐达耿椤㈡瑩鎸婃径澶屾暰濠电姷鏁搁崑娑樜涘Δ鍐╁床闁逛即鍋婇弫鍌涖亜韫囨挻鍣界紒鐘荤畺閺屾盯顢曢敐鍥╃厐閻庤鎸稿Λ娆撳箞閵婏妇绡€闁搞儮鏅濈粣妤呮⒑闂堟稒澶勯柛鏃€鐟╅悰顕€骞掑Δ鈧粻濠氭倵閻㈡鐒剧紒鈧担绯曟斀闁绘ê鐏氶弳鈺呮煕鐎ｎ剙浠滄い顓炴搐閳诲骸顕ュ┑鍥ㄣ仢濠碘剝鎮傞崺鈩冩媴娓氼垰鏁奸梻鍌欑窔濞佳呮崲閸儱纾归柡鍥ュ灩缁€鍐煃瑜滈崜鐔奉潖濞差亝顥堟繛娣€栭惄顖炲春閳ь剚銇勯幒鎴濐仼闁告垹濞€閺屸€崇暤椤斿吋婀伴悗闈涚焸濮婃椽妫冨☉姘暫闂佺娅曢崝妤冨垝缂佹ê顕遍悗娑欘焽閸樿棄鈹戞幊閸婃劙宕戦幘缁樼叆闁哄洢鍔嬮柇顖炴煏閸℃洜绐旀鐐达耿楠炲洦鎷呴崨濠傗偓顖氣攽閻橆喖鐏辨繛澶嬬洴椤㈡牠宕堕鈧惌?&& 闂傚倸鍊搁崐宄懊归崶褏鏆﹂柣銏㈩焾缁愭鏌熼柇锕€鏋涢柛銊︾箞楠炴牕菐椤掆偓閻忣亝绻涢崨顖毿ｅǎ鍥э躬婵″爼宕ㄩ鍏碱仩缂傚倷鑳舵慨鎶藉础閹惰棄钃熸繛鎴炃氬Σ鍫熸叏濡も偓閻楀﹪寮幆褉鏀介柣鎰级閸ｈ棄鈹戦悙鈺佷壕闂備礁鎼惌澶屽緤閸婄喓浜介梻浣哄帶椤洟宕愰幋锕€纾婚柣鎰劋閳锋垿鏌涘┑鍡楊伀闁绘帟娉曠槐鎺楁偐閾忣偄纾抽悗娈垮枦椤曆囶敇閸忕厧绶炲┑鐘插楠炴劕鈹戦悙鑸靛涧缂佽弓绮欓獮澶愬灳閺傘儲鐏侀梺鑲┾拡閸撴稓澹曢挊澹濆綊鏁愰崨顔藉創闁哄稄绻濋弻锝夊閳轰胶浠氶梺閫炲苯澧柛鎾村哺瀹曠敻寮撮姀锛勫幈濡炪倖鍔х徊鍓х矆閳ь剟姊虹紒妯诲鞍闁烩晩鍨跺璇测槈濮橆偅鍕冮梺鍛婃寙閸涱垰甯掗梻鍌欑窔濞艰崵寰婃繝姘？闂傚牊渚楀鏍磽娴ｈ偂鎴炲垔鐎靛摜纾奸悗锝庡幗绾泛螖閻樺弶宸濈紒杈ㄦ尰缁楃喖宕惰閻忓秹姊洪悷鐗堝暈闁诡喖鍊块弫鎰版倷閸撲胶鏉搁梺鍝勫暙閸嬪棗霉閸曨垱鐓熼幖鎼灣缁夐潧霉濠婂懎浠遍挊婵嬫煛婢跺鍎ユ繛鎾愁煼閺屾洟宕煎┑鍥舵￥婵犫拃灞藉缂佽鲸甯￠、娆撴嚃閳诡儸鍕垫?&& 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓闁搞劌鍊块弻娑㈩敃閿濆棛顦ョ紓浣哄С閸楁娊寮诲☉妯锋斀闁告洦鍋勬慨銏ゆ⒑濞茶骞楅柟鎼佺畺閸┾偓妞ゆ帒鍠氬鎰箾閸欏澧悡銈夋煏婵炑冩噸缁楀姊洪崫鍕殭闁稿﹦鏁诲畷鎴﹀箻鐠囪尙顦ф繝銏ｆ硾閿曪絾绔熼弴銏♀拻濞达絽鎲￠崯鐐寸箾鐠囇呯暤鐎规洘绮岄埢搴ㄥ箛椤曞懏绁梻渚€娼х换鍫ュ磹閺嶎厼鐓曢柟瀵稿Х绾捐棄霉閿濆洦顏熷〒姘⊕缁绘盯宕奸悢鍓叉闂佸搫鐭夌徊鍊熺亙闂侀€炲苯澧撮柡浣稿暣閺佸倿骞嗚閻忓﹥绻濋悽闈浶ｉ柤鐟板⒔缁鎼归锛勭畾闂侀潧鐗嗙€氼垶顢欐径鎰厵鐎瑰嫰鍋婇悡鍏兼叏婵犲啯銇濈€规洏鍔嶇换婵嬪礃椤垶袩闂傚倷鑳堕…鍫ヮ敄閸涱垪鍋撳顐㈠祮闁靛棔绶氬顕€宕奸锝嗘珝闂備線娼ф蹇曟閺囥垹鍌ㄥù鐘差儐閳锋垿鏌熺粙鎸庢崳闁宠棄顦甸幃妤€顫濋悡搴♀拫閻庢鍠氶…鍫ュ煡婢跺娼╅柨婵嗘噸婢规洟鏌ｉ悢鍝ユ噧閻庢凹鍘剧划鍫ュ礃椤旂晫鍙嗛梺鍝勬处閿氶柣蹇撳级椤ㄣ儵鎮欑拠褑鍚梺璇″枓閺呮稓鍙呯紓鍌欑劍钃辨繛鍛焸濮婄粯鎷呮笟顖滃姼闂佸搫鐗滈崜娆擄綖濠靛惟闁冲搫鍊瑰▍?
            if (ench.canEnchant(stack) && !currentEnchants.containsKey(ench)) {
                boolean compatible = true;
                for (net.minecraft.world.item.enchantment.Enchantment existing : currentEnchants.keySet()) {
                    if (!ench.isCompatibleWith(existing)) {
                        compatible = false;
                        break;
                    }
                }
                if (compatible) possible.add(ench);
            }
        }

        // 3. 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紓浣哄Х婵炩偓妤犵偞鐗楀蹇涘礈瑜忚摫闁诲氦顫夊ú姗€鎮￠敓鐘茶摕闁绘棁銆€閸嬫挸鈽夊▎妯煎姺婵犵鈧櫕鍠橀柡宀嬬節閸┾偓妞ゆ帒瀚弲婵嬫煕鐏炲墽銆掗柛妯绘崌閹嘲顭ㄩ崟顓犵厜閻庤娲樼划鎾诲箖閵忋倖鍋傞幖娣€栭幉浼存⒒娴ｈ櫣甯涙慨濠傤煼瀹曘垼顦叉い鏂跨箰閳规垿宕辫箛鏃€鏉搁梻浣虹帛钃辩憸鏉垮暣閸┾偓妞ゆ帒鍊荤敮娑氱磼閸屾稑娴い銏＄☉椤劑宕ㄩ銈囬棷婵犵數鍋犻幓顏嗙礊閳ь剚銇勯銏╂█闁诡噯绻濇俊鐑藉煛閸屾粌骞楅梺鍦劋婵炲﹤鐣峰┑鍥ㄥ劅闁挎繂鎳庨悘濠傗攽閻愬弶顥為柛鏃€娲滃▎銏ゆ倷閻戞鍘甸梺鍝勵槼濞夋洘绂掑☉銏＄厸闁告侗鍠氶惌鎺撴叏婵犲啯銇濈€规洏鍔嶇换婵嬪礃椤垶袩闂傚倷鑳堕…鍫ヮ敄閸℃瑦鏆滈柟鐑樸仜閳ь剨绠撳畷鍫曞Ω閿斿墽肖闂備線娼ц噹闁告粈绀侀弲顓㈡⒒閸屾瑨鍏岄柟铏崌椤㈡岸顢橀姀鐘碉紱闂佺粯鍔曢崥鈧柣鎺戯攻閵囧嫰骞橀崡鐐典痪闂佺粯鎸堕崕鐢稿蓟閿熺姴鐐婃い顓烆儛娴滎亪宕洪埀顒併亜閹哄秷鍏岀紒鐘靛仱閺?
        if (!possible.isEmpty()) {
            net.minecraft.world.item.enchantment.Enchantment pick = possible.get(this.random.nextInt(possible.size()));
            stack.enchant(pick, 1); // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎺嶇劍椤斿洦绻濆閿嬫緲閳ь剚娲熷畷顖烆敍濮樿鲸娈鹃梺鍝勮閸庢煡鎮￠弴鐘亾閸忓浜鹃梺閫炲苯澧寸€规洘娲熼獮瀣偐閻㈡妲搁梻浣告惈缁嬩線宕㈡禒瀣亗婵炲棙鎸婚埛鎴炪亜閹惧崬濡块柣锝変憾閺岋紕鈧絻鍔岄埀顒佹礋閳ユ棃宕橀钘変画闂佸搫顦扮€笛冃掗幇顒夋富闁靛牆楠稿銊︾箾婢跺绀嬫鐐村灴瀹曠喖顢涘☉娆忓姃闂備線娼荤€靛矂宕㈤崗鍏煎弿闂侇剙绉甸埛?1
        }
    }

    // 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫宥夋煟閹邦厽缍戝ù婊堜憾濮婅櫣鍖栭弴鐐测拤缂備礁顑嗛崹鍦垝婵犳碍鍋愰悹鍥皺椤旀劕鈹戦悜鍥╃У闁告挻鐟╅幃姗€顢旈崼鐔哄幈濠电偛妫楃换鎺旂不閺屻儲鐓忛柛銉戝喚浼傜紓浣哄У閻╊垶鐛Ο鍏煎磯濞撴凹鍨卞鎴︽⒒閸屾瑧顦﹂柟纰卞亰楠炲繒鈧綆鍠栫粈鍫熸叏濡寧纭剧紒鐘靛仱閺屾洘绻涢崹顔煎Ф濠电偟顑曢崝鎴﹀蓟濞戙垹鐒洪柛鎰亾閻ｈ泛顪冮妶搴′簮闁哄懏绻勫Σ鎰板箳濡や礁鈧攱銇勯幒鍡椾壕闂佸憡鏌ｉ崐妤呮儉椤忓棛纾奸柕蹇曞Т缁犺鈹戦垾鍐茬骇闁告梹鐟╅悰顕€骞掗幊铏⒐閹峰懘姊归幇顓熺窔婵犵數濮烽弫鎼佸磻濞戞娑樜旈崘鈺佸簥闂佸湱澧楀妯盒ч崣澶岀闁糕剝锚閻忓秹鏌涚€ｎ偅灏柍缁樻崌瀹曞綊顢欓悾灞奸偗濠电姷鏁搁崑娑㈡儍閻戣棄鐒垫い鎺嶈兌缁愮偞绻涢幋娆忕仼鐎瑰憡绻堥弻鐔哄枈閸楃偛绠洪梺鍝勬噷閸ㄨ櫣鎹㈠┑瀣潊闁挎繂妫涢妴鎰版⒑閹稿孩绌跨紒鎻掓健閹崇偤鏌嗗鍛槯闂佸吋绁撮弲婵嬫儊閸儲鈷戦柛鎰皺濞堥亶鏌涚€ｎ偅宕岄柡灞剧洴楠炲洨鍠婂Ο杞板濡炪倖鐗曞Λ妤呭箠婢舵劕纾婚柟鐐灱閺嬫棃鏌涢…鎴濇灍闁诲繐鐗撳铏规嫚閼碱剛顔夐梺鐓庣秺缁犳牠銆佸璺何ㄩ柍杞拌兌椤︽澘顪冮妶鍡楃瑐缂佲偓娓氣偓瀹曟繈宕ㄩ褎瀵岄梺闈涚墕濡瑩鍩涢幒妤佺厽闁斥晛鍟悡銉╂懚閻愮儤鐓曟繛鎴濆船楠炴劙鏌￠埀顒佺鐎ｎ偆鍘藉┑顔筋殔濡寮稿☉銏＄厽闊洦宀搁崫铏圭磼缂佹鈯曠€垫澘瀚埀顒婄秵閸忔ê危閸儲鐓熼柟鎯у船閳ь剚绻堝濠氬即閻旇櫣顔曢梺鍓茬厛閸犳牗鎱ㄦ径鎰拺闁告繂瀚烽崕鎰繆椤愩垹鏆ｇ€殿喖顭烽幃銏ゅ川婵犲嫮肖濠德板€х徊浠嬪疮椤栫儐鏁佺€广儱顦伴埛鎴︽煙閹澘袚闁轰浇椴告穱濠囶敃閵忕姵娈婚悗娈垮枦椤曆囧煡婢舵劕顫呴柣妯诲絻缁侇噣姊绘笟鈧褔鈥﹂崼銉ョ？闁惧浚鍋嗛々閿嬨亜閺嶎偄浠﹂柍閿嬪灩閻ヮ亪顢橀悙鏉戞閻炴碍鑹鹃埞鎴︽倷閹绘帞楠囩紓渚囧枛妤犵宓勯梺鍦濠㈡绮婚幎鑺ョ厵閻庢稒蓱閳锋劖銇勯銏⑿㈤柍瑙勫灴椤㈡瑧绮电€ｎ偆鏆ユ繝纰樻閸嬪懘鎮烽敃鍌樷偓鍐ㄢ枎閹邦喚鐦?
    private void upgradeAllEquipmentLevels() {
        net.minecraft.world.entity.EquipmentSlot[] slots = {
                net.minecraft.world.entity.EquipmentSlot.MAINHAND,
                net.minecraft.world.entity.EquipmentSlot.HEAD,
                net.minecraft.world.entity.EquipmentSlot.CHEST,
                net.minecraft.world.entity.EquipmentSlot.LEGS,
                net.minecraft.world.entity.EquipmentSlot.FEET
        };

        for (EquipmentSlot slot : slots) {
            ItemStack stack = this.getItemBySlot(slot);
            if (stack.isEmpty() || !stack.isEnchanted()) continue;

            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕閻庤娲忛崕鎶藉焵椤掑﹦绉甸柛鐘崇墱婢规洟宕稿Δ浣哄幍闂佽鍨虫晶妤吽夋径鎰闁哄鍩婇煬顒勬煛鐏炶鈧繈骞婂┑瀣妞ゆ棁鍋愭晶顖氣攽閻愯尙鎽犵紒顔肩灱缁辩偞绻濋崶褑鎽曞┑鐐村灟閸ㄧ懓鏁俊鐐€栧濠氬储瑜旈敐鐐侯敂閸啿鎷洪梺瑙勫劶婵倝寮潏銊ょ箚妞ゆ劑鍨归弳锝団偓娈垮枦椤曆囧煡婢舵劕顫呴柣妯诲絻缁侇噣姊绘笟鈧褔鈥﹂崼銉ョ？闁惧浚鍋嗛々閿嬨亜閺嶎偄浠﹂柍閿嬪灩閻ヮ亪顢橀悙鏉戞閻炴碍鑹鹃埞鎴︽倷鐠鸿櫣姣㈤梺鍝ュУ閻楁洟顢氶敐鍥ㄥ珰婵炴潙顑嗛～宥夋⒑闂堟稓绠冲┑顔惧厴椤㈡瑦绻濋崶銊㈡嫼闂佽崵鍠愭竟鍡樼閵忋倖鐓曢柣鏇氱閻忥箓鏌熼鎯т壕缂佸倹甯為埀顒婄秵閸嬧偓闁?-> 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛濠傛健閺屻劑寮崹顔规寖闂佹椿鍘介悷鈺呭蓟閻斿皝鏋庨梽鍥敋瑜嶇叅闁挎洍鍋撴い顓炴穿缁犳稑鈽夐幒鍡椾壕闁挎洖鍊哥粻锝夋煟閹存繃顥滈柡?1 -> 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柤纰卞墻濡茬兘姊绘担鍛婃儓缂佸绶氬畷銏＄鐎ｎ亞锛涢梺璺ㄥ枔婵敻鎮¤箛鎿冪唵閻犻缚娅ｆ晶鏇㈡煕閹垮啫骞楃紒缁樼☉椤斿繘顢欓懡銈囨晨闂備礁鎲￠崝蹇涘磻閹剧繝绻嗛柣鎰典簻閳ь剚鐗犻獮鎰偅閸愩劎鐛ラ柟鍏肩暘閸ㄥ銆呴弻銉︹拺妞ゆ巻鍋撶紒澶屾暬閸╂盯骞嬮敂钘夆偓鐢告煕閿旇骞栭弽锟犳⒑闂堟稒顥滈柛鐔告尦瀵鏁愭径濠勵唺闂佺粯鍔楅弫鎼佸汲閵堝憘?
            Map<net.minecraft.world.item.enchantment.Enchantment, Integer> enchants = EnchantmentHelper.getEnchantments(stack);
            for (Map.Entry<net.minecraft.world.item.enchantment.Enchantment, Integer> entry : enchants.entrySet()) {
                int newLevel = entry.getValue() + 1;
                // 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫鍐煥閺囨浜鹃梺姹囧€楅崑鎾舵崲濠靛洨绡€闁稿本绮岄·鈧梻浣侯焾椤戞垹鎹㈠┑瀣摕鐎广儱顦导鐘绘煕閺囥劌澧繛鍜冪秮濮婂宕掑顑跨敖闂佹悶鍔岄悥鐓庮嚕婵犳碍鏅插璺猴功椤撴椽姊洪幐搴ｇ畵婵☆偒鍘艰灋闁告洦鍨遍埛鎴炵箾閼奸鍤欐鐐搭殕閵囧嫰濡搁妷锔绘＆婵犵绱曢弫璇茬暦閻旂⒈鏁嶆慨姗嗗墮閺併倝姊绘笟鈧褑鍣归梺鍛婃处閸嬪懘鎮甸敍鍕＝闁稿本鑹鹃埀顒傚厴濮婅棄顓兼径濠勵槷闁诲函缍嗛崰鏍兜閳ь剟姊虹憴鍕姸婵☆偄瀚划濠氬冀椤撶喎浠┑鐐叉缁绘劙顢旈鍕ㄦ斀妞ゆ牗鍑归崵鐔虹磼鏉堛劌绗ч柍褜鍓ㄧ紞鍡樼閻愬樊娼╅柕濞炬櫆閻撴瑧绱掔€ｎ亞浠㈤柡鍡稻閹便劍绻濋崒娑欏創闁轰礁鐗撻弻娑㈠Ψ閹存柨浜鹃梺绋款儐閹瑰洤顕ｉ幘顔藉€风€广儱妫涢埥澶愭煃鐠囨煡鍙勬鐐差儔閹晠鎮介棃娑樼畾濠电姷鏁告慨浼村垂婵傜鏄ラ柡宥庡幖缁€澶愭煥閺囩偛鈧悂寮告笟鈧弻娑樼暆閳ь剟宕戦悙鐑樺亗闁哄洢鍨洪悡娆撴煛婢跺﹦浠㈤柟顔昏兌缁辨帡濡搁妶鍥╃厯闂佸搫鐬奸崰搴敊韫囨侗鏁婂┑鐘宠壘娴犳劖绻濆▓鍨灈闁挎洏鍊濋垾锕€鐣￠幍顔芥闂佸湱鍎ら崺鍫濐焽閳哄倶浜滈柟鐑樺焾濡茬兘鏌ｉ妷顔婚偗婵﹦绮幏鍛村川婵犲倹娈橀梻浣告惈椤戞劙宕抽敐鍛殾闁靛ň鏅╅弫瀣煕濞戝崬鏋ょ紒瀣姇閳规垿鎮╅崹顐ｆ瘎婵犵數鍋愰崑鎾斥攽閻愭澘灏冮柛銉戝棙鎲板┑鐘垫暩婵潙煤閵堝洨涓嶉柧蹇ｅ亗缁诲棝鏌曢崼婵嗏偓鍛婄閹€鏀介柍钘夋娴滄繈鎷戞潏鈺冪＜缂備焦顭囧ú瀵糕偓瑙勬礀瀹曨剟鍩㈡惔銈囩杸閹肩补妲呭Λ婊堟⒒?10缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛銈呭閺屾盯骞橀懠棰濆敼闂佺顑嗛幐鎼侊綖濠靛鏁嗛柛灞剧矤閸炶埖淇婇悙顏勨偓鏍箰閹间礁围缂佸娉曢弳锕傛煕椤愶絾绀€闁绘挻绋戦埞鎴︽偐閹绘帗鏆橀梺闈涱槴閺呮粓鍩涢幒妤佺厱閻忕偞宕樻竟姗€鏌嶈閸撴岸骞冮崒姘辨殾闁圭増婢樼粻鐟懊归敐鍛喐闁哄苯鐗嗛—鍐Χ閸℃顫囬梺绯曟櫅鐎氭澘鐣烽悽绋垮嵆闁靛骏绱曢崢鍗烆渻閵堝棗濮х紒鑼亾瀵板嫰宕熼娑氬幐婵炶揪绲介幉锟犓夐悙鐢电＜缂備焦顭囧ú瀛橆殽閻愬樊鍎旈柟顔界懇瀹曟﹢鍩℃担鍛婃嚈闁诲孩顔栭崰鎾诲礉閹达箑鏋侀柛鎰靛枛绾惧吋绻涢幋鐐跺閻㈩垶绠栧缁樼節鎼粹€茬盎濠电偠顕滅粻鎴犲弲闂佸搫璇為崨顔藉櫑濠电姷鏁告慨鐢割敊閺嶎厼闂い鏍ㄧ矊缁躲倕霉閻樿尙鎳侀柛銉墯閻掕偐鈧箍鍎遍幊鎰板礉閿曗偓椤啴濡堕崱妤冪懆闂佸摜濮甸懝楣冣€﹂崶顒€绠涙い鎾跺Х椤旀洟姊洪崷顓犲笡閻㈩垳鍋為弲銉╂煟鎼淬埄鍟忛柛鐘愁殙閵囨劙宕橀鍏夊亾閿曞倸惟闁宠桨鑳堕ˇ銊╂⒑閸忕厧澧柛顭戜邯瀹曟垿骞樼拠鏌ユ暅濠德板€撻懗鍫曞储闁秵鈷戦梻鍫熶緱濡牓鏌涢悩宕囧闁哄懎鐖奸、娑㈡倷鐎电骞愰梻浣告啞缁牏绮堟担瑙勬珷闁圭虎鍠楅悡娆愩亜閺冣偓閺嬪鎳撻崸妤佺厵妞ゆ梻鏅幊鍥┾偓娈垮枛閻栧ジ鐛€ｎ亖鏀介柛鐘靛閸ㄥ灝顫忕紒妯诲缂佹稑顑呭▓顓犵磽娴ｈ櫣甯涢柛銊ユ健婵℃挳宕橀埡鍐槇闂佹悶鍎滈崱妯诲暫闂傚倷绶氬褔鎮ч崱娴板洭顢涘鍛紡閻熸粍妫冨濠氭偄閾忓湱鐓撻梺绉嗗嫷娈㈤柍褜鍓氶〃鍡欐崲濞戙垹宸濇い鎰╁灮娴煎嫮绱撴担浠嬪摵闁圭顭烽獮蹇涘川椤栨稑鐝伴梺鏂ユ櫅閸熶即寮抽妷锔跨箚闁绘劦浜滈埀顑懐涓嶉柟鎯ь嚟椤╂煡鏌涢锝嗙鐎规挷绶氶悡顐﹀炊閵婏妇锛曢梺绋款儐閹瑰洭寮幇顓熷劅闁斥晛鍟版禍顏堟⒒娴ｈ銇熼柛妯圭矙閵嗗啯绻濋崶褑鎽曢梺鍝勬川閸犳捇鎮甸懜鐐逛簻闁哄秲鍔庨。鏌ユ煕閿濆棙銇濋柡灞剧洴閹垻鎹勯崫鍕偖婵犳鍠栭敃銈夆€﹀畡鎵殾闁圭儤鍩堝鈺傘亜閹达絾顥夊ù婊堢畺閺屾稑鈹戦崟顐㈠闂佺顑嗛幐鎼侊綖濠靛鍋傞幖杈剧磿閻嫰鏌ｆ惔銈庢綈婵炲弶顭囬幑銏ゅ磼濠靛牅绨烽梻鍌欑閹测剝绗熷Δ鍛偍闁芥ê锛夐敐澶樻晢闁告洦鍏橀幏娲⒒閸屾氨澧涢柛鎰吹濡叉劙鏁撻悩宕囧幈闁诲繒鍋涙晶浠嬫儗婵犲偆鐔嗙憸鏃傜不閺嵮屾綎缂備焦蓱婵挳鏌涘☉姗堝伐闁哄棗鐗嗛—鍐Χ閸愩劌顬堥梺缁橆殕閹告悂鎮鹃悜钘夌闁挎棁妫勬禍婊堟⒑缂佹ɑ灏悗娑掓櫆濞煎繘宕煎┑鍐╂杸濡炪倖姊归弸缁樼瑹濞戙垺鐓曢幖鎼枙闁垶鏌熼鎯у幋闁哄苯娲弫鍌炲箚瑜嶅Ч鏌ユ⒒閸屾瑧顦﹂柟璇х節瀹曟繈寮介鐐碉紵闂佽鍎煎Λ鍕矆閸喆浜滈柡鍌氱仢閳锋梻鐥?
                if (newLevel <= 10) {
                    entry.setValue(newLevel);
                }
            }
            EnchantmentHelper.setEnchantments(enchants, stack);
        }
    }

    // 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫宥夋煟閹邦厽缍戝ù婊堜憾濮婅櫣鍖栭弴鐐测拤缂備礁顑嗛崹鍦垝婵犳碍鍋愰悹鍥皺椤旀劕鈹戦悜鍥╃У闁告挻鐟╅幃姗€顢旈崼鐔哄幈濠电偛妫楃换鎺旂不閺屻儲鐓忛柛銉戝喚浼傜紓浣哄У閻╊垶鐛Ο鍏煎磯濞撴凹鍨卞鎴︽⒒閸屾瑧顦﹂柟纰卞亰楠炲繒鈧綆鍠栫粈鍫熸叏濡寧纭剧紒鐘靛仱閺屾洘绻涢崹顔煎Ф濠电偟顑曢崝鎴﹀蓟濞戙垹鐒洪柛鎰亾閻ｅ爼鏌ｆ惔銏犲枙缂佽弓绮欓崺鐐哄箣閿旂粯鏅╃紒缁㈠幘閺屽宕ラ銈囩＝濞达絽鎼牎闂佺粯顨堟慨鎾敋閿濆棛绡€婵﹩鍘藉▍鏍⒑閸涘﹥澶勫ù婊勭箞瀹曠喖宕橀鐣屽幗闂佺粯锚瀵埖寰勯崟顓熷枑闁哄鐏濋弳鐐烘煙娓氬灝濮傜€殿喗鎸抽幃娆撳煛閸屾稒婢戦梻鍌欒兌閸嬨劑宕曢柆宥呯柈閻犳亽鍔庡Λ顖滄喐閺冨牆钃熼柣鏃傗拡閺佸﹪鏌ｉ幘宕囧哺闁稿鎹囬獮鏍ㄦ媴閻熼鎮ｉ梻浣虹帛閸ㄧ厧螞閸曨偅鏆滈梻鍌欑閸熷潡骞栭锕€纾归柣鐔稿閺嬪秹鏌涢妷顔煎闁抽攱鍨垮娲敃閵堝懍绮堕梺鍏兼た閸ㄩ亶寮查崜浣插亾閻㈢數銆婇柛瀣尵閹叉挳宕熼鍌楁晬缂傚倸鍊哥粔顕€宕戦幘鍓佺＝濞达絽鎼牎缂備礁顑嗛崹鍧楀春閵夛箑绶炲┑鐘插閸嶉潧顪冮妶鍡楀潑闁稿鎸剧槐鎺楁嚑椤掆偓娴滄儳菐閸パ嶈含闁诡喗鐟╅、鏃堝礋閵娿儰澹曢梺鍝勭▉閸樿偐绮堟径鎰厵閺夊牆澧介悾杈╃棯閹勫仴闁哄本绋戦埞鎴﹀幢濡ゅ啫鍑犳繝鐢靛仦閸垶宕归悷閭﹀晠婵犻潧娲㈡禍婊堟煙閻愵剦娈旈柟鍐查叄瀵偊骞栨担鍏夋嫼闂佺厧顫曢崐鏇㈢€锋繝鐢靛仜閹锋垹绱炴担鍝ユ殾闁哄洢鍨瑰洿婵犮垼娉涢敃锕傛偘閵夈儮鏀芥い鏂款潟娴犳粓鏌涚€ｎ偅宕岄柡宀嬬磿娴狅箓宕滆閻忚京绱撴担鍝勑ｉ柣鈺婂灠椤曪綁顢氶埀顒勭嵁濮椻偓瀹曟寰勬繝浣割棜闂佽崵濮垫禍浠嬪礉婢舵劕纾婚柟鐐灱閺嬫棃鏌涢…鎴濇灍闁诲繐鐗撳铏规嫚閼碱剛顔夐梺鐓庣秺缁犳牠銆佸璺何ㄩ柍杞拌兌椤︽澘顪冮妶鍡欏婵ǜ鍔戦幃鍧楀焵椤掍椒绻嗛柣鎰典簻閳ь剚鐗犻獮鎰板幢濞戞鍔﹀銈嗗笒鐎氼剛澹曟繝姘厵闁绘劦鍓欐晶顖炴煕濮橆剦鍎旈柡灞剧☉椤劑鍩€椤掑嫭鍊块柨鏇炲€哥壕濠氭煏婢跺棙娅嗛柍閿嬪灴閺屾稑鈽夊鍫熸暰婵犮垼娉涚€氫即寮诲☉銏犵闁哄鍨甸幗鐢告煢濡厧鏋涢柡灞糕偓鎰佸悑閹肩补鈧尙鏁栫紓浣哄亾閸庢娊濡剁粙娆惧殨闁割偅娲栭柋鍥ㄧ箾閹寸伝顏堚€栫€ｎ喗鈷戦柣鐔告緲閺嗛亶鎮楀鐓庢灓婵″弶鍔欓獮鎺楀棘閸濆嫪澹曢梺鎸庣箓缁ㄥジ骞夐悙顑跨箚闁圭粯甯楅崯鐐烘煏閸パ冾伃妤犵偞锕㈠畷姗€宕ｆ径濞惧亾椤栫偞鍊甸柛顭戝亝缁舵煡鎮楀鐓庢珝闁糕斁鍋撳銈嗗笒閿曪箑鐣濆☉銏＄厸闁告侗鍠氱粻姗€鏌℃笟鍥ф灈闁宠棄顦垫慨鈧柍閿亾闁归攱妞藉娲偂鎼搭喗缍楅梺绋匡攻濞茬喎顕ｉ幖浣哥闁绘劗鏁搁鏇㈡⒑閸涘﹦鎳冩い锔诲灦閹﹢骞橀鐣屽幍濡炪倖姊归崕铏闁秵鐓涘ù锝囶焾閺嗭綁鏌涢埞鎯т壕婵＄偑鍊栫敮鎺斺偓姘卞厴瀵?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓闁搞劌鍊块弻娑㈩敃閿濆棛顦ョ紓浣哄Т缂嶅﹪寮诲澶婁紶闁告洦鍋€閸嬫挻绻濆銉㈠亾閸涙潙绠甸柟鐑樼箖鐎靛矂鏌ｆ惔顖滅У濞存粍绮撻、妤呭鎺虫禍婊勩亜閹板墎绋荤紒鈧崘顏嗙＜缂備焦顭囩粻鐐翠繆椤愩垹鏆欓柍钘夘樀瀹曪繝鎮欓幓鎺濇闂傚倸鍊烽悞锕€顪冮崸妤€鍌ㄥù鐘差儍閳ь剙鍟村畷鍗炩槈濡粣绠撻弻娑㈠即閵娿儲鐏撻梺姹囧€愰崑鎾绘⒒娴ｇ瓔娼愰柛搴㈠▕椤㈡岸顢橀姀鐘栄囨煃鏉炴媽顔夐柡鈧禒瀣厽闁逛即鍋婇弶娲煕閵堝拋鍎戠紒杈ㄦ尭椤撳ジ宕熼鐘靛床闁诲孩顔栭崰鏍€﹂悜钘夋瀬闁瑰墽绮崑鎰版煛鐏炶鍔氶柡浣筋潐缁绘繈鎮介棃娴躲垽鏌ｈ箛鏂垮摵鐎规洘绻堝浠嬵敃閵堝棗娅樻繝鐢靛Х閺佸憡鎱ㄩ悽鍓叉晩闁哄稁鍘肩粣妤佷繆閵堝懎顏╃紓宥嗭耿濮婄粯鎷呴崨濠傛殘闂佸搫琚崝鎴﹀蓟婵犲洦鏅插璺鸿嫰缁侊箓姊洪崨濠傚Е闁哥姵鐗滈惀顏囶樄闁诡喖缍婇獮渚€骞掗幋婵愮€存繝鐢靛仜閻楀﹤煤閻旂厧钃熼柨婵嗘閸庣喐銇勯弽銊х煂閺嶏繝姊绘担鍛婂暈闁圭顭烽幆鍕敍濠靛浂妫?
    private boolean checkFullBodyEnchanted() {
        net.minecraft.world.entity.EquipmentSlot[] slots = {
                net.minecraft.world.entity.EquipmentSlot.MAINHAND,
                net.minecraft.world.entity.EquipmentSlot.HEAD,
                net.minecraft.world.entity.EquipmentSlot.CHEST,
                net.minecraft.world.entity.EquipmentSlot.LEGS,
                net.minecraft.world.entity.EquipmentSlot.FEET
        };
        for (EquipmentSlot slot : slots) {
            ItemStack stack = this.getItemBySlot(slot);
            // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯锋嫼閻熸粎澧楃敮鎺撶娴煎瓨鐓曢柟鎯ь嚟缁犵偞顨ラ悙鎼疁鐎殿喗鎸虫慨鈧柍閿亾闁归攱妞介幃宄邦煥閸涱収鏆柣銏╁灡鐢绮嬪澶婄骇婵☆偆鏁搁幊鎾烩€﹂妸锔藉劅婵犻潧顑呮禒鎰版煟鎼淬値娼愭繛鍙夌矒瀵偊骞栨担鍝ュ姦濡炪倖甯掗敃锔剧矓閻㈠憡鐓曢柣妯诲墯濞堟粓鏌涢埡鍌滄创妤犵偛顑夐幃娆擃敂閸愵亞娉块梻鍌欑閹碱偊宕愰崷顓涘亾缁楁稑娲ょ粻姘舵煕椤愶絿濡囬柡鈧禒瀣挃闁搞儜鈧弸宥夋煥濠靛棙澶勬い顐ｆ礋閺岀喖鎮欓鈧晶顖炴煕濮橆剦鍎旈柡灞剧☉閳藉宕￠悙瀵镐邯婵犵數鍋涢幏鎴犵礊娴ｅ壊娼栭柧蹇撳帨閸嬫捇宕烽鐑嗏偓宀勬煕閻愯埖顏犵紒杈ㄥ浮椤㈡瑩鎮剧仦鎯ф珰闁诲氦顫夊ú婵嬶綖婢舵劕围闁挎繂顦粈鍐煃鏉炴壆鍔嶆い鎾剁帛娣囧﹪鎮欓鍕ㄥ亾閺嶎偅鏆滈柟鐑橆檪閸ヮ剦鏁嶆繛鎴炲嚬濞村嫬鈹戦悙鍙夆枙濞存粍绻堥崺娑㈠箣閿旂晫鍘炬繝娈垮枟閸旀洟鍩€椤掍焦绀嬬€殿喗鎮傞獮瀣倷椤忓啰鐩庨梻渚€娼ч…鍫ュ磿閺屻儱闂柦妯侯棦閻熼偊鐓ラ柛鏇ㄥ墮閳ь剚鍔楅埀顒冾潐濞插繘宕濋幋锔衡偓浣糕槈濡攱顫嶉柡澶婄墑閸斿海绮欓幇顑芥斀闁绘ê鐏氶弳鈺佲攽閻愨晛浜炬繝鐢靛仒閸栫娀宕堕懜鍨珗闂備礁鎲℃笟妤呭垂閾忣偆鈻旂€广儱顦伴悡銉︾節闂堟稒锛嶆俊鎻掔秺閺岋綁骞樼€垫悶鈧帡鏌嶈閸撴瑧绮诲澶婄？閺夊牜鐓堝▓浠嬫煙闂傚顦﹂柛灞诲姂閺岀喓绱掗姀鐘崇亶闂佺粯鎸诲ú鐔煎箖濡ゅ懏鏅查幖绮光偓鑼嚬闁诲氦顫夊ú鏍儔婵傜鐒垫い鎺戝枤濞兼劖绻涢幓鎺旂鐎规洘绻堥獮瀣晜鐞涒€充壕濞达絿纭堕弸搴ㄦ煙閻愵剚缍戦柍褜鍓熼弨閬嶅Φ閸曨垰绠ｉ柨婵嗘啗閹剧粯鍊甸柛顭戝亽濞堟粍鎱ㄦ繝鍌ょ吋鐎规洘甯掗～婵嬵敄閽樺澹曢梺褰掓？缁€浣哄瑜版帗鐓曟繝闈涘閸旀鏌涚€ｎ偅灏い顐ｇ箞閹剝鎯旈埥鍡橀獎闂傚倷绶氶埀顒傚仜閼活垱鏅堕鐐寸厽妞ゆ挆鍐╃彎閻庤娲╃换婵嬬嵁鎼淬劍瀵犲璺虹灱閺嗩偅绻濋悽闈涗粶婵☆垰锕ョ粋宥呪攽鐎ｎ亞锛涢梺鍛婃处閸ㄩ亶鎮￠弴銏㈠彄闁搞儯鍔嶇亸顓㈡煙椤旇棄鐏︾紒缁樼洴瀹曘劑顢欓幆褉鎷伴梻浣告惈閻绱為埀顒傜磼閻樺磭娲寸€殿喗鎸抽幃娆撳级閹稿孩鍟熷┑鐘垫暩婵敻顢欓弽顓炵獥闁规崘顕х壕瑙勭節闂堟侗鍎忕紒鐘冲哺閺屾盯骞囬棃娑欑亪缂備胶濯寸徊鍓ф崲濠靛顥堟繛鎴炆戝▓鎻掝渻閵堝骸浜滅紒澶屾嚀椤繘鎼圭憴鍕瀭闂佸憡娲﹂崑鍕叏閵忋垻纾奸柛鎾楀棙顎楅梺鍛婄憿閸嬫捇姊虹粙鍖℃敾闁圭鍟块～蹇曠磼濡顎撴俊鐐差儏缁ㄨ偐鎲伴崱娆戠＝闁稿本姘ㄨⅵ闂佺顑嗛幑鍥箖濡ゅ啯鍠嗛柛鏇ㄥ墰椤︻參姊烘潪鎵槮妞ゎ厾鍏橀幃浼搭敊閽樺绐為柣蹇曞仧椤牊绂嶉悙顒傜闁瑰鍎愭禒鐐亜韫囨挻顥炴い鎰矙閺岋綁骞囬鐓庡闂佺粯鎸婚悷鈺侇潖濞差亶鏁囬柕濞у懏娈稿┑鐘媰鐏炵晫浠紓?
            if (stack.isEmpty() || !stack.isEnchanted()) return false;
        }
        return true;
    }
    // 闂?闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煟閵忋埄鐒剧痪鎯ь煼閺岋綁骞囬鑺ユ瘎闂佹椿鍘介悷鈺呮偂椤愶箑鐐婇柕濞р偓濡插牏绱掗悙顒€鍔ゆ繛灏栤偓鎰佹綎婵炲樊浜堕弫鍡涙煃瑜滈崜娑氬垝閺冨牆绠绘い鏃囧亹閿涙粓姊洪棃娴ュ牓寮插鍫熷亗婵炴垶鍩冮崑鎾荤嵁閸喖濮庨梺鍝ュ櫏閸嬪懏绌辨繝鍥ㄥ癄濠㈣绻勯幊鎾诲煘閸愵喖鍨傛い鏃傛嚀娴滈箖鏌″搴′簼鐎规洖寮剁换娑㈠箣濞嗗繒浠煎Δ鐘靛亼閸ㄧ儤绌辨繝鍥ч柛娑卞枛濞咃綁鎮楀▓鍨灆闁告鍟块～蹇撁洪鍕啇闂佺粯鍔栫粊鎾磻閹捐鍗抽柕蹇婃櫆閺呯偞绻濋姀锝呯厫闁告梹娲熼幏鎴︽偄閸忚偐鍙嗛梺缁樻煥閹碱偄鐡紓浣哄亾閸庢娊宕ョ€ｎ剚宕叉繝闈涱儏閸ㄥ倹銇勯幇鈺佺仼妞ゎ偄绉剁槐鎾诲磼濮樻瘷銏ゆ煟濡も偓缁绘帒危閹版澘绠抽柡鍐ㄥ€婚敍婊堟⒑闂堟稓绠冲┑顔碱嚟缁槒銇愰幒鎾嫼缂傚倷鐒﹂…鍥ㄦ櫠椤忓牊鐓忛柛顐犲焺閻掔偓銇勯弴顏嗙М妞ゃ垺娲熸慨鈧柍杞扮劍閸婎垶姊绘担瑙勫仩闁稿骸顭峰浠嬪礋椤栨氨顦伴梺鍛婂姦閸犳鍩涢幋锔界厾闁诡厽甯掗崜顓熴亜韫囨挾鍚囬柛銉墻閺佸秵绻濇繝鍌涘櫧闁伙絽鐖煎娲捶椤撶偛濡哄銈冨妼濡繈骞冮敓鐘冲亜闁稿繗鍋愰崢钘夆攽閳藉棗鐏ユ繛澶嬫礈閼洪亶宕稿Δ浣哄幈闂婎偄娲﹂幐璇诧耿娴煎瓨鐓忛柛銉戝喚浼冨銈冨灪閿曘垽骞冨▎鎾搭棃婵炴垶甯掑宥夋⒒娴ｈ棄袚閽冭京绱掔拠鎻掆偓鍧楀春閻愬搫绠ｉ柨鏃囨娴滃綊鎮楃憴鍕婵炴潙鍊垮鎶芥晸閻樻枼鎷虹紓鍌欑劍閿氭繛鎼枤缁辨帡鎮╁畷鍥р拰閻庢鍠栭…宄邦嚕閹绢喗鍋勯柧蹇撴贡濡插洭姊虹涵鍛棈闁规椿浜炲濠囨偩鐏炵偓娈伴梺闈涱槴閺呮粓鍩涢幋锔界厵闁兼祴鏅涙禒婊堟煃瑜滈崜姘跺垂閸喚鏆﹂悷娆忓椤╃兘鎮楅敐搴濇捣闁硅姤娲栭埞鎴︽倷閺夋垹浠搁柤瑁ゅ€濋弻锛勨偓锝庝邯閸欏嫰鏌″畝鈧崰鏍蓟閸ヮ剚鏅濋柍褜鍓熷绋库槈閵忥紕鍘撳銈呯箰鐎氼噣宕洪敐澶嬬厸鐎光偓鐎ｎ剛蓱闂佽鍨卞Λ鍐╀繆閹间焦鏅滃ù鐘差儐閺嗘﹢姊婚崒娆戭槮闁圭⒈鍋婇幃褍顭ㄩ崼婵堫槶濠电偞鍨堕懝楣冨垂濠靛鍊甸柨婵嗙凹閹查箖鏌涘顒夊剶闁哄本鐩俊鐑藉箣濠靛棙鏆樺┑顔斤供閸擄箑銆掓繝姘厪闁割偅绻傞弳娆撴煃瑜滈崜姘舵偋閻樺樊鍤曢柛顐ｆ礃閸?
    public UUID getOwnerUUID() {
        return this.ownerUUID;
    }

    public void setOwner(Player player) {
        this.ownerUUID = player.getUUID();
        this.entityData.set(OWNER_UUID_SYNC, Optional.of(this.ownerUUID));
    }

    public int getTeleportModuleLevel() {
        return this.teleportModuleLevel;
    }

    public int getMultiShotLevel() {
        return this.multiShotLevel;
    }

    public int getBlackHoleCooldown() {
        return this.blackHoleCooldown;
    }

    public boolean isBrutal() {
        return this.entityData.get(IS_BRUTAL);
    }

    public EntityDataAccessor<Integer> getDataXpAccessor() {
        return DATA_XP;
    }

    public int getFatalHitCount() {
        return this.entityData.get(DEATH_PLAQUE_FATAL_HIT_COUNT);
    }

    public void setFatalHitCount(int count) {
        this.entityData.set(DEATH_PLAQUE_FATAL_HIT_COUNT, Math.max(0, count));
    }

    public boolean hasDroppedRecord() {
        return this.deathRecordDropped;
    }

    public void setDroppedRecord(boolean dropped) {
        this.deathRecordDropped = dropped;
    }

    public ItemStack createDeathRecordCard(int fatalHitCount) {
        if (this.entityData.get(UNIT_ID) <= 0) {
            this.entityData.set(UNIT_ID, this.random.nextInt(999) + 1);
        }
        ItemStack card = new ItemStack(ExampleMod.DEATH_RECORD_ITEM.get());
        card.setCount(1);
        card.setTag(DeathPlaqueDataCodec.buildFromTurret(this, Math.max(1, fatalHitCount)));
        return card;
    }

    public void onTeleportCompleted(net.minecraft.world.phys.Vec3 startPos, boolean damageTriggered) {
        if (!damageTriggered || this.level().isClientSide) {
            return;
        }
        if (!(this.level() instanceof ServerLevel serverLevel)) {
            return;
        }

        int level = this.teleportModuleLevel;
        if (level < 3) {
            return;
        }
        if (this.blackHoleCooldown > 0) {
            return;
        }

        double range = TeleportModuleRules.blackHoleRangeForLevel(level) * TurretConfig.COMMON.blackHoleRangeScale.get();
        if (range <= 0.0) {
            return;
        }

        int cooldown = (int) Math.max(0, Math.round(
                TeleportModuleRules.blackHoleCooldownTicksForLevel(level) * TurretConfig.COMMON.blackHoleCooldownScale.get()
        ));
        this.blackHoleCooldown = cooldown;
        this.blackHoleActiveTicks = 20;
        this.blackHoleCenter = startPos;

        // Start burst: make black-hole trigger obvious to nearby players.
        serverLevel.sendParticles(ParticleTypes.PORTAL, startPos.x, startPos.y + 0.25, startPos.z,
                120, range * 0.20, 0.45, range * 0.20, 0.08);
        serverLevel.sendParticles(ParticleTypes.ENCHANT, startPos.x, startPos.y + 0.15, startPos.z,
                80, range * 0.24, 0.35, range * 0.24, 0.04);
        serverLevel.sendParticles(ParticleTypes.SMOKE, startPos.x, startPos.y + 0.20, startPos.z,
                60, range * 0.20, 0.30, range * 0.20, 0.02);
        serverLevel.playSound(null, startPos.x, startPos.y, startPos.z, SoundEvents.ENDERMAN_TELEPORT,
                net.minecraft.sounds.SoundSource.HOSTILE, 1.1f, 0.75f);
        TurretModuleLog.info("black-hole triggered turret={} level={} range={} cooldownTicks={}",
                this.getUUID(), level, range, cooldown);
    }
    @javax.annotation.Nullable
    public LivingEntity getOwner() {
        if (this.ownerUUID == null) return null;
        return this.level().getPlayerByUUID(this.ownerUUID);
    }

    // ==========================================
    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱樈閸犳顕欏ú顏呪拺缂侇垱娲栨晶鍙夈亜閵娿儲鍤囬柣娑卞枤閳ь剨缍嗛崰妤呭煕閹寸姷纾奸悗锝庡亽閸庛儵鏌涙惔銏犲闁哄瞼鍠栭幃鐑芥偋閸繃鐏庨梻浣虹帛娓氭宕抽敐澶屽祦闁圭儤鍤﹂弮鍫濈劦妞ゆ帒瀚涵鈧梺瑙勫劶婵倝鎮￠悢鍏肩厸闁告劑鍔嶆径鍕亜韫囨洖校缂佺粯绋掑鍕偓锝庡墰閻ゅ嫬鈹戦纭峰伐妞ゎ厼鍢查悾鐑藉箳閹搭厽鍍靛銈嗗灱濡嫭绂嶉崜褏纾奸悗锝庡弾閸わ附绻涢幋鐐冩艾危閸儲鐓忛煫鍥ㄦ礀闉嬮梺纭呭Г濞叉鎹㈠┑瀣潊闁挎繂鎳愰崢顐︽⒑閸涘﹥鈷愭繛鍙夌矌閸?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙闁稿被鍔庨幉鎼佸籍閸惊銉╂煕閹般劍娅嗛柛搴ｅ枛閺屾洝绠涚€ｎ亞鍔村┑鐐跺皺椤牓鍩為幋锔藉亹閻犲泧鍐х矗闂佽瀛╅崙褰掑矗閸愩劎鏆﹂柨婵嗙墢閻も偓濠电偞鍨堕悷褔宕㈤幘缁樷拺闁告稑锕︾粻鎾绘倵濮樼厧澧撮柛鈹惧亾濡炪倖宸婚崑鎾淬亜椤撶姴鍘寸€规洘妞介幃娆忣啅椤斿吋鍊梻浣虹《閸撴繈鎮疯閹線宕奸妷锔规嫽闂佺鏈銊︽櫠濞戞氨纾奸悗锝庡亜濞搭喗顨ラ悙瀵稿⒌妤犵偛娲幃褔宕奸姀鐘茬闂傚倷鐒︾€笛兾涙笟鈧、姘愁槻闁宠绉撮鍏煎緞鐎ｎ剙骞嶆俊鐐€栧Λ渚€宕戦幇顔剧煋婵炲樊浜濋悡娆愩亜閺冨倹娅曢柣顓烇躬閹藉爼鏁愭径瀣幘濠电偞娼欓鍡椻枍閸ヮ剚鐓涢柛鈾€鏅涢獮妤€菐?
    // ==========================================
    static class MaintainSpaceGoal extends Goal {
        private final SkeletonTurret turret;
        private final double speed;
        private final float minDistance; // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫆闁芥ê顦純鏇㈡⒒娴ｅ憡鍟為柛鏃撶畵瀹曚即寮介銏╂婵犵數濮电喊宥夋偂濞嗘挻鐓曢柟鐐殔閹冲海绮敓鐘斥拺缂佸灏呭銉╂煟閺嵮佸仮闁诡噯绻濋、鏇㈡晝閳ь剟鎮欐繝鍥ㄧ厪濠电姴绻掗悾閬嶆煛閸℃﹩娈樼紒杈ㄦ尰閹峰懘宕崟鎴節閺屾稑螖娴ｇ硶鏋欓悗娈垮枦椤曆囧煡婢跺á鐔奉煥閸涱厽鐏侀梺褰掝棑婵炩偓闁瑰磭濞€椤㈡牠骞愭惔鈥茬凹闂傚倸鍊搁崐鐑芥嚄閸洖绠犻柟鎹愵嚙鎼村﹪鏌＄仦璇插姶闁轰礁瀚伴弻娑樷槈濠婂嫬娑х紓鍌氱У閻楃娀寮婚弴锛勭杸闁哄洨鍊妷鈺傜厸闁糕剝顨嗛ˉ銏ゆ煛鐏炵晫啸妞ぱ傜窔閺屾盯骞樼捄鐑樼亪濡ょ姷鍋涢崯顖溾偓闈涖偢瀵爼骞嬮悩鎻掔闂傚倷绀侀幉鈩冪瑹濡ゅ懎绐楁慨妯挎硾閻?(3闂?
        private LivingEntity owner;

        public MaintainSpaceGoal(SkeletonTurret turret, double speed, float minDistance) {
            this.turret = turret;
            this.speed = speed;
            this.minDistance = minDistance;
            // 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫鍐煥閺囨浜鹃梺姹囧€楅崑鎾舵崲濠靛洨绡€闁稿本绮岄·鈧梻浣侯焾椤戞垹鎹㈠┑瀣摕闁靛ň鏅涢崡铏繆閵堝倸浜炬繛瀛樼矒缁犳牠寮诲☉妯滄棃宕ㄩ浣告灓闂備礁鎼張顒傜矙閹达箑鐓″璺侯煬濞笺劑鏌涢锝囩畵妞ゎ偆濞€濮婄粯鎷呴崫銉礊缂備緡鍣崹鎷岀亱闂佸憡鍔﹂崰鏍嫅閻旇　鍋撻獮鍨姎闁绘绮岄‖濠囧Ω閳哄倵鎷洪梺鍛婄☉閿曘儳浜搁悧鍫熷弿婵☆垳顭堟俊鍧楁煕閹烘挸绗掗柍璇查叄楠炲洭顢楅崒婊呭祦闂傚倷娴囬～澶婎熆濮椻偓閹ê顫濈捄铏规煣濠电姴锕ら悧濠囧煕閹达附鐓曟繝闈涘閸旀岸寮介埄鍐瘈闁靛繈鍨洪崵鈧銈嗗灥椤︻垶顢氶敐澶婅摕闁靛绠戞禍褰掓⒑閼测斁鎷￠柛鎾磋壘閳绘捇骞嗚閺€浠嬫煟濡偐甯涙繛鎳峰嫨浜滈柟瀛樼箖閸ｆ椽鏌涙惔顔间喊闁哄矉缍侀幃銏ゅ传閵壯呭帒闂備焦鎮堕崝灞筋焽閿熺姴鏋侀柟鎵閸婄兘鏌ｉ幋鐐嗘垵鈻嶉崶顒佲拺闂侇偆鍋涢懟顖涙櫠鐎涙绡€闁逞屽墯缁楃喖鍩€椤掆偓椤繘鎼归崷顓狅紲濠碘槅鍨扮换妤呭磻閹版澘绠柛鎰靛枟閺呮繈鏌涚仦鎹愬闁诡垳鍋涢埞鎴︽倷閸欏妫炵紓浣筋嚙濡繂顕ｉ妸鈺傚殟闁靛绲肩花濠氭⒑閸濆嫬鏆婇柛瀣崌閺屾稒鎯旈姀鐘灆閻庢鍠氶…鍫ュ煡婢舵劕顫呴柨娑樺楠炴劕鈹戦悙鑸靛涧缂佽弓绮欓獮妤€顭ㄩ崱妞诲亾閺夋垟鏀介柣鎰▕閸ょ喎鈹戦姘煎殶缂侇喖顭烽獮姗€鎳￠妶鍛偊闂備胶纭堕崜婵嬪礄閻熼偊鐎堕柕濞炬櫆閳锋垿鏌涘┑鍡楊仾妞ゃ儲鍨块弻娑㈠箻鐎靛摜鐣奸梺鐟扮畭閸ㄥ綊鍩ユ径濠庢僵闁挎繂鎳嶆竟鏇㈡⒑濮瑰洤鐏い鏃€鐗犻幃鐐哄礈瑜庨崑鏍煏婵炵偓娅嗛柍閿嬪灩缁辨帞鈧綆浜炴禒銏°亜閹哄鐏查柡宀€鍠栧畷銊︾節閸屾鐏嗗┑鐘殿暯閸撴繈骞愰崘鑼殾闁靛ě鈧崑鎾斥槈濞呰櫕鍨甸埢宥夊炊椤掍讲鎷虹紓浣割儐鐎笛冿耿閹殿喚纾奸悗锝庡亜缁楁帡鏌?MOVE 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犖ч柛銉㈡櫇閸樼娀姊绘担鍛婃儓妞わ缚鍗冲畷闈涱潩椤戠偞妞介、鏃堝礋椤撶偛绠伴梻鍌欑閹诧紕鍒掗崼銉﹀€块柨鏇炲€搁悿?
            this.setFlags(EnumSet.of(Flag.MOVE));
        }

        @Override
        public boolean canUse() {
            // 闂?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧潡鏌熺€电孝缂佽翰鍊濋弻锕€螣娓氼垱锛嗛悷婊呭鐢帞澹曟總鍛婄厽闁归偊鍨伴惃娲煟濞戞牕鍔︽慨濠冩そ瀹曨偊宕熼娑欑€遍梻?1闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弮鍫熸殰闁稿鎸剧划顓炩槈濡娅ч梺娲诲幗閻熲晠寮婚悢鍏煎€绘慨妤€妫欓悾鐑芥⒑閹肩偛鈧洟鎳熼婵堜簷闂備焦瀵х换鍌炲箠鎼淬劌姹查柡鍐ㄧ墛閻撳啰鎲稿鍫濈婵炲棙鎸哥粻鐘绘煙閹冩闁搞儺鍓欓幑鑸点亜閹惧鈽夊ù婊呭亾缁绘盯宕煎┑鍫滆檸闂佸搫顑冮崐鏍Φ閸曨垼鏁囬柣鎰版涧閳敻姊洪悙钘夊姷缂佺姵鎸绘穱濠囧箹娴ｅ摜鍘告繛杈剧导鐠€锕€危娴煎瓨鈷掑ù锝囶焾閺嗛亶鏌熺喊鍗炰簽闁逞屽墯閸戝綊宕滈悢鑲╁祦闁糕剝绋戦柋鍥煟閺冨洦顏犻柣锕€鐗嗛埞鎴︽倷閼碱剙顣洪梺璇茬箲缁诲牆顕ｉ幖浣瑰亜闁稿繒鍘ч悵鏃堟⒒娓氬洤澧紒澶屾暬閹€斥枎閹惧鍘卞┑鐐村灦閿曨偄顔忛妷鈺傜厓缂備焦蓱缁€鍫ユ煃瑜滈崜婵嬶綖婢跺⊕鍝勎熼懡銈囶啎婵犵數濮村ú銈囩不閺嶃劎绡€濠电姴鍊绘晶娑㈡煕閵堝懐效闁哄本娲樺鍕槈閵忊槅鈧秹姊虹紒妯肩闁稿锕濠氭晲閸℃ê鍔呴梺鐐藉劚閸熸寧娼忛崨瀛樷拺缂佸顑欓崕鎰版煙閻熺増鍠樼€殿喛顕ч濂稿醇椤愶綆鈧洭姊绘担鍛婂暈闁规悂绠栧畷浼村冀閵娿倗绠氶梺鍦檸閸犳牕顔忓┑瀣€垫繛鎴烆伆閹存績鏋嶉柛銉墯閳锋垿姊洪銈呬粶闁兼椿鍨遍弲鍫曞箻椤旂晫鍙嗗┑鐘绘涧閻楀棙绂掗崡鐐╂斀妞ゆ梻鎳撴禍楣冩⒒娓氣偓濞佳囨偋閸℃稑绠悗锝庝憾閻掕棄鈹戦悩鍙夊闁抽攱鍨块弻鐔虹矙閹稿孩宕抽梺闈涙鐢帡鈥﹂懗顖ｆЪ濡炪們鍔岄幊鎰板矗閸涘瓨鈷戠紓浣股戦ˉ鍫熴亜閵夛附宕岀€殿喗濞婇弫鍐磼濞戞艾寮虫繝鐢靛█濞佳兾涢鐐嶏綁宕妷褏锛滈梺缁樼懃閹虫劗绮旈鈧弻鈥崇暆鐎ｎ剛鐦堥悗瑙勬礃鐢帡锝炲┑瀣垫晣闁绘柨鍢叉竟宥嗙節閻㈤潧浠滈柣掳鍔庨崚鎺撴償閵娿儳锛涢梺瑙勫礃閸╂牕鐣烽崣澶岀瘈闂傚牊绋掑婵堢磼閳锯偓閸嬫捇姊绘担渚劸闁哄牜鍓涢崰濠傤吋閸涱亝鐏侀梺鍝勮閸庢煡鍩涢幋鐘电＜閻庯綆浜滈惃锟犳煕閺冨倸鏋涢柡灞稿墲閹峰懐绮电€ｎ亝顔勬俊鐐€ら崑鍕崲閹邦喖寮叉俊鐐€曠换鎰矓閻㈢鐤炬繝闈涱儐閳锋垹绱撴担鑲℃垿藟閸℃绠鹃柟鎹愵嚃濞兼劗绱掗弮鍌氭灈鐎殿喗鎸虫慨鈧柍閿亾闁归绮换娑欐綇閸撗冨煂闂佸湱鈷堥崑鍛矉閹烘嚚娲敂閸涱垰骞堥梺鐟板悑閻ｎ亪宕愰弴銏″剭婵炲樊浜濋悡娆愵殽閻愯尙浠㈤柣蹇氬皺閳ь剝顫夊ú鏍Χ閸涘﹣绻嗛柣鎴ｆ鍞悷婊冪У閹便劑鏁傞幋鎺旂畾闂佺粯鍔︽禍婊堝焵椤掍胶澧遍柡渚囧枟缁绘繈宕堕妸銉㈠亾閸ф鐓ラ柡鍥╁仜娴滄壆绱撳鍡欏濞ｅ洤锕俊鍫曞川椤撶喐顔嶇紓浣瑰劤婢т粙宕㈣閻忓姊虹紒姗嗘當闁绘绻掔划濠氬箻鐡掍胶鎳撻…銊╁焵椤掑嫬纭€闁规儼妫勯拑鐔兼煃閳轰礁鏆炲┑顖涙尦閺屾稑鈹戦崟顐㈠闂佹寧绻傚ú銊у閸忛棿绻嗛柕鍫濇噹閺嗘瑩鏌＄€ｎ偆娲撮柡灞剧洴閸╃偤骞嗚婢规洖鈹戦敍鍕杭闁稿﹥鐗曢蹇旂節濮橆剛锛涢梺瑙勫礃椤曆呮兜閳ь剟姊绘笟鍥у缂佸鏁诲畷鎴︽晲婢跺鍘遍梺闈涱槹閸ㄧ數鈧皜鍥у嚑婵炲棗绻嗛弨浠嬫煟閹邦喖鍔嬮柨娑氬枛閺屾稑螖娴ｇ硶鏋欓悗娈垮枛椤嘲顕ｉ幘顔芥櫖闁告洦鍘藉鎴濃攽閻樺灚鏆╅柛瀣仱瀹曟洟鎼归銈庢锤闂佺粯鍔﹂崜娑氬姬閳ь剟姊洪棃娑氱濠殿喗鎸抽、鏃堝Χ婢跺鍘搁梺鍛婁緱閸ㄤ即鍩㈤崼鐕佹闁绘劖褰冮弳娆撴懚閺嶎厽鐓曟繛鎴濆船閺嬫稑霉閻欌偓閸欏啫顫忓ú顏勪紶闁告洖鐏氭晥闂佽娴烽悷鎶藉礃閿濆棛浜栭梻浣告惈鐞氼偊宕曢弻銉﹀亗闁绘柨鍚嬮悡蹇涚叓閸パ嶆敾婵炲懎鎳橀弻锝堢疀閺囩倫銉х磼鏉堛劍灏い鎾炽偢瀹曨亪宕橀妸銈囩煑闂傚倷妞掔槐顔惧緤閸ф绀傛俊顖濇閺嗭箑鈹戦崒婊庣劸闁告濞婇弻锝夊棘鐠恒劍顔堥梺绋款儐閹瑰洭骞冨鍫熷殟闁靛鍎崑鎾诲垂椤愩倗顔曢梺鐟邦嚟閸庢劖绂掗悙顑句簻闊洦鎸炬晶娑㈡煕鎼粹槄宸ラ柍瑙勫灴閹晛鐣烽崶鑸垫闂備焦濞婇弨杈╂暜閹烘绠掗梻浣瑰缁诲倸煤閿曞倸鍚归柍褜鍓涚槐鎾存媴閻熸壆绁峰銈庡幘閸忔ê顕ｆ繝姘櫜濠㈣埖蓱閺咃綁姊虹紒妯虹仴婵☆偅鐟﹂〃娆忊攽閻樻鏆柍褜鍓欓崯璺ㄧ棯瑜旈弻娑㈠籍閳ь剙煤閻旂厧鏄ラ柣鎰惈缁狅綁鏌ｅ鍡椾簻濞存粓绠栭弻銊モ攽閸℃瑥鍤紓浣靛姀婵倝濡甸崟顖氱閻庢稒菧娴犮垹鈹戦纭锋敾婵＄偠妫勯悾鐑筋敃閿曗偓缁€瀣亜閹惧鈯曢柣搴ㄤ憾濮婄粯鎷呮笟顖滃姼缂備胶绮崹鍧楀极閸愵喖顫呴柣妯虹仛濞堥箖姊虹涵鍛涧缂佺姵鍨圭划缁樼節濮橆厼浠梺鎼炲劘閸斿瞼寰婇懡銈囩＜闁归偊鍘鹃埥澶嬨亜椤忓嫬鏆ｅ┑鈥崇埣瀹曞崬螣閻戞ɑ顔傞梻鍌欑閹芥粍鎱ㄩ棃娴㈡椽鎮㈡搴㈡闂侀潧顦弲鈺呭极閸愵喗鐓冮柛銊︾⊕濞呭棝鏌￠崒妤€浜炬繝纰夌磿閸嬫垿宕愰弽褜娼栧┑鐘宠壘绾偓闂佽鍎煎Λ鍕不閿濆鐓ラ柡鍥殔娴滃墽绱撴担鍝勑￠柛妤佸▕瀵鎮㈤悡搴ｇ暰闂佺粯顨呴悧婊兾涢崟顖涒拻闁稿本鑹炬禍鐐烘煕閵娿倕宓嗛柍銉︽瀹曟﹢顢旀担闀愬闂佹寧绻傜花鑲╄姳缂佹ǜ浜滈柟鍝勵儏閻忣噣鏌嶈閸撴繈锝炴径濞掓椽寮介鍕喘閹晫绮欓懗顖涙啺闂備焦瀵х换鍌炈囬姣兼稑顫滈埀顒勫箖瑜版帒绠掗柟鐑樺灥椤姊虹拫搴″€荤粣鏃€鎱ㄦ繝鍛仩缂侇喗鐟ラ埢搴ㄥ箚瑜嶆竟澶愭⒒娴ｅ憡璐￠柟铏尭鐓ら柕鍫濐槹閸嬧晝鈧懓瀚伴崑濠傤焽閵娾晜鐓冪憸婊堝礈閻旂厧违濞撴埃鍋撶€殿噮鍣ｅ畷鐓庘攽閸℃瑧宕哄┑锛勫亼閸婃牕顫忔繝姘仱闁哄啠鍋撶紒鍌涘笩椤﹁鎱ㄦ繝鍌ょ吋鐎规洘甯掗～婵嬵敄閽樺澹曟俊鐐差儏鐎涒晠顢曟禒瀣叆闁绘柨鎼瓭缂佺偓鍎抽…鐑藉蓟濞戞ǚ妲堥柛妤冨仜缁傚繘姊洪幐搴ｇ畵妞わ富鍨崇划濠氬箮閼恒儳鍘搁梺鍛婂姧缁茶姤绂嶉幆褜娓婚柕鍫濇婵苯鈹戦鍝勨偓婵囦繆閻㈢绀嬫い鏍ㄦ皑閻も偓闂備礁鎲￠幐鐑芥嚄閸洖姹查柣妯兼暩绾捐棄霉閿濆懏鎯堢悮銊╂⒑缁嬫寧鎹ｉ柡浣筋嚙椤曪絾绻濆顓炰簻闂佺粯鎸稿ù鐑芥偩妤ｅ啯鍋℃繝濠傚閻帞鈧娲滈弫濠氬箖閵忋垺濯奸柛顭戝枤缁夋椽鏌熼瑙勬珚闁圭厧缍婇、鏇㈠煑閳轰椒澹曢梺瑙勫婢ф鎮?
            if (turret.isInWaterOrBubble()) return false;

            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愭い鎰枎娴滈箖鏌ㄩ弴鐐测偓鎼佹倷婵犲啨浜滈柟鍝勬娴滃墽绱撴担鐟板妞ゃ劌锕濠氭偄閸忚偐鍔烽梺鎸庢磵閸嬫挸顭胯缁犳牠寮婚妶澶婄骇閻犳亽鍔嬮搹搴ㄦ⒑闂堟稒顥為悽顖涘浮閿濈偛鈹戠€ｎ偅娅滈梺鍛婁緱閸撴瑩藟濮樿埖鈷掗柛灞剧懄缁佺増銇勯弴鐔哄⒌鐎规洝顫夌€靛ジ寮堕幋鐘崇劸闂備礁鎼ˇ浼村垂瑜版帒姹查柨鏇炲€归悡鐔兼煛閸愩劌鈧敻骞忛敓鐘崇厸濞达絿顭堥弳锝夋煛鐏炵偓绀夌紒鐘崇洴閺佹劙宕卞▎鎴犲床缂傚倸鍊峰ù鍥ㄣ仈閹间焦鍋￠柍杞扮贰濞?
            if (!turret.entityData.get(IS_FOLLOWING)) return false;
            // 闂?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧潡鏌熺€电孝缂佽翰鍊濋弻锕€螣娓氼垱锛嗛悷婊呭鐢帞澹曟總鍛婄厽闁归偊鍨伴惃娲煟濞戞牕鍔︽慨濠冩そ瀹曨偊宕熼娑欑€遍梻浣告啞钃辨俊顐㈠暙閻ｇ兘宕奸弴銊︽櫌闂侀€炲苯澧撮柟閿嬪灴閹垽宕楅懖鈺佸妇濠电姰鍨奸崺鏍儎椤栨凹鐎舵い鏃傛櫕缁犻箖鏌涘☉鍗炴灓濠⒀屼邯閺屽秶鎲撮崟顐や紝濡炪們鍨洪悷鈺侇嚕椤掑嫬围闁告洦鍙€缁绘垿姊婚崒娆戭槮闁硅绻濋弫鍐閵忣澀绗夐梺鍝勭▉閸樺綊鍩€椤戣法绐旂€殿噮鍣ｅ畷鐓庘攽閸偄鏅ｆ繝鐢靛仩閹活亞寰婇挊澶涜€块梺顒€绉撮崒銊╂⒑椤掆偓缁夌敻鍩涢幋锔界厱闁挎棁顕ч獮鏍瑰鍛壕缂佺粯鐩畷妤呮嚃閳哄倸娅氭俊鐐€戦崹娲嚌妤ｅ啠鈧箓濡搁埡渚€鍞堕梺缁樻閺€閬嶆偩娴犲鈷掑ù锝囶焾閺嗛亶鏌熺喊鍗炰喊鐎规洦鍨堕幃鈺冩嫚閼碱剨绱遍梻浣告贡閸嬫捇寮告總绋垮嚑闁哄啫鐗婇悡鏇熴亜椤撶喎鐏ラ柡瀣枛閺岋綀绠涢幘璺衡叡缂備浇椴搁幐濠氬箯閸涱垳椹抽悗锝庝簼椤斿嫭淇婇悙顏勨偓鏍垂闂堟耽娲Ω閳轰胶顦梺鍦劋椤ㄥ繘寮崶顒佺厪闊洦娲栧瓭缂備焦鍔栭惄顖炲蓟閿濆棙鍎熼柕蹇婃噰婵洭鏌﹂崘顓㈠摵缂佺粯鐩畷銊╊敊閹€鎷伴梻浣告惈閻绱為埀顒傜磼閻樺磭娲寸€殿喗鎸抽幃娆撳级閹稿孩鍟熼梻鍌氬€烽懗鍫曗€﹂崼銉晞闁糕剝绋戠粈澶嬬箾閸℃ɑ灏紒鐘崇墱閳ь剛鎳撶€氼厽绔熺€ｎ喖缁╁ù鐘差儐閸婄敻鏌ㄥ┑鍡涱€楀ù婊勫姍閺岀喎鐣￠柇锔惧悑濠殿喖锕ュ浠嬬嵁閺嶎厽鍊烽柟缁樺笒鍟哥紓鍌氬€峰ù鍥╀焊椤忓懏鍙忛柕鍫濇川閻鈧箍鍎卞Λ搴ㄥ磻閸涘瓨鐓曢柟鑸妽濞呭洭鏌涘Ο鍦煓婵﹨娅ｇ槐鎺懳熼懡銈呭汲闂備胶顢婇婊呮閺囩喓鐝堕柡鍥╁Х绾惧吋淇婇姘础缂佺姵宀稿铏圭磼濡搫顫嶅┑鐐插悑閻熝呭垝椤撯槅妯勯梺鍝勭灱閸犳牠鎮伴鈧畷褰掝敊閸欍儲鍋呭┑锛勫亼閸娿倝宕戦崨顖涘床闁告洦鍨扮粻鏌ユ煕閺囥劌鐏￠柟顖滃仱閹綊宕堕敐鍌氫壕闁惧浚鍋呭В鍡樼節閻㈤潧啸闁轰焦鎮傚畷鎴︽偐鐠囪尙顔屽銈呯箰濡娆㈤妶澶嬬厽闁逛即娼ф晶鐗堛亜閳哄倻鍙€闁哄被鍊濋獮渚€骞掗幋婵喰戞俊鐐€愰弲婵嬪礂濮椻偓瀵濡搁埡浣稿祮濠德板€愰崑鎾趁瑰鍫㈢暫婵﹤顭峰畷鎯邦檨婵℃彃婀辩槐鎺旂磼濡偐鐣惧銈忛檮閻擄繝寮婚敐鍫㈢杸闁哄啫鍊婚悿鍕⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤冪憪闂佺厧鍟块悥鍏间繆閹绢喖绠抽柡鍐ㄥ€婚敍婊冾渻閵堝棙绀€婵☆偅鐩畷姘鐎涙鍘撻梺鑺ッˇ钘壩熼埀顒佺節濞堝灝鏋撻柛瀣崌濮婃椽寮妷锔界彅闂佸摜鍣ラ崹鍫曘€?
            if (turret.isPurgeActive()) return false;
            if (turret.ownerUUID == null) return false;
            Player p = turret.level().getPlayerByUUID(turret.ownerUUID);
            if (p == null) return false;
            this.owner = p;

            return turret.distanceToSqr(p) < (minDistance * minDistance);
        }

        @Override
        public boolean canContinueToUse() {
            if (turret.isPurgeActive()) return false;
            // 闂?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧潡鏌熺€电孝缂佽翰鍊濋弻锕€螣娓氼垱锛嗛悷婊呭鐢帞澹曟總鍛婄厽闁归偊鍨伴惃娲煟濞戞牕鍔︽慨濠冩そ瀹曨偊宕熼娑欑€遍梻?2闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弮鍫熸殰闁稿鎸剧划顓炩槈濡娅ч梺娲诲幗閻熲晠寮婚悢鍏煎€绘慨妤€妫欓悾鐑芥⒑閹肩偛鈧洟鎳熼婵堜簷闂備焦瀵х换鍌炲箠鎼淬劌姹查柡鍐ㄧ墛閻撳啰鎲稿鍫濈婵炲棙鎸哥粻鐘绘煙閹冩闁搞儺鍓欓幑鑸点亜閹惧鈽夊ù婊呭亾缁绘盯宕煎┑鍫滆檸闂佸搫顑冮崐鏍Φ閸曨垼鏁囬柣鎰版涧閳敻姊洪悙钘夊姷缂佺姵鎸绘穱濠囧箹娴ｅ摜鍘告繛杈剧导鐠€锕€危娴煎瓨鈷掑ù锝囨嚀椤曟粎绱掔拠鎻掆偓鍧楃嵁婵犲偆鍚嬮柛鈩冪懅瑜伴箖姊洪崫鍕偍闁搞劍妞介崺娑㈠箣閿旂晫鍘遍梺鎸庢椤曆囩嵁閺嶎厽鐓曢柡鍌涱儥閸庢劗绱掔紒妯兼创鐎规洩绲惧鍕熼悡搴⌒ㄩ梻鍌欑閸氬顪冮懞銉ь洸闁割偅娲栫粻鏍煃閸濆嫬鏆熺痪鎯у悑娣囧﹪顢涘鍐ㄤ粯濡ょ姷鍋涢悧鍡涘煘閹达附鍋愰柛顭戝亝濮ｅ嫭绻濆▓鍨灍闁圭鍟块悾鐑筋敍閻戝棙鏅濋梺闈涚墕濞层劑鎮鹃崼鏇熷仭婵犲﹤鍟幑锝夋煙楠炲灝鐏╅柍钘夘樀婵偓闁炽儱鍘栫花鐢告⒑绾懎浜归悶娑栧劦瀹曟粌鈹戦崱蹇旂亖婵犵數濮电喊宥夊磹閻㈠憡鍋℃繛鍡楃箰椤忣亞绱掗埀顒勫礃椤旂晫鍘遍梺鍝勫暊閸嬫捇鏌ｉ悢鍙夋珚闁诡喕鍗抽、姘跺焵椤掑嫮宓侀柟鐑樺殾閺冨牆鐒垫い鎺戝€荤亸鐢碘偓骞垮劚椤︿即鎮￠崘顏呭枑婵犲﹤鐗嗙粈鍫熺箾閹寸儑渚涢柛銈嗩殔閳规垿鎮╅幓鎺撴缂備讲妾ч崑鎾寸節濞堝灝鏋熼柨鏇楁櫊瀹曘垺銈ｉ崘銊ュ亶闂佹眹鍨归幉锟犲煕閹达附鐓曟繛鎴烇公閸旂喓绱掗悩铏磳闁诡喗顨呴～婵嬵敆閳ь剙危婵犳艾纭€閺夊牃鏅滈崰鎰版煟濡も偓閻楀棛绮鑸电厽闁规儳顕幊鍛磼鏉堛劌绗ч柍褜鍓ㄧ紞鍡涘磻閹烘纾块柕澶涚細缁诲棙銇勯弽顭戞當濞存粓绠栧濠氬磼濞嗘埈妲梺鍦拡閸嬪﹪骞婇悢纰辨晬闁绘劖娼欓崜鍫曟⒑缁嬭法绠洪柛瀣姍閵嗗懘鎮滈懞銉у弳闂佸搫娲ㄩ崑娑㈠焵椤掆偓缂嶅﹤鐣烽悽绋跨妞ゆ梻鏅崢鎾绘煛婢跺苯浠﹀鐟版瀹曟繂顓奸崱娆戭啎闂佸憡渚楅崰妤€鐣风仦鐐弿濠电姴瀚敮娑㈡煙瀹勭増鍤囬柟顔惧厴閺屽洭鏁冮埀顒€鈻撳┑鍫㈢＝闁稿本鐟чˇ锔姐亜閹存繃顥㈢€规洖缍婂畷绋课旈埀顒傜不濮橆剦鐔嗛悹杞拌閸庢垿姊婚崟顐㈩伃闁哄本绋戦埥澶婎潨閸繀绱ｅ┑鐐差嚟婵秹宕橀敐鍡樻澑闂備胶绮崝鏍ь焽濞嗘挻鍊堕柣鏂垮悑閻撴洟鏌曟繛鍨姕閻犳劧绱曠槐鎺楊敊閼测晛鈪甸悗瑙勬礀瀹曨剟鍩ユ径濞炬瀻闊洤楠哥€垫煡姊婚崒娆戝妽闁诡喖鐖煎畷鏇㈡倻濡⒈娲稿┑鐘诧工閹冲繘锝為弴銏＄叆闁哄倸鐏濋埛鏃傜棯閹冩倯闁靛洤瀚板顒勫垂椤旇瀵栭梺姹囧焺閸ㄩ亶鎯勯鐐茶摕闁绘柨鎽滈悷褰掓煕椤垵鏋涙い顒€鐗撳铏光偓鍦濞兼劙鏌涢妸銉﹀仴闁绘侗鍣ｅ畷鍫曨敆婢跺娅嶉梻浣虹帛椤洭寮粙璺ㄦ殾闁告縿鍎崇壕浠嬫煕鐏炴崘澹橀柍褜鍓欓崲鏌ユ箒闂佹悶鍎崝濠冪閸儲鐓曟繝闈涘閸旀粓鏌￠崱妯肩煉闁哄被鍔戦幃銏ゅ传閸曟垯鍎抽埀顒冾潐閹搁娆㈠鍓佸祦闁哄稁鐏旀惔顭戞晢闁逞屽墴閹﹢顢欓崜褏锛滈梺鎶芥暜閸嬫捇鏌涚€ｎ偅宕屾慨濠勭帛閹峰懘宕ㄦ繝鍌涙畼闂備礁鎲″褰掑垂閸喚鏆︽繝闈涚墐閸嬫捇鏁愭惔鈥愁潻闂佹悶鍔嶇换鍐Φ閸曨垰鍐€妞ゆ劦婢€濞岊亪姊洪幎鑺ユ暠闁搞劌娼″璇测槈濡攱顫嶅┑顔筋殔閻楀棙瀵奸幇顔剧＝濞达絽绠嶆禒婊堟煛閸涱垰鈻堢€殿喛顕ч埥澶愬閻橀潧骞愰梻浣侯焾閺堫剛鍒掑畝鍕劵闁荤喖鍋婂〒濠氭煏閸繈顎楁鐐寸墬缁绘稑顔忛鐓庣闂佷紮缍侀弨杈╃紦娴犲宸濆┑鐘插€风花璇测攽閻愬瓨灏伴柛鎴濈秺瀹曞綊鏌嗗鍡欏弳闂侀潧鐗嗛ˇ浼村煕閹烘垯鈧帒顫濋敐鍛婵犵數鍋橀崠鐘诲炊閵娿儰缃曢梻浣虹《閸撴繈藝閸濆娊娲敂閸曞簶鏅犻弻宥夊传閸曨偀鍋撶粙搴撴灁婵犻潧顑嗛埛鎴︽煕閹炬潙绲诲ù婊勭箖缁绘盯宕ｆ径娑溾偓鍧楁煙椤曞棛绡€鐎规洘锕㈤、娆撴偩鐏炶棄濡囨繝鐢靛О閸ㄥジ宕洪弽顐ょ煓闁硅揪璐熼埀顒€鎳橀、妤呭礋椤掑倸骞楁俊鐐€栭幐楣冨窗鎼粹埗褰掝敋閳ь剟寮婚敍鍕勃闁伙絽鐫楅妷锔轰簻鐟滃瞼娆㈠璺鸿摕婵炴垯鍨圭粻濠氭倵闂堟稒鍟為柛锝勫嵆閹鎲撮崟顒€顦╅梺鎼炲姀娴滎剟鍩€椤掑嫭娑ч柕鍫㈩焾椤曪綁宕奸弴鐐殿吅闂佺粯鍔楅。浠嬪磻閹炬椿鏁嗛柛鏇ㄥ厴閹锋椽姊洪懡銈呮瀾婵犮垺锕㈤崺娑㈠籍閸屾粎锛滃銈嗘礀閹冲酣鎮橀敃鍌涚厵妞ゆ梹鍎虫禒锔剧磼缂佹绠撴い顐ｇ箞椤㈡﹢鎮╅幓鎺旑唶闂傚倸鍊风粈渚€骞夐垾瓒佹椽鏁冮崒姘憋紱闂佺硶鍓濋悷褎绋夊澶嬬厵闁诡垱婢樿闂佺顑冮崝宥夊Φ閸曨垰鍐€闁靛ě灞炬婵＄偑鍊戦崕顖炲垂娴犲钃熼柨娑樺濞岊亪鏌ｉ敐鍛健鐟滃秹鍩為幋锔芥櫖闁告洦鍋勯獮瀣⒑鏉炴壆顦﹂柛濠傜仢閻ｅ嘲顭ㄩ崱鈺傤€囬梻浣告憸閸嬫盯鎮ラ悡搴綎?
            if (turret.isInWaterOrBubble()) return false;

            return !turret.getNavigation().isDone() &&
                    owner != null &&
                    turret.distanceToSqr(owner) < (minDistance * minDistance);
        }

        @Override
        public void start() {
            // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑鏅悷婊冪Ч濠€渚€姊虹紒妯虹伇婵☆偄瀚板鍛婄瑹閳ь剟寮诲☉妯锋斀闁告洦鍋勬慨搴ㄦ⒑閹肩偛濡界紒璇插暣婵＄敻宕熼姘敤闂侀潧臎娴ｆ彃浜鹃柟鐑橆殕閻撶喐绻濋棃娑冲伐闁绘挻鍔曡彁闁搞儜宥堝惈濡炪們鍨虹粙鎴﹀煘閹达箑骞㈡俊銈勭閸旀帡姊婚崒娆戭槮缁剧虎鍘鹃崚鎺楊敍濮ｅ吋鐩畷姗€顢欓懝鐗堟啺闁诲骸绠嶉崕閬嶆偋濠婂喚鐎堕柕濞炬櫆閳锋垿鏌涘☉姗堟敾閻忓繒澧楅幈銊ノ熺粙鍨瀷闂佸憡甯楃敮鎺楀煝鎼淬劌绠涙い鎺戝€婚悰顕€姊绘担绛嬫綈婵犮垺锕㈤幃妯侯潩鐠鸿櫣鏌у┑鐘诧工鐎氼喚绮绘ィ鍐ㄧ骇闁割偅绻傞埛鏃傜磼鐎ｎ厼鍚归柟鍙夋倐瀵爼宕归鑺ヮ唹缂傚倷绀侀崐鍝ョ矓瑜版帒绠栨繛鍡樻惄閺佸棝鏌涚仦鍓х煂婵℃彃娲ら埞鎴︽偐閸偅姣勬繝娈垮枟閹稿啿鐣烽幇顖樹汗闁瑰箍鍊曢ˇ鐢稿箖閳哄懏鍋ㄩ柣銏㈩暜缁辨煡姊绘担铏瑰笡闁挎岸鏌熺喊鍗炰簼缂佸倸绉瑰畷鐑筋敇閻樼绱查梺鍝勵槸閻楀嫰宕濈仦鐭綊顢欓柨顖氫壕閻熸瑥瀚粈鍐偨椤栨稑娴柍銉畵婵℃悂鍩℃担渚О闂備線娼ч…鍫ュ磿濞戙垹鍗抽柕蹇婃閹风粯绻涢幘鏉戠劰闁稿鎹囬弻宥堫檨闁告挻鐩畷鎴濃槈閵忊€虫濡炪倖鐗楃粙鎺戔枍閻樼偨浜滈柡宥冨妿閻瞼鐥幆褋鍋㈤柡宀嬬秮楠炲寮埀顒€鈻嶉崨顒肩懓顭ㄩ崼銏㈡毇濠殿喖锕ㄥ▍锝夊箯閻樿钃熼柕澶堝劚閸欏﹥绻濋悽闈涗粧闁告牜濞€瀹曟儼顦查柣婵嚸—鍐Χ閸℃鐟ㄩ梺绋匡工椤兘骞嗙仦鎯х窞閻忕偟顭堟禍鐐殽閻愯尙浠㈤柛鏃€纰嶉妵鍕晜閸喖绁Δ鐘靛仜濡繈骞冨▎鎾村€绘俊顖濇〃閻㈢粯绻濋悽闈涗粶婵☆偅顨堥幑銏ゅ箛闁附鏅滃銈嗗姧闂勫嫰鎮″☉銏＄厱闁斥晛鍟伴幊鍐冀閿涘嫮纾藉ù锝堟鐢稓绱掔€ｎ偄绗掓い顓炴穿缁犳稑鈽夊Ο纰辨Ф闁荤喐绮岀粔鐟扮暦閸濆嫮鏆嗛柍褜鍓涘Σ鎰板箻鐎涙ê顎撻梺鍛婃尭瀵墎鐟ч梻鍌欒兌缁垶鎮ч弴銏犖ч柟闂磋兌瀹?
            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈠姊绘笟鈧褔藝椤愶箑鐤炬繛鎴炶壘椤ユ岸鏌涢敂璇插箺闁哥姵鍔欓弻锝呂旈埀顒勬偋閸℃瑧绠旈柟鐑樻尰閸欏繘鎮峰▎蹇擃伀闁告瑢鍋撻梻浣告惈閻绱炴担鍓插殨妞ゆ洍鍋撶€规洘甯掗～婵嬵敆閳ь剟鈥栭崱娑欌拻濞达絽鎲￠幉绋库攽椤旇姤缍戦摶鐐寸節闂堟侗鍎忛柦鍐枛閺屾洘绻涢崹顔煎闂佽　鍋撳ù鐘差儐閻撴洟鏌嶉柨顖氫壕闂佸搫鎳忕划搴ㄦ偡瑜嶉埞? turret, 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎰剁悼閳ь剚濞婇幃妤呯嵁閸喖濮庡銈忓瘜閸ㄨ泛鐣疯ぐ鎺戠＜闁绘劕顕崢浠嬫⒑闂堟稓绠氶柛鎾寸箘缁辩偤宕熼娑氬幈闂侀潧顧€缁茶姤淇婄捄銊х＜闁抽敮鍋撻柛瀣尰缁绘繂鈻撻崹顔界亶闂佹寧娲嶉弲鐘茬暦閵忋倖瀵犲璺烘閻?闂? 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎰剁悼閳ь剚濞婇幃妤呯嵁閸喖濮庡銈忓瘜閸ㄨ泛鐣疯ぐ鎺戠＜婵犙勫劤娴滈箖鎮峰▎蹇擃仾缂佲偓閳ь剙鈹戦悙鑼勾闁告柨娴烽崚鎺撶節濮橆剛鐫勯梺鍓插亞閸犳捇宕㈤柆宥嗗€甸柛蹇擃槸娴滈箖姊洪柅鐐茶嫰婢у鈧娲橀崹鍧楀箖濞嗘挸浼犻柛鏇ㄥ幗閻?闂? 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫鍐煥閺囨浜鹃梺姹囧€楅崑鎾舵崲濠靛洨绡€闁稿本绋戝▍锝夋⒑閹肩偛濡界紒璇茬墦閻涱噣寮介‖銉ラ叄椤㈡鍩€椤掍椒绻嗛柣鎴ｅГ閻撳啰鎲稿鍫濈婵鍩栭崑瀣煟濡灝鐨洪柡鍡畵閺屟嗙疀閿濆懍绨电紓浣筋嚙濡瑧鎹㈠☉妯兼殕闁逞屽墴閿濈偤宕抽幇鐗堚拻闁稿本鑹鹃埀顒佹倐瀹曟劙鎮滈懞銉モ偓鍧楁煥閺囩偛鈧綊宕曢幋鐘冲枑闁绘鐗嗙粭鎺旂磼閳ь剚寰勭仦绋夸壕闁稿繐顦禍楣冩⒑闁偛鑻晶鎾煕閳规儳浜炬俊鐐€栫敮濠勭矆娓氣偓瀹曠敻顢楅崟顒傚幈闂佽鍎抽顓㈠箠閸ヮ剚鐓冮柕澶樺灣閻ｇ數鈧娲栭悥濂稿灳閺嶎収鏁嗗ù锝堫嚃濡啴鎮楃憴鍕８闁告梹鍨块妴浣糕枎閹炬潙娈熼梺闈涱樈閸犳洟骞?
            net.minecraft.world.phys.Vec3 awayPos = net.minecraft.world.entity.ai.util.DefaultRandomPos.getPosAway(turret, 4, 2, owner.position());

            if (awayPos != null) {
                // 闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃繘鍩€椤掍胶鈻撻柡鍛█閵嗕礁鈻庨幘鍐插敤濡炪倖鎸鹃崑鐔兼偘閵夆晜鈷戦柛锔诲幖閸斿銇勯妸銉﹀櫧濠㈣娲樼换婵嗩潩椤撶姴骞嶉梻浣虹帛閸旓箓宕滃鑸靛€堕梺顒€绉甸悡娑㈡煃瑜滈崜鐔煎箠閻愬搫唯闁挎繂瀚惄搴ㄦ⒒娴ｅ憡鎯堥柛鐕佸亰瀹曟劙鎮界粙璺唵闂佽法鍠撴慨鐢告偂閺囥垹绠规繛锝庡墮閻忊晠鏌ｈ箛銉ヮ洭缂佽鲸甯″畷鎺戭潩濮ｆ瑣鍨介弻宥夋寠婢舵ɑ鈻堟繝娈垮枓閸嬫捇姊洪幐搴ｂ槈閻庢凹鍓熼悰顕€宕奸妷锔规嫽婵炶揪绲介幉锟犲箚閸儲鐓曞┑鐘辫兌閻瑦銇勯姀鈥蹭孩妞わ箑鍟胯彁闁搞儜宥嗘暰缂備浇妗ㄧ划娆忕暦閵婏妇绡€闁告洦鍋勭粻鐐烘⒒閸屾瑧顦﹂柣銈呮搐椤╁ジ濡搁埡鍌氭畱闂佸壊鍋呭ú姗€宕愰崸妤佺厵闂傚倸顕崝宥夋煟閹惧娲撮柟顔斤耿閹瑧鎹勯惄鎺撴崌閺屾盯鎮╃粵纭呪偓鍧楁煛鐏炵澧查柟宄版嚇閹兘寮跺▎鐐稈闂佽姘﹂～澶娒哄鍫濈獥闁哄稁鍘归埀顑跨閳藉顫滈崱妯哄厞婵＄偑鍊栭幐鐐叏闂堟侗鐔嗛柟鍓х帛閳锋帡鏌涚仦鍓ф噮妞わ讣绠撻弻鐔哄枈閸楃偘鍠婇柦妯荤箖閵囧嫰骞囬崜浣烘殸闂佹眹鍊楅崑鎾舵崲濠靛洨绡€闁稿本绋戝▍锝夋⒑閹肩偛濡界紒璇茬墦閻涱噣寮介‖銉ラ叄椤㈡鍩€椤掍椒绻嗛柣鎴ｅГ閻撳啰鎲稿鍫濈婵鍩栭崑瀣煟濡灝鐨洪柡鍡畵閺屾盯顢曢敐鍡楊槱闂佽桨绀佸Λ妤呮箒闂佹寧绻傚ú銊╁Υ婵犲洦鐓曢悗锝庡亝瀹曞矂鏌熼鐣岀煉闁瑰磭鍋ゆ俊鐤槻妤犵偞顨婇弻锝夋偄閸濄儳鐓€缂備礁顦紞濠囨偘椤斿槈鏃堝焵椤掑嫧鈧箓濡搁埡浣哥獩濡炪倖鐗楃划搴ㄥ礉鐠鸿　鏀介柣姗嗗枛閻忛亶鏌涢埡鍌滃⒌鐎规洘绻堝浠嬵敇閻愰潧骞堥梻浣烘嚀椤曨參宕戦幋鐐殿洸婵犲﹤鐗婇悡娆撴煙娴ｅ啯鐝繛鍛嚇閺屽秷顧侀柛鎾磋壘鐓ら柣鏂款殠閸ゆ洟鏌涘☉姗堟敾闁稿海鍠栭弻鏇熺節韫囨洜鏆犻梺閫炲苯澧伴柡浣割煼瀵鏁愭径瀣簻缂備礁顑嗛娆徫涢崱娑欌拺闁圭娴烽埥澶岀磼婢跺﹤顣虫俊鍙夊姍楠炴帒螖婵犲啯娅撻梻浣风串缁蹭粙寮甸鍕棷鐟滃秹鈥旈崘顔嘉ч柛鈩兠喊宥夋⒑闂堟稓澧㈡い顓炵墦閹箖鎮滈挊澹┾晠鏌嶉崫鍕舵敾闁哄懌鍨藉铏圭矙閹稿孩鎷遍梺鑽ゅ枂閸婃鍩€椤掍胶鈻撻柡鍛Т椤繑绻濆顒傦紲濠殿喗顭堥崑鎰板矗閺囥垺鈷戠紒瀣儥閸庡繘鎮楀鐓庡⒋婵犫偓娓氣偓濮婅櫣绮欑捄銊т紘闂佺顑嗙粙鎾寸珶閺囩喓绡€婵﹩鍘鹃崢閬嶆煟韫囨洖浠滃褌绮欓幆灞界暆閸曨剛鍘卞┑掳鍊撶粈渚€宕ú顏呯厸鐎光偓閳ь剟宕伴幘鑸殿潟闁圭儤顨呴～鍛存煟濡櫣锛嶅ù婊冪埣濮?(1.0)
                turret.getNavigation().moveTo(awayPos.x, awayPos.y, awayPos.z, speed);
            }
        }

        @Override
        public void stop() {
            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁逞屽墾缁犳挸鐣锋總绋课ㄩ柨鏃囧Г閻濇牠姊绘笟鈧褔鏁嶈箛娑樼妞ゆ帊绶￠崬鍫曟⒒閸屾瑨鍏岀紒顕呭灦瀵濡搁埡鍌氬壄濠电娀娼ч鍛磼閳哄懏鐓ラ柡鍥╁仜閳ь剙缍婇幃锟犲即閻旇櫣顔曢梺鐟扮摠缁诲倿鎳滆ぐ鎺撶厽闊洢鍎抽幃濂告煟閵夘喕閭鐐叉椤︿即鏌涚€ｃ劌鐏查柡灞糕偓宕囨殕闁逞屽墴瀹曚即寮介鐘茬ウ闂佺硶鍓濋崙鐟拔ｆィ鍐┾拺闁革富鍘藉▍鏇炩攽閻愨晛浜鹃梻浣筋嚃閸犳鈥﹂崼銏笉婵炴垯鍨圭粻濠氭煙绾板崬骞楅柨娑樻濮婄粯鎷呴崨濠冨創闁荤偞鍑归崑濠傜暦濠靛棛鏆嗛柛鏇ㄥ亞閸欌偓濠电姰鍨煎▔娑滅檶闂佺粯姊婚崢褔宕归崒娑栦簻闁哄洨鍋為崳鍝ョ磼鏉堛劍鈷愮紒缁樼箞閹粙妫冨☉妤冩崟婵＄偑鍊栧ú锕傚储娴犲绠為柕濞炬櫆閻撱儵鎮楅敐搴′簻鐎殿喖娼″鍝勑ч崶褏浼勯梺杞扮劍閹倿骞嗙仦瑙ｆ瀻闊浄绲块崬鐢告煟閻樺弶鎯堥柟纰卞亰钘濇い鎺戝閻撴洟鎮楅敐搴′簼鐎规洖鐭傞弻鈩冩媴閻熸澘顫嶉梺璇″灡濡啴宕规ィ鍐╁殤妞ゆ巻鍋撻柛銈庡墴濮?
            turret.getNavigation().stop();
        }
    }
    // ==========================================
    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱樈閸犳顕欏ú顏呪拺缂侇垱娲栨晶鍙夈亜閵娿儲鍣界紒顔芥閵囨劙骞掗幘顖涘闂備胶鍘ч～鏇㈠磹閺囥垹鍑犻幖娣妽閳锋垿鎮介锝呮灓缂佸鍠氶埀顒侇問閸犳盯顢氳閸┿儲寰勬繛銏㈠枛閺屻劎鈧綆鍏橀崑鎾寸節濮橆厸鎷洪悷婊呭鐢帗绂嶆导瀛樼厱闁绘ê纾晶鐢告煕閳哄倻銆掑ù鐙呭缁數鈧綆鍋勯惁婊堟⒒娓氣偓濞佳囨偋閸℃稑鐤い鎰剁畱缁€澶嬫叏濡炶浜鹃梺鍝勬湰缁嬫帞鎹㈠┑瀣妞ゅ繐妫涢弶浠嬫煟?& 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐偓锝庝簼閹癸綁鏌ｉ鐐搭棞闂囧鏌ㄥ┑鍡樻悙闁告柨顑囬埀顒冾潐濞叉牕顕ｉ崼鏇炵疄闁靛鍎哄〒濠氭偣閸ヮ亜绱﹀瑙勬礋濮婄粯鎷呯粵瀣異闂佸摜濮甸〃鍛粹€﹂崹顕呮建闁逞屽墴瀹曟椽濮€閳╁啫鍔呴梺闈涱焾閸庢娊鎮块埀顒佷繆閻愵亜鈧牠骞愭ィ鍐ㄧ？闁归偊鍓﹂悞鑺ャ亜閺嶃劎鈼ョ紒璇叉閺岋綁骞囬崗鍝ョ泿闂侀€炲苯澧柣妤佹礋椤㈡瑨绠涢弮鍌滅槇濠殿喗锕╅崜娑㈡晬濞戙垺鈷戦柣鐔告緲閳锋梻绱掗鍛仸鐎规洘鍔欏Λ鍐归姀鐘电Ш闁轰焦鍔欏畷銊╊敇閻斿壊鍞查梻鍌欑劍閻綊宕濆鍜佹富濞寸姴顑呴拑鐔哥箾閹存瑥鐏╅柛鎰ㄥ亾闂備線娼ц噹闁告劧绲剧€氭煡姊婚崒娆戭槮婵犫偓闁稁鏁嗛柤纰卞墯瀹曞弶绻濋棃娑欑煑缂佽妫濋弻娑㈩敃閿濆棛顦ラ梺缁樺姇閿曪箓骞夊宀€鐤€婵炴垶锚閸?
    // ==========================================
    private void handlePickupAndXp() {
        if (this.level().isClientSide) return; // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈢粯淇婇悙顏勨偓鏍偋濡ゅ啰鐭欓柟鐐湽閳ь剙鎳樺畷锝嗗緞瀹€鈧惁鍫熺節閻㈤潧孝闁稿﹥鎮傚鎼佹晝閸屾稓鍘鹃梺缁橆殔閻楀棝顢氬鍫熺厪闁搞儜鍐句紓缂備胶濮甸惄顖炵嵁濡吋宕夊〒姘煎灡濮ｅ洭姊绘担绛嬪殭閻庢稈鏅犻幊婵囥偅閸忣垰娲弻鍡楊吋閸涱垰濮︽俊鐐€栧濠氬磻閹惧墎纾奸柣妯垮皺鏁堥悗瑙勬礃濞茬喖寮婚崱妤婂悑闁告侗鍨抽弸鍐⒑閻熸澘鎮戦柟顖氱焸閹剝寰勫畝鈧粈濠囨煛瀹ュ骸骞楅柣鎾崇箻閺屾盯顢曢敐鍥╃暫閻庣懓鎲＄换鍕儉椤忓牆绠氱憸瀣磻閵忋倖鐓涚€光偓鐎ｎ剛鐦堥悗瑙勬礃閿曘垽宕洪埄鍐╁閺夌偟澧楀Ο濠囨⒒閸屾瑦绁版い鏇嗗懏宕查柛顐犲劚绾捐法鈧娲栧ú锕傦綖閺囥垺鐓欓柣鎴炆戦埛鎰版倵濮橆厼鍝洪柡灞诲€楅崰濠囧础閻愭彃袨闁荤喐绮嶅Λ鍐嚕?

        // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箻閺岀喖骞嗛弶鍟冩捇鏌涙繝鍌涘仴闁哄被鍔戝鎾倷濞村浜鹃柛婵勫劚椤ユ岸鏌涜椤ㄥ棝鎮″▎鎾寸厵妞ゆ牗绋掔欢鑼偖濮樿埖鈷戠紒瀣儥閸庡矂鏌￠崨顔绢灱闁诲繐鍟村娲箰鎼达絿鐣甸梺鐟板暱闁帮絽顕ｉ崘娴嬫瀻闁瑰濮烽敍婊堟⒑缂佹鎲块柛瀣崌閺屾盯濡搁妷褍鐓熼悗娈垮枛椤兘骞冮姀銏犳瀳閺夊牄鍔嶅▍鏍⒒娴ｈ櫣銆婇柛鎾寸箞閵嗗啴宕ㄩ弶鎴炶緢闂佺粯鏌ㄩ崥瀣偂濞嗘劑浜滈柡鍐ㄥ亞閸庣娀鏌涚€ｃ劌鐏柟渚垮妽缁绘繈宕橀埞澶歌檸闂備胶顢婂▍鏇㈡偋閻樿鏄ラ柍鈺佸暞婵挳姊婚埀顒勫箛椤旇偐顐奸梻鍌氬€搁崐椋庣矆娓氣偓楠炴顭ㄩ崼婵嬫７闂侀潧顦弲娑氬婵犳碍鐓曢柡鍥ュ妼楠炴牜鈧鍠楅悡鈥愁潖缂佹ɑ濯村〒姘煎灡缂嶅﹪姊洪崨濠冪闁诲繑宀搁幃楣冩倻閼恒儮鎷洪梺鍛婄箓鐎氼厽鍒婃總鍛婄厱闁圭偓娼欓崫鐑橆殽閻愯尙澧﹀┑鈩冩倐婵＄兘顢欓挊澶岀处闂傚倷鑳剁涵鍫曞礈濠靛桅闁绘劒绲绘慨鎶芥煟閵忋垺鏆╃痪鎹愭闇夐柨婵嗩槹濞懷冣攽閳╁啯銇濋柡灞剧☉铻栧ù锝囩《閺嬫瑩鎮楀▓鍨灈妞ゎ厾鍏樺顐﹀箛椤撶偟绐炴繝鐢靛Т鐎氼噣寮堕幖浣光拻闁稿本鑹鹃埀顒佹倐閹勭節閸曨厾鐓撻梺鍦劋椤ㄥ棝宕愰崼鏇熺厱妞ゆ劗濮撮崝婊堟煕鐎Ｑ冨⒉缂佺粯绻冪换婵嬪磼濮橀棿鐥紓鍌欐祰閸╂牠鎮￠敓鐘茶摕闁挎繂妫楃粻鐘绘⒑閸涘﹥鐓ユ繛瀵稿厴瀹曟岸骞掗幋鏃€鐎婚梺褰掑亰閸撴稓绮ｉ悙鐑樼厽閹兼惌鍨崇粔鐢告煕鐎ｎ亜顏柨婵堝仱閺佹捇鎮╅弬銉﹀闂備浇宕甸崰鎰熆濡綍锝嗙節濮橆厾鍘惧┑鐐跺蔼椤曆囨倶閿曞倹鐓熸繛鎴濆船濞呭秹鏌涢埞鎯т壕婵＄偑鍊栫敮鎺斺偓姘煎弮閸╂盯骞掗幋鏃€鏂€闂佺粯蓱閻擄繝顢撳Δ鈧湁婵犲﹤瀚惌瀣磼缂佹銆掑ù鐙呯畵瀹曟帒顫濋敐鍛濠电娀娼уΛ娑㈠汲閿曞倹鐓涘璺猴功濮樸劍淇婇幓鎺斿闁逛究鍔岄～婊堝幢濡も偓鐎涳絽鈹戦悙璺轰汗闁哥姴閰ｉ崺鐐哄箣閿旇棄浜圭紓鍌欑劍钃遍梺娆惧幖椤啴濡堕崱妤冧淮闂佺娅曢崝娆撶嵁婢舵劕绠绘い鏃囧Г濞呭洭姊虹粙鎸庢拱缂佸鎹囧畷銏ゆ偨閸涘﹦鍘介柟鍏肩暘閸ㄥ鍩婇弴鐔翠簻妞ゆ挾鍋炲婵堢磼椤旂⒈鐓煎┑锛勫厴閺佸倻鎹勯妸褏鏆板┑锛勫亼閸婃牠鎮уΔ鍐ㄦ瀳鐎广儱锛嗘径鎰潊闁靛牆妫涢崢?3.5 闂?
        // getBoundingBox() 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犖ч柛灞剧煯婢规洖鈹戦鐭亜鐣烽鍕偍閻庣數纭堕崑鎾舵喆閸曨剛顦ョ紓鍌氱Т閿曨亪鎮伴鑺ュ劅闁靛绠戦惂鍕節閵忥絾纭鹃柣顓烆槺濡叉劙鏌嗗鍡忔嫽婵炶揪绲介幉锟犲箚閸垻纾奸悗锝傛櫇缁愭梻鈧娲忛崹铏圭紦娴犲宸濆┑鐘插€告竟鎺撶節瀵伴攱婢橀埀顒佹礋楠炲﹨绠涘☉娆忎簵濠电偛妫欓崝妤冪不妤ｅ啯鐓曟い鎰剁悼缁犳ê霉閻橆喖鐏查柡宀嬬磿閳ь剨缍嗛崜娆撳几濞戙垺鐓涚€光偓鐎ｎ剛袦闂佽桨鐒﹂崝娆忕暦閻撳寒鐓ラ柛鎰ㄦ櫅閸撶敻姊婚崒娆戝妽闁活亜缍婂畷鏇㈡倻濡⒈娲稿銈呯箰閻楀繐鐣垫担琛″亾楠炲灝鍔氭い锔跨矙瀵偅绻濋崟顓燂紡闂佺懓鍢查惌鍌炲传閻戞ɑ鍙忛柨婵嗘媼濡偓濠殿喖锕︾划顖炲箯閸涘瓨鍊绘俊顖滃劋閻ｎ剟姊绘担渚敯妞ゆ洘绮庡Σ鎰板即閵忕姵鐎銈嗘磵閸嬫捇鏌熼鐣屾噰婵☆偄鍟埥澶娢熼梻鏉戞瀳濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣銏犳啞閸ゅ矂鏌涢幘妤€鎳嶇粭澶愭⒑缂佹ɑ鐓ラ柛姘儔瀹曟劙鎮介崨濠勫弳濠电娀娼уΛ婵嬵敁濡も偓椤儻顦村褎顨婃俊鐢稿礋椤栨稒娅嗛梺缁樺姦閸撴艾袙閸炲碂late(1.5) 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犖ч柛灞剧煯婢规洖鈹戦鐭亜鐣烽鍕偍閻庣數纭堕崑鎾舵喆閸曨剛顦銈庡亜椤︻垶鈥﹂崶顏嗙杸婵炴垶顭傞埡鍛厪闁割偅绻冨婵嬫煟閿濆鐣烘慨濠勭帛閹峰懘宕ㄦ繝鍌涙畼缂傚倷绀侀幖顐㈩焽閳ュ磭鏆﹂柡鍥ュ灪閹偞銇勯幇鈺佲偓鎰板几閺嶎厽鍊垫鐐茬仢閸旀碍銇勯敂鍨祮闁诡噯绻濆鎾偄閸撲胶鐣鹃梻渚€娼ч悧鍡涘箠鎼淬劌姹叉繛鍡楃贩瑜版帗鍋愭繛鍡楃箲婢跺嫰鏌ｉ幘瀵告噰闁哄矉绠戣灒濞撴凹鍨辨闂佽桨绀侀悧鎾愁潖濞差亜浼犻柛鏇ㄥ墯閹疯京绱撴担鍓插剱闁搞劌娼″畷娲閳╁啫鍔呴梺闈涱焾閸庢娊鎮鹃悙顒傜瘈闂傚牊绋戦埀顒佹倐钘濇い鏇楀亾闁哄苯娲、娑橆潩閿濆棙鏉?
        List<Entity> targets = this.level().getEntities(this, this.getBoundingBox().inflate(3.5));

        for (Entity target : targets) {

            // --- 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亜顒㈡い鎰矙閺屻劑鎮㈤崫鍕戙垻鐥幆褜鐓奸柡灞剧☉閳藉宕￠悙鑼洿闂備焦瀵х换鍌炈囬婊呬笉闁规儼濮ら悡娑㈡煕閹板墎鍒板ù婊勫劤椤?A: 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗霉閿濆牊顏犵紒鈧繝鍌楁斀闁绘ê寮堕幖鎰磽娴ｅ弶娅婃慨濠冩そ椤㈡鍩€椤掑倻鐭撻悗鐢殿焾椤ユ岸鏌涜椤ㄥ棝宕愰悽鍛婄厱闁挎棁顕ч獮鏍偖閵婏妇绠鹃悗娑欘焽閻﹦绱撳鍜冭含鐎殿喛顕ч埥澶愬閻樻牓鍔嶉妵鍕籍閸屾艾浠樺銈庡亽娴滎亜顫忛搹鍦煓婵炲棙鍎抽崜鏉款渻閵堝棗鐏ユい锕傛涧椤曪絿鎷犲顔兼倯闂佺硶鍓濋敋妞ゎ偓绻濆铏规喆閸曢潧鏅遍梺鍝ュУ閻楁绌辨繝鍐浄閻庯綆鍋€閹?(婵犵數濮烽弫鍛婃叏閻戝鈧倿顢欓悙顒夋綗闂佸搫娲㈤崹鍦缂佹绠鹃柟瀛樼懃閻掓椽鏌℃担绋款伃闁哄本鐩俊鐑筋敊閻撳寒娼荤紓鍌欑劍閸旀牠銆冩繝鍥ц摕闁绘梻鍘х粻姘辨喐韫囨稑绠洪柣妯虹－缁?& 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴姘辩Т闂佹悶鍎洪崜锕傚极瀹ュ鐓熼柟閭﹀灠閻ㄦ椽鏌ㄥ☉娆戞噮缂佽鲸鎹囧畷鎺戔枎閹存繂顬夐梺钘夊暢妞村摜鎹? ---
            if (target instanceof ItemEntity itemEntity) {
                ItemStack stack = itemEntity.getItem();

                // 1. 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂磋閳ь剨绠撻、妤呭礋椤愩倧绱遍梻浣告啞濞诧箓宕愮€ｎ€㈡椽顢旈崟骞喚鐔嗛悹铏瑰皑閸旂喖鏌ｉ妶鍛悙闁宠鍨块、娆愭叏閹邦亞鎹曢梻浣侯焾椤戝棝骞愰幖浣哥厴闁硅揪闄勯弲顒勬煕閺囩偟浠涙い銉︽尵缁辨挻鎷呴崫鍕戯絿绱掔€ｎ偄鐏撮柛鈹垮劜瀵板嫭绻涢姀銏犳灈鐎规洦鍋婂畷鐔碱敆閳ь剟鎯冮妸锔剧瘈缁炬澘顦辩壕鍧楁煕鐎ｎ偄鐏寸€规洘鍔欏浠嬵敇閻旇渹缃曟繝寰锋澘鈧洟宕导瀛樺剹婵炲棙鎸婚悡娆撴煟閹伴潧澧褜鍨辩换娑㈠礂閼测晛鈪归柧缁樼墵閺屻劌鈹戦崱妯烘闂佸搫妫涢崑銈夊蓟濞戞埃鍋撻敐搴″閺嶏繝姊洪柅娑氣敀闁告柨鐭侀悘鎺楁⒑缂佹ɑ灏Δ鐘叉啞缁傛帒螣閼姐倗顔曢柣搴㈢⊕椤洭鎯岀€ｎ剛纾奸悹鍥ㄥ絻椤忣參鏌涢埞鎯т壕婵＄偑鍊栫敮鎺楀窗濮橆剦鐒介柟閭﹀幘缁犻箖鏌涘▎蹇ｆШ缂佺姵鐗犻弻鏇㈠炊閵婏腹鎷荤紓渚囧枟閻熴儵鍩㈡惔銊ョ鐟滃秵鎱ㄩ崫鍕ㄦ斀闁绘ê鐏氶弳鈺佲攽椤旂偓鏆柟铏箖閵堬綁宕橀埡浣插亾瀹勬壋鏀介柣妯哄级婢跺嫰鏌ｉ幘鍐叉殻闁哄本绋戦埞鎴﹀幢濡ゅ﹣鎮ｉ梻渚€鈧偛鑻晶顔姐亜椤撶偛妲绘い?
                if (itemEntity.hasPickUpDelay()) continue;

                // 2. 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎺嶇劍椤斿洭姊绘担瑙勫仩闁稿孩妞藉畷婊冣枎閹存繍妫滈悷婊呭鐢鎮″☉銏＄厱闁靛绲介崝姘舵煟韫囷絼閭柡灞剧〒閳ь剨鎬ラ崟顒傚絽闂佸墽绮悧鐘诲蓟閵娿儮鏀介柛鈩兠▍锝夋⒑閸濆嫭顥為柣鐔叉櫊瀵鈽夊Ο閿嬬€婚棅顐㈡储閸庢煡寮ィ鍐┾拺闂傚牊绋掗幖鎰版倵濮橆厽绶叉い鏇稻缁傛帞鈧綆鈧厸鏅濋幉绋款煥閸繃杈堥梺璺ㄥ枔婵敻鍩涢幋鐘电＜閻庯綆浜濋崑銉︺亜鎼淬埄娈滈柡灞诲姂瀵挳濡搁妶澶婁粣闁诲孩顔栭崰鏍€﹂悜钘夌畺闁靛繈鍊曠粈鍌炴煠濞村娅呯€殿喗濞婂铏规嫚閹绘帒姣愮紓鍌氱Т濡瑧绮嬪鍜佺叆闁告洦鍓欏鍧楁⒑闂堟稓绠為柛濠冪墵瀹曟垿鍩勯崘顏嗙槇婵犵數濮撮崐鎼侇敂椤忓棛纾奸悹鍝勬惈缁狙呯磼缂佹鈽夋い鏂跨箻椤㈡瑩鎮℃惔锝囨綁闂?
                // - 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯锋嫼閻熸粎澧楃敮鎺撶娴煎瓨鐓曢柟鎯ь嚟閹冲啯銇勯弴顏嗗埌闁伙綇绻濋弻鍥晜閽樺妲ｉ梻鍌欑窔濞佳囨偋閸℃あ娑樷槈濞嗘劖鐝烽梻渚囧墮缁夌敻鎮￠弴銏犵婵烇綆鍓欓悘鈺佲攽椤斿吋鍠橀柟钘夌埣閹瑩鎮滃Ο鐓庡妇濠电姷鏁搁崑鐔煎磻閹炬枼鏋嶉柛鈩冪⊕閻撶喖鏌熼幑鎰【闁哄鍨佃彁闁搞儜宥堝惈闂佽鍠楅悷鈺呭箖娴犲顥堟繛鎴炲嚬閸嬔冣攽閻樺灚鏆╅柛瀣洴楠炲﹨绠涢幙鍐╃稁闂佺厧顫曢崐鏍綖閺囥垺鐓欓柣鎴烇供濞堟棃鏌ｉ鐕佹畷濞ｅ洤锕、娑橆潩椤撶喎鍓电紓鍌欐缁讹繝宕伴弽顒備簷闂備胶绮敃銏狀焽瑜庣粋宥堛亹閹烘挾鍘遍柣搴秵閸嬪懐浜搁悽鐢电＜閺夊牄鍔嶅畷宀€鈧娲樼敮鎺楀煝鎼淬劌绠ｆ繝闈涙－閻庢挳姊绘担鑺ヮ棄闁哥喕娅曠粋宥夘敆閸屾艾鐏婂銈嗘尪閸ㄥ湱绮婚敐澶嬬叆闁哄啫娉﹂幒妤€绠繛宸簼閸嬧剝绻濇繝鍌涘櫣妞わ絽銈搁幃浠嬵敍濞戣鲸鐤侀悗娈垮櫘閸嬪﹪寮婚崱妤婂悑闁糕剝鐟ラ獮鍫ユ⒑绾懎顥嶉柟娲讳簽濡叉劙寮撮姀鐘插殤闂佸憡鍔﹂崰妤呮偂?(婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓闁搞劌鍊块弻娑㈩敃閿濆棛顦ョ紓浣哄У瑜板啴婀侀梺鎸庣箓閹冲酣藟韫囨梻绠鹃悗娑欘焽婢х敻鏌＄仦鐐缂佺粯绋栭ˇ鍙変繆椤愶綆娈旈柣顭戝墴濮婂宕掑▎鎰偘濠电偛顦板ú鐔风暦娴兼潙绠婚悗娑櫭鍧楁⒑閸︻叀妾搁柛鐘愁殜瀹曟劕鐣￠幍铏杸闂佺粯锚瀵埖寰勯崟顖涚厽闁规崘娉涢弸娑㈡煛瀹€鈧崰鎰偓闈涖偢瀵爼骞嬪鍐╃€抽梻鍌欑閹碱偊藝閺夋娓诲ù鐘差儏閽冪喖鏌ㄩ悢鍝勑㈤柣?
                // - 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欑€靛摜鐦堥梺姹囧灲濞佳冪摥濠德板€楁慨鐑解€﹂崼銉ョ厺闁规崘顕ф儫闂佸啿鎼崐鐢稿箯濞差亝鈷掑〒姘搐娴滅偤鏌涚€ｎ偆娲撮柟宕囧枛椤㈡稑鈽夊▎鎰娇闂佽娴烽弫鍝ユ兜閸洖纾婚柟鎹愬煐閸犲棝鏌涢弴銊ュ闁挎稒锕㈠铏圭矙閹稿孩宕抽梺杞扮椤攱淇婄€涙ɑ濯寸紒顖涙礃椤秴鈹戦埥鍡楃仸闁衡偓闁秵鍊靛┑鐘崇閳锋垿鏌ｉ悢绋款棆闁圭晫濮风槐鎺旀嫚閹绘帗娈梺瀹狀嚙缁夊綊鐛Ο鑲╃＜婵☆垶鏀辩€氳棄鈹戦悙鑸靛涧缂佽弓绮欓獮妤€顭ㄩ崨顖滅厠濠电偛妯婃禍婵嬫偂濞戙垺鐓冪憸婊堝礈閻旈鏆﹂柨鐔哄У閸婄兘鏌涢…鎴濅簼妞ゆ梹娲樼换婵堝枈濡椿娼戦梺鎼炲姂濞佳囧煝瀹ュ鏅插璺猴攻鏉堝牓姊洪幐搴㈩梿濠殿喓鍊濆畷锝堢疀閺冣偓閸欏繑淇婇妶鍌氫壕濠碘槅鍋呴〃濠傜暦濠靛鏅濋柛灞剧〒閸樹粙姊洪崫鍕殭闁稿﹤鎽滈弫顕€宕奸弴鐔哄幗闂婎偄娲﹂幐楣冩晬瀹ュ鐓冪憸婊堝礈濠靛缍栧璺衡姇濞差亜鍐€妞ゎ兘鍓濆鑺ヤ繆閹间礁鐓橀幖瀛樻尭娴滄儳銆掑锝呬壕閻庤娲忛崝搴ㄥ焵椤掍胶鈯曢懣銈夋煙闁垮銇濇慨濠冩そ瀹曠兘顢樿閸旂鈹戦悙宸殶闁稿繑锕㈠畷鐑樼節閸パ冨祮闂佺粯锚閻忔岸鏁嶈箛娑欌拺闁告繂瀚峰Σ鍏肩箾婢跺绀夐柛濠冩尦濮婄粯绗熼埀顒勫焵椤掑倸浠滈柤娲诲灡閺呭爼宕滆绾惧ジ鏌涘▎蹇ｆЧ闁靛洦绻勯埀顒冾潐濞叉﹢宕归崸妤冨祦婵☆垵鍋愮壕鍏间繆椤栫偞鏁遍悗姘偢濮婄粯鎷呴崨濠傛殘缂備礁顑嗛崹鍧楀极閸愵喗鏅濋柛灞炬皑閻ゅ洭姊洪崨濠冨闁搞劑浜堕幃锟犳偄闂€鎰畾闂侀潧鐗嗙€氼喚鎷归悧鍫㈢闁割偆鍠愮粈瀣煛瀹€瀣瘈鐎规洏鍔戦幃褔宕奸～顑藉亾閹邦剦娓婚柕鍫濇鐏忣參鏌涘顒夊剰妞ゆ洏鍎靛畷鐔碱敆閸屾粎妲囬梻浣侯焾閺堫剛鍒掑畝鈧槐鐐存媴閸︻厾鐦堥梺姹囧灲濞佳嗏叿闂備焦鎮堕崝搴ㄥ储瑜旈崺銏ゅ棘鎼存挻顫嶉梺瀹犳硾閹碱偄煤椤撱垹钃熼柛鈩冾殢閸氬骞栧ǎ顒€鐏繛鍛搐閳规垿鎮欏顔兼婵犳鍠楅幐鎶姐€侀弽顓炲耿婵炴垶鐟ユ禍?
                boolean shouldPickup = stack.isEdible() || isCommandScavenging();

                if (shouldPickup) {
                    ItemStack remainder = addItemToInventory(stack);

                    // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯锋嫼閻熸粎澧楃敮鎺撶娴煎瓨鐓曢柟鎯ь嚟濞叉挳鎸婂┑鍫熷枑闁哄倹顑欏鏍ㄧ箾瀹割喕绨兼い銉ョ墛缁绘稑菐椤掆偓閸旀岸鏌ｅΔ浣瑰碍妞ゆ洩缍侀獮鎾诲箳閸℃﹩娼旈梻渚€娼х换鎺撴叏閻戝壙鍥敋閳ь剙顫忓ú顏咁棃婵炴垼椴稿瓭闂備礁鎼幊蹇曞垝閹捐绠栭柍銉︽灱閺嬪酣鏌熼悙顒佺稇闁逞屽墮閻忔氨鎹㈠☉銏犵闁绘劙娼ч埅褰掓⒑闁偛鑻晶顖炴煕閵娿儳浠㈤柣锝囧厴楠炲洭寮堕崹顔兼暏闁荤喐绮岀换妯侯嚕閹惰姤鏅濋柛灞剧〒閸樼敻姊虹拠鈥崇仭婵犮垺顭堥。鍧楁⒒娴ｈ櫣甯涢柟姝屽吹缁瑩骞嬮敂鍏夊亾閿旂偓宕夐柕濠忕畱绾绢垶姊洪幆褏绠抽柟铏崌閵嗗倸煤椤忓應鎷洪梺鍛婄☉閿曘儵鍩涢幇鐗堢厽闁绘梹绻傞幊蹇涳綖?
                    if (remainder.isEmpty()) {
                        itemEntity.discard(); // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎺嶇劍椤斿洭姊绘担铏瑰笡闁告梹娲熼、姘额敇閻樺吀绗夋俊銈忕到閸燁垶鎮￠崘顏呭枑婵犲﹤鐗嗙粈鍫熸叏濡潡鍝虹€规洖寮剁换娑㈠箣濞嗗繒浠奸悗鐟版啞缁诲啴濡甸崟顖氱闁告鍋熸禒濂告倵濞堝灝鏋欓柛妤佸▕楠炲啫螖閸愨晛鏋傞梺鍛婃处閸撴盯藝娴煎瓨鈷戦悶娑掆偓鍏呭闂傚倷绶￠崜娆戠矓閻㈢鐤炬い鎺戝閻撴瑩姊洪銊х暠妤犵偞顨呴埞鎴︻敍濞戞瑥鍞夐梺鍝勭潤閸℃瑧鏉稿┑顔矫崥瀣礊閸儲鈷戦柛婵勫劚閺嬪秹鏌涘Δ鈧崯鍧楋綖韫囨洜纾兼俊顖濐嚙椤庢捇姊洪棃鈺佺槣闁告ü绮欓幊锝夊炊椤掍讲鎷洪梺鍛婄☉閿曘儵鎮￠妷鈺傜厽妞ゆ巻鍋撻柕鍫熸倐瀹曟椽鍩€椤掍降浜滈柟鍝勭Ф椤︼箓鏌涢妶搴″⒋闁哄本绋戦～婊堝焵椤掑倻涓嶉柡宓苯娈ㄥ銈嗗姧鐎靛矂寮€ｎ喗鐓冪憸婊堝礈閻旈鏆︽繛宸簻閻掑灚銇勯幒宥夋濞存粍绮撻弻鐔兼倻濡櫣浠村銈呮禋娴滎亪寮婚敐澶婄闁告鍋熸导鍫ユ⒑閸濆嫯瀚扮紒澶屽厴绡撳〒姘ｅ亾闁哄本鐩獮妯兼崉閻戞浜俊銈囧Х閸嬫盯宕弶鎴犳殾婵犲﹤妫Σ鍝勨攽閻愯尙鐒惧ù婊庝邯楠炲啫鐣￠幍铏€诲┑鐐叉閸ㄧ鎽梻?
                        this.playSound(SoundEvents.ITEM_PICKUP, 0.2F, 1.5F);
                    }
                    // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯锋嫼閻熸粎澧楃敮鎺撶娴煎瓨鐓曢柟鎯ь嚟濞叉挳鏌熼鍡欑瘈妤犵偛顑呴埞鎴﹀箛椤撶偟妲ｉ梻鍌欑窔濞佳囨偋閸℃稑绠犻柟閭﹀枤娑撳秴霉閻撳海鎽犻柣鎾寸懇閺屾盯骞囬鐘插绩闂佸憡鐟ョ€氫即寮婚敐鍛闁告鍋為悵婵囩節濞堝灝鏋撻柛瀣崌濮婅櫣绱掑Ο蹇ｄ簻铻炴繛鎴欏灩缁犵娀鏌熼崜褍鍔﹂柍褜鍓ㄧ粻鎾翠繆閹间礁鐓涘ù锝勮濡蹭即姊绘担绋挎毐闁圭⒈鍋婇弫鍐Ψ閳寡冾樀閹晠鎮介悽纰夌闯闂備胶顭堥張顒勬偡瑜斿畷婵嗩吋閸℃ê寮挎繝鐢靛Т閸婅崵绮旈悜姗嗘闁绘劖娼欐慨宥嗩殽閻愭煡鍙勯柟绋匡攻瀵板嫭鎯旈姀鈥虫毇闂傚倸鍊风粈浣圭珶婵犲洤纾诲〒姘ｅ亾鐎规洘娲樺蹇涘Ω閵夈儱顫婇梻鍌氬€搁崐椋庢濮橆剦鐒界憸鏃囨濡炪倖鎸堕崹鍦閸ф鐓欓柟顖滃椤ュ鏌?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙闁稿被鍔庨幉鎼佸棘鐠恒劍娈惧銈嗙墱閸嬫盯鏌ㄩ妶鍡曠箚闁靛牆瀚ˇ锔界箾閸剛鍒版い顏勫暣婵″爼宕卞▎蹇ｆ椒濠电姰鍨奸～澶娒洪悢椋庢殾闁硅揪绠戠粻濠氭偣閸ャ劌绲婚柣搴幖椤啴濡堕崱妤€顫呴梺绋款儐閹稿濡甸崟顔剧杸闁规崘娉涢。鐢告⒑闁偛鑻晶鍓х磼閻樿櫕灏板ǎ鍥э躬楠炴牗鎷呴崫銉ュ箰濠电偠鎻紞鈧俊妞煎妿濡叉劕顭ㄩ崼鐔叉嫽婵炶揪缍€濡嫭绂嶈ぐ鎺撶厓鐎瑰嫭澹嗘晶锔锯偓瑙勬礃缁矂鍩㈡惔銊ョ鐎规洖娲﹂悡?
                    else {
                        itemEntity.setItem(remainder);

                        // 3. 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙闁稿被鍔庨幉鎼佸棘鐠恒劍娈惧銈嗙墱閸嬫盯鏌ㄩ妶鍡曠箚闁靛牆瀚ˇ锔界箾閸剛鍒版い顏勫暣婵″爼宕卞▎蹇ｆ椒濠电姰鍨奸～澶娒洪悢椋庢殾闁硅揪绠戠粻濠氭偣閸ャ劌绲婚柣搴幖椤啴濡堕崱妤€顫呴梺绋款儐閹稿濡甸崟顔剧杸闁规崘娉涢。鐢告⒑闁偛鑻晶鍓х磼閻樿櫕灏板ǎ鍥э躬楠炴牗鎷呴崫銉ュ箰濠电偠鎻徊浠嬪箹椤愶絾鍙忛柛顐ｆ礃閳锋帒霉閿濆懏鍟為柛鐔哄仱閺屾盯寮埀顒勫垂閸喚鏆︽繝闈涙处閸庣喖鏌曟繛鍨姢闁挎稒鐟╁娲捶椤撶偛濡哄銈冨妼濡繈宕?(闂?缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋敐鍛闂佽姤蓱缁诲牓寮婚悢灏佹灁闁割煈鍠楅悘宥夋⒑閸濆嫭顥炵紒顔肩焸閸╃偤骞嬮敂钘変汗闂佸湱绮敮鈺傚閳ь剟姊绘担鍛婂暈妞ゃ劌妫楅悾婵嬪箹娴ｆ瓕鎽曢梺缁樻濞咃絿澹曟總鍛婄厪闊洦娲栨牎闂佽绻愮粔鐟邦潖?
                        if (this.tickCount % 60 == 0) {
                             if (this.ownerUUID != null) {
                                 Player owner = this.level().getPlayerByUUID(this.ownerUUID);
                                 if (owner != null && this.distanceTo(owner) < 12) {
                                     owner.displayClientMessage(Component.literal("[Status] Rescue support is active."), true);
                                 }
                             }
                             // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰级閻ゅ嫬鈹戞幊閸娧呭緤娴犲鐤い鎰╁€愰崑鎾愁潩椤掑效闂侀潧娲ょ€氫即鐛幒妤€绠ｆ繝鍨姃缁辨繈姊绘担鑺ャ€冪紒鈧担鑲濇稑鈹戠€ｎ亣鎽曢梺鎸庣箓椤︻垳绮诲☉娆嶄簻闁哄啫鍊哥敮璺衡攽閳╁啯銇濇慨濠呮缁瑥鈻庨幆褍澹夐梻浣告啞濮婂綊鎮烽埡渚囧殨濠电姵鑹惧洿婵犮垼娉涢敃锝囨閸洘鈷戦梻鍫熶緱濡牓鏌涢悩鎰佹當鐞氭瑧鈧厜鍋撻柛鏇ㄥ厴閹疯櫣绱撴担鍓插剱妞ゆ垶鐟╁畷鏇㈠箛閻楀牏鍘电紓浣割儐椤戞瑩鎮￠崗纰辨闁绘劘灏欑粻鑽も偓瑙勬磸閸斿酣鍩€椤掍胶鈯曢拑閬嶆煕鎼搭喕绨界紒杈ㄥ笧缁辨帡濮€閻樿尙顔愰梻浣烘嚀閸熷潡鏌婇敐澶婄畺?HUD (婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯锋嫼閻熸粎澧楃敮鎺撶娴煎瓨鐓曟俊顖涘椤ュ鏌?
                             this.entityData.set(DATA_STATUS_OVERLAY, "status.inventory_full:" + this.entityData.get(UNIT_ID));
                        }
                    }
                }
            }

            // --- 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亜顒㈡い鎰矙閺屻劑鎮㈤崫鍕戙垻鐥幆褜鐓奸柡灞剧☉閳藉宕￠悙鑼洿闂備焦瀵х换鍌炈囬婊呬笉闁规儼濮ら悡娑㈡煕閹板墎鍒板ù婊勫劤椤?B: 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰级閻ゅ嫬鈹戞幊閸娧呭緤娴犲鐤い鎰╁€楁稉宥夋煟閺傚灝鎮戦柣鎾卞劦閺岋綁寮幐搴㈠創閻庢稒绻堝娲传閸曢潧鍓紓浣藉煐瀹€绋款嚕鐠囨祴妲堥柕蹇婂墲濞呭棝鏌ｉ悩鍙夊鐟滄澘鍟扮划濠氭嚒閵堝洨锛滈梺缁樺姦閸撴瑩宕濋妶澶嬬厪闁割偆鍠愰崐鎰版煙椤曞棛绡€妞ゃ垺娲熼弫鍐焵椤掑嫭鍊峰┑鐘叉处閻撳繐鈹戦悙鎴濆€介澶愭煕鐎ｎ偅宕屾鐐村浮瀵剟宕崟顏勵棜闂佽崵鍠愰悷銉р偓姘煎幘缁氨鎹勯妸褏锛濋悗骞垮劚鐎氼喚绮ｉ弮鍌楀亾濞堝灝鏋涙い顓犲厴瀵偊骞囬鐐电獮闁诲函缍嗘禍鏍磻閹剧粯鍊婚柤鎭掑劤閸樼數绱撻崒娆戝妽闁挎氨绱掑Δ浣侯暡缂佺粯鐩畷濂割敃閵忕姷鐫勬繝娈垮枛閿曘儱顪冩禒瀣疇婵犻潧顑呯痪褔鏌涢…鎴濇灍闁稿寒浜缁樻媴閸涘﹥鍠愭繝娈垮枤閺佽鐣峰┑瀣嵆闁冲灈鏂侀崑鎾绘晝閸屾氨鍊炲銈嗗笒椤︿即寮插鍫熲拺闁告挻褰冩禍浠嬫煕鐎ｎ亝鍤囩€殿喗鐓℃慨鈧柕鍫濇閹锋椽姊绘笟鍥т簽闁稿鐩幊鐔碱敍濞戞瑦鐝锋繛瀵稿帶閻°劑鎮￠崘顏呭枑婵犲﹤鐗嗙粈鍫ユ煟閺傛娈犻柣鎺旀櫕閹茬顓兼径妯绘櫔闂佹寧绻傞ˇ顖滅矆閸緷褰掓晲閸噥浠╅梺缁樻尰閹歌崵鎹㈠┑瀣潊闁挎繂鎳愰崢顐︽⒑閸涘﹥鈷愰柣妤冨█閻涱噣宕卞☉娆忊偓鐑芥煟閹寸伝顏呯椤撶偐鏀介柣鎰级椤ユ粎绱掔紒妯哄妞ゃ垺妫冮、鏃堝醇閻斿搫骞堥梻渚€娼ч悧鍡涘箠鎼淬劌鐒垫い鎺嗗亾闁诲繑绻堥敐?---
            if (target instanceof ExperienceOrb orb) {
                // 1. 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕閻庤娲忛崕鎶藉焵椤掑﹦绉甸柛鐘崇墱婢规洟宕稿Δ浣哄幍闂佽鍨虫晶妤吽夋径鎰闁哄鍩婇煬顒勬煛鐏炶鈧繈骞婂┑瀣妞ゆ棁鍋愭晶顖氣攽閻愯尙鎽犵紒顔肩灱缁辩偞绻濋崶褑鎽曞┑鐐村灟閸ㄧ懓鏁梻渚€娼х换鍡涘礈濠靛鍋熼柡宥庡亞绾惧ジ鏌ｉ幇闈涘闁告柣鍊濋弻鏇㈠醇閻旂鈧劙鏌熼鍡欑瘈妞ゃ垺娲熼弫鍐焵椤掑嫭鍊峰┑鐘叉处閻撳繐鈹戦悙鎴濆€介澶愭煕鐎ｎ偅宕屾鐐村浮瀵剟宕崟顏勵棜闂佽崵鍠愰悷銉р偓姘煎幘缁氨鎹勯妸褏锛濋悗骞垮劚鐎氼喚绮ｉ弮鍌楀亾?
                int amount = orb.getValue();

                // 2. 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑鏅悷婊冪箻閸┾偓妞ゆ帊鑳堕埢鎾绘煛閸涱喚绠橀柛鎺撳笒閳诲酣骞樺畷鍥跺敽婵犲痉鏉库偓鎾绘倿閿曗偓閳诲秹寮崼鐔叉嫽闂佺鏈悷褔藝閿曞倹鐓欓悹鍥囧懐鐦堥梺璇″枤閸忔ɑ淇婇悜钘壩ㄩ幖娣灮閳藉鏌嶉挊澶樻Ц妞ゎ偅绻堥、妯款槼缂傚秵顨婂缁樻媴缁涘缍堥悗瑙勬礃閿曘垽銆佸鎰佹Ь缂備緡鍠栭…鐑藉箠閿熺姴围闁稿本鐭竟鏇㈡煟閻斿摜鎳冮悗姘煎幘缁牓鍩€椤掆偓閳规垿鎮欐０婵嗘疂缂備胶濮甸幑鍥偘?
                this.xpBuffer += amount;

                // 3. 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰级閻ゅ嫬鈹戞幊閸娧呭緤娴犲鐤い鎰╁€楁稉宥夋煟閺傚灝鎮戦柣鎾卞劦閺岋綁寮幐搴㈠創閻庢稒绻堝娲传閸曢潧鍓梺鐓庡暱閻栧ジ鐛径鎰濞达絿鎳撴禍閬嶆⒑閸撴彃浜濈紒璇插閹兘濡歌绾捐棄霉閿濆懏鎯堢€涙繈姊洪崫銉ユ瀻婵炵》绻濋崹楣冩晜閻愵剙纾梺闈涱煭缁犳垹澹曢鐐粹拺闁诡垎鍛唶濠电姭鍋撻弶鍫涘妼椤曢亶鏌涢妷顔煎闁抽攱鍨堕幈銊╂偡閻楀牊鎮欓梺鍛婃⒐瀹€鎼佸蓟閻旂厧绀冮柛娆忣槸閺€顓㈡⒑鐠囪尙绠伴柛鐔告綑椤繘鎼归崷顓狅紲濠殿喗顨呭Λ娑㈠礉閹间焦鐓熼煫鍥ㄦ尵缁犳煡鏌ｉ悢鍙夋珚妤犵偛鍟～婊堝焵椤掑嫬钃熼柛鈩冾殢閸氬鏌涢埄鍐噧妤?
                orb.discard();
                this.playSound(SoundEvents.EXPERIENCE_ORB_PICKUP, 0.1F, 1.0F);

                // 4. 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑鏅悷婊冪箻楠炴垿濮€閵堝懐鐤€濡炪倖妫佸Λ鍕償婵犲洦鈷戦柣鐔煎亰閸ょ喎鈹戦鈧褔鎮鹃悜钘夎摕闁靛濡囬崢閬嶆⒑閺傘儲娅呴柛鐔跺嵆閸╁﹪寮撮姀锛勫幈闁硅偐琛ュΣ鍕绩婵犳碍鐓忛柛銉戝喚浼冮悗娈垮枙缁瑦淇婂宀婃Х婵犳鍠栧ú锔炬崲濠靛棌鏋旈柛顭戝枟閻忓秶绱撴笟鍥ф灈缂佸顫夋穱濠囨偨缁嬭法顦板銈嗙墬濮樸劑顢欐繝鍥ㄢ拺缂侇垱娲栨晶鏌ユ煏閸モ晛浠︾紒鏃傚枛瀵挳濮€閳锯偓閹锋椽鏌ｉ悩鍙夊闁绘搫绻濋、鎾澄旈崨顔惧幗闂婎偄娲﹂弻銊╁传濞差亝鐓欐い鏇炴缁♀偓闂佽桨鐒﹂幑鍥箖閳哄懎鐭楀璺哄閸嬫捇顢楅崟顒€鈧灚顨ラ悙鑼虎闁告梹宀搁弻鐔风暋闁箑鍓板銈庡幖濞差參宕洪敓鐘茬＜婵☆垰婀遍惄搴ㄦ⒒娴ｇ瓔娼愮€规洘锚閳绘柨鈽夊▎鎴濃叞闂?10 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼槮闁搞劍绻冮妵鍕冀椤愵澀绮剁紓浣插亾濠㈣埖鍔栭悡娑㈡煕閵夈垺娅呴柛鎾村▕閺屻倝寮堕幐搴′淮閻庢鍠栭悥鐓庣暦閻撳寒娼╂い鎾跺枔瑜板懘姊绘担瑙勫仩闁告柨绉堕幑銏ゅ醇閵夈儴鎽曢梺闈浥堥弲婊堝磻閸曨垱鐓曟繝闈涙閻濇棃鏌ㄥ┑鍡╂Ч闁?= 1 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓闁搞劌鍊块弻娑㈩敃閿濆棛顦ョ紓浣哄Т缂嶅﹪寮诲澶婁紶闁告洦鍋€閸嬫挻绻濆銉㈠亾閸涙潙鐭楀璺虹墔缁ㄥ妫呴銏″闁瑰憡鎮傞、鏃堝箻椤旂晫鍘介柟鍏肩暘閸婃洟鎮￠幇鐗堢厪闁搞儜鍐句純閻庢鍣崳锝呯暦閹烘埈鐓ラ柛鏇ㄥ墮閺呴潧鈹戦悩鍨毄闁稿鐩幆鍥ㄥ閺夋垹顦梺纭呮彧缁犳垿鎷戦悢鍏肩叆闁绘柨鎼瓭缂佺偓鍎抽崥瀣箞閵娿儺娼ㄩ柛鈩冾殔楠炲姊洪崷顓х劸闁哥噥鍋婇垾鏃堝礃椤斿槈褔鏌涢埄鍏狀亪妫勫鍛斀闁挎稑瀚禒鎺旂磼椤旂晫鎳冩い?
                while (this.xpBuffer >= 10) {
                    ItemStack bottle = new ItemStack(Items.EXPERIENCE_BOTTLE);
                    ItemStack left = addItemToInventory(bottle);

                    if (left.isEmpty()) {
                        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缂佺姷濞€閺岀喖宕滆鐢盯鏌涚€ｃ劌鈧繈寮婚弴鐔虹闁绘劦鍓氶悵鏃傜磽娴ｆ彃浜炬繝銏ｅ煐閸旀牠鎮″☉銏＄厱闁靛鍨哄▍鍛存煛鐎ｎ偄鐏撮柡灞剧☉閳诲氦绠涢弴鐙€鍞圭紓鍌欒兌缁垶鎯勯鐐靛祦閻庯綆浜栭弸搴ㄧ叓閸ャ劍纾婚柟顕嗙悼缁辨捇宕掑顑藉亾妞嬪孩濯奸柡灞诲劚閻ら箖鏌ｅΟ娆惧殭闁藉啰鍠栭弻锝夊籍閸屾瀚涢梺杞扮缁夊綊寮诲☉銏犵労闁告劗鍋撻悾鍫曟⒑閸濆嫭顥為柣鐕傜畵楠炲牓濡歌閸犲棝鏌涢弴銊ュ箹鐎殿喓鍔岄埞鎴︻敊绾攱鏁惧┑锛勫仒缁瑩鐛崘顔肩労闁告劏鏅涢崝鍛存⒑閺傘儲娅呴柛鐕佸灦閹線鏁愭径瀣ф嫽婵炶揪绲块…鍫ュ箖閹寸偘绻嗛柣鎰级閸嬨儳鈧娲栫紞濠囩嵁鎼淬劍瀵犲璺鸿嫰婵附淇婇悙顏勨偓鏍ь啅婵犳艾纾婚柟鍓х帛閻撶喖鐓崶銊︾叆闁告繃妞介弻鈩冩媴缁嬫寧娈绘繝娈垮枓閸嬫捇姊洪棃娑氬闁瑰啿绻橀幃妤咁敆閸曨剙鈧灚顨ラ悙鑼虎闁告梹纰嶇换娑氭嫚瑜忛崚浼存煃鐠佸磭鐭欐い銏℃瀹曞ジ鎮㈤崫鍕濠碉紕鍋戦崐鏍偋閺囩倣娑樼暆閸曨偆锛涢梺鐟板⒔缁垶鎮″▎鎾粹拺闁割煈鍣崕鎰版煕婵犲啫濮堥柟渚垮妽缁绘繈宕掗妶鍥ф倯闁诲氦顫夊ú妯兼暜閹烘缍栨繝闈涱儛閺佸棗顭跨捄渚Ч婵☆垰锕濠氬磼濞嗘帒鍘″銈庡幖閻楁捇寮崘顔嘉ㄩ柍鐟扮氨閸嬫捇宕橀濂稿敹濠电姰鍩勬禍椋庣礊娓氣偓閻涱噣宕堕浣镐罕闂佸壊鍋嗛崰鎰版偟閺嶎厽鈷掑ù锝勮閻掗箖鏌￠崼顐㈠缂侇喗鐟╅獮鎺楀箣閺冣偓閻?
                        this.xpBuffer -= 10;
                    } else {
                        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙闁稿被鍔庨幉鎼佸棘鐠恒劍娈惧銈嗙墱閸嬫盯鏌ㄩ妶鍡曠箚闁靛牆瀚ˇ锔界箾閸剛鍒版い顏勫暣婵″爼宕卞▎蹇ｆ椒濠电姰鍨奸～澶娒洪悢椋庢殾闁硅揪绠戠粻濠氭偣閸ャ劌绲婚柣搴幖椤啴濡堕崱妤€顫呴梺绋款儐閹稿濡甸崟顔剧杸闁规崘娉涢。鐢告⒑闁偛鑻晶鍓х磼閻樿櫕灏板ǎ鍥э躬楠炴牗鎷呴崫銉ュ箰濠电偠鎻紞鈧俊妞煎妿濡叉劕顭ㄩ崼鐔叉嫽婵炶揪缍€濡嫭绂嶈ぐ鎺撶厓鐎瑰嫭澹嗘晶锔锯偓瑙勬礃缁矂鍩㈡惔銊ョ鐎规洖娲﹂悡锝夋⒒娴ｇ鏆遍柟纰卞亰楠炲﹨绠涘☉妯煎幈闂佺鎻梽鍕偂濞嗘垹纾奸悗锝庡亜椤曟粓鏌熼惂鍝ョМ闁哄苯绉剁划顓㈠传閸曨偄袘缂傚倷娴囨ご鍝ユ暜閿熺姴鏄ラ柍褜鍓氶妵鍕箳瀹ュ洤濡芥繝娈垮灡閹告娊寮诲☉銏℃櫆閻犲洦褰冪€涳絽鈹戦悙瀛樼稇閻庢碍婢橀～蹇涙惞閸︻厾锛滃┑鈽嗗灠濞存碍绂嶅鍡欎航濠电姷鏁告慨鎾磻閸℃稒鍊块柦妯侯棦瑜版帗鍋傞幖杈剧稻閹插ジ姊虹紒妯诲碍缂佺粯锕㈤幃锟狀敃閿曗偓閻愬﹪鏌曟径鍫濆姎濠殿喓鍨荤槐鎾存媴閸撴彃鍓甸悗瑙勬礈閺佺危閹版澘绠抽柟鎯у閹虫繈姊洪幖鐐插妧闁告洦鍘肩紞鍡涙⒒閸屾瑧顦﹂柟纰卞亰瀵敻顢楅崟顒€鍓銈嗙墬閸戝綊宕甸弴鐏诲綊鎮╁顔煎壈闁诡垳鍠栭幃宄邦煥閸愵€囨寠閻斿鐔嗛悹楦挎閻忚京鐥幑鎰棄闂囧鏌ㄥ┑鍡楊伀闁活厽鐟╅弻娑樷攽婵犲喚浠╃紓浣介哺鐢偤骞忛悩缁樺殤妞ゆ巻鍋撴い锝嗘そ濮婄儤瀵煎▎鎴濆煂闂佹悶鍨洪悡锟犲灳閿曞倸惟闁宠桨绶氶崬璺衡攽閻樼粯娑ч柣妤€妫濋悰顕€骞囬悧鍫氭嫽婵炴挻鍩冮崑鎾绘煃瑜滈崜娑㈠磻濞戙垺鍤愭い鏍ㄧ⊕濞呯娀鏌熷▓鍨灓缁炬儳鍚嬮妵鍕即閻愭潙娅ｉ悗娈垮櫘閸犳岸鍩€椤掑喚娼愭繛鎻掔箻瀹曟繃鎯旈妸銉у姦濡炪倖甯婇懗鍫曞煀閺囥垺鐓ユ慨妯垮煐閻撴洟鏌熼崹顔兼殭鐎殿噮鍠楅幈銊︾節閸愨斂浠㈤悗瑙勬磸閸斿秶鎹㈠┑瀣妞ゎ厽鍨惰ⅸ闂傚倸鍊风粈渚€骞夐敓鐘虫櫇闁靛繈鍨绘稉宥夋煛瀹ュ骸骞栫紒鐘冲哺閺屽秷顧侀柛鎾跺枛瀵鈽夊Ο閿嬵潔闂佸憡顨堥崑娑氱矉韫囨稒鈷戦柛婵嗗閺嗘瑩鏌ｅΔ鈧敃顏勭暦閹达箑绠涢柣妤€鐗忛崢鍓х磼閻愵剚绶茬€规洦鍓氶弲鍫曞级濡潧缍婇幃鈩冩償閵忕姵鐏庢繝娈垮枛閿曘儱顪冮挊澶屾殾妞ゆ劧绠戠粈瀣亜閹烘埈妲规い銉︽濮婄粯鎷呮笟顖滃姼濡炪倖鍨靛Λ婵嬬嵁閹达箑鐐婄憸婊冾焽閺嶎厽鐓曟繝闈涙閳绘洟鏌ц箛姘兼綈閻庢碍宀稿Λ鍛搭敃椤愩垹绠婚梺缁樼墵娴滆泛顫忕紒妯诲濞撴凹鍨抽崝绋款渻閵堝棗鐏ユ俊顐ｇ箞閻涱噣骞囬弶璺啇婵炶揪绲介幗婊堝矗閳ь剙鈹戦悩顔肩伇闁糕晜鐗犲畷婵嬪即閻樺吀绗夋繝鐢靛У绾板秹鎮″▎寰稒锛愭担钘夊帯濡炪倧璁ｇ粻鎾诲蓟濞戙垹绠婚柛鎰蔼閸╃偛顪冮妶搴濈盎闁哥喎鐡ㄦ穱濠囧醇閺囩偛鑰垮┑掳鍊愰崑鎾淬亜椤愩垻鐒告慨濠冩そ濡啫鈽夊顑藉彙婵＄偑鍊ら崢濂告偋閹捐绠栭柟顖嗗懏娈濋梺褰掓敱濮婂宕伴幇顔剧當闁绘梻鈷堥弫宥嗘叏濮楀棗骞栭柍褜鍓﹂崹璺侯潖缂佹ɑ濯寸紒瀣儥濡矂姊虹粙娆惧剱閻㈩垪鈧磭鏆﹂柟杈剧畱缁€瀣亜閹邦喖鏋戦柣?
                        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缂佺姷濞€閺岀喖宕滆鐢盯鏌涚€ｃ劌鈧繈寮婚弴鐔虹闁绘劦鍓氶悵鏇㈡⒑缁嬫鍎忔い鎴濐樀瀵鏁愭径濠勭杸濡炪倖甯婇悞锕傚磿閹剧粯鈷戠紓浣姑粭鎺楁煟韫囨柨鍝哄┑锛勬暬瀹曠喖顢涘槌栧敽闂備胶纭堕崜婵嬪Φ閻愬鐝堕柡鍥ュ灪閳锋帒霉閿濆懏鎲哥紒澶嬫そ閺岋繝鍩€椤掑嫭鐒肩€广儱鎳庨悗顓㈡⒑閼姐倕鏋戦悗姘墦閺佹劖寰勬繝鍕澑婵＄偑鍊栭幐楣冨磿閹版澘鍚归柕鍫濐槹閳锋垿鏌涘┑鍡楊伌婵℃彃缍婇弻娑㈠Ω閵壯呅ㄥ銈冨灪閻熲晛鐣烽妸鈺婃晩闁告挆鍛潓闂傚倷鐒﹂惇褰掑垂閽樺鐒界憸宥夋偤椤撱垺鈷戦悹鍥ㄥ絻椤掋垽鏌涢幋婵堢Ш鐎规洩缍佸畷姗€顢欓幆褏銈﹀┑鐘垫暩婵潙煤閵堝纭€闁规儼濮ら悡蹇涚叓閸ヮ灒鍫ュ磻閹捐妫橀柕澶堝劙婢规洟姊洪崜鑼帥闁稿妫涚划缁樸偅閸愨晝鍘甸柣搴ｆ暩椤牊绂掕閺岀喖宕橀幓鎺撴闂佸疇顫夐崹鍧椼€佸▎鎾崇闁绘挸瀛╅悘搴ㄦ⒒娴ｅ憡鎯堥柣顒€銈稿畷浼村冀椤撴壕鍋撴担绯曟瀻闁圭偓娼欐禒濂告煟韫囨洖浠﹂柛搴″暱閳诲秴顫濋懜鐢靛幗闁瑰吋鐣崐銈咁焽閹邦厾绠鹃柛娆忣檧閼板潡鏌熼鎯у幋闁糕晪绻濆畷銊╊敇閻樺灚姣囧┑鐘垫暩婵挳鏁冮妶澶婅Е婵せ鍋撻柟顔哄灲瀹曨偊濡疯濡插洦绻濆▓鍨灍闁挎洍鏅犲畷锝嗘償閵娿儳鍔﹀銈嗗笂閼宠埖鏅堕崹顐ｅ弿濠电姴瀚敮娑㈡煙瀹勭増鍤囬柟顔界矊铻ｉ柣鎴烆焽閺嗘岸姊婚崒娆戭槮婵犫偓闁秴鐓曢柛顐犲劚绾捐鈹戦悩鍙夊櫤妞ゃ儯鍊栨穱濠囨倷椤忓嫧鍋撻弽顓熷亱婵°倕鎳忛崑鍕亜閹烘垵顏柛銈傚亾闂備胶顫嬮崟鍨暦闂佺粯鎸婚悷褏妲愰幘瀛樺闂傚牊绋撴禒濂告⒑閸濆嫷鍎戦柛鐘崇墵瀵?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲梺姹囧€ら崰妤呭Φ閸曨垰绠涢柍杞拌兌閸旀挳姊洪幖鐐测偓鏍洪悢鐓庤摕婵炴垯鍩勯弫鍐煥濠靛棙顥滄い锔规櫊濮婄儤娼幍顕呮М濠碘槅鍋呴悷褔骞戦姀鐘闁靛繒濮烽鍝勨攽閻愬弶顥滅紒缁樺笚缁傛帗绺介崨濠勫幗闂佺粯鏌ㄩ幗婊堝箠閺囩姷纾奸柣妯挎珪瀹曞瞼鈧鍠栭…鐑藉极閹邦厼绶炲┑鐘插閺夊憡淇婇悙顏勨偓鏍涙担瑙勫弿闁靛牆鎲涢幒妤€绀嬫い鏍ㄧ▓閹峰搫鈹戦鐐殌婵炲眰鍊濆畷婵嗩潩閼哥數鍘甸梺鎯ф禋閸嬫捇鎳撶捄銊㈠亾?
                        // 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫鍐煥閺囨浜鹃梺姹囧€楅崑鎾舵崲濠靛洨绡€闁稿本绮岄·鈧梻浣侯焾椤戞垹鎹㈠┑瀣摕鐎广儱顦导鐘绘煕閺囥劌澧繛鍜冪秮濮婂宕掑顑跨敖闂佹悶鍔岄悥鐓庮嚕婵犳碍鏅插璺猴功椤撴椽姊洪幐搴ｇ畵婵☆偒鍘艰灋闁告洦鍘剧壕钘壝归敐鍛儓妞ゅ孩鎸剧槐鎾愁吋閸曨厾鐛㈤悗娈垮枛椤兘骞冮姀銏″仒闁炽儱鍘栨竟鏇炩攽閻愭潙鐏﹂柣鐕佸灦閹偞绂掔€ｎ偆鍘藉銈嗘尵閸庢劙宕曢幋鐘电＜閺夊牄鍔屽ù顔姐亜閵忊€冲摵鐎规洖宕埢搴ㄥ箣閻愭惌鍟屾繝鐢靛У椤旀牠宕伴弽顓熸櫇闁靛鍎哄〒璇裁归悩宸剭闁逞屽厸缁舵艾顕ｉ幘顔碱潊闁绘瑢鍋撴繛鐓庯躬濮婃椽宕橀崣澶嬪創闂佺锕ラ崝姗€藝瑜版帗鐓涚€光偓鐎ｎ剛蓱闂佽鍨卞Λ鍐╂叏閳ь剟鏌ｅΟ鎸庣彧闁稿汞鍥ㄢ拻濞达絽鎲￠崯鐐烘煛鐏炶濡跨紒顔芥瀹曟粍鎷呯粙璺ㄤ喊婵犳鍠楅…鍫濃枖濞戞碍鍏滈柍褜鍓熷铏圭磼濡搫顫呴梺鍝勬噺缁挸顕ｉ鍕劦妞ゆ帒瀚埛鎺懨归敐鍥剁劸妞ゃ儱绻橀弻娑氣偓锝庝簼椤ャ垻鈧娲戦崡鎶界嵁閸ヮ剚鍋嬮柛顐ｇ箑閹絾淇婇悙顏勨偓鏍暜閹烘柡鍋撳鐓庡籍闁糕晜鐩獮瀣晜鐟欙絾瀚介梻浣稿閸嬪懐鍠婂鍛瀺闁割偁鍨荤壕濂告煃瑜滈崜娑㈠焵椤掑﹦绉甸柛鐘愁殜閹繝寮撮姀锛勫幐闂佺鏈粙鎴︻敋濠婂牊鐓欓柣褍鎽滅粙璇睬庨崶褝韬€规洩绲惧鍕節閸屻倖缍掗梻鍌欐祰濡椼劎绮堟笟鈧畷鎰板锤濡も偓閽冪喖鏌曟繛鐐珦闁轰礁绉甸幈銊ヮ潨閸℃ぞ绨诲銈冨劜绾板秶鎹㈠┑瀣仺闂傚牊绋愬▽顏堟⒑閹肩偛濡奸柣鏍с偢楠炲啴鎮滈懞銉у姸閻庡箍鍎卞Λ妤€鈻撳畝鍕拺缂佸妫楃€氬嘲鈻撻弴銏＄厽闁规儳鐡ㄧ粈瀣煛鐏炶濡奸柍瑙勫灴瀹曞崬螣缂佹ê鈧兘姊绘担鍛婂暈閽冮亶鏌熼崨濠傗枙鐎殿喖顭烽崺鍕礃閳轰緡鈧捇姊洪崨濠勭細闁稿孩鐩慨鈧柕鍫濇閸樹粙姊洪幐搴ｇ畵婵☆偅绋撶划濠氭倷閻戞鍘遍梺瀹狀潐閸庤櫕绂嶉悙顑跨箚闁绘劦浜滈埀顒佺墱閺侇噣骞掗弬鍝勪壕婵鍘у顔锯偓瑙勬礃閸ㄦ寧淇婇懜闈涚窞閻庯綆鍓欓獮宥夋⒑閸濆嫷妲搁柣妤佹尵缁寮借閻庤埖銇勯弴妤€浜鹃梺鍝勬湰閻╊垱淇婇崼鏇炲窛妞ゆ挆鍌滅＞闂傚倷娴囬鏍窗濡ゅ懏鏅濋柕蹇嬪€曠粻鏍ㄧ箾閸℃ɑ灏伴柛銈咁儐缁绘盯宕奸悢濂夊殝濡炪們鍎遍ˇ闈涱潖缂佹ɑ濯村瀣凹鐟曞棛绱撴担鍝勑ｉ柛銊ユ健楠炲啴濡烽敂楣冩缂備礁顑堥崕濠氬箺閺囥垺鈷戦悹鎭掑妼閺嬫柨鈹戦鑺ュ唉闁哄苯顑夊畷鍫曞Ω瑜忛惁鍫ユ⒑閸撹尙鍘涢柛瀣閹便劑宕煎顏呮瀵噣宕奸悢鍙夊濠电偠鎻徊浠嬪箺濠婂牆鍑犻柛鎰ㄦ杺娴滄粍銇勯幇鈺佺労婵☆垪鍋撻梻浣筋嚃閸燁偊宕楅悙顒侇棃鐎规洏鍔戦、姗€鎮埀顒勫船閻㈠憡鈷掑ù锝呮啞閸熺偛銆掑顓ф疁鐎规洩绲鹃幆鏃堝Ω閵夈剱鏇㈡煟鎼搭垳绉甸柛鐘愁殜閹繝寮撮悢铏诡啎闂佺懓鐡ㄧ换鍌炴嚋鐟欏嫷娈介柣鎰儗濞堟洜绱掔紒妯兼创鐎规洏鍔戦、姗€鎮欑€涙﹩鍟嬪┑?
                        break;
                    }
                }
            }
        }
    }

    // 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫宥夋煟閹邦厽缍戝ù婊堜憾濮婅櫣鍖栭弴鐐测拤缂備礁顑嗛崹鍦垝婵犳碍鍋愰悹鍥皺椤旀劕鈹戦悜鍥╃У闁告挻鐟╅幃姗€顢旈崼鐔哄幈濠电偛妫楃换鎺旂不閺屻儲鐓忛柛銉戝喚浼傜紓浣哄У閻╊垶鐛鈧獮鍥ㄦ媴妞嬪海顦梻鍌氬€风粈渚€骞楀鍫濈獥閹兼番鍔岀粻鐘虫叏濡炶浜鹃悗娈垮枛椤嘲顕ｉ幘顔藉亜濡炲娴烽悰顕€姊绘担绋款棌闁稿鎳愰幑銏ゅ磼濞戞瑥寮块柟鍏肩暘閸斿秹宕愰悽鍛婄厽闁靛繈鍊栧☉褎銇勯敐鍛倯濞ｅ洤锕、鏇㈠閻樿櫕顔掗柣搴㈩問閸犳牠鈥﹂柨瀣╃箚闁归棿绀佸敮闂侀潧绻嗗Σ鍛焽閺冣偓缁绘繈鎮介棃娑楃捕濠碘槅鍋呴悷褔寮鈧獮鎺戭渻濠靛棭妲搁柍瑙勫灩閳ь剨缍嗛崑鈧柟宄版惈閳规垿顢欓悙顒€娈屽┑鐐茬湴閸婃牗绌辨繝鍥ㄥ亗閹兼惌鍠氶崬鐢告偡濠婂啰鐏遍柛鎺撳笒閳诲酣骞樼捄铏广偊闂傚鍋勫ú锔剧矙閹烘纾婚柟鎵閸嬶綁鏌涢妷锝呭缂佽尪宕甸埀顒冾潐閹哥螞濠靛棭娼栭柧蹇撴贡绾惧吋淇婇娑欍仧婵﹤娼″铏圭矙濞嗘儳鍓梺绋匡攻缁诲牆鐣峰ú顏呮櫢闁绘ɑ褰冪粣娑橆渻閵堝棙鈷愰柛搴㈠▕閻涱喖螖娴ｈ櫣鐦堢紒鐐緲椤﹁京澹曢崸妤佺厱閻庯綆鍓欓弸鏃堟煕閹烘挸娴い銏＄☉椤繈鏁愰崱娆屽亾濞差亝鈷戦柛娑橈功閳藉鏌ｆ幊閸旀垿骞冮垾鏂ユ瀻鐎电増绻傜紞濠囧极閹版澘宸濇い鎾跺枑閻︼絾绻濋悽闈涗粶闁活亙鍗冲畷鎰旈崘鈺婃綗闂佸湱鍎ら〃鍛存偂濞戙垺鐓曟繛鎴濆船閺嬨倝鏌涘鈧褔鈥旈崘顔嘉ч柛鈩冪懃閳懓鈹戦埥鍡椾簼妞ゃ劌锕ら悾鐑筋敍閻戝棙鏅濋梺瀹犳硾閻忔洟宕惰閹芥洟姊洪棃娑辨闁奸潧缍婇獮蹇撁洪鍛嫼缂傚倷鐒﹁摫閻忓浚鍘艰灃闁绘娅曢崐鎰偓娈垮枟婵炲﹪寮婚崱妤婂悑闁糕剝鐟ラ獮妯荤節閻㈤潧浠╅悘蹇ｄ邯椤㈡俺顦归柟顔斤耿閺佹劖寰勭€ｎ剙甯?(婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾剧粯绻涢幋娆忕労闁轰礁顑嗛妵鍕箻鐠虹儤鐎鹃梺鍛婄懃缁绘﹢寮婚悢铏圭＜闁靛繒濮甸悘鍫㈢磽娴ｅ搫啸濠殿喖鐏氱粚杈ㄧ節閸ヨ埖鏅┑鐐叉鐢晠宕濋崨瀛樷拺閻犲洤寮堕崬澶愭煕閳哄倻澧遍柟骞垮灩閳藉顫滈崱妤佹珚婵＄偑鍊栧Λ浣哥暦閻㈠憡鍎庨幖娣妽閳锋垶鎱ㄩ悷鐗堟悙闁逞屽墯椤ㄥ﹤鐣烽幋锕€绠婚悹鍥у棘閿曞倹鐓曢柡鍥ュ妼閻忕娀鏌涘Δ鍕彧濞ｅ洤锕俊鍫曞磼濮橆偄顥氭繝鐢靛仜閻°劎鍒掗幘鍓佷笉闁哄诞灞剧稁濠电偛妯婃禍婵嬫倿婵犳碍鐓熼柟閭﹀灠閽勫ジ鎮楀顓熺凡妞ゎ叀鍎婚¨渚€鏌涢妸銉у煟鐎殿喖顭锋俊鍫曞醇濞戞鐫忛梻浣告贡閸庛倕顫忔繝姘辈妞ゆ劧闄勯崐鐢告偡濞嗗繐顏紒鈧崘顔界厱闁靛ě鍕瘓濡炪們鍨洪敃銏犵暦濡ゅ懏鍋傞幖杈剧悼閻涱噣姊虹拠鎻掑毐缂傚秴妫欑粋宥呪枎閹寸姷锛為梺鍝勬储閸ㄦ椽鍩涢幒鎳ㄥ綊鏁愰崶鍓佸姼闂佸搫妫濇禍鍫曞蓟閻斿搫鏋堥柛妤冨仒閸犲﹪鎮楃憴鍕闁告梹顨堝Σ鎰板箳閹冲磭鍠栭幊鏍煛娓氣偓閻?10-36)
    // 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫鍐煥閺囨浜鹃梺姹囧€楅崑鎾舵崲濠靛洨绡€闁稿本绮岄。娲⒑閽樺鏆熼柛鐘崇墵瀵寮撮悢铏诡啎闂佸壊鐓堥崰鏍ㄧ珶閸曨偀鏀介柣鎰级閳绘洖霉濠婂嫮鐭掔€规洘锕㈤崺鈧い鎺嗗亾妞ゎ亜鍟存俊鍫曞幢濡儤娈梻浣侯焾椤戝洭宕伴弽顓炴瀬鐎广儱鎳夐弸搴ㄦ煙鐎电啸闁挎稒绮庣槐鎾诲磼濞嗘挻顎栭梺鎼炲妿閹虫捇顢氶敐澶樻晩濠殿喗鍔掔花濠氭⒑闂堟侗妾ч梻鍕娴滄悂鎮介悽鐢碉紲濡炪倖娲栧Λ娑㈠礆娴煎瓨鎳氶柡宥庣亹瑜版帗鏅查柛顐ゅ櫏娴犫晛顪冮妶鍡樷拹婵炶尙鍠栧濠氭晲閸垻鏉搁梺鍝勬川閸嬫鍒掗崼鏇熺厽閹兼番鍨归幖鎼佹煕閺冣偓閸ㄧ敻鎮鹃悜钘夌疀闁哄鐏濆畵鍡涙⒑闂堟稓绠冲┑顔芥尦瀹曟垵顓兼径瀣ф嫼闂侀潻瀵岄崣鈧俊鐐倐閺屾盯鎮╅幇浣圭杹闂佽鍠掗埀顒佹灱濡插牓鏌曡箛銉х？闁告ɑ鎹囬幃宄邦煥閸曨厾鐓夐悗瑙勬礃缁捇骞冮姀銈嗗殐闁宠桨鑳堕妶锕傛⒒娴ｄ警鏀伴柟娲讳簽缁骞嬮悩鍏哥瑝濠电偞鍨堕悷锝嗙濠婂牊鐓涢柛鎰╁妼閳ь剝妫勯‖濠囧箹娴ｅ湱鍘遍梺缁樻煥椤ㄥ酣宕曢弮鈧幈銊︾節閸曨厼绗￠梺鐟板槻閹虫ê鐣烽妸锔剧瘈闁稿本绋掗悾鐓庘攽閿涘嫬浜奸柛濞垮€濆畷銏＄附閸涘﹤浜遍梺绯曞墲缁嬫帡宕戦埡鍛厽闁硅揪绲借濡炪們鍎遍悧濠勬崲濞戙垹绠ｉ柣鎰皺閻熸煡姊虹拠鑼缂佽埖鑹鹃～蹇涙惞鐟欏嫬鍘归梺鍛婁緱閸犳牕鈽夎缁辨挻鎷呴崫鍕戯綁鏌涢妸銉﹁础闁告帗甯″畷濂稿Ψ閵夆晛鏁归梻渚€娼ч¨鈧┑鈥虫喘瀹曘垽骞樼紒妯煎幗闂佺粯鍔曢顓㈠煝閹剧粯鐓冪憸婊堝礈濞嗘挸鍌ㄩ柡宥冨妿閻濆爼鏌￠崶鈺佇ョ痪鍙ョ矙閺屾稓浠﹂幑鎰棟闂侀€炲苯澧柟鑺ョ矌閸掓帡寮崼鐔蜂缓缂備礁顑呴悘婵嬫倵椤撱垺鈷戠紒澶婃鐎氬嘲鈻撻弮鍌滅＜闁绘ê纾晶閬嶆煙閸欏鍊愮€殿噮鍣ｅ畷鐓庘攽閸ャ剱姘舵⒒娴ｈ鐏遍柡鍛洴瀹曨垶顢涘☉妯虹亖闂佸湱铏庨崰妤呭磻閳╁啰绠鹃柛鈩冾殘缁犵増銇勮箛濠冩珚闁?(婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯煎幗闁瑰吋鎯岄崹宕囩矓閻㈠憡鐓曢煫鍥ㄦ閼拌法鈧鍠楅幃鍌氼嚕娴犲鏁囬柣鏂垮级鐎氬ジ姊绘担绛嬪殐闁搞劌閰ｅ畷銊╊敍閿濆懏鏆梻鍌氬€风粈渚€骞夐檱閹筋偆绱撴笟鍥ф灍闁瑰憡鎮傞、姘舵晲婢舵ɑ鏅濋梺鎸庢磵閸嬫挾绱掗埀顒傗偓锝庡亖娴滄粓鏌″鍐ㄥ闁靛棙甯￠弻娑樷枎韫囨棏妫為梺瀹狀潐閸ㄥ潡骞冨▎鎾崇骇闁瑰濮冲鎾翠繆閻愵亜鈧倝宕㈤悡骞熸椽顢橀姀鐘电暫闂佺粯鍔楅崕銈夋偂閵夆晜鍊甸柨婵嗗暙婵¤櫣绱掗妸銉吋婵﹥妞藉畷顐﹀礋椤掆偓椤︹晛顪冮妶鍐ㄥ婵☆偅顨婇崺銏狀吋閸℃瑧鐦堥梺鍛婃磸閸斿本绂嶉悙顒傜闁割偅绻勬禒銏ゆ煛鐎ｃ劌鈧洟鈥﹂懗顖ｆЪ濡炪們鍔岄敃顏堟偘椤曗偓瀹曞崬鈽夊Ο鑲╂綁闂備礁澹婇崑鍛崲閸曨剙顕遍悗锝庡枟閳锋垿鏌涘☉姗堝伐濠殿喖鐬奸埀顒侇問閸犳骞愰幆顬綁骞囬悧鍫濅簻闂佺绻愰惃鐑藉箯缂佹绠鹃弶鍫濆⒔閸掔増銇勯锝嗙闁糕斁鍋撳銈嗗灱濡嫭绂嶆ィ鍐┾拻濞达絼璀﹂悞鐐亜閹存繃顥㈡鐐村灴瀹曞爼顢楅埀顒勬嫅閻斿吋鐓熼柡鍐ㄥ€搁崝瀣煕閻樺弶顥㈤柡灞剧洴瀵挳濡搁妷銈囩泿婵＄偑鍊ら崑鍕规搴㈩潟闁规儳鐡ㄦ刊鎾煕濠靛棗鐝旈柕寰涢绨诲銈嗘尵婵挳宕㈢€电硶鍋撳▓鍨灕妞ゆ泦鍥х叀濠㈣泛谩閻斿鐓ラ柛娑卞幗閻庡姊虹€圭媭鍤欓梺甯秮閻涱噣宕卞鍏夹梻浣告惈濡參宕瑰畷鍥潟?
    private ItemStack addItemToInventory(ItemStack stack) {
        ItemStack toAdd = stack.copy();

        // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑鏅悷婊冪Ч閿濈偛鈹戠€ｎ偅娅囬梺绋跨焿婵″洨绮欒箛鏃傜瘈闁靛骏绲介悡鎰版煕閺冣偓閻楃姴鐣烽弴鐐嶆梹鎷呴崗鍝ョ泿闂備礁鎼崐鎼佹倶濠靛鐓曢柡鍌氱氨濡插牓鏌熼幆褏锛嶉弫鍫ユ⒑閸濆嫮鐒跨紓宥勭椤曪綁顢氶埀顒€鐣烽幒鎴僵妞ゆ垼娉曠敮娑㈡⒒閸屾瑧鍔嶉柣顏勭秺瀹曟劕螖閸涱厾锛涢梺瑙勫礃椤曆勵攰闂備礁鎲″ú锕傚垂娴兼潙纭€闁惧浚鍋傜换鍡涙煏閸繂鈧憡绂嶉悙顒傜閻庢稒顭囬惌鎺旂磼閻樺磭澧い顐㈢箰鐓ゆい蹇撴噽閸旂敻姊虹紒妯哄閻忓浚浜為埀顒佺濠㈡﹢鈥﹂懗顖ｆ闂佹悶鍔嶆刊鍊熴亹娓氣偓濮婃椽骞栭悙鎻掑闂佸憡鏌ㄧ粔瑙勪繆闂堟稈鏀介柛顐ｈ壘娴滈箖鎮峰▎蹇擃仾缂佲偓閸愨晝绠鹃柛娆忣槺婢ф娊鏌ｈ箛鎾虫殻婵﹥妞藉畷銊︾節娴ｈ櫣绠掗梻浣告啞閿曘垻绮婚弽顒侇棨闂傚倷绶￠崜娆戠矓閻㈢鐓曢柟杈鹃檮閻撴洘绻涢幋鐑囧叕婵﹥顨堢槐鎺楀醇閺囨碍鍠氶梺鍝勬湰閻╊垱淇婇幖浣哥厸闁逞屽墴楠炲銈ｉ崘鈺冨幍濡炪倖娲嶉崑鎾剁磼閻樺磭澧电€殿喖顭峰畷鍗炍旀繝鍌涘€梻浣虹《閸撴繈鎮烽妷鈺冨祦婵せ鍋撴慨濠勭帛閹峰懘鎼归悷鎵偧闂備礁婀遍…鍫ュ箟閿熺姰鈧啴濡烽埡浣侯啇婵炶揪绲介幉鈩冩綇閸績鏀介柣鎰级椤ョ偤鏌涢弮鈧〃鍫㈠垝?(缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧湱鈧懓瀚伴崑濠傘€掓繝姘厵闁绘垶蓱閳锋帡鏌ｉ鐔峰摵闁哄本鐩、鏇㈡晲閸℃瑯妲梻浣规偠閸斿矂宕愰崸妤€钃熸繛鎴欏灪閺呮粓鎮归崶銊ョ祷缂佺姴鎼—?10 ~ 36)
        // 0-4: 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煟閵忋埄鐒剧紒鎰殘閳ь剙绠嶉崕鍗灻洪妸鈺傚剹闁糕剝銇滈埀顒佸笒椤繈鏁愰崨顒€顥氬┑掳鍊楁慨鐑藉磻濞戙垺鏅濋柕澶嗘櫅缁犳岸鏌￠崘銊у閹喖鏌ｆ惔顖滅У濞存粍绻堝畷鏉课熷Ч鍥︾盎闂侀潧绻嗗Σ鍛枔濠婂應鍋撶憴鍕闁哥姵鐗犻妴浣肝旀担鐟邦€撻柣鐘叉礌閳ь剙寮堕崺? 5-9: 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愭い鏃傛嚀娴滈箖鏌涢幇闈涙灈鐎瑰憡绻冮妵鍕箳閹存繃鍊┑锛勫仩婵倖绌辨繝鍥х濞达綀顫夊▍鍡欑磽閸屾瑧鍔嶉柨鏇楁櫊瀹曨垰顓兼径瀣ф嫽婵炶揪缍€椤宕戦悩缁樼厱閹兼番鍨洪妵婵嬫煙椤旂煫顏堝煡婢舵劕顫呴柍銉ュ帠缁ㄥ姊绘担铏瑰笡闁瑰摜顭堥湁闂佸灝顑呴閬嶆倵閿濆骸鏋熼柍閿嬪灴閺岀喖顢涢崱妤€顏い鈺€鍗冲铏圭矙濞嗘儳鍓伴柣搴㈠嚬閸樺墽鍒? 10-36: 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁逞屽墾缁犳挸鐣锋總绋款潊闁炽儱鍘栫划鈩冧繆閻愵亜鈧牠宕濊缁骞嬮悩鐢电劶婵犮垼鍩栭崝鏇犵不鐟欏嫮绠鹃柨婵嗛婢ь噣鏌ｈ箛锝勭凹缂佺粯鐩畷銊╊敍濮橈絾鐎伴梻浣告惈閺堫剛绮欓弽顓勫洭鎼归鐘辩盎闂侀潧顭堥崕鏌ニ夐姀鈶╁亾?
        int startSlot = 10;
        int endSlot = 36;

        // 1. 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁逞屽墾缁犳挸鐣锋總绋款潊闁炽儱鍟跨花銉╂⒒娴ｇ瓔娼愬鐟版閺呰泛螖閸涱厾锛涢柣搴秵閸犳鎮￠弴銏＄厓闁宠桨绀侀弳鐔兼煃椤栨稒绀嬮柡灞剧⊕閹棃鏁嶉崟鎳峰洦鐓涢悘鐐插⒔濞插瓨顨ラ悙鐤殿亣鐏冮梺閫炲苯澧伴柍褜鍓氶崙褰掑礈閻旂厧绠栭柛顭戝亜椤曢亶鎮楀☉娅辨岸骞忓ú顏呪拺闁告稑锕︾粻鎾绘倵濮樼厧骞栨い鏂跨箰閳规垹鈧綆鍋嗛崢閬嶆煟鎼搭垳绉甸柛鎾寸懇瀵鈽夊锝呬壕閻熸瑥瀚粈澶嬨亜椤愩埄妲洪柟骞垮灩閳规垿宕遍埡鍌氬厞婵＄偑鍊栭幐鐐叏閹绢喚宓侀柛顐ゅ枔缁♀偓闂佹眹鍨藉褎绂掑鍕箚妞ゆ劧绲块幊鍥┾偓瑙勬礀缂嶅﹤螞閸愩劉妲堟慨姗嗗幗閸Ｑ囨⒒閸屾艾鈧悂宕愰悜鑺ュ殑闁告挷鐒﹂崗婊堟煕椤愶絾绀€闁汇倗鍋撶换娑㈠箣濞嗗繒浠鹃梺鎼炲€栭崝鏍Φ閸曨垰鍐€妞ゆ劑鍨规竟澶愭⒑鏉炴壆顦﹂柨鏇ㄤ邯閹繝顢曢敃鈧悙濠囨煏婵炑€鍋撴俊鎻掔墦濮婂搫煤鐠囨彃绠哄銈冨妼閹虫﹢鍨鹃敂鐐磯闁靛绠戠壕顖涚箾閹炬潙鍤柛銊ゅ嵆瀹曟粓骞庨懞銉㈡嫼婵炴潙鍚嬮悷褏绮欑拠娴嬫斀闁绘劘顕滃銉︺亜椤愩垻绠荤€规洦鍋婂畷鐔煎箠瀹勭増鎼愰柣鎰功閹茬顓兼径鍡忓亾閺嶎厼閱囬柕澶涘閸樹粙鏌熼崗鑲╂殬闁搞劌缍婂畷鐢割敆閸曨剛鍘卞┑鐐叉缁绘劙寮抽敐鍡╂闁绘劖褰冮弳銏°亜閿曗偓濠€閬嶅焵椤掑喚娼愭繛璇х畵瀹曟垶绻濋崘褏绠氶梺缁樺灱濡嫰锝為崨瀛樼厽婵☆垰鎼懜瑙勩亜閵夛妇顣茬紒缁樼箞閹粙妫冨☉妤佸媰闂備焦鎮堕崝宀勬偉婵傜绠栭柣鎴ｆ鍞梺鎸庢濡嫬顕ｉ崸妤佸€垫鐐茬仢閸旀碍銇勯敂鍨祮闁?
        for (int i = startSlot; i <= endSlot; i++) {
            ItemStack slotStack = inventory.getItem(i);

            // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯锋嫼閻熸粎澧楃敮鎺撶娴煎瓨鐓曢柟鎯ь嚟閹冲啯銇勯弴顏嗗埌闁伙綇绻濋弻鍥晜閽樺妲ｉ梻鍌欑窔濞佳囨偋閸℃あ娑樷槈濞嗘劖鐝峰銈嗗笒閸婅螞椤栫偞鐓涘璺哄绾爼寮崼銉﹀€甸悷娆忓缁€鍐煕閺冣偓閻熴儵鎮鹃悜鑺ユ櫢闁绘ê鍟块埀顒傚厴閺屽秹宕崟顐＄敖濠电偛鍚嬪Λ鍐潖缂佹ɑ濯撮柛娑橈龚绾偓闂備焦鍎崇换鎰版煀閿濆懐鏆︾憸鐗堝笚閸嬪鏌涢鐘茬労婵炲弶鎮傚娲川婵犲啫鐦烽梺鍛婁緱閸ㄧ晫妲愰崘娴嬫斀闁绘劘鍩栬ぐ褏绱掗懠璺盒撶紒鏃傚枑缁绘繈宕戦弬銈囩М鐎规洦鍋婃俊鐤槾闁挎稒绮嶇换婵嬪閿濆棛銆愭俊銈囧У閹倿骞冮敓鐘茬疀闁绘鐗忛崢鎼佹⒑閸涘﹣绶遍柛姗€绠栧畷娲晲閸ワ絽浜鹃悷娆忓缁€鍫熴亜椤撶偟澧ｉ柣蹇撳暣濮婃椽鏌呴悙鑼跺濠⒀屽灦閹妫冨☉鏍т划闂佽鍠掗弲婵囩閿曞倸纾兼俊銈傚亾濞存粓绠栭弻鐔兼倻濡櫣鍔稿┑鐐茬毞閺呮粓濡甸崟顖氱闁规惌鍨版导鎰節濞堝灝鏋熺紒瀣尵濡叉劙骞樼€涙ê顎撻梺鍦帛鐢﹥绔熼弴鐐╂斀闁绘﹩鍠栭悘杈ㄧ箾婢跺顬煎褎绻傞埞鎴﹀焺閸愩劎绁烽梺缁橆殕閹瑰洤顕ｆ繝姘亜闁绘挸娴烽悾楣冩偡濠婂啰绠绘鐐搭殜閹晠鎮欓幋鎺旂泿闂備線娼чˇ顓㈠磿閺屻儖澶愭偐閻㈢數锛滈柡澶婄墑閸斿瞼绮缁辨帗娼忛妸銉х懆闁句紮缍侀弻銈嗘叏閹邦兘鍋撻妶鍛傦綀銇愰幒鎾嫽婵炶揪绲肩拃锕傚绩閻楀牏绠鹃柛娑卞枟缁€瀣煏閸℃鏆炵紒缁樼箞瀹曟儼顦存い鏂挎处缁绘繈鎮介棃娴躲垽鏌涢悤浣镐簽婵炲棎鍨介幃娆撴倻濡　鍋撻崼鏇熺厽闁归偊鍓涙禒娑欑箾閸涱喗绀€闂囧鏌ｉ幘鎶筋€楁い蹇ｅ幗閹?
            if (ItemStack.isSameItemSameTags(slotStack, toAdd) && slotStack.getCount() < slotStack.getMaxStackSize()) {
                int space = slotStack.getMaxStackSize() - slotStack.getCount();
                int moveCount = Math.min(space, toAdd.getCount());

                slotStack.grow(moveCount);
                toAdd.shrink(moveCount);

                if (toAdd.isEmpty()) return ItemStack.EMPTY; // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑鏅悷婊冪Ч濠€渚€姊虹紒妯虹伇婵☆偄瀚划濠氭偐缂佹鍘甸梺璇″瀻鐏炶姤顔嶉梻鍌氬€哥€氼剛鈧矮鍗冲濠氭晸閻樿尙顦ㄩ梺闈涱焾閸庮噣宕戦幘缁樺殟闁靛绠戝?
            }
        }

        // 2. 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯煎幗闁瑰吋鎯岄崹宕囩矓閻㈠憡鐓曢悗锝庝簻閳ь剚鎮傞敐鐐测攽鐎ｎ偅娅囬梺閫炲苯澧撮柛鈺冨仱楠炲鏁冮埀顒勬偂閿熺姵鐓曢柍鈺佸枤濞堟ê霉閻欌偓閸ㄥ磭妲愰幘瀵哥懝闁搞儜鍕蒋闂備焦鎮堕崝宀€澹曢銏犵闁圭儤鎸剧弧鈧┑顔斤供閸撴盯顢欐繝鍌楁斀閹烘娊宕愰幘缁樺殑闁割偅娲栭崒銊╂⒑椤掆偓缁夌敻鍩涢幋锔界厱闁挎棁顕у銊︿繆閻愵剚鍊愰柡灞剧洴婵℃悂濡烽妷銊ョ厴闂備礁鐤囬褏绮旈悷鎵殾闁割偅娲栨儫閻熸粌绻橀、娆撳即閵忊檧鎷洪梺鍛婃尰瑜板啯绂嶉悙鐑樼厱闁绘ɑ鐓￠崣鍕煙椤旀枻鑰挎鐐达耿椤㈡瑩鎮剧仦钘夌婵犵數鍋犻幓顏嗗緤娴犲绠烘繝濠傛閳ь剚娼欓埞鎴︽倷瀹割喖娈舵繝娈垮灠椤曨厾鍒掓繝姘闁煎鍊曠粊锕傛⒑缁洖澧查柛鎴犳嚀椤﹪濡搁妷銏℃杸闂佸疇妫勫Λ妤佺閻愮儤鐓曢柣妯挎珪鐏忓灚淇婇崣澶婂妤犵偞顭囬埀顒佺⊕閿氭い搴㈡崌濮婃椽宕ㄦ繝鍕窗闂佺姘﹀▍鏇犫偓闈涖偢瀹曞爼顢楁担鍙夊缂傚倷绀侀鍫濃枖閺囥垹鍙婇柛宀€鍋為悡鏇炩攽閻樻彃鏆熺紒鐘靛仦椤ㄣ儵鎮欓幓鎺撴濡炪倧绠戝﹢閬嶅焵椤掑喚娼愭繛璇х畵瀹曟垶绻濋崘褏绠氶梺缁樺灱濡嫰锝為崨瀛樼厽婵☆垰鎼懜瑙勩亜閵夛妇顣茬紒缁樼箞閹粙妫冨☉妤佸媰闂備焦鎮堕崝宀勬偉婵傜绠栭柣鎴ｆ鍞梺鎸庢濡嫬顕ｉ崸妤佲拺闁告挻褰冩禍鏍煕鎼淬垻鍙€闁?
        for (int i = startSlot; i <= endSlot; i++) {
            if (inventory.getItem(i).isEmpty()) {
                inventory.setItem(i, toAdd);
                return ItemStack.EMPTY; // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑鏅悷婊冪Ч濠€渚€姊虹紒妯虹伇婵☆偄瀚划濠氭偐缂佹鍘甸梺璇″瀻鐏炶姤顔嶉梻鍌氬€哥€氼剛鈧矮鍗冲濠氭晸閻樿尙顦ㄩ梺闈涱焾閸庮噣宕戦幘缁樺殟闁靛绠戝?
            }
        }

        return toAdd; // 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫鍐煥閺囨浜鹃梺姹囧€楅崑鎾舵崲濠靛洨绡€闁稿本绮岄。娲⒑閽樺鏆熼柛鐘崇墵瀵寮撮悢铏诡啎闂佸壊鐓堥崰鏍ㄧ珶閸曨偀鏀介柣鎰级閳绘洖霉濠婂嫮鐭掔€规洘锕㈤崺鈧い鎺嗗亾妞ゎ亜鍟存俊鍫曞幢濡儤娈梻浣侯焾椤戝洭宕伴弽顒侇棨婵＄偑鍊栭幐鍫曞垂濞差亜鐓曢柟杈鹃檮閸婄敻鏌涢敂璇插箹鐞氥劑姊洪柅鐐茶嫰閸樻挳鏌涚€ｎ偅宕屾慨濠呮缁瑥鈻庨幆褍澹夐梻浣告贡椤牊鏅堕挊澹╋綁骞囬弶璺唺闂佺懓鐤囧▍鏇炍涢崘顔兼槬闁逞屽墯閵囧嫰骞掗幋婵愪患缂備胶濮锋慨鐢稿箞閵娿儺娓婚悹鍥紦婢规洟鏌?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙闁稿被鍔庨幉鎼佸棘鐠恒劍娈惧銈嗙墱閸嬫盯鏌ㄩ妶鍡曠箚闁靛牆瀚ˇ锔界箾閸剛鍒版い顏勫暣婵″爼宕卞▎蹇ｆ椒濠电姰鍨奸～澶娒洪悢椋庢殾闁硅揪绠戠粻濠氭偣閸ャ劌绲婚柣搴幖椤啴濡堕崱妤€顫呴梺绋款儐閹稿濡甸崟顔剧杸闁规崘娉涢。鐢告⒑闁偛鑻晶鍓х磼閻樿櫕灏板ǎ鍥э躬楠炴牗鎷呴崫銉ュ箰濠电偠鎻紞鈧俊妞煎妿濡叉劕顭ㄩ崼鐔叉嫽婵炶揪缍€濡嫭绂嶈ぐ鎺撶厓鐎瑰嫭澹嗘晶锔锯偓瑙勬礃缁矂鍩㈡惔銊ョ鐎规洖娲﹂悡?
    }
    // ==========================================
    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱樈閸犳顕欏ú顏呪拺缂侇垱娲栨晶鍙夈亜閵娿儲鍣界紒顔芥閵囨劙骞掗幘鍏呭摋婵犳鍠楅敃鈺呭储閹烘绠ｉ柣妯哄暱鎼村﹤鈹戦悙鏉戠仧闁搞劌婀辩划濠氭晲婢跺鍘介梺褰掑亰閸樼晫绱為幋鐘垫／闁哄娉曞瓭濡炪値浜滈崯瀛樹繆閼稿灚鍎熼柍銉ョ－椤旀帡姊绘担渚劸缂佺粯鍨块弫鍐閻樺灚娈惧┑鐐叉▕娴滄粓鎮為崹顐犱簻闁瑰搫绉瑰宄懊瑰鍕煉闁哄瞼鍠栧畷顐﹀礋椤撳鍊濋弻娑㈠棘鐠恒剱锝夋煏閸パ冾伃妞ゃ垺娲熼弫鎰償閵忋垺姣夌紓?(婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓闁搞劌鍊块弻娑㈩敃閿濆棛顦ョ紓浣哄У瑜板啴濡撮幒鎴僵闁挎繂鎳嶆竟鏇熶繆閻愵亜鈧垿宕瑰ú顏呭仭闁挎梻鍋撳畷鍙夌節闂堟侗鍎忕痪鎯с偢閺屾稓浠﹂挊澶嬫闁诲孩鍑归崜娑樷枎閵忋倖鍊烽柣鎴烆焽閸樼敻姊绘笟鍥у伎缂佺姵鍨堕弲鍫曟偋閸稐绨婚梺鍝勫€圭€笛囧窗濡粯鍙忓┑鐘插暞閵囨繃淇婇銏犳殭闁宠棄顦板蹇涘煛娴ｅ摜绉茬紓鍌氬€搁崐鐑芥嚄閼稿灚鍙忛柣銏㈩焾閸ㄥ倿鏌涜椤ㄥ懘寮伴妷鈺傜厱婵炴垶顭囬幗鐘绘煕鐎ｃ劌濮傞柡灞剧☉閳藉顫滈崼婵嗩潬闂備礁鎲￠悷銉ノ涘Δ鍛厴闁硅揪闄勯崐鐑芥煛婢跺鐏╁ù鐘虫倐閺岋箓宕橀銏犳懙缂備胶绮换鍫ュ春閳ь剚銇勯幒宥囶槮妞ゆ洟浜堕幃妤€鈽夊▎妯煎姺闂佸憡锕㈡禍璺侯潖濞差亝顥堟繛鎴ｄ含閸欐碍绻濈喊妯峰亾閾忣偄鏋犻梺璇″灠閼活垶鎮惧┑瀣妞ゆ帒鍊搁獮鎰攽閻愬瓨灏伴柤瑙勫劤鐓ら柕鍫濇噳閺嬪秶鈧箍鍎卞Λ搴㈢濠婂牊鐓忛煫鍥ュ劤绾惧潡鏌熼崘鍙夊枠闁哄瞼鍠栭幖褰掝敃閵堝應鎷伴梻浣虹《閺咁亞鎹㈠┑鍡欐殾婵せ鍋撴鐐叉椤﹁櫕绻?
    // ==========================================
    static class TurretDefendOwnerGoal extends net.minecraft.world.entity.ai.goal.target.TargetGoal {
        private final SkeletonTurret turret;
        private LivingEntity attacker;
        private int timestamp;

        public TurretDefendOwnerGoal(SkeletonTurret turret) {
            super(turret, false);
            this.turret = turret;
            this.setFlags(EnumSet.of(Flag.TARGET));
        }

        @Override
        public boolean canUse() {
            // 1. 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂磋閳ь剨绠撻、妤呭礋椤愩倧绱遍梻浣告啞濞诧箓宕愮€ｎ€㈡椽顢旈崟骞喚鐔嗛悹铏瑰皑閸旂喖鏌ｉ妶鍛悙闁宠鍨块、娆愭叏閹邦亞鎹曢梻浣侯焾椤戝棝骞愰幖浣哥厴闁硅揪闄勯弲顒勬煕閺囩偟浠涙い銉︽尵缁辨挻鎷呴崫鍕戯絿绱掔€ｎ偄鐏撮柛鈹垮劜瀵板嫭绻涢姀銏犳灈闁圭厧缍婇幃鐑藉箥椤旀嫎婊勭節閻㈤潧啸闁轰礁鎲￠幈銊﹀閺夋垵鐎梺缁樻尭缁ㄥ爼寮搁弽銊х闁瑰瓨姊归崵宥夋煕閵夘喖澧婚柡浣哥Ч閺岋綁骞囬鐔虹▏闂佸憡鎸堕崝宀勫煘閹达附鍋愰悹鍥囧啩绱ｉ梻浣虹帛椤ㄥ懘鏁冮鍫濈畺?
            if (this.turret.ownerUUID == null) return false;
            Player owner = this.turret.level().getPlayerByUUID(this.turret.ownerUUID);
            if (owner == null) return false;

            // 2.婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾剧粯绻涢幋娆忕労闁轰礁顑嗛妵鍕箻鐠虹儤鐎鹃梺鍛婄懃缁绘劙婀侀梺绋跨箰閸氬绱為幋鐘垫／闁诡垎鍕淮闂佸搫鐭夌槐鏇熺閿旂偓瀚氶柟缁樺笒鑲栭梻鍌欐祰濡椼劎绮堟担鑲濇稑鈻庨幋鐐插簥濠电娀娼ч鍡浰夐崼鐔虹闁瑰瓨绻傞懜褰掓煕閹炬潙顥嬬紒杈ㄦ尰閹峰懘骞撻幒宥咁棜闂傚倷鑳剁涵鍫曞礈濠靛牏鐭欓柟鐑橆殕閸嬪倿鐓崶銊р姇闁绘挻娲橀妵鍕箛閸撲焦鍋х紓浣哄У閻楃娀寮诲☉銏℃櫜闁告洦鍘鹃悡鎾绘⒑閸濆嫮鐒跨紒缁樼箓閻ｇ兘鏌嗗鍛祮闂佺粯鍔樼亸娆撳Χ椤曗偓濮婄粯鎷呴崨濠冨創闁荤偞鍑归崑濠傜暦濠靛棛鏆嗛柛鏇ㄥ亞閸欌偓濠电姰鍨煎▔娑滃闂佸搫顑呴柊锝夊蓟閻旇　鍋撻悽娈跨劸鐎涙繈鎮峰鍕凡闂佸府绲介～蹇涙惞鐟欏嫬鐝伴梺鍝勮閸庡崬顕ｉ弶搴撴斀闁绘劖婢樼亸鍐煕閵夋垵鍟拌ぐ澶嬩繆閻愵亜鈧牜鏁幒妤€纾瑰┑鐘崇閸庢顭跨捄鍝勵槵闁稿鎹囬悰顕€宕归鐓庮潛婵＄偑鍊х紓姘跺础閸愯尙鏆﹂柟閭﹀枤绾惧吋淇婇姘础缂佺姵鑹鹃—鍐Χ閸℃瑥顫х紓浣割儐閸旀瑩鐛径瀣ㄥ亝闁告劏鏅濋崣鍡涙⒑閸濆嫭宸濋柛瀣洴閸┾偓妞ゆ巻鍋撶紓宥咃躬楠炲啴鏁撻悩鎻掑祮闂佺粯姊婚…鍫濐嚕閸喒鏀介柍钘夋閻忕娀鏌熺喊鍗炰喊闁糕晜鐩顕€宕奸悢鍝勫箺闂備焦瀵х换鍌炈囬鈧獮澶嬨偅閸愨晝鍘搁柣蹇曞仜婢ц棄煤閺夋垟鏀介柍鈺佸暞閸婃劕鈹戦垾宕囧煟鐎规洏鍔戦、姗€鎮╅闂寸病闂傚倷娴囬褍顫濋敃鍌︾稏濠㈣泛鈯曢崫鍕垫建闁逞屽墴楠炲﹤鈹戦崶銉ヤ簼闂佸憡鍔樺▔鏇犵矙韫囨挴鏀介柣妯肩帛濞懷勩亜閹寸偛濮嶇€殿噮鍋婂畷鍗炩槈濞嗘垵甯楅柣鐔哥矋缁挸鐣峰鍐ｆ婵﹩鍙庡鐔兼⒑缂佹ê濮囬柟纰卞亰閹偤宕归鐘辩盎闂佸湱鍎ら崹鐢割敂椤忓牊鐓熼柟鎯ь嚟閳藉銇勯鈩冪《闁圭懓瀚伴幃婊冾潨閸℃﹫绱掑┑鐘垫暩閸嬫盯骞婃惔銊ョ疇闊洦娲樺畷鍙夌箾閹寸偟顣查悗姘皑閹叉瓕绠涘☉妯碱槴婵炲鍘ч悺銊╂偂閸愵喗鍋℃繛鍡楃箰椤忊晠鏌ｈ箛鏃€灏﹂柡灞剧洴閸╃偤骞嗚婢规洖鈹戦敍鍕杭闁稿﹥鐗滈弫顕€骞掗弬鍝勪壕婵鍘у顕€鏌?
            this.attacker = owner.getLastHurtByMob();
            int i = owner.getLastHurtByMobTimestamp();

            // 3. 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴濐潟閳ь剙鍊块幐濠冪珶閳哄绉€规洏鍔戝鍫曞箣閻欏懐骞㈤梻鍌欑窔閳ь剛鍋涢懟顖涙櫠閹绢喗鐓涢悘鐐插⒔閵嗘帡鏌嶈閸撱劎绱為崱娑樼；闁告侗鍘鹃弳锔锯偓鍏夊亾闁告洦鍓涢崢鎼佹倵閸忓浜鹃柣搴秵閸撴盯鏁嶉悢鍝ョ閻庣數顭堥鎾斥攽閳ヨ櫕鍠樻鐐茬箻閹晝鎷犻懠顒夊斀闂備礁婀遍崕銈夊春閸繍鐒介柕澶堝劗閺€浠嬫煟濡椿鍟忛柡鍡樼矌缁辨帗娼忛妸锔绢槹閻庤娲橀崹鐢稿煡婢舵劕顫呴柣妯碱暜缁鳖噣姊绘担绋款棌闁绘挸鐗撳畷鎶筋敊绾拌京鍔烽梺鍝勭▉閸樹粙鎮￠悩娴嬫斀妞ゆ棁妫勬慨鍥煃瑜滈崜姘跺礉濞嗗繒鏆﹂柟杈剧畱缁犲鏌￠崒妯哄姕妞ゎ偄绉撮埞鎴︽倷閸欏顎涢梺鍛婄懃鐎涒晝绮嬪澶樻晜闁割偅绻勯悾娲⒑鐠恒劌鏋斿┑顔芥尦閺屽宕堕浣哄帾婵犮垼鍩栫粙鎴︺€呴鍕厱婵炲棗绻戦ˉ婊堟煃鐟欏嫬鐏撮柟顔界懇瀵爼骞嬮悩杈敇濠碉紕鍋戦崐銈夊储閻撳篃娲敇閵忕姷鐣洪梺缁樺姇閹碱偄顔忓┑鍡忔斀闁绘绮鹃崗宀€绱掗悩鍐插摵婵﹥妞介幃鈩冩償濞戞ü鍒掓俊鐐€戦崐鏇㈠磹閸喚鏆﹂梻鍫熺▓閺嬪酣鏌熼幍铏珒缂併劏顕ч—鍐Χ閸℃顫庢繝娈垮枟閹告娊骞冨鈧獮鎾诲箳閸℃ɑ鏉告俊鐐€栧濠氬箠閹惧顩插Δ锝呭暞閳锋帒銆掑锝呬壕濠电偘鍖犻崨顔煎簥闂佸壊鍋侀崕閬嶅垂閸屾粍鍠愰柣妤€鐗嗙粭鎺楁煟閹烘垹浠涢柕鍥у楠炴帒顓奸崶鑸敌滈梻浣哥－缁垰煤閻旂厧钃熼柍銉ョ－閺嗗棝鎮楅敐搴″闁伙箑鐗撻幃妤冩喆閸曨剛顦ㄩ梺鎸庢磸閸ㄥ綊鎮鹃悜鑺ュ亜缁炬媽椴搁弲婵嬫⒑閹稿海绠撻悗娑掓櫊钘熼柨婵嗘缁?
            return i != this.timestamp && this.canAttack(this.attacker, net.minecraft.world.entity.ai.targeting.TargetingConditions.DEFAULT);
        }




        @Override
        public void start() {
            this.mob.setTarget(this.attacker);
            Player owner = this.turret.level().getPlayerByUUID(this.turret.ownerUUID);
            if (owner != null) {
                this.timestamp = owner.getLastHurtByMobTimestamp();
            }
            super.start();
        }

        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗霉閿濆浜ら柤鏉挎健濮婃椽顢楅埀顒傜矓鐎电顥氶柛褎顨嗛悡蹇涙煕椤愶絿绠栧璺哄閺岋繝宕卞Ο鑲╃厜闂佸搫鑻粔瑙勪繆閻戣姤鏅滈柣锝呭缁辨﹢姊绘担鍛婃儓妞ゆ垵鎳愮划鏃囥亹閹烘柨绁﹂梺鍝勭▉閻忔梹鎯旈…鎴炴櫌闂侀€炲苯澧ǎ鍥э攻缁轰粙宕ㄦ繝鍕箺婵＄偑鍊栭幐楣冨闯閵夈儮鏋旀繝濠傜墛閻撴瑦銇勯弮鍌滄憘婵炲牊绮撻弻鈩冩媴閻熸澘顫嶉梺璇″灡閺屻劑鍩為幋锕€閱囬柕蹇婂墲濞呮帡姊?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎电濡介梺绋款儏椤戝鎮￠锕€鐐婇柕濞р偓濡插牏绱掗幆褍鈷旂紒顕呭灣閹广垹鈽夐姀鐘殿吅濠电偛妫楃换鎺撶妤ｅ啯鈷戠紒瀣儥閸庡繑銇勯敂鐐毈鐎殿喛顕ч埥澶愬閳哄倹娅囬梻浣瑰缁诲倸螞濞戔懞鍥Ω閳哄倵鎷虹紓鍌欑劍钃遍悘蹇ｅ弮閺屾稒绻濋崒銈囧悑闂佺硶鏂侀崑鎾愁渻閵堝棗鍧婇柛瀣尵缁辨帡鎮╅懠顑呪偓瑙勬礃濞茬喖寮婚崱妤婂悑闁糕剝銇炵純鏇熺節閻㈤潧孝闁挎洏鍊濆畷銏ゅ箚椤剝妞介、鏃堝川椤旂晫褰告繝鐢靛О閸ㄧ厧鈻斿☉銏╂晞闁搞儺鍓欓惌妤呮煕閳╁啨浠滈柡鈧禒瀣厽闁归偊鍘界紞鎴︽煟韫囥儵妾柕鍥у椤㈡﹢鎮欓弶鎴炵亷闂備浇顕栭崰姘跺磻閵堝懐鏆﹂柕濠忓缁♀偓婵炶揪缍€濞咃綁鎮炬ィ鍐┾拻濞达絽鎼敮鍫曟煏閸喐鍊愮捄顖炴煕瀹€鈧崑娑㈠触鐟欏嫮绠鹃柛鈩兠慨鍌毭瑰鍕煁闁靛洤瀚伴獮鍥敊婢跺箍鍨介弻锝堢疀閺傝法绁烽梺瀹狀潐閸ㄥ潡銆佸▎鎾村仭濡绀侀ˉ姘舵⒒閸屾艾鈧兘鎮為敂閿亾缁楁稑鎳忓畷鏌ユ煕鐏炲彞绶辨繛鍫㈡櫕缁辨帞鈧綆浜炲銊╂煛鐎ｎ偅顥堥柡灞界Ч瀹曨偊宕熼鐔蜂壕闁煎鍊楁稉宥呂旈敐鍛殲闁稿﹦鏁诲濠氬醇閻旇　妲堝銈冨劚缁绘﹢寮诲☉娆愬劅闁挎繂鎳夐弸鍛存⒑閸濆嫭婀扮紒瀣笧閹广垹鈹戠€ｎ亞顦ㄥ銈呯箰濡盯寮抽妶澶嬧拺闁告稑顭▓婊兠瑰鍐煟鐎殿喖顭锋俊鎼佸煛娴ｇ绁梻浣虹帛閸旀牜绮婇幘顔肩；闁规儳绠嶆禍褰掓煙閻戞ê鐏╅柡?
        @Override
        protected boolean canAttack(@Nullable LivingEntity target, net.minecraft.world.entity.ai.targeting.TargetingConditions targetPredicate) {
            if (target == null) return false;
            if (target instanceof Player && target.getUUID().equals(this.turret.ownerUUID)) return false; // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎺嶇劍椤斿洭姊绘担绋挎毐闁圭⒈鍋婇獮濠冩償閿濆拋妫滄繝鐢靛У绾板秹鎮￠弴鐔虹闁瑰瓨绻傞懜褰掓煛鐎ｎ剙鏋戠紒缁樼洴瀹曘劑顢涘锝嗙€伴梻浣告惈鐞氼偊宕濋幋婵愬殨妞ゆ洍鍋撶€规洘甯掗埥澶娾枎閹存繃閿梻鍌氬€风粈浣哄椤撶姴鍨濇い鏍嚤濞戙垹绀冩い鏃囧亹閻ｆ椽鏌ｉ悢鍝ユ噧閻庢凹鍘介崚濠囧箻椤旂晫鍘鹃梺璇″幗鐢帡宕濋妶鍥ㄥ枑闁硅泛锕ゅú锕傚煕?
            if (target instanceof SkeletonTurret) return false; // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎺嶇劍椤斿洭姊绘担绋挎毐闁圭⒈鍋婇獮濠冩償閿濆拋妫滄繝鐢靛У绾板秹鎮￠弴鐔虹闁瑰瓨绻傞懜褰掓煛鐎ｎ剙鏋戠紒缁樼洴瀹曘劑顢涘锝嗙€伴梻浣告惈鐞氼偊宕濋幋婵愬殨闁圭虎鍠楅崐閿嬬箾閺夋埈鍎忓ù婊堢畺閺岀喖姊荤€电濡介梺绋垮椤ㄥ棙绌辨繝鍥ч柛娑卞枛濞呫倝姊虹粙鍖″姛闁轰礁顭峰濠氬Ω閵夈垺鏂€闂佺硶鍓濋悷銉╁吹椤掑倻纾藉ù锝夋涧婵″吋銇勯鐘插幋鐎殿喖顭烽弫鎾绘偐閹绘帞鐛╂俊鐐€栫敮鎺楀磹婵犳碍鍋傞柟鍓х帛閳?
            if (target instanceof IronGolem) return false;      // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎺嶇劍椤斿洭姊绘担绋挎毐闁圭⒈鍋婇獮濠冩償閿濆拋妫滄繝鐢靛У绾板秹鎮￠弴鐔虹闁瑰瓨绻傞懜褰掓煛鐎ｎ剙鏋戠紒缁樼洴瀹曘劑顢涘锝嗙€伴梻浣告惈鐞氼偊宕濋幋婵愬殨闁圭虎鍠楅崐閿嬬箾閺夋埈鍎忓ù婊冨⒔閹叉悂鎮ч崼婵堢懖闂佺顑呴崐鍧楀蓟閵娿儮鏀介柛鈩兠禒楣冩偡濠婂懎顣奸悽顖涱殜瀵煡寮婚妷锔惧幈闂侀潧顦崕閬嶃€傞幎鑺ョ厱闁哄啠鍋撻柟顔煎€搁～蹇撁洪鍛姷闂佺粯鍔樼亸顏嗏偓姘緲椤儻顧侀柛鐘愁殜婵＄敻宕熼姘鳖吅濠电姴鐏氶崝鏍煝閸儲鍊?
            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎺嶇劍椤斿洭姊绘担绋挎毐闁圭⒈鍋婇獮濠冩償閿濆拋妫滄繝鐢靛У绾板秹鎮￠弴鐔虹闁瑰瓨绻傞懜褰掓煛鐎ｎ剙鏋戠紒缁樼洴瀹曘劑顢涘锝嗙€伴梻浣告惈鐞氼偊宕濋幋婵愬殨闁圭虎鍠楅崐閿嬬箾閺夋埈鍎忓ù婊堢畺閺屾稑鈹戦崟顐㈠Б婵炴垶鎸哥粔褰掑蓟閵娿儮鏀介柛鈾€鏅滄晥闂備胶绮幐濠氭偡閳哄懎绠栨俊銈傚亾闁宠棄顦埢搴∥熼悡搴⌒ㄩ梻鍌欑劍濡炲潡宕㈡總鍓叉晞闁搞儮鏅滈～鏇㈡煙閻戞﹩娈㈤柡浣割儔閺屾盯鍩勯崘顏呭櫘闂佸搫妫庨崐婵嗩潖閾忚瀚氶柍銉ㄦ珪閻忔洖顪冮妶搴′簻妞わ妇鏁婚悰顔跨疀濞戞ê绐涢柣搴㈢⊕閿曗晛螞閸愩劉鏀介柣鎰綑閻忥箓鎮介娑樼瑲缂佸倸绉归幃娆擃敆閸屾粠鍟庨梻浣烘嚀閻°劑鎮烽妷鈺傚€舵い蹇撶墛閻撴洟骞栫划瑙勵潐鐎规悶鍎查妵鍕敇閳╁啰銆婇梺鍦嚀鐎氼厾绮悢纰辨晬婵﹩鍓欓ˉ搴㈢節閻㈤潧浠滈柣掳鍔戝畷鍨償閵娿儳锛欏┑鐘绘涧椤戝懘鎷戦悢鍝ョ闁瑰瓨鐟ラ悘鈺呭船椤栫偞鈷戦梻鍫熺〒缁犳岸鏌涢幘瀵哥疄闁诡喚鏁诲鎾閳锯偓閹风儤绻涢弶鎴濇倯闁荤啙鍛煋妞ゆ梹绁归悷閭︾叆闁告劦浜滈悡鐔兼倵濞堝灝鏋︽い鏇嗗洤鐓″璺好￠悢鍏肩叆閻庯綆鍏橀崑鎾寸節濮橆収妫呭銈嗗姂閸ㄨ櫣绮婇銈囩＜闂婎偒鍘鹃惌娆戔偓瑙勬礃缁秶鈧絻鍋愰埀顒佺⊕鑿ら柟閿嬫そ濮婃椽宕ㄦ繝鍕窗闂佺閰ｆ禍璺侯嚕閹间礁绠ｉ柣鎰典簷缁ㄥ姊洪棃娑辩劸闁稿骸顭烽悡顒勵敆閸曨剛鍘藉┑鐐村灥瀹曨剙鈻嶅澶嬬厱闁宠鍎虫禍鐐繆閻愵亜鈧牜鏁繝鍥ㄢ挃鐎广儱妫涢々鍙夌節婵犲倻澧㈤柛娆愭崌閺屾盯濡烽敐鍛瀴闁诲繐绻掓晶妤呭Φ閸曨垰唯闁挎柨澧介悡澶愭⒑?
            if (target.getPersistentData().getBoolean("IsFriendlyZombie")) return false;
            if (target.getPersistentData().getBoolean("IsFriendlyCreeper")) return false;

            return super.canAttack(target, targetPredicate);
        }
    }

    // ==========================================
    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱樈閸犳顕欏ú顏呪拺缂侇垱娲栨晶鍙夈亜閵娿儲鍤囬柨婵堝仱閸╋繝宕橀鍡闯濠电偠鎻徊鎹愩亹閸愨晝顩插Δ锝呭暞閳锋垹绱掔€ｎ偄顕滄繝鈧悧鍫涗簻闁哄洦锚閻忛亶鏌曢崶銊ュ妤犵偞甯￠獮妯尖偓娑欘焽瑜版悂姊婚崒娆掑厡缁绢厼鐖煎畷婊冣攽鐎ｎ偄浠悷婊勬楠炲啴鍩勯崘銊х獮闂佸綊鍋婇崢鎼佸箯濞差亝鈷掑〒姘搐娴滅偤鏌涚€ｎ偆娲撮柟宕囧枛椤㈡稑鈽夊▎鎰娇婵＄偑鍊栭悧妤冪矙閹邦喗宕查柛鈩冪⊕閻撴洘绻涢崱妤佺婵℃彃鎽滅槐鎺戭渻閿曗偓鐎氼喚绮?(婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓闁搞劌鍊块弻娑㈩敃閿濆棛顦ョ紓浣哄У瑜板啴濡撮幒鎴僵闁挎繂鎳嶆竟鏇熶繆閻愵亜鈧垿宕瑰ú顏呭仭闁挎梻鍋撳畷鍙夌節闂堟侗鍎忕痪鎯с偢閺屾稓浠﹂挊澶嬫闁诲孩鍑归崜娑樷枎閵忋倖鍊烽柣鎴烆焽閸樼敻姊绘笟鍥у伎缂佺姵鍨堕弲鍫曟偋閸稐绨婚梺鐟板⒔閸嬨劑宕戦姀鈩冨弿濠电姴鎳忛鐘绘煙閸欏灏︾€规洜鍠栭、鏇㈠閻樻ɑ鍨剁换婵嬫偨闂堟刀娑㈡煕鐎ｎ偅宕岄柡灞剧☉铻栭柛鎰╁妺濮规姊洪崫鍕靛剱婵☆偄鍟～蹇撁洪宥嗘櫌闂侀€炲苯澧扮紒顔芥閹粙宕ㄦ繝鍌欑暗闂備線娼ч¨鈧┑鈥虫川缁粯銈ｉ崘鈺冨幍闁诲海鏁搁…鍫ュ焵椤掍胶澧垫鐐差儏閳规垿骞橀崗澶婁壕闁割煈鍟旇ぐ鎺撳亗閹艰揪绲鹃幉濂告⒑缂佹ɑ灏版繛鑼枛瀵寮撮悢铏圭槇闂婎偄娲﹂幖鈺伱洪銏♀拺婵炶尪顕ч獮妤呮偨椤栨侗娈滈柕鍡楀暣婵＄兘鍩￠崒姘ｅ亾閻戣姤鐓犵痪鏉垮船閸旑喚鎲告惔銊ｂ偓鍐Ψ閳哄倸鈧兘寮堕崼鐔风闁逞屽墲濞夋洟鍩€椤掑喚娼愭繛鍙夌矒瀹曟顫滈埀顒勫Υ娴ｅ壊娼ㄩ柍褜鍓熼獮鍐Χ閸℃ê顎撻梺鍛婄☉閿曘儱袙?
    // ==========================================
    static class TurretAssistOwnerGoal extends net.minecraft.world.entity.ai.goal.target.TargetGoal {
        private final SkeletonTurret turret;
        private LivingEntity target;
        private int timestamp;

        public TurretAssistOwnerGoal(SkeletonTurret turret) {
            super(turret, false);
            this.turret = turret;
            this.setFlags(EnumSet.of(Flag.TARGET));
        }

        @Override
        public boolean canUse() {
            // 1. 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼妽闁稿繑绮撻弻娑㈩敃閿濆棛顦ラ梺姹囧€濈粻鏍蓟閿濆绠涙い鎾跺О閸嬬偤姊洪崫鍕靛剰缂佸缍婂濠氬Ω閵夈垺鏂€闂佺硶妾ч弲婊嗗€撮梻鍌欑窔閳ь剛鍋涢懟顖炲储閸濄儳纾奸柤闀愮祷婢规﹢鏌ｉ敐鍥у幋濠碘剝鎮傞崺鈩冪節閸愨晜鐝濋梻鍌欑劍閹爼宕曢鐐茬閹肩补鍩楀ú顏勭妞ゆ梻鏅崢閬嶆⒑鐎圭媭娼愰柛搴ゆ珪缁傚秹鎮欓璺ㄧ畾闂佺粯鍔︽禍婊堝焵椤掍胶澧遍柡渚囧櫍楠炴帡寮崫鍕濠殿喗顭囬崢褍顕ｉ閿亾?
            if (this.turret.ownerUUID == null) return false;
            Player owner = this.turret.level().getPlayerByUUID(this.turret.ownerUUID);
            if (owner == null) return false;

            // 2. 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕閻庤娲忛崕鎶藉焵椤掑﹦绉甸柛鐘崇墱婢规洟宕稿Δ浣哄幍闂佽鍨虫晶妤吽夋径鎰闁哄鍩婇煬顒勬煛鐏炶鈧繈骞婂┑瀣妞ゆ棁鍋愭晶顖氣攽閻愯尙鎽犵紒顔肩灱缁辩偞绻濋崶褑鎽曞┑鐐村灟閸ㄧ懓鏁梻浣瑰缁诲倿骞婃惔銊⑩偓鏍偓锝庡枟閳锋垹鈧娲栧ú銊ф暜濞戞瑤绻嗘い鎰╁灩閺嗭絾顨ラ悙鎻掓殶闁瑰弶鎸冲畷鐔碱敆閳ь剟顢撻幘缁樷拺闁稿繘妫块懜顏堟煕鎼达紕鏋冮柕鍥ㄥ姌椤﹁鎱ㄦ繝鍌涙儓閻撱倝鎮规担鍝ワ紞闁煎疇娅ｇ槐鎾寸瑹閸パ勭亶闂佽崵鍟块弲娑㈩敋閿濆棛绡€婵﹩鍘藉▍銏ゆ⒑缂佹﹩鐒鹃悘蹇旂懇瀹曟繈鏁冮埀顒勨€旈崘顔嘉ч柛鈩冾殘閻熴劑姊虹粙鍖″伐婵犫偓闁秴鐒垫い鎺嶈兌椤ｈ尙鈧厜鍋撻柟闂寸閽冪喖鏌ｉ弮鍥仩缁炬儳鍚嬫穱濠囶敍濠靛浂浠╅梺鑽ゅ枑閻撯€愁潖閻戞ê顕辨繛鍡樻尰椤庡秹姊虹紒姗嗘畼濠殿喗鎸抽敐鐐剁疀濞戞ü绱堕梺鍛婃礃閸ゎ亪宕惰閸婄偤鎮峰鍐ч柍銉︾墵瀹曞ジ濡烽敂鎯у箺闂佺懓鍚嬮悾顏堝垂瑜版帒鍚规い鎺戝閻撴洟鏌ｅΟ铏癸紞濠⒀囦憾閺屾稑鈻庤箛鏂挎缂備胶绮粙鎾诲焵椤掑倹鏆╂い顓炵墢閺侇噣宕奸弴鐔哄幗闁圭儤濞婂畷婵嬪箣濠垫劕娈?
            this.target = owner.getLastHurtMob();
            int i = owner.getLastHurtMobTimestamp();
            if (i == this.timestamp) return false;

            // 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰鍐€闁靛ě鍛帎婵?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣椤愯姤鎱ㄥ鍡楀⒒闁绘帞鏅幉绋款吋閸澀缃曞┑鐘垫暩閸嬫稑螞濞嗘挸绠伴柛婵勫劤閻棗顭块懜闈涘闁绘挻绋撻埀顒€绠嶉崕杈殽閹间胶宓佹俊銈呮噺閻撴洟鎮楅敐搴濇喚闁稿孩妫冮弻鐔碱敊缁涘鐤侀悗瑙勬礈閸忔﹢銆佸鈧幃娆撳箛閳轰礁濮﹂梺鍝勭焿缂嶄焦淇婇崼鏇炵＜婵﹩鍋勯ˉ姘舵⒒閸屾艾鈧悂宕愭搴ｇ焼濞撴埃鍋撴鐐差樀閺佹捇鎮╅懠顒夋Ф婵＄偑鍊栫敮鎺斺偓姘煎墰缁牏鈧綆鍋佹禍婊堟煙閺夎法浠涚紒鑸垫皑缁辨帗娼忛埡浣圭€剧紓浣虹帛缁诲牓骞冩禒瀣棃婵炴潙澧庨崑銈夊蓟濞戙垹惟鐟滃秶鏁崼鏇熺厓缂備焦蓱閻撱儵鏌嶉挊澶樻Ц妞ゎ偅绻冨蹇涘煛閸愩劌鑴梻鍌氬€风粈渚€骞栭銈嗗仏妞ゆ劧绠戠壕鍧楁⒑椤掆偓缁夌敻宕愰崸妤佺厱妞ゎ厽鍨垫禍鏍瑰鍕煉闁哄瞼鍠栧畷顐﹀礋椤撳鍊栭妵鍕晜閼测晝鏆ら梺鍝勭焿缂嶁偓缂佺姵鐩俊鐤槾鐞氾箓姊绘担绛嬪殐闁哥姵顨婇妴鍐╃節閸嬭姤鐩畷姗€濡搁姀鈽嗘綌婵犵數鍋涘Λ娆撳礉閺嶎偀鍋撳顒傦紞缂佽鲸鎹囧畷鎺戔枎閹搭厽袦闂備胶顭堥敃銈夊箺濠婂懎鍨濋柡鍐ㄦ储娴滃綊鏌熼悜妯虹仼闁伙絽鎼埞鎴︽偐鐠囇冧紣闂佸憡纰嶉敃銏ゅ箖閵忋倖鍊绘俊顖濇〃缁囨⒒娴ｅ搫浠洪柛搴ㄤ憾瀹曨垳鎹勯妸锔诲仺閻熸粍鏌ㄩ～蹇旂節濮橆剛锛滃┑鐐叉閸ㄥ灚淇婃禒瀣拺婵炶尪顔婄花鑽ょ磽瀹ュ拑宸ラ柣锝呭槻閳规垿宕卞▎鎰暦闂備線鈧偛鑻晶鎾煕閳规儳浜炬俊鐐€栫敮濠勭矆娓氣偓瀹曠敻顢楅崟顒傚幈濠电偛妫楃换鎰板汲閿濆洠鍋撶憴鍕婵＄偘绮欏畷娲焵椤掍降浜滈柟鍝勭Ч濡惧嘲霉濠婂嫮鐭掗柡宀€鍠栭幃婊兾熼搹鐟板Ъ婵犵鍓濋悡锟犓夐幘鑸殿潟闁圭儤顨呮儫閻熸粌绻掗弫顔尖槈閵忥紕鍘梺鎼炲劀閸愬彞绱旈梻浣虹《閺呮繈宕戦妶澶堚偓浣割潨閳ь剟骞冨▎鎴斿亾濞戞鎴﹀磹閻戣姤鈷掑ù锝呮啞閸熺偤鏌涢妸顭戞綈闁逛究鍔戦幃浠嬪垂椤愩垹绨ユ繝鐢靛█濞佳兠洪妸褍濮柍褜鍓熷铏圭矙閹稿孩鎷辩紒鐐緲缁夋挳鍩㈤幘璇℃Ъ缂備胶绮粙鎾诲焵椤掍胶鈯曟い顓炴喘閹矂宕卞☉娆戝幈濠德板€愰崑鎾绘煕閻旈攱鍋ユい銏″哺閺佹劖寰勬繝鍥ф暪闂備礁鎼ú銊╁磻閻旂厧鍌ㄩ柟闂寸劍閳锋垹绱掔€ｎ偄顕滄繝鈧幍顔剧＜妞ゆ柨銈搁崣鍕煟濞戝崬娅嶆鐐达耿瀹曟粍鎷呴悮瀵搁棷婵犵數鍋犻幓顏嗗緤閼测晛鍨濇繛鍡樻尭娴肩娀鏌ц箛鎾磋础缁炬儳銈搁幃褰掑炊椤忓嫮姣㈡繝鈷€宥囩暤闁哄矉绲介埥澶愬础閻愬浜鹃梻渚€鈧偛鑻晶鍓х磽瀹ュ懏顥㈢€规洑鍗冲浠嬵敃閵堝嫮鐟濋梻浣瑰缁诲倸螞濞戞艾濮柍褜鍓氱换婵嬫偨闂堟刀銏ゆ煕婵犲倻绉虹€规洘濞婇幊鐐哄Ψ閵堝洨鐣鹃梻浣告贡缁垳鏁悙鐢典笉闁肩⒈鍓涚壕鑲╃磽娴ｈ鐒芥繛鎻掔摠椤ㄣ儵鎮欏顔煎壎闂佽鍠楅悷鈺侇嚕閸洖绠ｉ柣娆屽亾闁哄棴绱曠槐鎾诲磼濮橆兘鍋撴搴ｇ焼濞撴埃鍋撻挊婵囥亜閺嶎偄浠﹂柛瀣槸閳规垿宕掑☉娆忎哗闂侀€炲苯鍘哥紒鈧笟鈧敐鐐差煥閸繄鍔﹀銈嗗笒鐎氼喖鐣垫笟鈧弻鈥愁吋閸愩劌顬夋繝娈垮灡閹告娊骞冨畡鎵虫瀻闊洦鎼╂禒鎯ь渻?
            if (this.target != null) {
                double maxRange = this.turret.getAttackRange();
                if (this.target.distanceToSqr(this.turret) > maxRange * maxRange) {
                    return false; // 闂傚倸鍊搁崐鎼佸磹閻戣姤鍤勯柛顐ｆ礀绾惧潡鏌ｉ姀銏╃劸缂佲偓閸喓绡€闂傚牊绋撴晶娑㈡煛閸℃鐭掗柡宀€鍠栭幃婊冾潨閸℃鏆ョ紓鍌欒兌婵攱绻涢埀顒侇殽閻愬澧懣鎰亜閹哄棗浜炬繝纰樷偓鐐藉仮闁哄本绋戦～婵嬪箛娴ｅ湱绉烽梻渚€娼уú銈団偓姘嵆閻涱喖螣閸忕厧纾梺鐑╂櫆鐢亞鎹㈠┑瀣摕闁挎繂顦粻鎶芥煙閹碱厼鐏ラ柛姘煎亰濮婃椽宕崟顒佹嫳闂佺儵鏅╅崹浼搭敋閿濆绠绘い鏂挎閳哄懏鐓忓璺虹墕閸斻倖銇勯弬鎸庡枠婵﹦绮幏鍛村川婵犲啫鍓甸梺鑽ゅ仦閸戝綊宕戞繝鍌滄殾闁归偊鍏橀弨浠嬫倵閿濆簼娴烽柟鑺ユ礋濮婃椽妫冨☉杈╁姼闂佺瀵掗崰鏍у祫闂佸壊鍋嗛崰宥囨崲閸℃ǜ浜滈柡宥冨妿閹冲棙銇勯幒鏂挎瀾缂佺粯鐩畷濂割敃閵忕姷顔掔紓鍌欐祰妞存悂骞愭繝姘闁告侗鍨辩€氭岸鏌嶉埡浣告殶闁哄棎鍎叉穱濠囨倷椤忓嫧鍋撹濮婁粙宕熼鍌滃骄闂佺硶鍓濋悷銉╁垂濠靛鍊甸柨婵嗙凹閹查箖鏌涘顒夊剰妞ゎ叀娉曢幑鍕偖绾惧鎯堥梻浣告憸閸嬬姴鈻斿☉銏犵厴闁硅揪闄勯崑鎰磽娴ｈ偂鎴︽煥椤撶偐鏀介柍钘夋娴滄繈鏌ｉ埡濠傜仴婵☆偆鍠栭幃宄邦煥閸曨剛鍙嗗?
                }
            }

            return this.canAttack(this.target, net.minecraft.world.entity.ai.targeting.TargetingConditions.DEFAULT);
        }

        @Override
        public void start() {
            this.mob.setTarget(this.target);
            Player owner = this.turret.level().getPlayerByUUID(this.turret.ownerUUID);
            if (owner != null) {
                this.timestamp = owner.getLastHurtMobTimestamp();
            }
            super.start();
        }

        @Override
        protected boolean canAttack(@Nullable LivingEntity target, net.minecraft.world.entity.ai.targeting.TargetingConditions targetPredicate) {
            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰级閻ゅ嫬鈹戞幊閸娧呭緤娴犲鐤い鎰╁€愰崑鎾愁潩椤掑效闂侀潧娲ょ€氫即鐛幒妤€绠ｆ繝鍨姃閻ヮ亪姊绘担渚劸妞ゆ垵鎳橀、鏍ㄥ緞婵犲孩缍庡┑鐐叉▕娴滃爼寮崱娑欑厓鐟滄粓宕滃☉姘灊闁哄啫鐗婇崑銊х磼鐎ｎ厽纭堕柨娑氬枛閹鐛崹顔煎濡炪倧缂氶崡鎶藉箖閿熺姴鍗抽柕蹇ョ磿閸樻悂姊洪幖鐐插姌闁稿氦椴告穱濠囨偂楠炵喓鎳撻…銊╁礋椤撶姷鍘滈梻浣告惈閺堫剟鎯勯鐐靛祦閻庯綆鍠楅崑鎰箾閺夋埈鍎愰柣搴濆嵆濮婄粯鎷呴崨濠冨創闂佸搫鐗滈崜鐔煎箚閸曨垼鏁嶉柣鎰版涧缁侊箓姊洪幖鐐插姶闁告搫绠撳顐﹀炊椤掍胶鍘藉┑顔筋殔濡绂嶅鍕╀簻妞ゆ劑鍨婚悞鍛婃叏婵犲倹鎯堥弫鍫ユ煕閵夋垵鎳庢慨鍫曟⒒娴ｈ鍋犻柛鏃€鍨剁粋宥夊醇閺囩姴绁﹂梺纭呮彧缁犳垿鎮欐繝鍕枑婵犲﹤鍠氶悞浠嬫煛瀹ュ海浜圭憸鐗堝笚閸嬫劗鈧懓澹婇崰鏍礈娴煎瓨鐓曢柕澶堝劤閹界姷绱掔紒妯肩疄濠殿喒鍋撻梺鎸庣箓濡盯濡撮幇顑芥斀闁宠棄妫楁禍婵囥亜閵娿儲顥犵紒顔碱儏椤撳ジ宕遍幇顑跨凹闂備礁鎲￠崝蹇涘疾濠靛鍌ㄩ柟闂寸劍閳锋垿鏌涘☉姗堟敾濠㈣泛瀚伴弻娑氣偓锝庝簼椤ョ姷绱掗纰辩吋妤犵偛閰ｉ幊鐐哄Ψ閵夈倗绱?
            if (target == null) return false;
            if (target instanceof Player && target.getUUID().equals(this.turret.ownerUUID)) return false;
            if (target instanceof SkeletonTurret) return false;
            if (target instanceof IronGolem) return false;
            if (target.getPersistentData().getBoolean("IsFriendlyZombie")) return false;
            if (target.getPersistentData().getBoolean("IsFriendlyCreeper")) return false;

            return super.canAttack(target, targetPredicate);
        }
    }
    // ==========================================
// ==========================================
    // 闂?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧潡鏌熺€电孝缂佽翰鍊濋弻锕€螣娓氼垱锛嗛悷婊呭鐢帞澹曟總鍛婄厽闁归偊鍨伴惃娲煟濞戞牕鍔︽慨濠冩そ瀹曨偊宕熼娑欑€遍梻浣告啞钃辨俊顐㈠暙閻ｇ兘宕奸弴銊︽櫌闂侀€炲苯澧撮柟閿嬪灴閹垽宕楅懖鈺佸妇濠电姰鍨奸崺鏍儎椤栨凹鐎舵い鏃傛櫕缁犻箖鏌涘☉鍗炴灓濠⒀屼邯閺屽秶鎲撮崟顐や紝濡炪們鍨洪悷鈺侇嚕椤掑嫬围闁告洦鍙€缁绘垿姊婚崒娆戭槮闁硅绻濋弫瀣⒑闂堟稓澧涢柟顔煎€块悰顕€宕橀鐣屽弳闁诲函缍嗛崑鍕礉閸涘瓨鈷戦梻鍫熶緱閻擃厼鈹戦垾铏枠鐎规洏鍨洪妶锝夊礃閳圭偓瀚奸梻浣侯焾缁绘ê螞閸ф鍤嬫い蹇撶墛閻撴洟骞栫划鍏夊亾鐎圭姴鐓橀梻鍌氭搐椤︿即濡甸崟顖氬嵆婵°倐鍋撳ù婊堢畺濮婃椽宕崟顔碱伃缂備礁顦遍崗妯肩槵婵炴挻鍩冮崑鎾绘煛鐏炲墽娲存鐐搭焽婢规洜鈧綆浜跺Λ鐔兼⒑閸涘娈滃ù婊冪埣瀵鎮㈤崗鐓庘偓缁樹繆椤栨粌鍔﹂柟椋庢嚀椤?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲梺姹囧€ら崰鏍箒闂佺绻愰崥瀣礊閹寸姷纾奸柟閭﹀弾濞堟粓鏌＄仦绯曞亾閹颁礁鎮戦柟鑲╄ˉ閳ь剙纾鎰節濞堝灝鏋︽い顐㈩樀閹繝鍨鹃幇浣告闂佸壊鍋呭ú鏍煁閸ャ劎绠鹃柟瀵镐紳椤忓牃鈧牜鈧綆鍠楅埛鎴犫偓瑙勬礀濞层劎鏁☉娆愬弿濠电姴鍋嗛悡濂告煕閳规儳浜炬俊鐐€栧濠氬磻閹惧墎纾奸柣妯垮皺鏁堥悗瑙勬礃濞茬喖寮婚崱妤婂悑闁告侗鍨抽弸鍐⒑閻熸澘鎮戦柣锝庝邯瀹曟劙濡舵径濠勯獓?+ 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墴閹潡顢氶埀顒勫蓟閿濆憘鏃堝焵椤掑嫭鍋嬮煫鍥ㄦ礈娑撳秴螖閿濆懎鏆為柣鎾冲暟閹茬顭ㄩ崼婵堫槶濠殿喗锕╅崢楣冨煘瀹ュ應鏀介柣妯哄级閹兼劗绱掗悩宕囧弨闁哄瞼鍠栭弻鍥晝閳ь剙顕ｉ幆顬″綊鎮╅锝嗙彋濠殿喖锕ュ钘夌暦閻戠瓔鏁囬柣鏃堟敱閻ｎ剟姊虹拠鎻掝劉闁告垵缍婂畷婊堟偄閻撳孩妲梺缁樺姇閹碱偆绮婚敐澶嬬叆闁哄洦顨呮禍楣冩⒒娴ｇ鑸规繛璇х畵婵＄敻宕熼姘辩杸闂佸疇妗ㄧ拋鏌ュ磻閹捐绠涢柡澶庢硶閿?
    // ==========================================
    static class TurretScavengeGoal extends Goal {
        private final SkeletonTurret turret;
        private final double speed;
        private Entity targetItem;

        public TurretScavengeGoal(SkeletonTurret turret, double speed) {
            this.turret = turret;
            this.speed = speed;
            this.setFlags(EnumSet.of(Flag.MOVE));
        }

        @Override
        public boolean canUse() {
            // 1. 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼妽闁稿繑绮撻弻娑㈩敃閿濆棛顦ラ梺姹囧€濈粻鏍蓟閿濆绠涙い鎾跺О閸嬬偤姊洪崫鍕靛剰缂佸缍婂濠氬Ω閵夈垺鏂€闂佺硶妾ч弲婊嗗€撮梻鍌欑窔閳ь剛鍋涢懟顖炲储閸濄儳纾奸柤闀愮祷婢规﹢鏌ｉ敐鍥у幋濠碘剝鎮傞崺鈩冪節閸愨晜鐝濋梻鍌欑劍閹爼宕曢鐐茬閹肩补鍩楀ú顏勭妞ゆ梻鏅崢閬嶆⒑鐎圭媭娼愰柛搴ゆ珪缁傚秹鎮欓璺ㄧ畾闂佺粯鍔︽禍婊堝焵椤掍胶澧遍柡渚囧櫍楠炴帡寮崫鍕濠殿喗顭囬崢褍顕ｉ閿亾?
            if (!turret.isFollowing()) return false;
            if (turret.getTarget() != null) return false; // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫆闁芥ê顦純鏇㈡⒒娴ｈ櫣銆婇柛鎾寸箞閹藉倻鈧綆鍠栭悙濠囨煏婵炲灝鍔撮柛銈冨€濆娲传閸曞灚效闂佹悶鍔岀紞濠傜暦濠靛鏅濋柍褜鍓熼垾鏃堝礃椤斿槈褔鏌涢埄鍐炬畼闁荤喆鍔岄—鍐Χ韫囨挾妲ｉ梺鍝ュУ瀹€鎼佸箠閻愬瓨缍囬柕濞у懐妲囨繝娈垮枟閿曗晠宕㈡ィ鍐ㄥ偍闁告鍋愰弨浠嬫煃閽樺顥滈柣蹇嬪劤閳ь剝顫夊ú鐔奉焽瑜忛崣鍛存煟鎼淬垻鈯曢柨鏇楁櫅閳绘挻绂掔€ｎ偆鍘介梺褰掑亰閸ㄤ即鎯冨ú顏勬瀬闁割偅鎯婇弮鍫熷亹闂傚牊绋愬▽顏堟⒑閼姐倕鏆遍柡鍛洴閹箖鎮滈懞銉ヤ簻缂佺偓濯芥ご鎼佸疾閵忋倖鈷戦梺顐ゅ仜閼活垱鏅剁€涙ǜ浜?

            boolean isCaptain = turret.isCaptain();
            boolean isCommandMode = turret.isCommandScavenging();

            // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁逞屽墾缁犳挸鐣锋總绋款潊闁炽儱鍟跨花銉╂⒒娴ｇ儤鍤€妞ゆ洦鍙冨畷鎴︽偄閾忛€涚瑝闂佽鍨庨埀顒勫绩娴犲鐓熸俊顖氭惈缁狙囨煙閸忕厧濮嶉柡宀嬬磿閳ь剨绲洪弲婵嬪礉瀹ュ鐓忛柛銉戝喚浼冨Δ鐘靛仦椤洭骞戦崟顖涘€绘俊顖炴？缁ㄦ挳姊婚崒娆戭槮缁剧虎鍙冮獮濠囧箻閸撲胶鐓嬮梺姹囧灮椤牊顢婇梻浣告啞濞诧箓宕归幍顔惧暗鐎广儱顦伴悡鏇㈡煏婢舵ê鏋ゅù鐘灲閺岀喖宕滆鐢盯鏌?1闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弮鍫熸殰闁稿鎸剧划顓炩槈濡娅ч梺娲诲幗閻熲晠寮婚悢鍏煎€绘慨妤€妫欓悾鐑芥⒑閹肩偛鈧洟鎳熼婵堜簷闂備焦瀵х换鍌炲箠鎼淬劌姹查柡鍐ㄧ墛閻撳啰鎲稿鍫濈婵炲棙鎸哥粻鐘绘煙閹冩闁搞儺鍓欓幑鑸点亜閹惧鈽夊ù婊呭亾缁绘盯宕煎┑鍫滆檸闂佸搫顑冮崐鏍Φ閸曨垼鏁囬柣鎰版涧閳敻姊洪悙钘夊姷缂佺姵鎸绘穱濠囧箹娴ｅ摜鍘告繛杈剧导鐠€锕€危鐟欏嫪绻嗛柣鎰典簻閳ь剚鐗犲畷娲醇閵夈儳锛涢梺瑙勫劤婢у孩绋夊澶嬬厵闁绘劦鍓欐晶顖涚箾閸忚偐澧柍瑙勫灴閹晝鈧湱濮撮ˉ婵堢磽娴ｆ彃浜鹃梺鍛婂姀閺傚倹绂嶅鍫㈠彄闁搞儯鍔嶇亸顓熴亜韫囷絼閭柡宀嬬秬缁犳盯骞樼捄琛″徍婵犳鍠栭敃銉ヮ渻閽樺鏆︽い鎰剁畱缁€瀣亜閹烘埈妲归柨娑樻閳规垿鎮欓懠顒佹喖缂備緡鍠栭惌鍌炲箖閵夆晜鍋傞幖鎼枛濞堛劌顪冮妶鍡楀闁糕晛瀚板畷銉р偓锝庡枟閻撴洟鏌曟径妯虹仸婵＄虎鍣ｉ弻娑㈠即閻愬弶娈诲┑顔硷攻濡炶棄鐣峰Δ鍛殐闁崇懓鐏濇禒锕傛⒒娴ｅ憡鎯堥柟鍐茬箳閹广垽宕奸妷褍绁︽繝鐢靛Т閸嬪棝宕ョ€ｎ喗鐓曢柍鈺佸暟閹冲懘鏌ｉ敃鈧悧鎾愁潖濞差亝顥堟繛鎴欏灮瀹曨亞绱撴担鐟扮祷濠⒀嗘閳藉宕归鐘蹭簼闂佸憡鍔忛弲娑㈠焵椤掆偓閻忔岸骞堥妸銉建闁逞屽墮铻為悹鎭掑姀婵啿霉閻樺樊鍎愰柣鎾跺У缁绘稑顔忛鑽よ兒闂佺灏欓崑鎾诲Φ閸曨垰顫呴柍钘夋閻や線鎮楃憴鍕闁哥姵鐗犻妴渚€寮撮姀鐘栄囧箹缁懓澧查柡鍡╀邯濮婂宕掑顑藉亾閻戣姤鍊块柨鏇炲€哥粻鏍煕椤愶絾绀€缁炬儳鐏濋埞鎴︽偐瀹曞浂鏆￠梺鎶芥敱濡啴寮诲☉銏犲嵆闁靛鍎遍～顏堟⒑閸涘﹦鎳冪紒缁橈耿瀵寮撮敍鍕澑婵犵數鍋為崕铏妤ｅ啯鐓犵痪鏉垮船婢т即鏌ｉ敐鍥т壕濞ｅ洤锕幃娆擃敂閸曘劌浜鹃柡宥庡幗閸嬪淇婇妶鍛櫣濡楀懎鈹戦悙鏉戠仧闁搞劌婀辨竟鏇熺節濮橆厾鍘甸梺璇″瀻閸滃啰绀婇梻浣告惈濡绮婚幘璇茶摕婵炴垯鍨瑰敮闂侀潧绻嗛崜婵嬫偟閿曞倹鈷戦悶娑掆偓鍏呭?-> 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲梺姹囧€ら崰鏍箒闂佺绻愰崥瀣礊閹寸姷纾奸柟閭﹀弾濞堟粓鏌＄仦绯曞亾閹颁礁鎮戦柟鑲╄ˉ閳ь剙纾鎰節濞堝灝鏋︽い顐㈩樀閹繝鍨鹃幇浣圭稁濠电偛妯婃禍鍫曞极閸℃稒鐓冪憸婊堝礈濞戞艾鍨濋柡鍐ㄥ€甸崑鎾绘濞戞瑦鍠愰柣蹇撶箳閺佹悂鍩€椤掆偓缁犲秹宕曢柆宓ュ洦瀵肩€涙ê浜楅梺缁樻閺呰尙鎹㈤崱妯镐簻闁哄秲鍔庨惌銈夋煛閳ь剟鎮ч崼娑楃盎闂佸湱鍎ら弻銊╁几閹寸姷纾肩紓浣诡焽濞插鈧娲橀〃濠囧箖閳╁啯鍎熼柕蹇ョ悼濡俱劑姊婚崒娆戭槮闁圭⒈鍋婇幆澶嬬附缁嬭法鐛ラ梺瑙勫礃濞夋盯宕瑰┑鍥╃闁糕剝蓱鐏忣厾绱掗悩鍗炲祮妤犵偞鐗楀蹇涘礈瑜庨崑褔姊洪崨濠忎緵闁告挾鍠庨～蹇曠磼濡顎撴繛鎾村嚬閸ㄩ亶寮婊呯＝闁稿本姘ㄦ晶鏃堟煕濡も偓閸熷潡鎮鹃悜钘夌疀妞ゆ垼濮ら弬鈧梺璇插嚱缂嶅棙绂嶅┑瀣€垫い鎺戝閸婂灚顨ラ悙鑼虎闁告梹纰嶇换娑氭嫚瑜忛崚浼存煃鐠佸磭鐭欐い銏℃瀹曞ジ鎮㈤崫鍕濠电姷鏁搁崑鐐差焽濞嗘搩鏁勯柛鈩冦仜閺嬪秹鏌涢妷顔煎闁绘挻鐟╅弻鐔虹磼濡櫣顑傜紓浣割槺閸庛倝骞堥妸锔剧瘈闁告劏鏂傛禒銏ゆ倵鐟欏嫭纾搁柛鏂跨Ф閹广垹鈹戠€ｎ亞顦ㄩ梺缁樺姦閸擄箑螞濞嗘挻鈷掗柛灞剧懆閸忓瞼绱掗鍛仸妤犵偞鍔欓獮鏍ㄦ媴閳ь剟宕堕鈧涵鈧梺?
            // 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫鍐煥閺囨浜鹃梺姹囧€楅崑鎾舵崲濠靛洨绡€闁稿本绮岄·鈧梻浣侯焾椤戞垹鎹㈠┑瀣摕闁靛ň鏅涢崡鎶芥煟閹邦厾銈撮柛瀣崄閵囨劙骞掗幋鐙呯幢闂佽鍑界紞鍡涘窗濡ゅ懎鐓曢柟瀵稿亼娴滄粓鏌熼崫鍕棞濞存粌澧界槐鎾存媴閸撳弶楔闂佽桨绀侀…宄扮暦閸濆嫧妲堥柕蹇曞Х椤旀帞绱撻崒娆戝妽妞ゎ厼娲畷銏＄鐎ｎ偀鎷洪梺鍛婄箓鐎氼剟鍩€椤掍焦鍊愰柟顔矫埞鎴犫偓锝庝簽閻ｆ椽姊洪悷閭﹀殶闁稿鍋ゅ畷锝堢疀濞戞瑧鍙嗗┑鐘绘涧濡瑩藟濠婂啠鏀芥い鏃囧亹鏁堥梺鍝勭灱閸犳牠銆佸▎鎴犻┏閻庯綆鍓欐慨鑲╃磽閸屾瑨鍏屽┑顔炬暬閹嫰顢涢悙闈涚ウ濠碘槅鍨靛▍锝夊汲閿曞倹鐓曢柕澶堝灪閺嗘洘绻濇繝鍌涘櫧缁惧彞绮欓弻娑氫沪閸撗勫櫘濡炪倧璁ｆ俊鍥箟閹间礁绾ф繛鍡欏亾閳诲牓鎮楃憴鍕┛缂佺粯绻堥悰顔芥償閵婏箑鐧勬繝銏ｆ硾椤戝洭鍩€?FollowGoal 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ帒锕︾粙蹇旂節閵忥絾纭炬い鎴濇喘閵嗗懘骞撻幑妤€缍婇幃鈺侇啅椤旂厧澹堢紓浣哄亾閸庡啿顭囬敓鐘茶摕闁绘梻鍘х粈鍫澝归敐鍥у妺闁瑰弶锕㈠鐑樻姜閹殿噮妲┑鐐叉▕閸欏啫顕ｆ繝姘亜闁稿繐鐨烽幏濠氭煟鎼达絾鏆╂い顓炵墛娣囧﹥绂掔€ｎ偀鎷洪梺鍛婄箓鐎氼厽鍒婃總鍛婄厱闁规崘娉涢弸娑欘殽閻愭彃鏆欐い顐ｇ矒閸┾偓妞ゆ帒瀚粻鏍ㄧ箾閸℃ê鐏︾€规洖顦靛鍫曟倷闂堟侗鏆梺娲诲亜缁绘垶绌辨繝鍥ㄥ€锋い蹇撳閸嬫捇寮借濞兼牜鎲搁悧鍫濈瑨缂佲偓婢舵劖鐓涢柛銉ｅ劚閻忊晠鏌ｉ幘顖楀亾閹颁胶鍞甸梺鍏兼倐濞佳勬叏閸モ晝纾兼い鎰╁灮鏁堥梺鍝勮嫰缁夌兘篓娓氣偓閺屾盯骞樼捄鐑樼亪濡ょ姷鍋涢崯鎶剿囬崣澶堜簻妞ゆ挻绮屾慨鍌溾偓瑙勬礈閸樠囧煘閹达箑鐐婃い蹇撴瑜板倿姊婚崒姘偓椋庢濮樿泛鐒垫い鎺戝€告禒婊堟煠濞茶鐏￠柡鍛埣楠炴﹢顢欓悾灞藉箰闂佽绻掗崑娑欐櫠閽樺娲箻椤旂晫鍘告繛杈剧悼椤牓鍩€椤掆偓閻忔繈鎮鹃悜绛嬫晝闁挎洍鍋撶紒鈧€ｎ偁浜滈柟浼存涧娴滅偤鏌嶈閸撶喐绂嶇捄渚綎闁惧繗顫夌€氭岸鏌＄仦璇插姎鐎殿喗婢橀埞鎴︽倷閺夊灝鐨熼梺鎼炲劀閸愵亜缍佸┑锛勫亼閸婃牜鏁幒妤€纾瑰┑鐘崇閸庢顭跨捄鍝勵槵闁稿鎹囬悰顕€宕归鐓庮潛婵犵妲呴崑鍕煀閿濆懐鏆﹂柟瀵稿仧缁♀偓闂佹悶鍎崝搴ㄥ储闁秵鍋℃繝濠傚暣閸欏嫰鏌曢崱妤€鏆ｇ€规洖銈告俊鐑藉Ψ瑜忛崢顒勬⒒娴ｇ瓔娼愬鐟版閺呰泛螖閸涱厾鍘?
            if (isCaptain && isCommandMode) return false;

            // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁逞屽墾缁犳挸鐣锋總绋款潊闁炽儱鍟跨花銉╂⒒娴ｇ儤鍤€妞ゆ洦鍙冨畷鎴︽偄閾忛€涚瑝闂佽鍨庨埀顒勫绩娴犲鐓熸俊顖氭惈缁狙囨煙閸忕厧濮嶉柡宀嬬磿閳ь剨绲洪弲婵嬪礉瀹ュ鐓忛柛銉戝喚浼冨Δ鐘靛仦椤洭骞戦崟顖涘€绘俊顖炴？缁ㄦ挳姊婚崒娆戭槮缁剧虎鍙冮獮濠囧箻閸撲胶鐓嬮梺姹囧灮椤牊顢婇梻浣告啞濞诧箓宕归幍顔惧暗鐎广儱顦伴悡鏇㈡煏婢舵ê鏋ゅù鐘灲閺岀喖宕滆鐢盯鏌?2闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弮鍫熸殰闁稿鎸剧划顓炩槈濡娅ч梺娲诲幗閻熲晠寮婚悢鍏煎€绘俊顖濐嚙閺嗘姊哄畷鍥ㄥ殌缂佸鏁搁幑銏犫槈濮楀棗鏅犲銈嗘⒒缁垶宕板鑸碘拺閺夌偞澹嗛ˇ锕傛煥閺囥劋閭€殿喖顭烽弫鎾绘偐閼碱剙鈧偤姊虹€圭姵銆冪紒鎻掔仢閳藉濮€閿涘嫬骞堥梺璇插嚱缂嶅棝宕戦崨顖欑剨闁汇垹鎲￠悡娆撴煕濞嗗浚妲归悘蹇ュ閳ь剝顫夊ú婊堝窗閺嶎厹鈧線寮崼婵堫槰濡炪値鍘介崹鍨繆閻戣姤鈷掗柛灞剧懄缁佺増銇勯弴鍡楀濞堜粙鏌熼梻瀵稿妽闁稿﹨鍩栭幈銊ノ熼崹顔惧帿闂佺顑呴澶愬蓟閿濆憘鐔封枎閹勵唲闂?
            double searchRange = 10.0; // 婵犵數濮烽弫鍛婃叏閻㈠壊鏁婇柡宥庡幖缁愭淇婇妶鍛殲闁哄棙绮嶆穱濠囧Χ閸涱厽娈堕梺娲诲幗閻熲晠寮婚悢鍏煎€绘俊顖炴櫜缁爼姊洪柅鐐茶嫰婢у墽绱掗悩铏碍闁伙綁鏀辩缓鐣岀矙鐠囦勘鍔嶉妵鍕籍閸ヮ灝鎾寸箾閸涱厾孝闁宠鍨块幃鈺呭垂椤愶絾鐦庡┑鐘愁問閸犳岸寮繝姘疇婵犻潧娲㈤崑鍛存煕閹般劍娅呭ù鐘荤畺濮婅櫣绱掑Ο鍝勑曢梺绋跨箲閻燂妇绮嬪鍜佺叆闁割偆鍠撻崢鎼佹⒑閹肩偛鍔撮柣鎾崇墕閳绘捇寮Λ鐢垫嚀椤劑宕奸姀銏℃瘒婵犳鍠栭敃銉ヮ渻娴犲钃熼柛娑樼摠閸婄兘鏌ら懝鐗堢【妞ゅ浚鍘界换婵嬪煕閳ь剛浠﹂悾灞煎寲闂備焦鐪归崕鐑樼椤忓嫷鍤曢柛鎾茬劍瀹曞鏌曟繝鍐ㄥ闁稿﹥绻堝璇差吋閸偅顎囬梻浣告啞閹稿爼宕濇惔鈽嗗殫濠电姴浼呭ú顏嶆晜闁告洦鍙忕槐閬嶆⒒娴ｇ儤鍤€濠⒀呮櫕閸掓帡顢涢悙鑼幈?(闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ巻鍋撶痪鎯ь煼閺岀喖鎮ч崼鐔哄嚒闂佺琚崝搴ㄥ箟閹间礁妫橀悹鎭掑妽濞堟儳顪冮妶鍡欏⒈闁稿孩鍔欏顐﹀礃椤旂晫鍘撻梻浣哥仢椤戝洭銆傞崣澶夌箚闁绘劘鍩栭ˉ澶愭煟閿濆妫戠紒顔界懅閹风娀鎮欓浣叉嫻闂佺懓鍢查幊鎰板箟閹绢喖绀嬮柛蹇撴啞閸?

            if (isCommandMode && !isCaptain) {
                // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯锋嫼閻熸粎澧楃敮鎺撶娴煎瓨鐓曢柟鎯ь嚟閹冲啯銇勯弴顏嗗埌闁伙綇绻濋弻鍥晜閽樺妲ｉ梻鍌欑窔濞佳囨偋閸℃あ娑樷槈濞嗘劖鐝烽梻渚囧墮缁夌敻鎮￠弴銏″€甸柨婵嗛婢ь喖霉閻橆偅娅嗛柕鍥у婵″爼宕ㄩ娑樹壕闁割煈鍣鏍磽娴ｈ偂鎴炲垔閹绢喗鐓曟繛鎴烇公瀹搞儵鏌￠崱妤冨ⅱ缂佽鲸鎸婚幏鍛村礈閹绘帒澹夐梺姹囧焺閸ㄦ娊宕伴弽顓犲祦婵°倕鎷嬮弫鍐煥閺冨泦鎺楀箯濞差亝鐓涘璺鸿嫰娴狅箑顭块悷鐗堫棦閽樻繈鏌ㄩ弬鍨挃缁惧墽鏅埀顒€绠嶉崕閬嶅箯閹存繍鍟呴柕澶嗘櫆閻撶喖鏌ㄥ┑鍡樺櫣婵¤尙绮妵鍕敃閿濆洨鐤勯梺纭呮珪缁挸螞閸愩劉妲堟俊銈呭暟缁夊潡姊婚崒姘偓椋庣矆娴ｅ湱鐝跺┑鐘叉搐绾惧鏌涘☉鍗炵仭鐎规洘鐓￠弻娑㈠即閵娿儮鍋撻悩缁樺亜闁绘挸娴烽ˇ鏉款渻閵堝棛澧紒瀣墦楠?-> 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ巻鍋撶痪鎯ь煼閺岀喖鎮ч崼鐔哄嚒闂佺琚崝搴ㄥ箟閹间礁妫橀悹鎭掑妽濞堟儳顪冮妶鍡欏⒈闁稿孩鍔欏顐﹀礃椤旂晫鍘撻梻浣哥仢椤戝洭銆傞崣澶夌箚闁绘劘鍩栭ˉ澶愭煟閿濆妫戠紒顔界懅閹风娀鎮欓渚囨闂佺硶鏂侀崑鎾愁渻閵堝棗绗掗悗姘煎墰缁牓宕熼娑氬幗濠碘槅鍨遍娆忣潖鐠恒劍鍠愰柣妤€鐗嗙粭姘舵煛閸涱喚鍙€闁哄本鐩崺鍕礂閻欌偓娴滄繄绮嬮幒妤€鐓涢柛灞剧矌椤?(100闂?
                searchRange = 100.0;
            }

            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缂佺姷濞€閺岀喖骞戦幇闈涙闁荤喐鐟辩粻鎾诲箖濡ゅ懏鏅查幖绮光偓鎰佹交闂備焦鎮堕崝宥囨崲閸儳宓侀柡宥庣仈鎼搭煈鏁嗛柍褜鍓氭穱濠囨嚃閳哄啯锛忛梺璇″瀻娴ｉ晲鍒掗梻浣告惈閺堫剙煤濡吋宕叉繛鎴欏灪閸婇攱銇勯幒宥堝厡鐟滄澘妫濆缁樻媴娓氼垳鍔稿銈嗗灥閹虫﹢銆侀弽銊ョ窞闁归偊鍓濋幗鏇㈡倵楠炲灝鍔氭俊顐ｇ懄閹便劌顭ㄩ崼鐔哄幍濠电偛鐗嗛悘婵嬪几濞戞ǚ鏀介柍銉ㄥ皺閻瑦鎱?
            List<Entity> loot = turret.level().getEntities(turret, turret.getBoundingBox().inflate(searchRange), e -> {
                if (e instanceof net.minecraft.world.entity.item.ItemEntity ie) return ie.getItem().isEdible();
                if (e instanceof net.minecraft.world.entity.ExperienceOrb) return true;
                return false;
            });

            if (loot.isEmpty()) return false;

            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗霉閿濆浜ら柤鏉挎健濮婃椽顢楅埀顒傜矓閹绢喖鍑犲〒姘ｅ亾闁哄瞼鍠栧鑽も偓闈涘濡差喚绱掗悙顒€鍔ゆい顓犲厴瀵鎮㈤悡搴ｎ槶閻熸粌绉电粋鎺懨洪鍛帗閻熸粍绮撳畷婊冾潩鏉堛劍娈伴梺璺ㄥ枔婵绮婚悩宕囩瘈濠电姴鍊绘晶鏇㈡煕閵娿儱鈧綊濡甸崟顖氱疀闁靛鍎遍埛澶愭⒑閸濄儱浠滄い锕傛涧椤繒绱掑Ο璇差€撻梺缁樺灦閿氭繛鍫濊嫰椤啴濡堕崱妯侯槱闂佸憡眉缁瑩鐛崼銉ノ╅柍鍝勫€告禒娲⒑閸涘﹦鈽夐柨鏇樺€栫粋?
            loot.sort(java.util.Comparator.comparingDouble(turret::distanceToSqr));
            this.targetItem = loot.get(0);
            return true;
        }

        @Override
        public void start() {
            turret.getNavigation().moveTo(targetItem, speed);
        }

        @Override
        public boolean canContinueToUse() {
            // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁逞屽墾缁犳挸鐣锋總绋款潊闁炽儱鍟跨花銉╂⒒娴ｇ儤鍤€妞ゆ洦鍙冨畷鎴︽偄閾忛€涚瑝闂佽鍨庨埀顒勫绩娴犲鐓熸俊顖氭惈缁狙囨煙閸忕厧濮嶉柡宀嬬磿閳ь剨绲洪弲婵嬪礉瀹ュ鐓忛柛銉戝喚浼冨Δ鐘靛仦椤洭骞戦崟顖涘€绘俊顖炴？缁ㄦ挳姊婚崒娆戭槮缁剧虎鍙冮獮濠囧箻閸撲胶鐓嬮梺姹囧灮椤牊顢婇梻浣告啞濞诧箓宕归幍顔惧暗鐎广儱顦伴悡鏇㈡煏婢舵ê鏋ゅù鐘灲閺岀喖宕滆鐢盯鏌?3闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弮鍫熸殰闁稿鎸剧划顓炩槈濡娅ч梺娲诲幗閻熲晠寮婚悢鍏煎€绘俊顖濇閸旂鈹戦悙鑼癁闁哄懐濞€瀵寮撮悢铏诡啎闂佸壊鐓堥崰鎺楀磻閹炬緞鏃堝川椤撶偛鎸ら梻浣侯焾閻ジ宕戦悙鍝勭厱闁圭儤顨嗛悡鏇㈡倶閻愭潙绀冨瑙勶耿閺屽秷顧侀柛鎾寸懇楠炴顭ㄩ崼婵堝姦濡炪倖甯婄粈渚€骞栭幖浣圭厱闁哄啠鍋撻柛銊ф暬閹箖鎮滈挊澶岀杸闂佸搫顦冲▔鏇㈩敊閹烘鈷戦悹鍥ｂ偓宕囦画濠电姰鍨洪敋闁活煈鍓熷濠氬磼濞嗘劗銈板┑鐐差槹濞茬喎鐣锋导鏉戠閻庢稒锚瀵潡鏌ｆ惔銊︽锭闁硅姤绮嶇粙澶婎吋婢跺鍘繝銏ｆ硾濡瑥鈻嶉崱娑欑厽闁规儳鍟块弳鐔兼煙閼碱剦鐒炬い顓滃姂瀹曠厧鈹戦崼顐Ｐら梻鍌欒兌缁垶寮婚妸鈹库偓鍐╂償閵娿儱鎯為梺鍝勬储閸ㄦ椽鎮￠弴鐔翠簻妞ゆ挾鍠庨悘銉ッ瑰鍕煂缂佽鲸甯″畷婊勬媴闂€鎰潟婵°倗濮烽崑鐐烘偋濡も偓椤洩绠涘☉妯碱槶閻熸粌閰ｅ畷鎴ｎ樄闁诡喗顨堥幉鎾礋椤掑偆妲锋繝鐢靛仜閹锋垹寰婇崹顔ワ綁骞囬弶璺啋闁诲孩绋掗敋妞ゅ孩鎸剧槐鎾存媴閸撴彃鍓扮紓浣靛姂娴滆泛鐣烽幋锕€绠荤紓浣姑▓銉╂⒑闂堟稓澧曢柟鍐查叄閹ɑ绻濋崒銈嗗瘜闂侀潧鐗嗗Λ娑欐櫠闁秵鐓曞┑鐘插暟閳洜鈧灚婢樼€氫即鐛崶顒夋晢闁逞屽墰缁絽鈽夐姀锛勫幗闁瑰吋鐣崹濠氬煀閺囥垺瀚呴弶鍫涘妿缁?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弴鐐测偓鍝ュ鐠恒劉鍋撶憴鍕婵炶绠戦悾鐑藉蓟閵夛妇鍘甸柣搴ｆ暩椤牆鐡梻浣告惈椤戝懘鎮ц箛娑樼劦妞ゆ巻鍋撶紒鐘茬Ч瀹曟洟宕￠悘缁樻そ閹晝鎷犻懠顒婄幢闂備礁婀遍崑鎾诲礈濮橆剦鐒介柍鍝勫€舵禍婊堟煙閹规劖纭鹃弽锟犳⒑闂堚晝瀵奸柛妤佸▕楠炲啫螖閸愨晛鏋傞梺鍛婃处閸撴盯藝閵夛妇绡€闁冲皝鍋撻柛鎰靛枛瀵即姊虹化鏇熸澒闁稿鎸搁—鍐Χ閸℃鐟愰梺鐓庡暱閻栧ジ宕烘繝鍥у嵆闁绘梻绻濈花璇差渻閵堝棙灏甸柛瀣仱瀹曟澘螣鐏忔牕浜?
            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈢粯淇婇悙顏勨偓鏍偋濡ゅ啰鐭欓柟鐐湽閳ь剙鎳樺濠氬Ψ閿旀儳寮虫繝鐢靛█濞佳兾涢鐐嶏綁宕奸弴鐔哄帗閻熸粍绮撳畷婊冣枎閹惧磭鐤囧┑顔姐仜閸嬫挾鈧鍣崑濠傜暦濮椻偓椤㈡瑩鎳栭埡瀣簥濠电姷鏁搁崑鐐哄垂閸撲焦绠掔紓鍌氬€搁崯顖毭洪悢濂夋綎缂備焦蓱婵挳鏌涘┑鍕姕闁诲寒鍠栭埞鎴﹀焺閸愶缚绮婚梺鍛婃⒐閸ㄥ潡鐛崘顔藉€烽柣鎴炆戝▍鍥⒑缁嬫寧婀版慨妯稿姂閹偓銈ｉ崘鈹炬嫼缂備礁顑堝▔鏇㈡倶闁秵鐓曢悗锝庡亞閵嗘帡鏌ｉ妷顔绘捣妞わ箑缍婇弻锛勪沪閻ｅ睗褏鈧娲﹂崑濠傜暦閻旂⒈鏁傞柛鈩冪懐濡差剙鈹戦敍鍕杭闁稿﹥娲滈幑銏ゅ箛椤旂懓浜炬慨姗嗗幗閸婃劙鏌熼搹顐ｅ磳妤犵偞鍔栭幆鏂库槈濡ゅ啰娉块梻鍌氼煬閸嬪嫬煤閿曞倸绠伴柣鎰靛墯濞呯姵绻涢幋娆忕仾闁绘挻鐩弻娑橆煥閳ь剛绮堟担瑙勬珷闁圭虎鍠楅悡娆愩亜閺冣偓閺嬪鎳撻崸妤佺厵妞ゆ梻鏅幊鍛存煙閻熸澘顏柟顖氬楠炴帡骞橀弶鎴狅紦闂備礁鎼惌澶岀礊娴ｉ€涚箚闁归棿鐒﹂弲婵嬫煃瑜滈崜鐔煎箖濮椻偓婵＄兘鍩￠崒婊冨笚闂備浇濮ら敋妞わ箒妫勮灒闁逞屽墮铻栭柣姗€娼ф禒锕傛煥閺囨ê鐏查柕鍡曠閳藉顫滈崱妯哄厞婵＄偑鍊栭崝鎴﹀春閸曨倠娑橆煥閸啿鎷婚梺绋挎湰閼归箖鍩€椤掑倸鍘撮柟铏殜瀹曞ジ寮撮悙纰夌吹闂備焦鐪归崹濠氣€﹂崼銉﹀仾闁绘劦鍓涚弧鈧梻鍌氱墛缁嬫捇骞婃担鍓茬唵闁兼悂娼ф慨鍥╃磼閻樺磭娲撮柡灞稿墲瀵板嫭鎯旈姀顫偓濠傤渻閵堝棙鐓ユ俊顐ｇ箓椤繒绱掑Ο璇差€撻梺鍛婄缚閸庝即鎼规惔鈽嗘富闁靛牆妫楅悘銉︿繆椤愶絿鎳呯紒顔碱儏椤撳吋寰勬繛鈷€鍐剧唵閻犺桨璀﹂崕鎴︽煕濮椻偓娴滆泛顫忓ú顏咁棃婵炴垼椴告晥闂備焦鎮堕崝搴ㄥ极鐠囪尙鏆︽い鏍ㄧ☉椤曢亶鏌熺喊鍗炲箺闁哄應鏅犻幃妤呭礂婢跺﹣澹曢梻浣告啞濞诧箓宕楀鈧獮蹇撁洪鍛嫼闂侀潻瀵岄崣搴ㄦ倿閻愵剛绠鹃悗鐢殿焾閸樻挳鏌涢埞鍨姕鐎垫澘瀚换娑㈡倷椤掍焦婢戦梻鍌欒兌椤牓寮甸鍌滅煓闁圭儤顨呴悡鏇㈡煙閻戞ɑ鈷掔痪鎯у悑閵囧嫰寮撮悙鏉戞濡ょ姷鍋為〃鍫ュ焵椤掆偓閻忔艾顭垮Ο灏栧亾濮樼厧鏋熺紒鍌涘浮閺佸啴宕掑杈╂毎闁荤喐绮嶇划鎾诲春閳ь剚銇勯幒宥堝厡婵炴彃鐡ㄩ幈銊︾節閸愨斂浠㈤悗瑙勬磸閸斿秶鎹㈠┑瀣妞ゆ挾濮靛▓濂告⒒娴ｇ瓔鍤欓悗娑掓櫊閹虫繃銈ｉ崘銊ョ哎闂佽偐鍘ф晶搴㈢娴犲鈷戦悹鍥ㄥ絻閸よ京绱撳鍛棦鐎规洑鍗冲浠嬵敃閵堝棴绱￠柣鐔哥矋濡啫顕ｇ拠宸悑濠㈣泛锕ｇ槐鍫曟⒑閸涘﹥澶勯柛瀣у亾闂佺顑嗛幐鑽ゆ崲濠靛棭娼╂い鎾跺仒閾忓酣姊绘担鍝勫付妞ゎ偅娲熷畷鎰旈崘顭戞?
            // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑鏅悷婊冪Ч濠€渚€姊虹紒妯虹伇婵☆偄瀚划濠氭偐缂佹鍘甸梺璇″瀻閸愨晩鍟堥梻浣规偠閸庢椽宕滈敃鍌氭瀬鐎广儱顦伴悡鐔兼煙闁箑鐏犻柣銊︽そ閺岋綁骞橀弶鎴犱紝濠碘槅鍋勯幊姗€銆侀弴銏狀潊闁炽儲鍓氬Σ杈╃磽閸屾瑧顦︽い鎴濇瀹曞綊宕烽鐐茬亰婵犵數濮甸懝鍓х不閿濆鐓熸俊顖氭惈閺嗛亶鏌＄€ｎ偄鐏存俊顐㈡嚇椤㈡洟濮€閳ユ剚妲辩紓鍌欑椤戝棝宕归崹顕呭殨?SkeletonTurret.tick 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛濠傛健閺屻劑寮村鑸殿€栨繛瀛樼矊缂嶅﹪寮诲☉銏犵疀闂傚牊绋掗悘宥夋⒑缁嬪灝顒㈡俊顐㈠暣瀵鏁愭径濠勵啋閻庤娲栧ú銈夊传濞差亝鈷?"hurtTime" 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ弬娆炬祲濠㈣埖鍔曠粻娑㈡煛婢跺孩纭堕柨娑欑洴濮婇缚銇愰幒鎴滃枈闂佸憡锚婢х晫鍒掔紒妯稿亝闁告劏鏅濋崢鎾绘偡濠婂嫮鐭掔€规洘绮撻幃銏ゆ偂鎼淬倖鎲伴柣搴＄畭閸庨亶鎮у鍐剧€堕柕濞炬櫆閳锋垹绱掔€ｎ厽纭剁紒鐘哄皺缁辨帞鈧綆鍋勯悘瀛樼節閳ь剚绗熼埀顒€顫忓ú顏勭闁绘劖褰冩慨澶愭⒑閸濆嫭鍣虹紒璇茬墦楠炲棗鐣濋崟顐㈣€垮┑鐐村灦閻熴儵鍩€椤掑倹鏆柡灞诲妼閳规垿宕卞☉鎵佸亾濡ゅ懏鐓涢悗锝庡墮閺嬫盯鏌?
            return targetItem != null && targetItem.isAlive() && !turret.getNavigation().isDone();
        }

        // tick 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洟鎮烽幊濠傜秺閹晛顔忛鐓庡Η缂傚倸鍊哥粔鐢告偋閺団懇鈧妇鎹勯妸锕€纾梺缁樺灦钃遍柟鐑戒憾濮婅櫣绮欑捄銊ь唹缂備緡鍠楅幑鍥ь嚕鐠囨祴妲堥柕蹇婃櫆閺呮繈姊洪幐搴ｇ畵婵☆偅鐩棟闁靛鏅滈埛鎴炵箾閼奸鍤欐鐐搭殕閵囧嫰濡搁妷锔绘＆婵犵绱曢弫璇茬暦閻旂⒈鏁嶆慨姗嗗墮閺併倝姊绘笟鈧褑鍣归梺鍛婃处閸嬪懘鎮甸敍鍕＝闁稿本鑹鹃埀顒傚厴濮婅棄顓兼径濠勵槷闁诲函缍嗛崰鏍兜閳ь剟姊虹憴鍕姸婵☆偄瀚伴幏鎴︽偄閸濄儳顔曢梺鐟扮摠閻熴儵鎮橀埡鍐＜闁绘ê鍟块埢鏇㈡煛瀹€瀣瘈鐎规洘甯掗～婵囨綇閵娧勵吇闂傚倷绀侀幖顐︻敄閸涙潙绠犻幖娣妼閻撴﹢鏌熸潏楣冩闁稿﹦鍏橀弻娑樷枎韫囷絾笑濠电偛鎷戠紞浣割潖缂佹ɑ濯寸紒瀣硶閻╁海绱撻崒姘毙＄紒鈧笟鈧、姘舵晲婢舵ɑ鏅濋梺闈涚箚閺呮盯骞冮幋锔解拺闁硅偐鍋涢崝鐢告⒒閸曨偄顏€规洜鍠栧畷姗€顢欑憴锝嗗闂備胶顭堢换妯何涢崸妤佸殝妞ゅ繐鐗婇悡鏇㈠箹濞ｎ剙鐏╅柍缁樻礋閹稿﹤鈹戦崶銉ょ盎闂佽宕樺▔娑㈠几閺冨倻纾奸柣妯垮吹閻ｆ椽鏌″畝鈧崰鎾诲焵椤掑倹鏆╂い顓炵墛缁傛帡鏁傞柨顖氫壕閻熸瑥瀚粈鈧柣搴㈠嚬閸樼晫绮氭潏銊х瘈闁稿被鍊栫€靛矂姊虹紒妯诲碍濡ょ姵鎮傞垾鏍偓锝庡墰绾捐棄銆掑顒佹悙婵炲懏锕㈤弻娑樜熼幐搴濡炪倖娲忛崕闈涚暦閻旂⒈鏁嶆慨妯夸含閺夊憡淇婇悙顏勨偓鏍暜閹烘纾婚柛鈩冦亗閿濆棗顕遍悗娑欘焽閸樹粙鏌熼懝鐗堝涧缂佽鲸娲熼幃楣冾敇閵忥紕鍘遍柟鍏肩暘閸斿骞夋ィ鍐╁癄婵犻潧顑嗛悡鐔镐繆閵堝倸浜鹃梺缁橆殔缁绘﹢濡撮崨瀛樼叆閻庯綆鍋勫鍨攽閿涘嫬浠╂い鏇嗗嫮顩插Δ锝呭暞閳锋垿鎮归崶锝傚亾閾忣偆浜鹃梻浣侯焾缁绘垿鏁嬪銈嗘穿缂嶄礁顕ｉ崼鏇炵妞ゆ挾鍠庨崗濠冧繆閻愵亜鈧牠骞愰悙顒佸弿濞村吋娼欑壕缁樹繆椤栨繍鍞虹紒璇叉閺岋綁骞囬崗鍝ョ泿闂侀€炲苯澧柣妤冨█閻涱噣骞囬弶璺啇婵炶揪绲介幗婊堫敊閹存績鏀介柣妯款嚋瀹搞儵鏌熼崘鏌ュ弰鐎规洜鎳撻埞鎴犫偓锝庡亜娴狀垶姊洪幖鐐插妧闁告劏鏅╁Λ鐔兼⒒娴ｅ憡鎯堥柛鐕佸亰閹囧幢濞嗘垹鐒奸柣搴秵閸嬩焦绂嶅鍫熺厵闁硅鍔栫涵鍓р偓娑欑箞濮婃椽宕崟顐淮闂佺楠哥壕顓炍ｉ幇鏉跨閻犲洩灏欓敍婊冣攽閻愬弶顥為柛鈺佺墕鍗辨い鏇楀亾婵﹨娅ｇ划娆撳礌閳╁喚鏆紓鍌欑贰閸犳鎮烽埡鍛ュù锝呭濞尖晠鏌熸０浣哄妽娴滄稑鈹戦敍鍕杭闁稿﹥鐗犲濠氬Ω瑜庡畷鍙夋叏濡炶浜鹃悗娈垮枛椤嘲鐣烽崡鐐嶆梹绻濋崒娑樷偓顖炴⒒娴ｅ憡鍟炲〒姘殜瀹曞綊鎮￠獮顒婄秮楠炴﹢顢欑憴锝嗗闂備胶鍘ч～鏇㈠磹閺囥垹鐓濋柛顐犲灮绾句粙鏌涚仦鍓ь灱濠㈣蓱閵囧嫰鍩℃担闈涗划婵犵鍓濋悺鏇⑺囬弻銉︾厱闁靛濡囩粻妯肩磼鏉堛劍灏伴柟宄版嚇閹虫牠鍩勯崘銊т紝閻庤娲╃紞鈧紒鐘崇洴瀵噣宕掑鍛潓闂傚倷绀佹竟濠囨偂閸儱纾婚柛鏇ㄥ墯閸欏繘鏌涢鐘茬伄缁炬儳銈搁弻銈囩矙鐠恒劋绮甸梺姹囧妽閸ㄥ湱妲?
    }    // ==========================================
    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱樈閸犳顕欏ú顏呪拺缂侇垱娲栨晶鍙夈亜閵娿儲鍣界紒顔芥閵囨劙骞掗幘顖涘闂佽崵濮村ú鈺冧焊濞嗘垹涓嶉柡灞诲劜閻撶喖鏌嶉崫鍕跺伐闁诲骏濡囬埀顒侇問閸犳牠鈥﹂悜钘夋瀬闁瑰墽绮崑鎰版煛鐏炶鍔氶柡浣筋潐娣囧﹪鎮欓鍕ㄥ亾閺嶎厼绀夐柟杈剧畱閸ㄥ倻绱撴担璇＄劷妞も晝鍏橀弻宥夊传閸曨剙娅ら梺鎶芥敱閸ㄥ潡骞冭ぐ鎺戠倞闁挎繂鍊告禍楣冩煣韫囷絽浜炲ù婊冪埣濮婄粯鎷呴崨濠呯闂佺娅曢幐鍝ュ弲濡炪倖鎸鹃崕鎰板吹?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缁炬儳顭烽弻鐔煎礈瑜忕敮娑㈡煕閵堝懓瀚伴摶鏍煥濠靛棙鍣归柡鍡樼懅閻ヮ亪宕滆閸も偓闂佸疇顫夐崹鍧楀箖閳哄啠鍋撻崷顓炐㈡い銉︾箘缁辨挻鎷呴幓鎺嶅闂備胶顭堥惉濂稿磻閻愮儤鍋傞煫鍥ㄧ〒閸欐捇鏌涢妷鎴濊嫰閸撲即姊洪柅鐐茶嫰婢ь垱绻涢崣澶岀煂闁告帗甯楃换婵嗩潩椤掑偆鍚呴梻浣虹帛閸旀寮幖浣瑰剨闁割偁鍎查埛鎺楁煕鐏炵偓鐨戝褎绋撶槐鎺斺偓锝庡亝鐏忎即鏌￠崨鐗堢【闁宠棄顦埢搴㈡償閿濆洨鏆?- 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ巻鍋撴潻婵嬫⒑闁偛鑻晶鎾煛鐏炲墽銆掗柍褜鍓ㄧ紞鍡涘磻閸涱厾鏆︾€光偓閸曨剛鍘靛銈嗘閸嬫劗绮旈搹鍏夊亾鐟欏嫭绀€闁绘牕鍚嬫穱濠囧箹娴ｈ倽銊ф喐韫囨稑围闂佸灝顑囩弧鈧┑鐐茬墕閻忔繂鈻嶅▎鎴犵＜闂婎偒鍘鹃惌娆撴煛娴ｇ鏆ｆい銏℃瀹曠喖宕归銈団枆婵犵數濮烽弫鍛婃叏閻㈠憡鍤岄柛鎾楀懐鐒奸梺鍛婂姀閺傚倹绂嶅鍫㈠彄闁搞儯鍔嶇亸顓熴亜韫囷絼閭柡宀嬬稻閹棃鍩ラ崱娆忔倯闂備浇顕栭崰妤呫€冮崨鏉戠厺闁规崘顕ч崹鍌涖亜閺冨倹娅曞ù婊冪埣濮婄粯鎷呯粵瀣異闂佸摜濮甸悧鐘茬暦閹版澘閿ゆ俊銈呭暙缁侊箓姊虹化鏇炲⒉缂佸鍨圭划鍫ュ礃閳瑰じ绨婚梺鍝勫暙濞层倖绂嶇憴鍕╀簻闁挎棁濮ょ欢鍙夈亜椤忓嫬鏆ｅ┑鈥崇埣瀹曞崬螣閻戞ɑ顔傞梻鍌欑閹芥粍鎱ㄩ悽绋跨闁搞儺鍓欑粻鏍归崗鍏肩稇閸烆垶姊洪崘鍙夋儓闁稿﹦鏁婚獮?
    // ==========================================
    static class TurretPackAttackGoal extends net.minecraft.world.entity.ai.goal.target.TargetGoal {
        private final SkeletonTurret turret;
        private LivingEntity potentialTarget;

        public TurretPackAttackGoal(SkeletonTurret turret) {
            super(turret, false); // false 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煟閵忋埄鐒剧痪鎯ь煼閺岋綁骞囬鑺ユ瘎闂佹椿鍘介悷鈺呮偂椤愶箑鐐婇柕濞р偓濡插牏绱撴担鎻掍壕婵犮垼鍩栭崝鏇犵不鐟欏嫮绠鹃柨婵嗛婢ь喖鈹戦敍鍕付妞も晛銈稿畷銊╊敇濞戞瑦鏉告俊鐐€栧褰掑几缂佹鐟规繛鎴欏灪閻撴洘鎱ㄥ璇蹭壕缂備胶濮甸悧鐘茬暦濞差亜顫呴柕鍫濇噽閻嫰姊虹粙鎸庢拱妞ゃ劌鎳忕粋宥夋倷椤掑顔旈梺缁樺姌鐏忔瑦绂掗姀銈嗙厱闁哄啠鍋撶痪鏉跨Ч婵＄敻宕熼娑欐珕闂佽鍨庣仦鐐様缂傚倸鍊风粈渚€宕愰崷顓熸殰闁圭儤顨愮紞鏍ㄧ節婵犲倻澧曢柣鎺戠仛閵囧嫰骞掗幋婵愪患缂備胶濮甸悧鐘诲蓟閿濆绠ｉ柨婵嗘－濡嫰姊洪崨濠庢畽婵炲懏娲熼獮鍫ュΩ閵夊海鍠栧畷顐﹀礋椤掍胶妲梻鍌欑閹猜ゅ綔闂侀€炲苯澧柡瀣偢瀵劍绂掔€ｎ偆鍘介梺褰掑亰閸樼晫绱為幋鐘电＜闁肩⒈鍓涚敮娑氱磼缂佹銆掓繛鎴濈仛椤︾増鎯旈敐鍥潓闂傚倷鑳剁划顖涚瑹濡ゅ懎闂柨婵嗩槺瀹撲線鏌熼悜妯烘闁哄啫鐗嗛悞鍨亜閹哄棗浜鹃梺杞扮贰閸犳绌辨繝鍥ㄥ€锋い蹇撳閸嬫捇濡舵径濠傚亶婵炲濮撮鍛村垂閸岀偞鐓曢柟鎹愬蔼閸忓瞼绱掗埀顒佺節閸屾鏂€闂佺粯蓱瑜板啴顢旈銈囨／闁硅鍔栭ˉ澶愭婢舵劖鐓ユ繝闈涙婢跺嫰鏌涢妶鍌氫壕闂傚倷绀侀幉锟犲蓟閿濆纾规繝闈涱儏閽冪喖鏌￠崶銉ョ仼闁绘劕锕ラ妵鍕敇閻旈浠奸梺鍛婃⒒閸忔﹢骞冨Δ鈧埢鎾诲垂椤旇姤顔勯梻浣规偠閸庢粓宕担鍓愮偛鈹戦敍鍕杭闁稿﹥鐗曡灋濞达綀鍊藉☉銏犵妞ゆ劗鍠愰悘渚€姊洪悷閭﹀殶闁稿鍠撶划缁樸偅閸愨晛鈧敻鏌ｉ姀鈽嗗晱闁绘帒澧介埀顒佺⊕缁诲倿鈥旈崘顔嘉ч柛鈩冾殘娴犳潙鈹戦埥鍡椾簼缂佽鍊块、姘舵晲婢舵ɑ鏅濋梺闈涚箚閺呮粓宕撻悽鍛娾拺闁绘挸瀛╅幉鎼佹煛娴ｈ鍊愮€?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁逞屽墾缁犳挸鐣锋總绋款潊闁炽儱鍟跨花銉╂⒒娴ｇ瓔娼愬鐟版閺呰泛螖閸涱厾锛涢柣搴秵閸犳鎮″▎鎾寸厵閻熸瑥瀚慨锕傛煕閵堝棛鎳呯紒杈ㄦ尰閹峰懘宕ｆ径瀣綃闂備礁鎼悮顐﹀礉瀹€鍕厴闁硅揪绠戦獮銏℃叏濡も偓濡瑩鏁撻妷锔跨箚闁绘劦浜滈埀顒佸姍瀵彃顭ㄩ崼鐔蜂簵闂佽法鍠撴慨鎾嫅閻斿摜绠鹃柟瀛樼懃閻忊晠鏌ｉ幒鎾淬仢闁哄本鐩獮鍥敊闂傛潙顥氶梻浣风串缁蹭粙鎮ラ悡搴綎婵炲樊浜滄导鐘绘煕閺囥劌澧繛鍛€濆娲嚒閵堝懏姣愰梺鍝勬噽婵挳顢?
            this.turret = turret;
            this.setFlags(EnumSet.of(Flag.TARGET)); // 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫鍐煥閺囨浜鹃梺姹囧€楅崑鎾舵崲濠靛洨绡€闁稿本绮岄·鈧梻浣侯焾椤戞垹鎹㈠┑瀣摕闁靛ň鏅涢崡铏繆閵堝倸浜炬繛瀛樼矒缁犳牠寮诲☉妯滄棃宕ㄩ浣告灓闂備礁鎼張顒傜矙閹达箑鐓″璺侯煬濞笺劑鏌涢锝囩畵妞ゎ偆濞€濮婄粯鎷呴崫銉礊缂備緡鍣崹鎷岀亱闂佸憡鍔﹂崰鏍嫅閻旇　鍋撻獮鍨姎闁绘绮岄‖濠囧Ω閳哄倵鎷洪梺鍛婄☉閿曘儳浜搁悧鍫熷弿婵☆垳顭堟俊鍧楁煕閹烘挸绗掗柍璇查叄楠炲洭顢楅崒婊呭祦闂傚倷娴囬～澶婎熆濮椻偓閹ê顫濈捄铏规煣濠电姴锕ょ€氼喚绮绘ィ鍐ㄧ骇闁割偅绻傞埛鏃傜磼鐎ｎ厼鍚归柟鍙夋倐瀵爼宕归鑺ヮ唹缂傚倷绀侀崐鍝ョ矓瑜版帒绠栨繛鍡樻惄閺佸棝鏌涚仦鍓х煂婵℃彃娲ら埞鎴︽偐閸偅姣勬繝娈垮枟閹稿啿鐣烽幇顖樹汗闁圭儤鎸诲▍鏍倵楠炲灝鍔氭い锔垮嵆閹繝寮撮姀锛勫幗闂佸搫鍟崐鎼佸储閹绢喗鐓曟繛鍡楃箰椤忣參鏌″畝鈧崰鏍€佸▎鎴犻┏閻庯綆鍋嗛弳顓㈡⒒娴ｇ儤鍤€鐎殿喖鐖奸獮鎰板礃閼碱剚娈鹃梺缁樻⒒閳峰牓寮崱娑欑厱閻忕偛褰炵欢閬嶆煕濮橆剚鎼愰柍瑙勫灴閹晠宕归锝嗙槑闂備胶顭堥鍥ㄦ叏閹绢噮鏁嬮柨婵嗩槸缁犲鎮归崶顏勭毢妞ゃ垹鎳樺娲川婵犲倸顫屽┑鈽嗗灠閿曨亜鐣烽悽绋垮嵆闁诲繗顕х紞濠囧箖閳轰緡鍟呮い鏃傚帶婢瑰牓姊绘担铏瑰笡闁告梹娲熼弫鍐敂閸繆鎽曢梺闈涱焾閸庮噣寮ㄦ禒瀣厱闁斥晛鍟ㄦ禒婊堟煕鐎ｎ偅宕岀€规洏鍔嶇换婵嬪礋閸偊鏁滈梻鍌欒兌缁垶宕濋敃鍌氱婵炴垶鑹炬慨顒勬煃瑜滈崜鐔奉潖婵犳艾纾兼慨妯哄船椤も偓缂傚倷绀侀鍡涘箰婵犳艾鐤鹃悹楦裤€€濡插牓鏌曡箛銉х？闁告ü绮欏娲箰鎼达絿鐣甸梺鐟板暱闁帮綁骞婂鍡愪汗闁圭儤鎼╁鎸庣節閵忥絽鐓愰柛鏃€鐗犻幃锟犳偄闂€鎰畾濡炪倖鐗楃划鐘诲绩閻楀牄浜滈柟鐑樻煥閺嬫盯鏌＄仦鍓ф创濠碘€崇埣瀹曞崬鈻庨幇顒佺彛闂?
        }

        @Override
        public boolean canUse() {
            // 1. 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯锋嫼閻熸粎澧楃敮鎺撶娴煎瓨鐓曢柟鎯ь嚟濞插瓨銇勯姀鈭额亞鍙呭銈呯箰閹冲骞忓ú顏呪拺闁煎鍊曢弸鎴濐熆閻熺増顥㈡鐐搭殜閹晠鎮介悽纰夌床闂佽崵濮村ú锕併亹閸愵喖鐒垫い鎺嗗亾闁诲繑绻堥幃楣冩倻閼恒儱浠虹紓浣割儓濞夋洟顢欐繝鍥ㄢ拺闁告繂瀚弳娆撴煕婵犲偆鐓奸柡浣哥Т閳规垿宕堕埡鍐惧晭闂佸搫顦悧鍡樻櫠娴犲绀嗗ù鐓庣摠閻撴瑩鏌ら幁鎺戝姢闁活厼鐬肩槐鎺楊敊绾拌京鍚嬮悗瑙勬穿缁叉儳顕ラ崟顐ゆ殕闁逞屽墴閹線宕奸妷锔规嫼闂備緡鍋嗛崑娑㈡嚐椤栨稒娅犳い鏍ㄧ矌绾惧吋淇婇妶鍛殭闁哄鐩弻娑㈠煘閹傚濠碉紕鍋戦崐鏍暜閹烘柡鍋撳鐓庡缂侇喛顕ч～婵嬫嚋閻㈤潧骞堥梻浣告惈濞层垽宕濆畝鍕€堕梺顒€绉甸悡娑樏归敐澶嬩氦闂婎剦鍓熼弻鈥崇暆鐎ｎ剛袦闂佽桨鐒﹂崝娆忕暦閵娾晛绾ф繛鍡楀綖缁辨棃姊婚崒娆愮グ妞ゆ泦鍛床婵°倓闄嶆禒鍫ユ煕濠靛嫬鍔滅€规洖寮剁换娑㈠箣閻愯尙鍔伴梺绋款儐閹告悂鍩ユ径濞炬瀻婵☆垳鍘ф慨娲⒒娴ｈ銇熼柛妯恒偢閺佸啴濡烽敂閿敵婵犵數濮村ù鍌炲极閸愵喗鐓忛煫鍥э攻濞呭懏绻涢崼锝嗙【闁宠鍨块崹楣冨礃閼碱剟鐛撻梻浣告啞濮婄懓煤閻旂厧鏄ラ柣鎰惈缁狅綁鏌ㄩ弴妤€浜鹃梻浣稿船濞诧妇鎹㈠┑鍥╃瘈闁稿本绋戝▍锝嗙節閳封偓閸モ晝鏆┑顔硷功缁垶骞忛崨鏉戝窛濠电姴鍊瑰▓姗€姊绘担钘夊惞闁革綇濡囩划濠氬箻鐠囪尙浼嬮梺鎸庢礀閸婃悂鎮欐繝鍐︿簻闁瑰搫绉堕ˇ锕€霉閻欌偓閸欏啫顫忓ú顏勭闁告瑥顦伴崕鎾绘⒑绾懏鐝柛鏃€鐟ラ悾鐑芥晲婢跺﹦顔掔紓鍌欑劍椤洭宕㈤柆宥嗏拺闂傚牊渚楀Σ褰掓煕閵娧勬毈鐎规洦鍨堕、娑橆潩閿濆棛浜栭梻浣告啞閻熴儵藝鏉堚晛濮柍褜鍓熷娲礃閼碱剚顔堥梺绋款儐閹搁箖鍩€椤掆偓缁犲秹宕曢崡鐏绘椽濡搁埡浣硅緢闂侀潧鐗嗛ˇ浼村煕閹达箑绾ч柣鎰綑椤ュ銇勯敂鐓庮洭缂佽鲸甯楀鍕償閿涘嫬甯跨紓鍌欑閸婂湱鏁敓鐘叉瀬闁告劦鍠栫壕鍏肩箾閹寸倖鎴︽偩娴煎瓨鈷掑ù锝囶焾閺嗛亶鏌熺喊鍗炰喊鐎规洦鍨堕、娑㈡倷閼碱剛宕堕梻浣告贡閸庛倝銆冮崱娑樼厱闁圭儤顨嗛悡鏇㈡倶閻愭潙绀冨瑙勶耿閺屽秷顧侀柛鎾寸洴閳ワ箓宕奸姀鐘茬柧闂傚倷鑳剁划顖炩€﹂崼銉晪鐟滃繑绔熼弴鐔虹瘈婵﹩鍘鹃崢鐢告⒑閸涘﹥瀵欓柛娑卞幘椤愬ジ姊绘担渚劸妞ゆ垶鍨归幑銏犫攽鐎ｎ亣鎽曢梺璺ㄥ枔婵挳鎮欐繝鍥ㄧ厪濠电姴绻愰々顒佺箾閸稑鈧繂顫忓ú顏勫窛濠电姴鍟伴崣鍡欑磽娴ｅ壊妲归柟鍛婂▕瀹曟椽鎮欓崫鍕吅闂佹寧姊婚悺鏃堝焵椤掍礁濮堝ǎ鍥э躬閹瑩鎳犻浣瑰枛闂備浇顕栭崰鏍磹閸ф鍋樻い鏃囨硶閻も偓濠电偞鍨堕敋缂佹劖绋戦—鍐Χ閸℃ê鐦烽梺鍛婁緱閸樼厧效閺屻儲鈷掗柛灞剧懅缁愭棃鏌嶈閸撴盯宕戝☉銏″殣妞ゆ牗绋掑▍鐘绘煙濞堝灝鏋ょ痪?
            if (this.turret.getTarget() != null) return false;

            // 2. 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈢粯淇婇悙顏勨偓鏍偋濡ゅ啰鐭欓柟鐐湽閳ь剙鎳樺畷锝嗗緞瀹€鈧惁鍫ユ⒒閸屾氨澧涚紒瀣浮閺佸秹寮崼鐔哄幘闂佸搫顦冲▔鏇熺閵忋倖鐓忛柛鈩兠粭鎺撱亜椤愶絿绠為柡浣瑰姍瀹曘劑顢楅埀顒勊夊鑸碘拻闁稿本鐟ч崝宥夋煙椤旇偐鍩ｇ€规洘绻傞鍏煎緞婵犲嫸绱甸梻浣筋潐閸庤壈顣鹃梺閫炲苯澧剧紒鐘虫尰娣囧﹪骞栨担鍝ュ幐婵炶揪绲鹃悺鏇㈠焵椤掆偓閻忔繈鍩為幋锔藉€烽柛娆忣樈濡繝鏌ょ憗銈呪偓婵嬪蓟濞戞埃鍋撻敐搴′簼鐎规洖鐭傞弻娑㈠煘閹傚濠碉紕鍋戦崐鏍暜閹烘柡鍋撳鐓庡籍闁糕晜鐩獮鎺懳旀担鍝勫箞闂佽绻掗崑娑欐櫠娴犲鈧倿寮婚妷锔惧幈闂佹寧绻傞幊蹇曟嫻閿涘嫮纾奸弶鍫涘妼缁椦呯磼鏉堛劌绗掗摶锝夋煣韫囨稈鍋撳☉姘鳖槰闂傚倸鍊风粈渚€骞楀鍫濋棷闁靛鏅涢崹鍌炴煕椤愶絾绀€缂佺姵鐗楁穱濠囧Χ閸屾矮澹曢梻浣哥－缁垶骞戦崶褏鏆︾憸鐗堝俯閺佸﹪鏌ｉ敐鍛殭闂侇収鍨崇槐鎾诲磼濮橆兘鍋撳畡鎳婂綊宕堕澶嬫櫔閻熸粌绉烽悘瀣攽閻樼粯娑фい鎴濇嚇瀵即濡烽埡鍌滃帗閻熸粍绮撳畷婊冾潩鐠轰綍锕傛煕閺囥劌鐏犵紒鐘茬－閳ь剙绠嶉崕閬嶆偋閸℃稑鍌ㄩ柨娑樺绾捐棄霉閿濆懏鎯堥弽锟犳⒑缂佹﹩娈樺┑鐐╁亾閻庢鍠涢褔鍩ユ径鎰潊闁绘ɑ鐗戦弲鐘诲蓟閵娿儮鏀介柛鈩兠▍锝咁渻閵堝骸浜滄繛宸幖椤繐煤椤忓嫮顔愰梺缁樺姈瑜板啴鈥栨径鎰拺缂佸鐏濋銏犫攽閻愯韬柛銊╃畺閺佸啴宕掑В灏栨櫊閺屽秵娼幍顔剧崲闂佸摜鍋涢悥鐓庮潖閾忓湱纾兼俊顖滃劦閹疯绻濋姀锝庢綈婵炶尙鍠庨锝夊箵閹哄棙鏂€闁诲函缍嗘禍鐐哄礉閿曗偓椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮婚敐鍫㈢杸闁哄啫鍋嗛弳锛勭磽娴ｈ鈷掗柛鐘虫崌閸┾偓妞ゆ帒锕︾粔鐢告煕閻樺磭澧辩紒顔肩墦瀹曞ジ鎮㈤搹鍦闂傚倸鍊搁悧濠囧礃鐠囧樊鍟呴柕澶嗘櫆閻撴盯鏌涢埄鍐噧濞寸娀浜堕弻鈥崇暆鐎ｎ剛蓱闂佽鍨卞Λ鍐╂叏閳ь剟鏌嶆潪鎵妽婵炲懏鐩缁樻媴閸涘﹥鍠愭繝娈垮枤閺佸骞冭椤劑宕煎┑鍫敼闂備線娼х换鍫ュ磹閺囥垻宓侀柕蹇ョ磿缁犻箖鏌熺€电鍓遍柣鎺嶇矙閺屾盯寮幘鍓佹殸濡炪値浜滈崯瀛樹繆閸洖骞㈡俊銈呭暟閹差亪姊绘担鍝勫付闁哥喐瀵ч弲鑸垫償閿濆懎鐏婃繝鐢靛У绾板秹宕愰悜鑺ョ厽闁瑰鍎愰悞浠嬫煕濮椻偓娴滆泛螞閸涙惌鏁冮柕蹇娾偓鎰佹П婵犵妲呴崑鍛村垂閸ф绠犻柟鎹愵嚙闁裤倖淇婇妶鍕厡闁告﹢娼ч—鍐Χ閸℃﹩姊块悗瑙勬礈閺佸骞嗙仦瑙ｆ瀻闁规儳顕崢闈涱渻閵堝棙鐓ラ柟纰卞亰閹﹢鎳犻钘変壕閻熸瑥瀚壕鎼佹煕閺傝法肖闁瑰箍鍨归埞鎴犫偓锝庝簽椤︺劌顪冮妶鍛閻庢凹鍠氱划娆撳炊椤掍讲鎷婚梺绋挎湰閼归箖鍩€椤掑倸鍘撮柟顔惧仱閺佸倿鏌ㄩ姘缂備焦顨嗙粙鎴﹀箠閹扮増鍎楁繛鍡樻尰閻撴瑩寮堕崼銉х暫婵＄虎鍣ｉ弻娑欐償閵忊晜鐣堕梻鍥ь樀閺屻劌鈹戦崱妯绘倷闂佸憡鏌ㄩ鍥焵椤掑喚娼愭繛鍙夛耿閹繝鏁撻悩鑼舵憰闂佺偨鍎查崜姘跺触鐎ｎ喖绠圭紒顔煎帨閸嬫挸鐣烽崶璺烘櫍缂傚倸鍊搁崐椋庢閿熺姴纾婚柛鏇ㄥ幘閻挾鎲搁悧鍫濈瑨闁藉啰鍠栭弻銊モ攽閸℃ê鏅甸梺缁樻⒒閸樠勫閻樼粯鐓曢柡鍥ュ妼婢ь垶鏌ｉ敂鑲╃ɑ濞ｅ洤锕幃娆擃敂閸曘劌浜剧憸蹇擃嚗婵犲啨鍋呴柛鎰ㄦ櫅娴滄姊虹捄銊ユ灁濠殿喖顕划濠氬冀椤撶喓鍘遍梺鎸庢椤曆囩嵁閹扮増鐓曢悗锝庡亝瀹曞矂鏌℃担鐟板闁诡垱妫冮崹楣冩嚑椤掆偓閸ゎ剟姊婚崒娆愮グ妞ゆ洘鐗犲畷瑙勫鐎涙ê浜遍棅顐㈡处濞叉﹢锝為弴銏＄厵闁绘垶蓱鐏忔壆绱撳鍛枠闁哄本娲樼换娑滎槻闁硅櫕鍔欏鑸电鐎ｎ偆鍘介柟鍏肩暘閸娿倕顭囬幇顓犵婵炴潙顑嗗▍鍥╃磼鏉堚晛浠︾紒妤冨枛閸┾偓妞ゆ帒瀚繚婵炴挻鍩冮崑鎾垛偓娈垮櫘閸ｏ絽鐣烽悡搴樻斀闁割偅绺鹃崑鎾绘倷閻戞ǚ鎷洪梺缁樻尭鐎涒晠骞夐幖浣圭厸濞达綀顫夐崐鎰版煙椤曞棛绡€妤犵偛顑夐弫鍌滄喆閿濆棗顏烘繝鐢靛仩閹活亞寰婃禒瀣疅闁跨喓濮寸粻姘舵煕椤愮姴鍔滈柛濠傜仛閹便劌螣閸濆嫯鍩為梺鍛娒顓㈠焵椤掑喚娼愭繛鍙夌墱缁辩偞绻濋崶鈺佺ウ闁瑰吋鐣崝宥団偓鐢靛Т椤法鎹勯搹鍦姽缂備線浜舵禍璺侯潖缂佹ɑ濯撮柛娑橈攻閸庢挾绱撴担鍓插剮缂佽埖鑹鹃悾鐑藉閿涘嫰妾梺鍛婄☉閿曘倝宕滈悷鎵虫斀閹烘娊宕愰弴銏犵疇闊洦绋掗崑鍌涚箾閹寸儑渚涢柣鏂挎閹娼幏宀婂妳闂佺楠哥换鎴﹀Φ閸曨垰鍗抽柣鏃囨閻撳姊洪崫鍕効缂傚秳鐒︽穱濠囧箹娴ｈ娅囬梺閫炲苯澧撮柟顔斤耿楠炴﹢顢欓悾灞藉箰?

            // 3. 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缂佺姷濞€閺岀喖骞戦幇闈涙闁荤喐鐟辩粻鎾诲箖濡ゅ懏鏅查幖绮光偓鎰佹交闂備焦鎮堕崝宥囨崲閸儳宓侀柡宥庣仈鎼搭煈鏁嗛柍褜鍓氭穱濠囨嚃閳哄啯锛忛梺璇″瀻娴ｉ晲鍒掗梻浣告惈閺堫剙煤濡吋宕叉繛鎴欏灪閸婇攱銇勯幒宥堝厡鐟滄澘鎳橀弻锝嗘償閿濆棗娈岄梺纭咁嚋缁辨洟骞戦姀銈呴唶闁靛鍎撮幗鏇㈡⒑閸濆嫭宸濋柛鐘虫尵缁粯銈ｉ崘鈺冨幈濡炪値鍘介崹鐢稿几濞戞ǚ鏀芥い鏃囧Г缁€鍫㈢磼?20 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犖ч柛銉㈡櫇閸樼娀姊绘担绋款棌闁稿鎳庣叅闁哄稁鍘肩壕濂告煏婵炑冨閺嬫垿姊洪崫鍕偓钘夆枖閺囥垹姹查柨鏂款潟娴滄粓鏌熼悜妯虹仴妞ゅ繆鏅濈槐鎺楁偐閻㈤潧绗￠梺闈涙搐鐎氭澘顕ｉ鈧畷鍫曗€﹂幋鐑嗘闂傚倷绀侀幉锟犲箹閳哄懎鐭楅柛鎰电厛濞兼牗绻涘顔荤盎鐎瑰憡绻傞埞鎴︽偐閹绘帗娈銈忚吂閺呯姴顫忛搹鍦煓婵炲棙鍎抽崜浼存煟鎼淬垹鍤柛鎾跺枛閵嗕礁顫濈捄浣曘劑鏌嶆潪鎷屽厡妞ゆ梹甯￠弻锝夊焺閸愩劎鐟愮紓浣插亾濞达綀娅ｇ粈濠傗攽閻樺弶鎼愮紒鐘崇墵閺屽秵娼幏灞藉帯闂佸搫妫寸粻鎾诲蓟濞戙垹唯闁瑰瓨鏌ㄦ禍楣冩⒑閻熸澘娈╃紒缁樼箓椤繒绱掑Ο璇差€撴繛鎾村嚬閸ㄦ娊宕濈粙娆炬富闁靛牆妫楅悘銉︿繆椤愶絿绠炴鐐插暢椤﹀綊鏌熼瑙勬珖闁归濞€瀹曪絾寰勭仦绋夸壕?
            // getEntitiesOfClass 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弴妤€浜惧銈庝簻閸熸潙鐣疯ぐ鎺濇晪闁告侗鍨版慨娲⒒娴ｄ警娼掗柛鏇炵仛閻ｅ墎绱撴担鎻掍壕婵犮垼鍩栭崝鏍磹閻㈠憡鐓ユ繝闈涙椤庢顭胯瑜板啴鍩為幋锔绘晩闁圭娴疯ぐ褔姊洪棃娑欐悙閻庢矮鍗抽悰顕€骞掑Δ鈧粻锝嗙節閸偄濮冮柣銉邯濮婄粯鎷呯憴鍕哗闂佺锕ラ悧鏇綖韫囨梻绡€婵﹩鍓涢崝锕€顪冮妶鍡楃瑨闁稿﹤缍婂畷鐢稿焵椤掑嫭鐓熼幖娣灩閸ゎ剟鏌涘Ο鎭掑仮闁炽儻绠撳畷褰掝敊閵壯冩灈闁诡喒鍓濋幆鏃堟晲閸モ晜鎲ｉ梻鍌氬€烽懗鍫曪綖鐎ｎ喖绀嬮柛顭戝亞閺嗭箓姊绘担铏瑰笡闁圭顭烽幃鐤槾婵″弶鍔欓獮鎺楀棘閸濆嫪澹曢梺鎸庣箓妤犲憡绂嶅鍕╀簻闁哄洨鍠撻惌鎺楁煛瀹€鈧崰鏍х暦濡ゅ懏鍋傞幖绮规濞兼岸姊绘担鍛婃儓闁活厼顦辩槐鐐寸瑹閳ь剙顕ｉ锕€绠涢柡澶婄仢缁愭稑顪冮妶鍡樺鞍缂佸甯為埀顒€鐏氶悧鐘差潖缂佹ɑ濯撮柧蹇曟嚀缁楋繝姊洪悡搴㈣础闁稿鎹囧鏌ユ嚋閻㈡娴勯柣搴秵娴滅偤顢欓崱娑欌拺缂備焦锕╅悞鐣岀磼椤曞懎鐏︾€规洜鏁婚獮瀣倷椤忓啰鐩庨梻浣侯攰閹活亞寰婃ィ鍏寰勬繛鎺旀嚀椤劑宕奸姀銏℃瘒闂備礁鎼惌澶岀礊娓氣偓閻涱喚鈧綆鍠楅弲鏌ユ煕濞戞ɑ鍣洪柟鐟版喘瀵鈽夊▎鎰妳闂佹寧绋戠€氬懓顦归柡宀嬬磿娴狅箓宕滆閸掓盯鎮楀▓鍨灍闁规瓕娅曟穱濠囧箹娴ｈ倽銊╂煏閸繃澶勯柡鍛偢濮婂宕掑▎鎴М闂佸湱鈷堥崑濠呮濡炪倖姊归崕鎶藉垂濠靛洨绠鹃柛鈩兩戠亸顓㈡煢?
            List<SkeletonTurret> allies = this.turret.level().getEntitiesOfClass(
                    SkeletonTurret.class,
                    this.turret.getBoundingBox().inflate(20.0),
                    // 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛濠傛健閺屻劑寮崹顔规寖闂佹椿鍘介悷鈺呭蓟閻斿吋鍊绘慨妤€妫欓悾鐑芥⒑缁嬪潡顎楅悗娑掓櫊婵＄敻宕熼姘敤濡炪倖鍔﹀鈧紒顔肩埣濮婅櫣绱掑Ο铏圭懆闂佽绻戝畝鍛婁繆閻㈢绀嬫い鏍ㄦ皑椤斿﹪姊虹化鏇炲⒉闁靛洨鍋炵粩鐔煎即閻斿墎绠氶梺缁樺姦娴滄粓鍩€椤戭剙娲﹂埛鏃堟煕閺囥劌浜介柣鏂挎閹便劌顪冪拠韫闂備胶鍋ㄩ崕鑽ょ不閹惧磭鏆﹂柛顐ｆ处閺佸棗顭跨捄渚剱婵炲懏鐗楃换婵嬫偨闂堟稐娌梺鎼炲妼閻栫厧鐣峰▎鎾村仭闁瑰啿锕ょ紞濠傜暦閻旂⒈鏁嶆繛鎴炶壘楠炴姊绘担铏瑰笡妞ゎ厼鐗婄粋宥夘敆閸曞﹤娲弫鍌炴偩瀹€鈧惁鍫ユ⒑闁偛鑻晶顖涚箾閻撳海绠婚柛鈺嬬節瀹曟﹢顢旈崟顓у斀婵犵數濮撮惀澶愬级鎼存挸浜鹃柡鍥ュ灩缁犵娀鏌熼悧鍫熺凡闁活厽顨婇弻鐔煎礈瑜忕敮娑㈡煟閹惧瓨绀嬮柡灞炬礃瀵板嫮鈧綆浜炴禒鎾煟鎼淬垹鍤柛鎾寸懇閸┿垽骞樺鍕瀹曘劑顢欑憴鍕伖闂傚倸鍊搁崐鎼佹偋婵犲嫮鐭欓柟鐑橆檪婢跺鐓ラ柛娑卞灣閿涙粎绱撻崒娆戝妽闁崇鍊濋、鏃堝醇椤愶絾娅旈梻浣瑰缁诲倸螞濡ゅ拋鏁嬮梺顒€绉甸悡娆戠棯閺夊灝鑸规鐐搭殜閺岋繝宕担绋款潻闂佸疇顫夐崹鍧楀箖濞嗘挸绾ч柟瀵稿С濡楁捇姊绘担钘夊惞闁革綇濡囧濠囧礈瑜忛惌澶愭煙閻戞ɑ澶勬俊顖氬閳规垿顢欑涵宄颁紣闂佸湱鈷堥崑鍛村疾閵夆晜鈷戦柟鑲╁仜閸斺偓闂佸憡鍔曟晶浠嬪焵椤掍礁鈻曟慨濠呮閹风娀骞撻幒婵嗗Ψ闂備胶鍘х紞濠勭不閺嶎厾宓佹俊銈傚亾妞ゎ厹鍔戝畷妤呭箻閸涱垳袦濡ょ姷鍋涘ú顓€侀弽顓熷殟闁靛闄勫鎴炵節閻㈤潧啸闁轰礁鎲￠幈銊р偓鐢电《閸嬫挸顫濋悡搴㈢彎閻庢鍠栭悥濂哥嵁閺嶃劍濯撮柛蹇擃槹鐎氬ジ姊绘担鍛婂暈缂佸鍨块弫鍐晝閸屾氨鍘愰梺鍝勬储閸ㄦ椽鎮￠悢鍏肩叆婵犻潧妫涢崙褰掓⒑椤撗冪仸闁哄本鐩崺鐐哄箚瑜屾竟鏇炩攽閿涘嫬浜奸柛濠冪墪椤斿繑绻濆顒傦紱闂佽鍎虫晶搴ｅ閼测晝纾藉ù锝呭帨濡劍銇勮箛鎾跺⒈闁轰礁顑夐弻銊モ攽閸♀晜笑闂佹悶鍔岄崐褰掑Φ閸曨垰绠涢柍杞拌兌娴煎嫮绱撴担鐟板闁稿鍊濆濠氭晲閸垻鏉搁梺鍝勬川閸嬫鍒掗懜鐢电瘈闁冲皝鍋撻柛灞剧矌閻撴捇姊虹拠鈥虫灆闁告娅曟穱濠囨倻閽樺鍘搁梺绋挎湰椤ㄥ棛鈧艾銈稿缁樻媴閸涘﹤鏆堢紓浣筋嚙閸婂鍩€椤掍礁鍤柛鐘崇墵閹椽顢橀悢铏圭槇闂佹眹鍨藉褎绂掗敂鐣岀闁稿繗鍋愰幊鍛存煃瑜滈崜姘跺礄瑜版帒绐楅柡宓啰銈梻鍌欑缂嶅﹪宕戞繝鍥х婵せ鍋撶€殿喓鍔戦幐濠冨緞閸℃ɑ鏉搁梻浣虹帛钃辩憸鏉垮暣椤㈡棃顢曢敂鐣屽幐婵犮垼娉涢鍡涘磹閹邦厽鍙忓┑鐘插暞閵囨繄鈧娲忛崝宥囨崲濠靛绀嬮柕濞垮労濞兼捇姊婚崒娆愵樂缂侀硸鍠氱槐鐐哄幢濡⒈娲稿銈呯箰閻楀棝寮伴妷鈺傜厓鐟滄粓宕滃璺何﹂柛鏇ㄥ灠缁犳娊鏌涢埄鍐︿沪濠㈣娲滅槐鎾诲磼濞嗘帒鍘＄紓渚囧櫘閸ㄥ爼寮€ｎ亶娓婚柕鍫濇缁岃法绱掗幓鎺戔挃闁逞屽墴濞佳囧Χ閹间胶宓侀柡宥庡弾閺佸洭鏌ｉ弬鎸庡暈闁绘繍鍋勯埞鎴︽偐閹颁礁鏅遍梺鍝ュУ椤ㄥ﹪寮崘顔肩厸闁告侗鍘奸崑宥嗙節闂堟稑鈧鈥﹂崼銉﹀€块柛顭戝亖娴滄粓鏌熼崫鍕棞濞存粓绠栭幃妤冩喆閸曨剙顦╅梺鍛婃尵閸犳牕鐣峰ú顏勎ㄩ柨鏇楀亾缂佸墎鍋ら弻鐔兼焽閿曗偓婢х増銇勯弮鈧敮鎺椻€旈崘顔嘉ч柛鈩冪懃椤囨⒑濞茶寮鹃柛鐘愁殘缁晠鎮㈤悡搴″祮闂佺粯鍔忛弲婊堝棘閳ь剟姊绘担铏瑰笡闁告梹鐗曢…鍥р枎閹炬潙鈧爼鏌ㄩ弴鐐测偓褰掓偂濞嗘挻鍊堕煫鍥ㄦ⒒婢ь剚绻涢崨顓燁棤缂佽鲸甯″畷鎺戭潩濮ｆ瑣鍨介弻宥囨嫚閺屻儱寮板Δ鐘靛仜椤戝顕ｉ浣哥窞缂佸顑欏Λ婊堟⒒閸屾艾鈧悂宕愰幖浣瑰亱濠电姴瀚惌娆撴煙閻戞ê鐓€闁兼澘娼￠弻鐔封枔閸喗鐏撶紒鐐劤閵堟悂寮诲☉姘勃闁绘劦鍓涘▓銈夋煛娴ｅ摜澧︽慨濠冩そ瀹曠兘顢橀悙韫帛婵犵數濮崑鎾绘⒑椤掆偓缁夊绮婚悢鍏肩厵缂備降鍨归弸娑氱磼閳ь剛鈧綆鍋佹禍婊堟煙閹规劖纭鹃柡瀣灦閵?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯锋嫼閻熸粎澧楃敮鎺撶娴煎瓨鐓曢柟鎯ь嚟閹冲洭鏌熼鈧褑鐏掗梺鐓庮潟閸婃鎯侀崼銉︹拺闂傚牊鐩悰婊呯磼閹绘帒鈷旀繛鎴犳暬閹瑩顢栭崣銉х泿闂備焦瀵уΛ渚€顢氳閹﹢鏁冮崒娑氬幍濡炪倖鐗楅悷褔藝閿斿浜滄い鎾寸矊婵倻鈧娲栭妶鎼佸箖閵忋倕浼犻柛鏇ㄥ亝鏉?
                    other -> other != this.turret && other.isAlive() && other.getTarget() != null
            );

            if (allies.isEmpty()) return false;

            // 4. 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亜顒㈡い鎰矙閺屻劑鎮㈤崫鍕戙垻绱掗埀顒勫醇閻旇櫣顔曢梺绯曞墲閿氶柣蹇婃櫊閺岋綁顢橀悢绋跨３闂佸搫澶囬崜婵嗩嚗閸曨厸鍋撻敐搴濈敖闁告梹鎮傚娲传閵夈儲鐎婚梺鐟板暱闁帮綁宕洪悙鍝勭闁挎棁妫勬禍褰掓倵鐟欏嫭绀€婵炴潙鍊垮鎶芥晸閻樻枼鎷洪梺瑙勫劶婵倝寮柆宥嗙厵闁荤喓澧楅崰妯尖偓娈垮枛椤兘寮幇顓炵窞濠电姴鍠氬Λ鐔兼⒒娴ｇ顥忛柣鎾崇墦瀹曟澘顪冮崜褎妲€闂傚倸鍊搁崐椋庣矆娓氣偓楠炲鏁撻悩鎻掔€柣鐔哥懃鐎氼喚绮绘ィ鍐╃厓鐟滄粓宕滈悢鐓庤摕闁挎稑瀚▽顏堟偣閸ャ劌绲绘い顒€鐗撳铏光偓鍦У椤ュ銇勯敂璇茬仴闁诲繑甯″娲礂閼测斂鍋為梺鍝勬噺閻熝兾ｉ幇顑╃喖鎳￠妶鍥╂闂備焦鐪归崹钘夘焽瑜戦埅鎾⒒娴ｄ警鐒炬い鎴濇楠炴垿宕堕鈧拑鐔哥箾閹寸們姘ｉ崼鐔剁箚妞ゆ牗鑹鹃幃鎴︽煙閹绘帇鍋㈡慨濠呮缁瑩宕归鍛Ψ闂備焦鎮堕崝灞筋焽閿熺姷宓侀柛鎰╁壆閺冨牆宸濇い鏃囧Г閻濇娊姊洪崷顓炲付闁宦板妿閹广垽宕熼姘€梺鍝勭▉閸樹粙鍩涢幋锔界厱婵犻潧妫楅顏呫亜閵夛妇鐭掗柡灞诲姂瀵潙螣鐞涒€充壕婵犻潧妫撮懓鍨€掑锝呬壕濠殿喖锕ㄥ▍锝囨閹烘嚦鐔煎礂閻撳孩鐏曢梻鍌欒兌椤牓顢栭崱娑樼闁搞儺鍓欓拑鐔哥箾閹存瑥鐏╃紒鐘差煼閹妫冨☉娆忔殘闂侀潻鎬ラ崶銊㈡嫼闂佸湱顭堢€涒晝澹曢幖浣圭厱闁靛鍊楅惌娆撴煏閸℃洜绐旂€殿噮鍣ｅ畷鐓庘攽鐎ｎ亝鏆┑鐘垫暩婵炩偓婵炰匠鍥ㄥ亱婵犲﹤鐗嗙憴锕傛倵閿濆骸鏋熼柍閿嬪笒闇夐柨婵嗘川閹藉倹绻涢崗鐓庡闁哄本绋掗幆鏃堝灳閾忣偅鐦ｉ梻浣瑰濞插繘宕归挊澶屾殾闁跨喓濮甸崐鐑芥煃閸濆嫬鈧粯绂?
            for (SkeletonTurret ally : allies) {
                // 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙闁诡垳鍋ら獮鏍庨鈧俊濂告煟椤撶噥娈滄鐐寸墪鑿愭い鎺嗗亾濠德ゅ亹缁辨帡骞囬褎鐤侀梺鍝勭焿缁绘繂鐣烽崼鏇炵厸濞达絽娴勭徊鍧楀焵椤掑喚娼愭繛鍙夌墪椤曪綁宕奸弴鐐电杽闂侀潧顭堥崕娆撴偄閻撳海顔囬柟鑹版彧缁插鍩€椤掍礁濮嶆慨濠冩そ瀹曘劍绻濋崟顒€娅戦梻浣瑰濞插繘宕曢崹顐＄箚闁汇垻顭堢粈瀣亜閺嶃劏澹橀柛鐐姂濮婃椽妫冨ù銈嗙洴瀹曘劑顢涘☉娆樺晫濠电姷鏁告慨鐑藉极閹间礁纾绘繛鎴欏灪閸嬪鈹戦悩鎻掓殶闁绘繂鐖奸弻娑㈠焺閸愵亖妲堥梺缁樺笒閻忔岸濡甸崟顖氱闁糕剝銇炴竟鏇熺節閻㈤潧袥闁稿鎹囧娲敆閳ь剛绮旈鈧崺鈧い鎺戯功閻ｇ數鈧娲栭妶鎼佸极閹版澘绀冪憸搴ㄦ儓韫囨挴鏀介柣姗嗗枛閻忚鲸绻涙径瀣灱閻?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲梺姹囧€ら崰妤呭Φ閸曨垰绠涢柍杞拌兌閸旀挳姊洪幖鐐测偓鏍洪悢鐓庤摕婵炴垯鍩勯弫鍐煥濠靛棙顥滄い锔规櫊濮婄儤娼幍顕呮М濠碘槅鍋呴悷鈺呯嵁閸儱惟闁宠桨鐒﹀畵宥咁渻閵堝棙灏靛┑顔芥尦瀹曟瑩鎮ら埡鍛拻闁稿本鑹鹃埀顒佹倐瀹曟劖顦版惔锝囩劶婵炴挻鍩冮崑鎾搭殽閻愬澧垫い銏℃礋閺佸啴鍩€椤掑嫭鍋い鏂款潟娴滄粓鏌熼弶鍨暢缂佸绮换娑㈠川椤栨埃鏋呭Δ鐘靛仦閻楁洝褰佸銈嗗坊閸嬫挸鈹戦檱閸嬫劙鎯€椤忓牆绠氱憸婊堟偂婵傚憡鐓涢悘鐐电《閸嬫捇骞囨担鍛婂€梺纭呭亹鐞涖儵鍩€椤掆偓绾绢參顢欓幇鐗堚拻濞达綀顫夐妵鐔兼煕濡湱鐭欓柕鍡楀暣瀹曘劑骞嶉鑽ょ秿濠电姷顣藉Σ鍛村磻婵犲洢鈧倿鏁冮埀顒勬箒闂佹悶鍎洪崜娆戠矆閸屾壕鍋撻崗澶婁壕闂佸憡娲﹂崗姗€骞忕紒妯肩瘈闁靛骏绲剧涵楣冩煥閺囶亪妾柣妤€娴风槐鎾诲磼濞嗘帒鍘＄紓渚囧櫘閸ㄥ爼骞嗛崟顖ｆ晬婵椴稿▓楣冩⒑缂佹ɑ灏紒銊ョ埣瀵劍绂掔€ｎ偆鍘甸梻渚囧弿缁犳垶鏅堕娑栦簻闁哄倽娉曟牎缂備胶绮换鍫ュ箖娴犲顥堟繛鎴烆殘閹规洟姊绘担铏瑰笡妞ゃ劌鎳橀弫鍐敂閸曨厽娈鹃悷婊呭鐢帡鏌ㄩ妶鍡曠箚闁靛牆鍊告禍楣冩⒑閽樺鏆熼柛鐘崇墵瀵鈽夊Ο閿嬵潔濠电偛妫欓崝妤冪矙閸ヮ剚鈷戦柛娑橈功閹冲啴鏌ㄩ弴銊ら偗闁诡噯绻濋、鏇㈡晝閳ь剟鎮欐繝鍥ㄧ厪濠电姴绻愰々顒併亜閿斿搫鍔ょ紒杈ㄦ尰閹峰懐鎲撮崟銊﹀闂備礁鎲￠…鍡涘幢濞嗗海鑳洪梻鍌氬€烽懗鍓佸垝椤栫偞鏅濋柕蹇曞閻掔晫鎲告惔锝囩焿闁圭儤鍩堥悡銉╂煕濞戝彉绨诲ù婊呭亾缁绘盯宕煎┑鍫滆檸闂佸搫顑戠粻鎾诲蓟濞戙垹鐓涢柛灞剧矊閳峰牏绱撴笟鍥ф灀闁哄懐濞€楠炲啴濮€閵堝棗浜楅柟鍏肩暘閸斿矂寮ぐ鎺撯拻濞撴埃鍋撴繛浣冲毝銊╁焵椤掑嫭鈷掗柛鏇ㄥ亜椤忊晠鏌嶇拠鑼х€殿喕绮欓、姗€鎮㈢亸浣镐壕闁汇垹鎲￠悡鏇㈢叓閸ャ劍鎯勬俊鑼焾闇夋繝濠傜墢閻ｇ儤鎱ㄦ繝鍐┿仢鐎规洏鍔嶇换婵嬪磼濮樺吋缍傞梻鍌欑閹碱偊骞婃径鎰柧婵犲﹤鎳愰惌澶愭煙閻戞﹩娈曢柣鎺曞亹閳ь剙绠嶉崕鍗炍涘畝鍕闁惧繐婀辩壕浠嬫煕鐏炲墽鎳呴柛鏂跨Ч閺屻劌顫濇潏鈺冿紲濠碉紕鍋熺划顖氣枍閸℃瑧纾肩紓浣诡焽閳洜鈧灚婢樼€氼噣鍩€椤掑﹦绉甸柛蹇斏戦幈銊╁炊椤掍讲鎷洪梺鍛婄箓鐎氼參宕宠ぐ鎺撶厽闁哄诞浣镐划濡ょ姷鍋涢崯鎾春閿熺姴绀冩い蹇撴４缁卞弶绻濆▓鍨灍妞ゃ劌鎳庤灋婵炲棙鎷叉径鎰唶闁靛鑵归幏缁樼箾閹炬潙鐒归柛瀣尰缁绘稒鎷呴崘鍙夊櫤鐎规洘鐓￠弻娑㈠焺閸愵亖妲堢紓浣插亾闁割偆鍠撶弧鈧梻鍌氱墛缁嬫挻鏅堕姀鐘闁规儳纾晥闂佸搫鐬奸崰鏍箖濠婂喚娼ㄩ柛鈩冾焽閺嗭箓姊绘担铏瑰笡闁圭顭烽幃鐑藉煛閸涱叀鎽曢梺鎸庣箓椤︻垳绮婚敐澶嬬厽闊洦姊归妵鐔访瑰鍕煉婵犫偓娴ｅ壊娓婚柕鍫濇閳锋帡鏌￠崪浣镐簽缂侇喚绮妶锝夊礃閳哄啫骞堟繝鐢靛仦閸ㄩ潧鐣烽鈧锝夘敋閳ь剟寮诲☉妯锋瀻闊洦鎼╂导鍐⒑?
                if (this.turret.ownerUUID != null && ally.ownerUUID != null && !this.turret.ownerUUID.equals(ally.ownerUUID)) {
                    continue; // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓闁搞劌鍊块弻娑㈩敃閿濆棛顦ョ紓浣哄С閸楁娊寮诲☉妯锋斀闁告洦鍋勬慨銏ゆ⒑濞茶骞楅柟鐟版搐椤繑绻濆顒勫敹闂佺粯鏌ㄩ崲鏌ョ嵁韫囨稒鈷戦柟绋挎捣缁犳挻銇勯敂璇茬仩妞ゆ柨绻愰埞鎴﹀幢韫囨梹鏉搁梻浣虹帛钃辩憸鏉垮暣椤㈡棃濡舵径瀣幐闁诲函缍嗛崑鍡樻櫠閸偅鍙忓┑鐘插暞閵囨繈鏌＄仦鑺ュ殗闁诡喗鐟╅幊鐘垫崉娓氼垯绱旀繝鐢靛Л閹峰啴宕掑顒傘偖闂備礁鎼懟顖滅矓閻戦摪銊︾瑹閳ь剟寮诲☉銏犵閻庨潧鎽滈悿鍕⒑閹稿海绠橀柛瀣仜椤曘儵宕熼鍌滅槇闂婎偄娲﹂崺鍐磻閹捐閿ゆ俊銈勮兌閸樹粙姊虹紒妯荤叆闁告艾顑囧▎銏ゅ煛閸愨晛鏋戦柟鑲╄ˉ濡插懘宕靛Δ鍛厱闁哄洢鍔岄悘鐘电磼閻樺磭鈯曢柕鍥у楠炴鎹勯悜妯尖偓楣冩⒑缂佹绠ラ柛瀣工椤繘鎼圭憴鍕彴闂佽偐鈷堥崜娑㈩敊婵犲洦鈷戠紒瀣儥閸庢垵鈹戦悙鈺佷壕闁诲氦顫夊ú姗€宕归崸妤冨祦闁搞儺鍓氶崑瀣煕椤愶絿绠戦柣銏㈢帛缁绘繈鎮介棃娑掓瀰濠电偘鍖犻崶鑸垫櫈闂佺硶鍓濈粙鎴犲婵犳碍鐓忓┑鐘茬箺缁€瀣瑰鍕煉闁哄备鈧剚鍚嬮柛銉ｅ妽濮ｅ嫰姊洪崨濠傜瑐闁告濞婂濠氭晬閸曘劌浜鹃柨婵嗛娴滅偤鏌曢崱妯虹缂?
                }

                LivingEntity allyTarget = ally.getTarget();

                // 5. 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柤纰卞墻濡茬兘姊绘担鍛婃儓婵炲眰鍔嶉幈銊╂倻閼恒儱鍓归梺鐟板⒔缁垶鎮￠悢鍏肩厪闊洦娲栧瓭濡炪們鍎辩换姗€寮婚埄鍐╁缂佸瀵у▓濠氭⒑閸濆嫯顫﹂柛濠冩礋濠€渚€鏌ｆ惔顖滅У闁稿鎳橀幃鐢稿即閵忊檧鎷虹紓浣割儓濞夋洜绮婚懠顒傜＜妞ゆ棁鍋愭晥婵犵绱曢弫璇茬暦閻旂⒈鏁嶆慨妯夸含濞煎姊绘笟鈧埀顒傚仜閼活垱鏅剁€涙ǜ浜滈柕蹇ョ磿婢ь亪鏌嶇拠鏌ュ弰妤犵偞顭囬埀顒€婀辨慨宀勫即閵忊檧鎷洪梺纭呭亹閸嬫盯宕濋幘顔界厱闁规儳顕幊鍛存煟閵夘喕娴锋い锕€缍婇弻锛勪沪閻ｅ睗褏鈧娲﹂崑濠傜暦閻旂⒈鏁冮柣鏃囨腹婢规洘绻濋悽闈浶ｉ柤鐟板⒔缁鎮╃仦鍌楀亾閹烘埈娼╅柨婵嗘噸婢规洘绻濆▓鍨灈闁挎洏鍎遍—鍐寠婢跺本娈鹃梺鎸庣箓濡娆㈤悙纰樺亾閸忓浜鹃梺閫炲苯澧撮柟顔瑰墲瀵板嫰骞囬娑欏闂佽崵濮村ú鐘诲焵椤掆偓绾绢厽绂掗埡鍛厽閹兼番鍨婚悡顖炴煕濡や礁鈻曞┑鈥崇摠閹峰懐鍖栭弴鐔衡偓濠氭⒑閸︻厼浜炬繛鍏肩懄缁傛帗绺介崨濠勫幗闂婎偄娲﹀ú鏍ㄧ瑜旈弻锟犲椽娴ｉ晲绨奸柣搴ㄦ涧閵堢鐣烽崼鏇ㄦ晢濞达絽寮剁€氳棄鈹戦悙鑸靛涧缂佽弓绮欓獮澶愭晸閻樿尙鐣鹃梺鍓插亖閸庢煡宕愰崹顐ｅ弿婵☆垰鎼懜褰掓煕濡警鍤熼柍褜鍓濋～澶娒洪弽顐ょ濠电姴娲㈤埀顑跨閳藉顫滈崱娆忓汲闂備礁鎲℃笟妤呭垂閹惰棄姹查柕澶堝劗閺€浠嬫煟濮楀棗鏋涢柣蹇涗憾閺屾盯鍩￠崒婊冣拰閻庤娲樼换鍫濐嚕閹绢喖顫呴柣妯兼暩閸橆剙鈹戦悩鍨毄濠殿喗鎸冲畷顖炲Ω閿旂虎娲稿┑鐘诧工閻楀﹪鎮″☉姘ｅ亾楠炲灝鍔氶柛鐕佸亝娣囧﹪骞愭惔娑楃盎闂佹寧绻傚Λ娑㈠矗閳ь剟姊洪崫鍕拱缂佸甯為幑銏犫槈閵忕姴鐎銈嗘⒒閹虫挻绂嶆ィ鍐╃厸鐎广儱楠告禍婵堚偓瑙勬礀瀵墎鎹㈠☉銏犵闁绘劕鐏氶崳褏绱撴担绋款暢闁稿鍊濋獮鍐ㄎ旈崨顔芥珳闁硅偐琛ラ埀顒冨皺閺佹牗淇婇悙顏勨偓褏鈧潧鐭傚畷銏＄附缁嬭法鍘撮梺纭呮彧闂勫嫰宕愰悜鑺ョ厾缁炬澘宕晶顔姐亜閵堝倸浜鹃梻鍌氬€烽悞锕傚箖閸洖绀夌€光偓閸曨剙鈧埖绻濋棃娑卞剾闁轰礁顑夐弻銊モ攽閸♀晜鈻撻梺杞扮閸熸挳寮婚弴銏犻唶婵犻潧妫禒楣冩⒑閸涘﹥绀€闁哥喐娼欓～蹇涙惞閸︻厾鐓撻柣鐘充航閸斿酣顢欓幋锔解拺缂佸顑欓崕鎰版煕閺冣偓濞茬喖宕?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲梺姹囧€ら崰妤呭Φ閸曨垰绠涢柍杞拌兌閸旀挳姊洪幖鐐测偓鏍洪悢鐓庤摕婵炴垯鍩勯弫鍐煥濠靛棙顥滄い锔规櫊濮婄儤娼幍顕呮М濠碘槅鍋呴悷褔骞戦姀鐘闁靛繒濮烽鍝勨攽閻愬弶顥滅紒缁樺笚缁傛帗銈ｉ崘鈹炬嫼闂佽鍎兼慨銈夊极闁秵鐓欓柣鐔哄閸犳鈧鍠栭…鐑藉极閹邦厼绶炲┑鐘插枤濡喖姊绘担绋款棌闁绘挸鐗撳畷鏉款渻閸撗勬闂傚倸鍊搁崐椋庣矆娓氣偓楠炲鏁撻悩鎻掔€柣鐔哥懃鐎氼喚绮绘ィ鍐╃厓鐟滄粓宕滈悢鐓庤摕闁挎稑瀚▽顏堟煕閹炬せ鍋撴俊鎻掔墦濮婅櫣鈧湱濯崵娆撴⒑鐢喚绉柣娑卞櫍瀹曞爼顢楁径瀣珜闂備胶顭堥張顒勬偡閿曞倸纾婚柛娑樼摠閳锋帡鏌涚仦鍓ф噮妞わ讣绠撻弻鐔哄枈閸楃偘鍠婇梺鐟扮－閸犳牠銆佸☉銏″€烽柛顐ｇ箖閸犳﹢鏌熼鑽ょ煓鐎规洦鍋婃俊鐑藉Ψ瑜嬮崑濠囨⒑鐠囨煡顎楃紒鐘茬Ч瀹曟洟鏌嗗畵銉ユ喘椤㈡稑顭ㄩ崨顒傜憹濠电姷鏁告慨鐢靛枈瀹ュ鍋傞柣鏂垮悑閻撶喖鏌￠崒娑橆嚋闁诡垰鐗婇妵鍕晲閸涱厽鍊梺闈涙搐鐎氭澘顕ｉ鍕閹肩补鍓濋悘搴ㄦ⒒娴ｇ瓔鍤冮柛鐘愁殜閵嗗啯绻濋崒婊勬闂佺粯鍨归悺鏃堝极閸モ晜鍠愰煫鍥ㄧ☉缁€澶愭煙闂傚鍔嶉柛瀣у墲缁绘繃绻濋崒姘间痪缂備浇娉涘鍫曞Φ閸曨垱鏅滈悹鍥皺娴狀參姊?
                if (this.canAttack(allyTarget, net.minecraft.world.entity.ai.targeting.TargetingConditions.DEFAULT)) {
                    this.potentialTarget = allyTarget;
                    return true; // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缂佺姷濞€閺岀喖宕滆鐢盯鏌涙繝鍛厫闁逛究鍔岃灒闁圭娴烽妴鎰磼閻愵剙鍔ゆ繛纭风節瀵鎮㈤悡搴ｇ暰闂佺粯顨呴悧婊兾涢崟顖涒拺闁告繂瀚銉╂煕鎼达絾鏆鐐插暙椤粓鍩€椤掑嫬绠栨繛鍡樻尭缁犵敻鏌熼崫鍕棡閻庡灚鐗楁穱濠囨倷椤忓嫧鍋撻幇鏉跨柧婵犲﹤鐗婇崑鍌炴煥閻斿搫孝闁藉啰鍠愮换娑㈠箣濞嗗繒浠奸梺缁樻惈缁绘繈寮诲☉銏犵労闁告劗鍋撻悾鍓佺磽娴ｅ搫鞋鐎规洜鏁稿Σ鎰板箳濡や礁鈧攱銇勯幒鍡椾壕闂佸憡鏌ｉ崐婵嬪蓟閺囥垹閱囬柣鏃傤焾閳ь剚鍔楅埀顒侇問閸犳盯顢氳閸┿儲寰勬繝搴ｅ弳闂佸憡渚楅崹鍗烆熆閹达附鈷掑ù锝呮啞鐠愶繝鏌涚€ｎ偅宕岀€规洘绮岄～婵嬵敇閻欌偓濞村嫰姊洪崗鑲┿偞闁哄懏绻勬竟鏇㈡寠婢规繂缍婇弫鎰板幢濡ゅ啩鍠婇梻浣告啞閸戝綊宕戞繝鍥ц摕闁斥晛鍟刊瀵哥磼濞戞﹩鍎忔繛鍫弮濮婄儤瀵煎▎鎴炲仹闂佺绻戦敃銏ょ嵁閸愵煈鐓ラ柛顐ゅ枎閻у嫭绻濋姀鐘插辅闁哄倷绶氬鏌ユ偐鐠囪尪鎽曢梺闈浥堥弲娑㈠础閾忣偂绻嗛柕鍫濆€告禍鐐箾鐎涙鐭掔紒鐘崇墪椤繐煤椤忓嫮鐤€婵炶揪缍侀ˉ鎾诲极閺嶎厽鈷戦弶鐐村椤︼附銇勯鐘插幋闁绘侗鍣ｅ畷姗€濡告惔銏☆棃鐎规洏鍔戦、娆撴⒒鐎靛憡鏆伴梻鍌氬€风粈渚€骞栭位鍥箥椤旂懓浜剧紒妤佺☉濞诧箓宕愰崼鏇熺厸闁搞儮鏅涘暩缂佺偓宕樺Λ鍕箒闂佹寧绻傜€氼噣鎯屽▎鎾寸厱婵犻潧锕ラ鐘电磼鏉堛劌绗ч柟椋庡█閹崇娀顢楅埀顒勫焻閻㈠憡鈷戠紓浣姑肩欢閬嶆煕閻樺啿鍝洪柛鈹惧亾濡炪倖甯掗敃锔剧矓閻㈠憡鐓曢柣妯虹－婢ц京绱掗纰辩吋闁轰焦鍔欏畷鍗炩枎閹寸姵顫屾繝鐢靛Х閺佸憡鎱ㄩ幘顔肩９鐟滅増甯掗梻顖炴煠閹帒鍔欑紒璇叉閺岀喓绱掑Ο铏诡儌缂備胶濮撮…鐑藉蓟閳ュ磭鏆嗛悗锝庡墰琚﹂梻浣筋嚃閸犳捇宕归挊澶屾殾闁靛濡囩弧鈧梺鍛婃礀婢у酣鐛姀銈嗏拻闁稿本鐟ㄩ崗宀€绱掗鍛仯闁轰緡鍣ｉ、鏃堝醇閻斿弶瀵栭梻浣告啞濞诧箓宕规导瀛樺仾濡わ絽鍟悡鏇熴亜閹板墎绋荤紒鈧崘顔界厸闁告侗鍠氱粻鐐烘煛鐏炲墽銆掑ù鐙呯畵瀹曟粏顦┑顔兼搐閳?
                }
            }

            return false;
        }

        @Override
        public void start() {
            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋敐鍛濠电姷顣换婵嗩焽瑜戦悘鎺楁⒑閸忚偐銈撮柡鍛箞閹偤宕楅懖鈺冾啎闂佸湱鍋撳娆撴倿瑜版帗鐓曢悗锝庡亝瀹曞矂鏌″畝鈧崰鏍€佸▎鎾崇畾鐟滃本绔熼弴銏♀拺闂傚牊绋撴晶宕囩磽瀹ュ嫮顦﹂柣锝呭槻椤粓鍩€椤掑嫬鏄ラ柍鈺佸暞婵绱掔€ｎ偒鍎ユ俊顐㈡缁绘繄鍠婃径宀€锛熼梺绋款儐閸ㄥ灝鐣烽幇鏉垮唨鐟滄粌顭囬弽褉鏀介柣妯虹枃婢规﹢鏌ｉ妶鍥т壕闁靛洤瀚伴獮鍥礈娴ｇ儤娈搁梻浣规偠閸斿矂宕愰幖浣哥厴闁硅揪绠戠壕鍏兼叏濮楀棗骞栭柡鍡楃墦濮?
            this.turret.setTarget(this.potentialTarget);
            super.start();
        }

        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柤纰卞墻濡茬兘姊绘担鍛婃儓婵炲眰鍔嶉幈銊╂倻閼恒儱鍓归梺鐟板⒔缁垶鎮￠悢鍏肩厪闊洦娲栧瓭濡炪們鍎辩换姗€寮婚埄鍐╁缂佸瀵у▓濠氭⒑閸濆嫯顫﹂柛濠冩礋濠€渚€鏌ｆ惔顖滅У闁稿鎳橀幃鐢稿箳濡や讲鎷虹紓鍌欑劍閿氱紒妤佸浮閺屻劑寮村Ο琛″亾濠靛棴鑰垮〒姘ｅ亾婵﹥妞介獮鎰償閿濆洨鏆ゆ繝鐢靛仜閻即宕濋幋锔惧祦婵°倕鎳庣壕鍏肩箾閹寸儐娈樼紒鐘宠壘椤啴濡堕崱妤€顫囬梺鎼炲妽濡炶棄鐣烽悽绋跨倞妞ゆ帊鑳堕崢闈涱渻閵堝棙鈷掗柣鈩冩煥閳绘挸顭ㄩ崼鐔哄幍濡炪倖姊归崕鎶藉储閹绢喗鐓涢悘鐐跺Г閸犳﹢鏌℃担绋库偓鍨暦閿濆鏁冩い鎺戝€婚弳銈呪攽椤旂》鏀绘俊鐐舵閻ｇ兘濡搁敂鍓х槇闂佸憡娲﹂崜娆忊枍閹寸姷纾介柛灞剧懆閸忓瞼绱掗鍛仸鐎规洘绻傞～婊堝焵椤掑嫬绠栨俊顖氱毞閸嬫捇鏁愭惔鈩冪亶闂佹娊鏀遍崹鍨潖濞差亶鏁冮柕鍫濇噸缁爼姊洪崗鍏笺仧闁搞劑浜跺鏌ュ礈娴ｆ彃浜鹃柣銏㈡暩閵嗗﹪鏌涚€ｎ偅灏柍缁樻崌瀹曞綊顢欓悾灞奸偗濠碉紕鍋戦崐銈夊矗閸愵喖缁╅弶鍫涘妿閳瑰秴鈹戦悩鍙夊闁稿﹨宕电槐鎺戔槈濮楀棗鍓遍梺鍝勬媼閸撴瑩鍩為幋锔藉亹閻犲泧鍐х矗闂備胶鎳撻崲鏌ヮ敄閸涱厼绁┑锛勫仜椤戝懎霉妞嬪骸顥氶柦妯侯棦瑜版帗鏅插璺虹灱缁愭鈹戦敍鍕壕闁诡喖鍊垮璇测槈濡攱鐎婚棅顐㈡处缁嬫垵顕ｆ导瀛樺€甸悷娆忓绾惧鏌涘Δ鈧崯鍧楊敋閿濆绠绘い鏃囨娴滃綊姊洪崨濠傚鐟滄澘鍟伴懞閬嶅Ψ閿斿墽鐦堝┑鐐茬墕閻忔繈寮搁悢鍏肩叆闁哄洦顨嗗▍濠勨偓瑙勬磸閸ㄦ椽濡堕敐澶婄闁靛ě鍐ㄧ闂傚倷绀侀幖顐﹀疮椤愶箑纾归柣銏㈩焾绾惧鏌熼幑鎰惞鐎规挷绶氶弻娑⑩€﹂幋婵囩亪婵犳鍠栭柊锝夊蓟閿濆棙鍎熼柕蹇曞Т濮ｅ牓姊洪崫銉バｆ慨妯稿姂瀹曟岸骞掑Δ浣规珳闂佸憡绋戦崐鐟拔涢崘銊ф殾闁靛ň鏅╅弫濠囨⒒閸屾稒缍戦悗鍨叀濮婂宕掑▎鎴濆闂佽鍠栭悥鐓庣暦閺囥垹绾ч柟瀛樻⒐閻忓啫鈹戦悙鏉戠仧闁搞劍妞藉畷鎰板醇閺囩喓鍘介梺鍝勫€圭€笛囧箟閸濄儳纾奸柍閿亾闁稿鎸剧槐鎾存媴缁嬪簱鎸冩繝鈷€鍕垫疁闁轰礁顑嗙换娑氣偓娑欘焽閻帞绱掗悩宕囧ⅹ妞ゎ偄绻掔槐鎺懳熺拠宸偓鎾绘⒑閸涘﹦鈽夐柨鏇樺€濆鎶藉醇閵夛腹鎷洪梺鐓庮潟閸婃洟寮搁崒鐐寸厱閹艰揪绲鹃弳顒勬煏閸℃洜绐旂€殿喕绮欓、姗€鎮欓懠顒傚春闂傚倷绀侀幖顐λ囨导鏉戝瀭鐟滅増甯掗拑?
        @Override
        protected boolean canAttack(@Nullable LivingEntity target, net.minecraft.world.entity.ai.targeting.TargetingConditions targetPredicate) {
            if (target == null) return false;
            // 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻锝夊箣閿濆憛鎾绘煕婵犲倹鍋ラ柡灞诲姂瀵噣宕掑顐㈩棜闁诲氦顫夊ú姗€鎮￠敓鐘茶摕婵炴垶顭囬弳鍡涙煃瑜滈崜鐔风暦閺囥垹绠涢柡澶嬪閻庮剟鏌ｆ惔顖滅У闁稿鐒︾粋宥咁煥閸喓鍘搁梺鍛婂姂閸斿矂鍩€椤掑倹鍤€闁宠绉瑰鎾閿涘嫬甯楃紓鍌氬€烽悞锕佹懌闂佹娊鏀辩敮锟犲蓟瀹ュ牜妾ㄩ梺鍛婃尰閻熝呭垝鐠囧樊鍚嬪璺猴功閿涚喖姊绘笟鍥у缂佸鏁诲畷鎴犫偓锝庡枟閻撴洟鏌嶉埡浣告殶闁宠棄顦甸弻娑氫沪鐠囨彃顫囬梺鍝勭灱閸犳挾妲愰幒妤€顫呴柣妯虹－娴滃爼姊绘担铏瑰笡闁圭顭烽幆鍕敍閻愯尪鎽曢悗骞垮劚閻楁粌顬婇妸鈺傗拺闁告稑锕ョ亸浼存煟閳哄﹤鐏﹂柣娑卞枦缁犳稑鈽夊▎蹇庢睏闂佽崵濮村ú鈺冧焊濞嗘搩鏁婄€光偓閸曨兘鎷洪梺闈╁瘜閸樺ジ宕濈€ｎ喗鐓欓柛娑橈工閸斻倝宕℃潏銊﹀弿婵☆垰鐏濋悡鎰版煃闁垮绗掗棁澶愭煥濠靛棙鍣洪悹鎰ㄥ墲缁绘繈鍩€椤掍胶顩烽悗锝庡亞閸橀亶姊洪崫鍕偓钘夆枖閺囥垺鍊堕梺顒€绉甸悡鍐喐濠婂牆绀堟慨妯挎硾缁€鍕喐閻楀牆绗掔紒鈧崼銉︾厽闁哄啫娲ゆ禍鍦偓瑙勬尫缁舵岸寮诲☉銏犵疀闂傚牊绋掗悘鍫ユ⒑閸涘娈曞┑鐐诧躬瀵寮撮敍鍕澑闂佸搫娲ㄩ崐顐﹀Ψ閿旇桨绨婚梺闈涚箳婵敻宕甸崶銊﹀弿濠电姴鍟妵婵堚偓瑙勬处閸嬪﹤鐣烽悢纰辨晢闁稿本锚娴滆绻濋悽闈涗粶闁宦板妿閸掓帗鎯旈妸銉э紱闂佺粯鏌ㄩ幖顐﹀垂?
            if (target instanceof Player && target.getUUID().equals(this.turret.ownerUUID)) return false;
            if (target instanceof SkeletonTurret) return false;
            if (target instanceof IronGolem) return false;
            if (target.getPersistentData().getBoolean("IsFriendlyZombie")) return false;
            if (target.getPersistentData().getBoolean("IsFriendlyCreeper")) return false;

            return super.canAttack(target, targetPredicate);
        }
    }


    // ==========================================
    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱樈閸犳顕欏ú顏呪拺缂侇垱娲栨晶鍙夈亜閵娿儲鍤囬柨婵堝仱椤㈡洟鍩楅埡鍌涙澑婵＄偑鍊栧ú鏍涘☉銏犵濞寸厧鐡ㄩ悡鐔镐繆閵堝嫮鍔嶉悘蹇ｅ幗閵囧嫰顢曢姀銏㈩唹缂備胶绮换鍌烇綖濠靛鏁嗛柛灞诲€栬ⅷ婵犵绱曢崑鎴﹀磹閺囩姵宕查柟閭﹀枓閸嬫挸顫濋悡搴＄睄闂佽鍠楄摫缂佹鍠栭崺鈧い鎺嗗亾妞ゎ偄绻掔槐鎺懳熼懖鈺傚殞闂備焦鎮堕崕婊堝礋椤撴繈鍋楁繝纰夌磿閸嬫垿宕愰弽顬℃椽鏁冮崒姘亶闂佽鍨奸悘娑㈡晲婢跺﹦鐤€闂佸搫顦冲▔鏇㈩敊婵犲倵鏀介幒鎶藉磹閹惧墎鐭嗗ù锝呮贡椤╁弶绻濇繝鍌滃闁抽攱鍨块弻娑樷槈濮楀牆濮涢梺瀹犳椤︾敻寮婚妸鈺佸嵆婵☆垰鎼慨搴ㄦ⒑瀹曞洨甯涢柟姝屽吹閳ь兛绲婚崑鎰板焵椤掍胶鈯曢懣銈夋煙闁垮銇濋柟顔煎槻椤劑宕ㄩ褎姣夐梺姹囧焺閸ㄩ亶銆冮崨鏉戠厺鐎广儱鎷嬮悡銉╂煕椤愩倕鏋旈柛妯圭矙濮婅櫣娑甸崨顕呬哗闂佺顑囬崰鏍箖妤ｅ啯鍋ㄧ痪鐗埫禍鐐箾閸繄浠㈤柡瀣⊕閵囧嫰顢橀悩鎻掑箣濡ょ姷鍋涢崯瀛樻叏閳ь剟鏌曢崼婵囧櫧妞は佸洦鈷戠紒瀣硶缁犱即鏌涘顒夊剶妞?
    // ==========================================

    public void setCaptain(boolean isCaptain) {
        this.entityData.set(IS_CAPTAIN, isCaptain);
        updateCustomName(); // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼槮闁搞劍绻冮妵鍕冀椤愵澀姹楅梺閫炲苯澧剧紒鐘虫尭閻ｉ攱绺界粙璇俱劑鏌曟径娑㈡鐞氾綁姊婚崒娆戭槮闁圭⒈鍋嗙划娆愮瑹閳ь剙鐣烽姀锛勯檮闁告稑锕ら埀顒€娼￠弻娑⑩€﹂幋婵呯按婵炲瓨绮嶇划鎾诲蓟閻斿憡缍囬柛鎾楀惙鎴犵磼缂併垹骞栭柣鏍с偢瀵鈽夐姀鐘愁棟闁荤姵浜介崜杈樄闁哄矉绱曟禒锔剧矙閸喒鎷ら梻浣烘嚀閸㈡煡骞婂鈧悰顕€寮介鐔封偓鐑芥椤愵偄骞栭柛銊︾箞濮婅櫣鎷犻崣澶婃敪濡炪値鍋勯ˇ顖滃弲闂佸啿鎼崯顐ゆ閵堝鐓曞┑鐘插閺嬫柨霉濠婂懏娅曠紒杈ㄦ崌瀹曟帒顫濋钘変壕闁绘垼濮ら崐鍧楁煥閺囩偛鈧綊寮插┑瀣厓閺夌偞澹嗙€靛ジ鏌ㄥ┑鍡╂▓闁轰礁绉电换婵囩節閸屾稑娅ч梺鎸庣⊕缁诲啰鎹㈠☉娆愮秶闁告挆鍛呮艾顪冮妶搴′簻妞わ妇鏁婚獮鍐晸閻樺弬銊╂煥閺冨洦銆冪紒銊ヮ煼濮婃椽鎮烽幍顔芥喖缂備浇顕ч崯鏉戠暦閻㈢鐐婇柍瑙勫劤娴滈箖鎮峰▎蹇擃仾缂佲偓閸愨晙绻嗛柣鎰硾琚氶梺閫涚┒閸旀垿宕洪埀顒併亜閹烘垵顏柣鎾崇箻閺屾盯顢曢敐鍥╃暫闂侀潻缍€婵倝濡甸崟顖涙櫆閻犲洩寮撻崰濠傗攽椤旂》鍔熺紒顕呭灦楠炲繘宕ㄩ弶鎴滅炊闂侀潧顦崐娑橆瀶閸涘﹣绻嗛柣鎰典簻閳ь剚鐗犲畷褰掓濞磋櫕绋戦埞鎴犫偓锝庝簽閻ｆ椽姊虹捄銊ユ灁濠殿喗鎸抽幃鐐哄垂椤愮姳绨婚梺鍦劋閸ㄧ敻顢旈鍫熺厓闂佸灝顑呴悘鎾煛鐏炲墽鈽夐柍钘夘槸椤粓宕奸妷褍寮芥繝鐢靛О閸ㄥジ锝炴径鎰ㄢ偓锕傚炊閳哄偆娼熼梺鍦劋閹稿摜娆㈤悙鐑樺€甸柨婵嗛娴滄粓鏌涢悙宸█婵?
    }

    public boolean isCaptain() {
        return this.entityData.get(IS_CAPTAIN);
    }

    // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箳閳ь剝顫夊ú鏍洪敃鍌ゆ晝濞寸姴顑嗛悡蹇涙煕椤愶絿绠栧璺哄閵囧嫰顢曢敐鍡欘槹闂佸搫鐭夌换婵嗙暦閸洖唯闁靛／鍌滄／闂傚倷鑳堕…鍫ヮ敄閸岀偛鐤炬繛鎴欏灩閻撴﹢鏌熸潏楣冩闁稿鍔欓幃妤呭捶椤撶倫銏°亜閵夛妇绠炴慨濠呮閹风娀鎳犻鍌ゅ晥婵犵數鍋涢幊蹇撁哄鍫濈闁靛繒濮弨浠嬫煕閵夈垺娅囬柣锕€鐗撳铏圭矙閹稿孩鎷遍梺鍛婂灱椤绮嬮幒鎾堕檮闁告稑艌閹锋椽鏌ｉ悩鍙夌┛閻忓繑鐟х划濠氬蓟閵夛妇鍘介梺鍐叉惈閿曘倝鎮橀敂閿亾濞堝灝鏋涙い顓犲厴瀵偊骞樼紒妯轰汗闂佽偐鈷堥崜銊ф閸欏绡€闁汇垽娼ф禒锕傛煕閵娿儱鎮戦柕鍥ㄦ楠炴牗鎷呴悷棰佹偅闂備胶鍘ч幗婊堝极閸濄儱濮柍褜鍓欓埞鎴︽倷閼碱剙顣洪梺璇茬箲缁诲牆顕ｇ粙搴撴婵浜敍婊呯磽閸屾瑧鍔嶉柨姘箾閹碱厼鏋熸い銊ｅ劦閹瑩鎳犻鍌ゅ晪闂備浇顕栭崰鎺楀疾濠靛绠柣妯肩帛閸ゆ垶銇勯幒鎴Ч閺佸牊绻濈喊澶岀？闁稿鍨垮畷鎰板冀椤撶偟顦梺纭呮彧缁犳垿宕归崒姘ｆ斀闁绘ê鐤囨竟姗€鏌ｉ幒鎴犱粵闁靛洤瀚伴獮鎺楀幢濡炴儳顥氬┑锛勫亼閸娿倝宕㈡ィ鍐ㄧ婵☆垯璀﹂崵鏇㈡偣閸パ勨枙闁告艾顑呴…璺ㄦ崉婵傛枻绻濇俊鎼佸煛閸屾粌寮抽梻浣告惈閸婃悂鎮樺┑瀣厱闁哄啠鍋撻柕鍥у瀵剟骞愭惔锛勭崺缂傚倷娴囨ご鎼佸箰婵犳艾绠柛娑卞枤椤╃兘鎮楅敐搴濈凹闁硅櫕鐟х槐鎾诲磼濞嗘劗銈板銈嗘肠閸ャ劌浜遍梺绯曞墲缁嬫帡宕戦埡鍐ｅ亾閻熸澘顏柛瀣工椤洭鍩￠崨顔间化闂佸憡绻傜€氼參骞嗛崼銉︾厾闁哄娉曟禒銏ゆ煃鐟欏嫬鐏撮柛鈹垮劦瀹曞崬螖閸愌冨缂傚倸鍊风欢锟犲闯椤曗偓瀹曞綊宕奸弴妯峰亾娴ｇ硶鏋庨煫鍥风到閹垶绻濋姀锝嗙【妞ゆ垵娲畷銏＄鐎ｎ偀鎷洪梺鍝勫€堕崕鎻掆枍閸涘瓨鐓曢柣鏇氱娴滅偟绱掗鍛籍妤犵偞甯掕灃濞达絽鎼鎶芥⒒娴ｅ憡鎯堟繛灞傚灲瀹曟繄鈧綆鍠楅悞鑺ャ亜閺嶎偄浠﹂柣鎾寸懄閵囧嫰寮崒姘闂佸搫妫崜姘跺Φ閸曨垰顫呴柨娑樺閸ｄ即姊虹拠鈥虫灍闁荤啿鏅犻妴浣肝旀担鐟邦€撶紓浣割儏閻忔繈锝為幘鏂ユ斀闁绘ê鐏氶弳鈺佲攽椤旀儳鍘寸€殿噮鍋婂畷銊︾節閸愩劌浼庨梻浣告贡閾忓酣宕伴弽顓熷仾妞ゆ柨顫曟禍婊堟煛瀹ュ啫濡块柣顓炶嫰閳藉骞樺畷鍥喲囨煛瀹€鈧崰鏍箖濠婂喚娼ㄩ柛鈩冾焽閺嗭箓姊绘担渚劸妞ゆ垶鍨瑰濠囧锤濡も偓缁犵喓绱掔€ｎ偒鍎ラ柛姘儔閺屾盯濡烽婊冨煂婵炲瓨绮庨崑鎾诲箞閵娿儙鐔兼偂鎼粹€茬帛闁诲孩顔栭崳顕€宕抽敐澶婅摕闁绘梻鈷堥弫濠囨煏婵炲灝鍔氶柡瀣ㄥ€栫换娑㈡⒒閺夋垵绁梺璇″枟閿曘垽骞冨▎鎰剁矗婵犻潧妫欓弳顖涚節濞堝灝鏋︽い顐㈩樀閵嗗啯绻濋崒銈嗙稁濠电偛妯婃禍婵嬪磻閿熺姵鐓涘璺猴功濮樸劑鏌熺粙鍨殶缂佽鲸鎸荤粭鐔煎炊瑜庨悵顕€姊洪幖鐐插闁轰焦妲掗惌楣冩⒑缁嬭法鐏遍柛瀣仱閸?
    public double getSquadScore() {
        // 1. 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛濠傛健閺屻劑寮崹顔规寖闂佹椿鍘介悷鈺呭蓟閻斿皝鏋庨梽鍥敋瑜嶇叅闁挎洍鍋撴い顓炴穿缁犳稑鈽夐幒鍡椾壕闁挎洖鍊哥粻锝夋煟閹存繃顥滈柡鍜佸墴濮婂宕掑▎鎴濆闂佽鍠栭悥鐓庣暦閺囩伝娲敂閸曨収妲舵繝鐢靛仜濡瑩宕归悷鎷旀盯顢涘鍕瀾闂佸搫鍟悧鍡涙嫅閻斿摜绠鹃柟瀛樼懃閻忊晝绱掗悩宕囨创婵﹤顭峰畷濂告偄鐞涒€愁潓闂備浇顕х换鎰版偋閸℃稑鐓橀柟杈鹃檮閸婄兘鏌涘▎蹇ｆЦ婵炲拑绻濆娲箹閻愭彃顬嗙紓渚囧枟閻熴儵顢氶敐鍡欑瘈婵﹩鍘藉▍銏ゆ⒑缂佹〞鎴︽偂閿熺姴鑸归悹楦裤€€閺€鑺ャ亜閺冣偓閺嬬粯绗熷☉銏＄厱闊洦姊婚埊鏇犵磼閺冨倸鏋涚€殿喗鎸虫慨鈧柍閿亾闁?(濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣銏犲閺佸﹪鏌″搴″箹闂傚偆鍨遍妵鍕冀閵娧呯厐缂備浇缈伴崐婵嬪蓟閿濆鏅查柛娑卞枟閹烽亶鎮楃憴鍕闁绘搫绻濆濠氭偄閸忕厧鈧粯淇婇婊呭笡闁稿骸楠搁埞?10000 闂?
        double score = getTier() * 10000.0;

        // 2. 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愭い鏃傛嚀娴滈箖鏌涢幇闈涙灈鐎瑰憡绻堥弻鈩冨緞鐎ｎ亞浠奸梺鍝勮嫰閻楁挸顫忛搹鍦煋闁糕剝顨呴瀛樼箾閸喐绀嬮柡灞剧⊕閹棃鏁嶉崟鎳峰洦鐓涢悘鐐靛亾缁€澶岀磼閻樺磭銆掗柍褜鍓ㄧ紞鍡樼閺嶎厼纾婚柟鎹愵嚙閸楁娊鏌ｅΟ鍝勬毐闁告ê缍婂娲焻閻愯尪瀚板褍鐡ㄩ幈銊︾節閸愨斂浠㈠Δ鐘靛仦閻楃娀骞冨▎鎾崇闁圭儤鍩堝鏇㈡⒒閸屾瑧顦﹂柟纰卞亰楠炲﹪骞囬鐘殿啎闂侀€炲苯澧撮柡宀€鍠栭、娆戞嫚閹绘帞銈俊銈囧Х閸嬬偤鈥﹂崶鈺傤潟闁圭儤鍤﹂悢鍏煎亗閹艰揪绱曢鎴︽⒒閸屾艾鈧娆㈠顒夌劷鐟滄棃鍨鹃敃鍌氶唶闁靛鍎抽敍鐔兼⒒娓氬洤澧紒瀣╃窔瀵偊宕掑☉鏍︾盎闂婎偄娲﹂幐濠氬闯閻ｅ瞼纾奸柣妯垮吹閻ｆ椽鏌″畝瀣М妤犵偞锕㈤幖褰掝敃閿濆懘妫锋繝鐢靛Л閹峰啫顓奸崶鈺傛闂備礁鎼惌澶屾閺囩喓顩烽柨鏇炲€哥壕褰掓煟閺傛娈犲ù鐓庡暞娣囧﹪鎮欓鍕ㄥ亾閺嶎厼绠伴柟闂寸鍥寸紓浣割儓濞夋洟寮抽敃鍌涚厱闁规崘灏欓崝宥団偓瑙勬礀椤︾敻寮诲☉妯锋斀闁糕剝顨忔禒鐓庮渻閵堝啫鍔滈柛鏃€鐟ラ～?(闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴姘辩Т闂佹悶鍎洪崜锕傚极閸愵喗鐓ラ柡鍥殔娴滃墽绱掗悙顒€鍔ゆい顓犲厴瀵鎮㈤悡搴ｎ槶閻熸粌绻掗弫顔尖槈閵忥紕鍘介梺瑙勫劤椤曨參鍩ユ径鎰梿濠㈣埖鍔栭悡銉︾節闂堟稒顥為柛锝嗘そ閺屾盯鎮㈤崫鍕勃缂備胶绮换鍫ュ春閳ь剚銇勯幒宥囶槮妞ゆ洟浜堕幃妤€鈽夊▎妯煎姺闂佸憡眉缁瑥顫忓ú顏勭閹兼番鍩勫鍨渻閵堝棙鑲犻柛鎰剁稻閻庢椽鎮楅獮鍨姎妞わ缚鍗抽幃?* 5000 闂?
        // 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣銏犲閺佸﹪鏌″搴″箹闂傚偆鍨遍妵鍕冀閵娧呯厐缂備浇缈伴崐鏇＄亙闂佹寧绻傞幊搴ㄥ汲濞嗘挻鐓㈤柛鎰典簻閺嬫盯鏌＄仦鐐缂佺粯鐩幃娆擃敆娴ｅ湱缈婚梻鍌欑窔閳ь剛鍋涢懟顖涙櫠椤曗偓閺岀喖鎼归锝呯３闁芥ɑ绻堥弻娑㈡晜鐠囨彃绠伴梺绋款儐閹告悂鍩㈤幘璇插瀭妞ゆ梻鏅禍顏堟⒒娴ｈ櫣甯涢柣妤佹礋婵″墎绮欑捄銊︽濠电偛妯婃禍婊堟倿閸偁浜滈柟鍝勭Ч濡惧嘲霉濠婂嫮鐭掗柡宀€鍠栭幃婊兾熼搹閫涙樊婵＄偑鍊曞ù姘椤忓牆钃?90/100闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弮鍫熸殰闁稿鎸剧划顓炩槈濡娅ч梺娲诲幗閻熲晠寮婚悢鍛婄秶濡わ絽鍟宥夋⒑閹肩偛鈧牠宕濋弽顓炍﹂柛鏇ㄥ灠閸愨偓闂侀潧顭堥崕鍗炐掗崼婵冩斀闁绘劘灏欏В鐐烘煛閸涱垰鈻堢€殿喖顭峰鎾偄閾忚鍟庨梻浣虹帛閸旓箓宕滃鑸靛仧闁哄洢鍨洪埛?0.9 * 5000 = 4500 闂?
        int kills = getKillCount();
        int target = getKillTarget(getTier());
        if (target > 0) {
            score += ((double)kills / target) * 5000.0;
        }

        // 3. 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾剧粯绻涢幋娆忕労闁轰礁顑嗛妵鍕箻閸楃偟鍔撮梺杞扮鐎氫即寮婚敓鐘茬倞闁靛鍎虫禒鑲╃磼閻愵剙鍔ょ紓宥咃躬瀵鏁撻悩鑼€為梺闈涱槶閸庢娊宕濋幘顔解拺閺夌偞澹嗛ˇ锕傛煥閺囨ê鈧繈宕洪悙鍝勭闁挎棁妫勬禍褰掓⒑閸涘﹦鎳冩い锔诲灦钘濋柍鍝勬噺閳?(婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｅΟ娆惧殭缂佺姴鐏氶妵鍕疀閹炬惌妫炵紓浣界堪閸婃繈寮诲☉銏犵婵°倐鍋撻柛鐕佸亰閹ɑ绻濋崶銊㈡嫼闂佸憡鎸昏ぐ鍐╃閺嶎厽鐓曢柕濞垮妽椤忕娀鏌嶈閸撴岸鎳濇ィ鍐ｂ偓锕傛倻閽樺鎽曢梺鎸庣箓椤︻垰螞濮椻偓閺岀喓绮欓崸妤娾偓妤呮煛閸℃澧㈢紒杈ㄦ崌瀹曟帒顫濆В娆嶅灪缁绘稑顔忛鐓庣睄閻庢鍠涢褔鍩ユ径濞㈢喖鏌ㄧ€ｅ灚缍岄梻鍌欑閹诧繝銆冮崼銉ョ；婵炴垶姘ㄦ稉宥囨喐閻楀牆绗氶柛瀣У閹便劌螣閸濆嫯鍩為梺瀹狀嚙閻楀﹪骞堥妸锔剧瘈闁告劏鏂傛禒銏ゆ倵鐟欏嫭纾搁柛鏂跨Ф閹广垹鈹戠€ｎ亞顦板銈嗗坊閸嬫挻绻涢崨顔肩伌婵﹦绮幏鍛瑹椤栨粌濮奸梻浣瑰濞测晝寰婇崸妤€绀嗛柟鐑樺灍閺嬪酣鏌熼幑鎰彧婵″樊鍓熷娲焻閻愯尪瀚板褜鍨堕弻鏇㈠炊瑜嶉顓燁殽閻愭潙娴€规洖宕—鍐箚瑜滃Λ婊堟⒒閸屾艾鈧绮堟笟鈧獮妤€顭ㄩ崟顒€寮块梺姹囧灮閺佹悂鎯屽▎鎾寸厵闁绘劦鍓涚粣鐐烘煥濠靛棭妲哥紒鐘崇⊕閵囧嫰骞嬮敐鍛呮捇鏌￠崒妤€浜鹃梻鍌欐祰椤曆囧礄閻ｅ瞼绀婇柛鈩冪☉绾惧鏌涘☉娆愮稇缁剧偓瀵ч妵鍕疀閹捐泛顤€闂佹娊鏀遍崹鐢告箒闂佺绻楅崑鎰板箠閸涘瓨鐓曢柟鍝勭Т瀹撳棝鏌＄仦璇测偓鏇犲弲闁荤姴娲╃亸娆愮椤撱垺鈷戦梺顐ｇ〒閳规帡鏌涢弬璺ㄧ閽樻繄鎲搁悧鍫濈瑲闁绘挻鐟﹂妵鍕籍閸パ傛睏缂備礁顦板浠嬪蓟閻斿吋鍋傞幖杈剧悼妤旈梻浣筋嚃閸犳岸宕楀鈧獮鍐樄鐎规洖銈搁敐鐐侯敇閻樺啿鐦婚梻鍌氬€搁崐鎼佸磹閻戣姤鍤勯柛顐ｆ礀绾惧潡鏌ｉ姀銏╃劸缂佲偓閸喓绡€闂傚牊渚楅崕蹇涙煕閵娿儱鈧骞夐幖浣瑰亱闁割偅绻勯悷鏌ユ⒑缁嬪潡顎楁い锔垮嵆婵＄敻宕熼鍓ф澑闂佽鍎抽顓㈠Χ閳轰讲鏀介柍鈺佸暙缁插鏌曢崼鐔稿€愮€殿喖顭烽弫鎰板幢濡搫濡抽梻浣瑰缁嬫垹鈧凹浜為崚鎺楁濞戞帗鏂€闂佺粯鍔樺▔娑㈡儍濞差亝鐓曢柣妯虹－婢ь亝銇勯弴顏嗙ɑ缂佺粯绻傞～婵嬵敇閻斿摜褰囬梻鍌欒兌椤牓寮甸鈧～婵嬪Ω閳轰礁鍋嶉梺褰掓？閻掞箓鎮￠悢鐓庣闁圭⒈鍘奸悘锝囩磼婢跺本鏆柡灞剧洴楠炴鈧潧鎲￠崚娑㈡煢濡崵绠栭柕鍥у瀵噣宕掑☉娆戝涧缂傚倷鑳舵繛鈧紒鐘崇墪椤曪綁宕奸弴鐐哄敹濠电娀娼уΛ宀勫箰閸愵喗鈷戦柛娑橈工缁椦冾熆瑜庨〃鍡欑矚鏉堛劎绡€闁搞儴鍩栭弲婵嬫⒑閹稿海绠撴俊顐㈢焸楠炲繑绻濆顓炩偓鍨箾閸繄浠㈤柡鍡樼懇閺屾盯濡烽幋婵囧婵¤尙澧楁穱濠囨倷椤忓嫧鍋撻弽顬稒绗熼埀顒€鐣烽幋锕€绠涢柛蹇ｅ亜濞差參銆佸璺虹劦妞ゆ巻鍋撴い顐㈢箻閹煎綊宕烽鐙呯床婵犳鍠楅〃鍛涘☉銏犵闁告稑锕︾粻楣冩倵濞戞瑯鐒介柣顓滃€濋弻娑㈠箻鐠虹儤鐏堝Δ?
        score += this.getAttributeValue(Attributes.ATTACK_DAMAGE) * 100.0;

        // 4. 闂傚倸鍊搁崐宄懊归崶褏鏆﹂柣銏㈩焾缁愭鏌熼柇锕€鏋涢柛銊︾箞楠炴牕菐椤掆偓閻忣亝绻涢崨顖毿ｅǎ鍥э躬婵″爼宕ㄩ鍏碱仩缂傚倷鑳舵慨鎶藉础閹惰棄钃熸繛鎴炃氬Σ鍫熸叏濡も偓閻楀﹪寮幆褉鏀介柣鎰级閸ｈ棄鈹戦悙鈺佷壕闂備礁鎼惌澶屽緤閸婄喓浜介梻浣瑰劤缁绘﹢鍩€椤掍胶銆掑瑙勫▕濮婄粯鎷呮笟顖滃姼濡炪倖鍨靛Λ婵嬪极閸愵喖顫呴柕鍫濇嚀閹芥洟鎮楅獮鍨姎闁绘绮岄‖濠囧Ω閳哄倵鎷洪梺鍛婄☉閿曘儳浜搁悽鍛婄厱闁绘ê纾晶顏呫亜?(闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰级閻ゅ嫬鈹戞幊閸娧呭緤娴犲鐤い鏍仜绾惧潡鏌￠崒姘辨皑闁衡偓娴犲鐓曢悘鐐插⒔椤ｆ煡鏌涢悢鍝勪槐闁哄本绋撻埀顒婄祷閸斿矂鍩€椤掍胶绠炵€殿喖顭烽幃銏㈡偘閳ュ厖澹曢梺姹囧灪椤旀牠鎮炴ィ鍐ㄧ柈缂佸绨遍弨浠嬫煃閽樺顥滃ù婊€绮欓弻娑㈠Ω閿曗偓閳绘洘顨ラ悙宸Ш缂侇喗鐟ч幑鍕Ω閿旂晫鏆﹂梻鍌欑窔閳ь剛鍋涢懟顖涙櫠娴煎瓨鐓曢柟鐑樻尭濞搭喗銇勯姀鈽呰€垮┑顔瑰亾闂佺粯顭堢亸娆撴偘閳哄懏鈷戦悹鍥ㄥ絻椤掋垻绱掔€ｎ偄绗╅柟绛嬪亜閳规垿鎮欓崣澶婃闂佺粯顨堟繛鈧鐐插暙铻栭柛娑卞幘椤ρ勭節閵忥絾纭鹃柨鏇稻缁旂喖寮撮姀鈾€鎷绘繛杈剧到閹诧繝宕悙鐑樼厱闁哄啠鍋撴い銊ワ工閻ｇ兘骞嬮敃鈧粻濠氭偣閸パ冪骇闁诲寒鍓熷娲濞戞艾顣哄┑鈽嗗亝缁嬫挸顕ｈ閸┾偓妞ゆ帒瀚埛鎴︽⒒閸喓娲撮柣娑欑矌缁辨帡鐓鐘电厯闂佽鍣换婵嬬嵁閸ヮ剦鏁囬柣鏂垮槻娴煎孩绻濈喊妯活潑闁搞劍濞婇垾锕傚醇閻斿墎绠氭繝闈涘€搁幉锟犳偂閸愵亞纾藉ù锝堝亗閹存繄鏆﹂悘鐐佃檸濞堜粙鏌ｉ幇顒佲枙闁稿孩妫冮弻鈩冩媴閻熸澘顫掗悗瑙勬礃椤牓藝閹惰姤鐓熸い鎰╁灮缁犵粯鎱ㄦ繝鍕笡闁瑰嘲鎳橀幃婊兾熼悜妯兼殮婵犵數濮幏鍐川椤旂晫褰ч梻浣告啞鐢鏁敓鐘偓浣糕槈濡攱鏂€闂佸綊鍋婇崢鐣屾椤撱垺鈷?
        score += this.getHealth();

        return score;
    }
    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱樈閸犳顕欏ú顏呪拺缂侇垱娲栨晶鍙夈亜閵娿儲鍤囬柨婵堝仱閸╋繝宕ㄩ鎯у箺闂備線娼х换鍡涘疾濞戙垺鍊堕柨鐔哄У閸嬨劍銇勯弽銉モ偓妤冨姬閳ь剙螖閻橀潧浠滈柛鐔跺嵆楠炲骞橀鑲╊槹濡炪倖宸婚崑鎾淬亜鎼淬垺灏扮紒缁樼洴楠炴﹢寮堕幋婵囩槗闂備焦鎮堕崝宥嗙箾婵犲倻鏆︽繝闈涚墢閻瑦绻涢崱娆忎壕閻庨潧鐭傚娲濞戞艾顣虹紓浣虹帛鐢繝骞冮悙顒佺秶闁靛绲肩花璇差渻閵堝棙灏靛┑顔芥尦瀹曘垻鈧數纭堕崑鎾斥枔閸喗鐏堝銈庡幖閸㈡煡鎮鹃柨瀣檮缂佸顕抽妸鈺傜厪濠㈣泛锕﹀畝鎼佹煛閸涱垰鈻堢€殿喖顭锋俊鎼佸煛娴ｈ櫣娼夐梻渚€鈧偛鑻晶瀵糕偓瑙勬礃濞茬喎鐣峰Ο渚晠妞ゆ柨鍚嬮鍧楁⒒娓氣偓濞佳嗗闂佸搫鎳忕划鎾诲箖閿熺姵鍋勯柛蹇氬亹閸樿棄鈹戦埥鍡楃仩闁圭⒈鍋嗛惀顏囶樄闁哄本绋撴禒锔炬嫚閹绘帩娼庨梻浣告惈閺堫剟鎯勯娑楃箚闁归棿绀佹儫闂侀潧顦崐鏍儓韫囨洜纾介柛灞剧懅鐠愪即鏌涢敐搴＄仯缂佽京鍋炵粭鐔煎焵椤掆偓椤曪綁顢曢敃鈧粻鑽ょ磽娴ｅ顏呯瑜版帗鈷戦柛婵嗗閳ь剙鐖煎畷鏇㈡嚑椤戣棄浜鹃柛顭戝亽濞堟粍鎱ㄦ繝鍕笡缂佺粯绻冮幆鏃堝灳閼碱剛娉垮┑鐘垫暩閸嬬娀顢氬鍛笉闁瑰濮村鏌ユ⒒娴ｅ憡鎯堢紒瀣╃窔瀹曟垿宕卞☉妯肩枃闂佸憡绋戦悺銊╁煕?
    public boolean isFollowing() {
        return this.entityData.get(IS_FOLLOWING);
    }
    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱樈閸犳顕欏ú顏呪拺缂侇垱娲栨晶鍙夈亜閵娿儲鍤囬柨婵堝仱閸╋繝宕ㄩ鎯у箺闂備線娼х换鍡涘疾濞戙垺鍊堕柨鐔哄У閸嬨劍銇勯弽銉モ偓妤冨姬閳ь剙螖閻橀潧浠滈柛鐔跺嵆楠炲骞橀鑲╊槹濡炪倖宸婚崑鎾淬亜鎼淬垺灏扮紒缁樼洴楠炴﹢寮堕幋婵囩槗闂備焦鎮堕崝宥嗙箾婵犲倻鏆︽繝闈涚墢閻瑦绻涢崱娆忎壕閻庨潧鐭傚娲濞戞艾顣虹紓浣虹帛鐢繝骞冮悙顒佺秶闁靛绲肩花璇差渻閵堝棙灏靛┑顔芥尦瀹曘垻鈧數纭堕崑鎾斥枔閸喗鐏堝銈庡幖閸㈡煡鎮鹃柨瀣檮缂佸顕抽妸鈺傜厪濠㈣泛锕﹀畝鎼佹煛閸涱垰鈻堢€殿喖顭峰鎾閻樿鏁规繝鐢靛█濞佳兠归崒姣兼盯鎮欓悜妯衡偓鍨箾閸繄浠㈤柡瀣⊕缁绘稓浜搁弽銈呬壕闁归鐒︾紞搴ㄦ⒑閹呯妞ゎ偄顦靛畷鎴濐潨閳ь剟寮诲澶娢ㄩ柕澶堝劚缁楊厽绻濋姀锝庢綈婵炲弶绮庡Σ鎰板箻鐎涙ê顎撴俊銈忛檮鐎笛囶敁濡ゅ懏鈷戦柛娑樷姇椤忓牆围闁归棿鑳跺畵浣糕攽閻樺弶鎼愮紒鐘崇洴濮婃椽顢橀妸鈺傤€嶉梺鍝勬噺閻╊垰顫忓ú顏呯劵闁绘劘灏€氭澘顭胯閻°劑骞堥妸锔剧瘈闁稿被鍊楅崥瀣倵鐟欏嫭绀冮悽顖涘浮閿濈偛鈹戠€ｅ灚鏅ｉ梺缁樺姈閹本绂掗埡鍐＝闁稿本鑹鹃埀顒傚厴閹虫宕滄担绋跨亰濡炪倖鐗楃划宥夊汲濠婂嫪绻嗛柕鍫濇噺閸ｅ湱绱掗悩闈涗槐闁哄本娲樼换娑㈡倷椤掍胶褰呯紓鍌欒兌婵兘骞婇幘缁樼畳闂備焦瀵х换鍌炴偋濠婂喚鐒介柟閭﹀幘缁?(闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煟閵忋埄鐒剧紒鎰殜閺岀喖骞嶉纰辨毉闂佺顑戠换婵嗩嚕閸洖閱囨慨姗嗗幗閻濇梻绱撴担鐣屽牚闁稿﹥娲熷﹢渚€姊虹紒妯忣亜螣婵犲洤纾块煫鍥ㄦ礈绾惧ジ鏌熼柇锕€寮炬繛鍫熺矒閺岋紕浠﹂崜褉妲堥梺瀹犳椤︻垶鍩㈡惔銊ョ疀妞ゆ棃鏁弸蹇曠磽閸屾艾鈧兘鎳楅懜闈涘灁妞ゆ挶鍨归梻顖炴煥濠靛棭妲搁柦鍐枛閺岋繝宕堕埡浣圭€荤紓浣稿閸嬨倝寮诲☉銏犵労闁稿繆鏅滈崹鍧楀箖閻㈢鍗抽柕蹇婃閹锋椽姊洪崨濠勭畵閻庢凹鍙冨畷鎶藉箮閼恒儳鍘搁梺鍛婁緱閸ㄤ即鍩㈤崼鈶╁亾濞堝灝鏋涙い顓犲厴瀵偊骞囬鐐电獮婵犵數鍋愰幊鍥疾閻樿钃熼柡鍥╁枎缁剁偤鏌涢锝囩畵濠殿喛鍩栫换娑氣偓鐢殿焾閳诲牏绱掗悩宕囧ⅹ妞ゎ偄绻橀幖褰掑捶椤撶媴绱叉繝娈垮枟椤ㄥ懎螞濞嗘挻鍋╅梺鍨儑缁♀偓闂佹眹鍨藉褎绂掑鍫熺叆闁哄洢鍔嬬花缁樸亜?
    public void setFollowing(boolean isFollowing) {
        // Legacy compatibility entrypoint; route to the authoritative mode setter.
        setFollowMode(isFollowing);
    }

    private static boolean isMiningAvoidTool(ItemStack stack) {
        if (stack == null || stack.isEmpty()) return false;
        Item item = stack.getItem();
        return item instanceof PickaxeItem
                || item instanceof AxeItem
                || item instanceof HoeItem
                || item instanceof ShovelItem
                || item instanceof FishingRodItem;
    }

    private static boolean ownerIsUsingMiningAvoidTool(LivingEntity owner) {
        if (!(owner instanceof Player player)) return false;
        return isMiningAvoidTool(player.getMainHandItem()) || isMiningAvoidTool(player.getOffhandItem());
    }

    private static boolean isInsideOwnerCenterView(LivingEntity owner, SkeletonTurret turret) {
        net.minecraft.world.phys.Vec3 look = owner.getLookAngle();
        net.minecraft.world.phys.Vec3 toTurret = turret.position().subtract(owner.getEyePosition());
        if (toTurret.lengthSqr() < 1.0E-6) return true;
        double dot = look.normalize().dot(toTurret.normalize());
        return dot >= 0.80D;
    }

    static class FollowMiningAvoidGoal extends Goal {
        private final SkeletonTurret turret;
        private LivingEntity owner;
        private int repathCooldown;
        private int centerTicks;

        public FollowMiningAvoidGoal(SkeletonTurret turret) {
            this.turret = turret;
            this.setFlags(EnumSet.of(Flag.MOVE, Flag.LOOK));
        }

        @Override
        public boolean canUse() {
            LivingEntity owner = this.turret.getOwner();
            if (owner == null) return false;
            if (!this.turret.isFollowing()) return false;
            if (this.turret.isPurgeActive()) return false;
            if (this.turret.isCommandScavenging()) return false;
            if (this.turret.getTarget() != null) return false;
            if (!ownerIsUsingMiningAvoidTool(owner)) return false;
            if (!isInsideOwnerCenterView(owner, this.turret)) return false;
            if (this.turret.distanceToSqr(owner) > 16.0 * 16.0) return false;
            this.owner = owner;
            return true;
        }

        @Override
        public boolean canContinueToUse() {
            if (this.owner == null || !this.owner.isAlive()) return false;
            if (!this.turret.isFollowing()) return false;
            if (this.turret.isPurgeActive()) return false;
            if (this.turret.isCommandScavenging()) return false;
            if (this.turret.getTarget() != null) return false;
            return ownerIsUsingMiningAvoidTool(this.owner) && isInsideOwnerCenterView(this.owner, this.turret);
        }

        @Override
        public void start() {
            this.repathCooldown = 0;
            this.centerTicks = 0;
            this.turret.getNavigation().stop();
        }

        @Override
        public void stop() {
            this.centerTicks = 0;
        }

        @Override
        public void tick() {
            if (this.owner == null) return;
            this.turret.getLookControl().setLookAt(this.owner, 10.0F, (float)this.turret.getMaxHeadXRot());
            this.centerTicks++;

            if (this.turret.isInWaterOrBubble()) {
                moveToNearestLand();
                return;
            }

            if (this.repathCooldown > 0) {
                this.repathCooldown--;
            }
            if (this.repathCooldown > 0) {
                return;
            }
            this.repathCooldown = 8;

            net.minecraft.world.phys.Vec3 retreat = MiningFollowAvoidanceLogic.computeRetreatPosition(
                    this.turret.position(),
                    this.owner.position(),
                    this.owner.getLookAngle(),
                    3.5
            );

            boolean moved = this.turret.getNavigation().moveTo(retreat.x, retreat.y, retreat.z, 1.25);
            boolean tooClose = this.turret.distanceToSqr(this.owner) < (3.0 * 3.0);
            if ((!moved || tooClose) && this.centerTicks >= 20) {
                tryTeleportOffCenter();
                this.centerTicks = 0;
            }
        }

        private void moveToNearestLand() {
            BlockPos land = findOwnerNearbyLandOutsideRadius(8.0, 18.0);
            if (land == null) {
                land = findNearestLandBlock();
            }
            if (land == null) {
                return;
            }

            double tx = land.getX() + 0.5;
            double ty = land.getY();
            double tz = land.getZ() + 0.5;
            if (this.turret.hasTeleportModule() && this.turret.canTeleport()) {
                this.turret.moveTo(tx, ty, tz, this.turret.getYRot(), this.turret.getXRot());
                this.turret.getNavigation().stop();
                this.turret.setTeleportCooldown(this.turret.getMaxTeleportCooldown());
                this.turret.notifyTeleport();
                this.centerTicks = 0;
                return;
            }
            this.turret.getNavigation().moveTo(tx, ty, tz, 1.35);
        }

        private BlockPos findOwnerNearbyLandOutsideRadius(double minRadius, double maxRadius) {
            if (this.owner == null) return null;
            Level level = this.turret.level();
            BlockPos ownerPos = this.owner.blockPosition();
            BlockPos best = null;
            double bestDistToTurret = Double.MAX_VALUE;
            double minSqr = minRadius * minRadius;
            double maxSqr = maxRadius * maxRadius;

            int max = (int)Math.ceil(maxRadius);
            for (int dx = -max; dx <= max; dx++) {
                for (int dz = -max; dz <= max; dz++) {
                    double radialSqr = dx * dx + dz * dz;
                    if (radialSqr <= minSqr || radialSqr > maxSqr) continue;
                    for (int dy = 3; dy >= -4; dy--) {
                        BlockPos feet = ownerPos.offset(dx, dy, dz);
                        if (!isDryStandable(level, feet)) continue;
                        double distToTurret = feet.distSqr(this.turret.blockPosition());
                        if (distToTurret < bestDistToTurret) {
                            bestDistToTurret = distToTurret;
                            best = feet;
                        }
                    }
                }
            }
            return best;
        }

        private BlockPos findNearestLandBlock() {
            Level level = this.turret.level();
            BlockPos origin = this.turret.blockPosition();
            BlockPos best = null;
            double bestDist = Double.MAX_VALUE;

            for (int dx = -6; dx <= 6; dx++) {
                for (int dz = -6; dz <= 6; dz++) {
                    for (int dy = 3; dy >= -4; dy--) {
                        BlockPos feet = origin.offset(dx, dy, dz);
                        if (!isDryStandable(level, feet)) {
                            continue;
                        }

                        double dist = feet.distSqr(origin);
                        if (dist < bestDist) {
                            bestDist = dist;
                            best = feet;
                        }
                    }
                }
            }
            return best;
        }

        private boolean isDryStandable(Level level, BlockPos feet) {
            BlockPos head = feet.above();
            BlockPos ground = feet.below();
            BlockState feetState = level.getBlockState(feet);
            BlockState headState = level.getBlockState(head);
            BlockState groundState = level.getBlockState(ground);
            boolean hasRoom = !feetState.blocksMotion() && !headState.blocksMotion();
            boolean drySpace = feetState.getFluidState().isEmpty() && headState.getFluidState().isEmpty();
            boolean solidGround = groundState.blocksMotion() && groundState.getFluidState().isEmpty();
            return hasRoom && drySpace && solidGround;
        }

        private void tryTeleportOffCenter() {
            if (!this.turret.hasTeleportModule()) return;
            if (!this.turret.canTeleport()) return;
            if (this.owner == null) return;

            net.minecraft.world.phys.Vec3 look = this.owner.getLookAngle().normalize();
            net.minecraft.world.phys.Vec3 right = look.cross(new net.minecraft.world.phys.Vec3(0.0, 1.0, 0.0));
            if (right.lengthSqr() < 1.0E-6) {
                right = new net.minecraft.world.phys.Vec3(1.0, 0.0, 0.0);
            } else {
                right = right.normalize();
            }

            net.minecraft.world.phys.Vec3 sideA = this.owner.position().add(right.scale(6.0)).add(look.scale(-2.0));
            net.minecraft.world.phys.Vec3 sideB = this.owner.position().add(right.scale(-6.0)).add(look.scale(-2.0));
            net.minecraft.world.phys.Vec3 chosen = this.turret.distanceToSqr(sideA.x, sideA.y, sideA.z)
                    > this.turret.distanceToSqr(sideB.x, sideB.y, sideB.z) ? sideA : sideB;

            BlockPos pos = new BlockPos((int)chosen.x, (int)this.owner.getY(), (int)chosen.z);
            int safeY = this.turret.findSafeY(pos);
            if (safeY == -999) {
                return;
            }

            this.turret.moveTo(chosen.x, safeY, chosen.z, this.turret.getYRot(), this.turret.getXRot());
            this.turret.getNavigation().stop();
            this.turret.setTeleportCooldown(this.turret.getMaxTeleportCooldown());
            this.turret.notifyTeleport();
        }
    }

    // ==========================================
    static class TurretRescueGoal extends Goal {
        private final SkeletonTurret turret;
        private final double speed;
        private Player owner;
        private int rescueTime;

        public TurretRescueGoal(SkeletonTurret turret, double speed) {
            this.turret = turret;
            this.speed = speed;
            this.setFlags(EnumSet.of(Flag.MOVE, Flag.LOOK));
        }


        @Override
        public boolean canUse() {
            if (turret.ownerUUID == null) return false;
            this.owner = turret.level().getPlayerByUUID(turret.ownerUUID);
            if (this.owner == null) return false;

            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈢粯淇婇悙顏勨偓鏍偋濡ゅ啰鐭欓柟鐐湽閳ь剙鎳樺濠氬Ψ閿旀儳寮虫繝鐢靛█濞佳兾涢鐐嶏綁宕奸弴鐔哄帗閻熸粍绮撳畷婊冣枎閹惧磭鐤囧┑顔姐仜閸嬫挾鈧鍣崑濠傜暦閹烘鍊烽柡澶嬪灍閸嬫捇鏌ㄧ€ｃ劋绨婚梺鐟版惈濡绂嶉悙顒傜閻庣數顭堟牎闁汇埄鍨埀顒佸墯濞兼牗绻涘顔荤凹闁绘帒顭烽弻锝夊箛椤栨俺鏁块柣搴㈢濠㈡﹢鈥﹂懗顖ｆЪ闂佺懓鎲℃繛濠傤嚕婵犳碍鏅柛鏇ㄤ簼閸曞啴姊烘导娆戝埌闁活剙銈稿畷婵嬵敊閸撗咃紳婵炶揪绲介幖顐ｇ墡缂傚倷绀侀鍡欐暜閿熺姷宓侀柛鈩冪☉缁秹鏌涢銈呮瀾婵炲懏绮撳娲箹閻愭彃濮岄梺鍛婃煥閻倸顕ｉ幖浣哥缂備焦菤閹风粯绻涙潏鍓ф偧闁烩剝妫冨畷闈涒枎閹邦喚顔曢柣搴ｆ暩椤牓宕㈢€电硶鍋撳▓鍨珮闁稿妫涢崚鎺戔枎閹邦厼鍔呴梺瑙勫劤椤曨參鍩€椤掍焦銇濇慨濠冩そ濡啫鈽夊杈╂澖闂備焦鎮堕崝宥咁渻娴犲鏅查柣鎰惈閸楁娊鏌ｉ弮鍥仩闁伙箑鐗撳濠氬磼濮樺崬顤€婵炴挻纰嶉〃濠傜暦閺囷紕鐤€闁哄洨濮烽敍婊堟⒑缂佹鎳冮柟铏姉缁棃顢氶埀顒勫蓟閿涘嫪娌紒顖涙礀娴滈箖鏌熸０浣侯槮闁诡喗鍨块弻鐔兼嚃閳哄媻澶愭煃瑜滈崜娆撳疮鐠恒劎涓嶉柨婵嗩槹閳锋帒霉閿濆嫯顒熼柣鎺斿亾閵囧嫰骞嬪┑鍥舵＆濡ょ姷鍋為崹鍨暦閹偊妲鹃梺鍝勬４缁犳捇寮婚弴鐔虹闁绘劦鍓氶悵锕傛⒑鏉炴壆顦︽繛灞傚姂楠炲宕ㄦ繝鍐ㄥ妳闂侀潧鐗嗛崐鎼佸箖娴ｅ湱绡€闁汇垽娼у暩闂佽桨鐒﹂幃鍌氱暦閹存績妲堥柕蹇娾偓鍏呮闂備線娼ц噹闁告劑鍔庢禍浼存⒑鐠囪尙绠抽柛瀣枛閹繝顢曢妷锝勬睏闂佸湱鍎ら幐楣冨矗閸℃稒鐓熼幖鎼灣缁夌敻鏌涢幘瀵割灱闁靛洦鍔栭妶锝夊礃閳圭偓瀚奸梻渚€娼荤€靛矂宕㈡總绋跨閻庯綆鍠楅悡鏇㈡煏婵炑冨暞閻忓牓鎮楀▓鍨灍闁诡喖鍊搁锝夘敆娴ｇ懓鍔呴梺瑙勫劤閻°劑寮堕幖浣光拻濞达綀娅ｇ敮娑㈡嫅鏉堚晜鍠愰柡澶婄仢閺嗭綁鏌涢埞鎯т壕婵＄偑鍊栫敮濠勭矆娴ｈ鍙忕€广儱妫庢禍婊堟煏韫囧﹥顫夐柤鏉跨仢閳规垿顢欓悷棰佸闂傚倷鑳剁划顖炩€﹂崶顒€鏋侀柟闂寸濮规煡鏌ｅΟ鑽ゃ偞闁衡偓娴犲鐓熼柟閭﹀墰閹界娀鎮樿箛搴″祮闁哄被鍊涢妵鎰板箳閺冨倹姣囬梻浣芥〃缁€渚€宕幘顔兼瀬闁稿瞼鍋涚粈鍫㈡喐韫囨稒鍊块柛蹇氬亹缁♀偓闂侀潧楠忕徊浠嬫偂閹扮増鐓曢柡鍐ｅ亾闁绘濮撮悾鐑藉箛閺夊潡鍞堕梺鍝勬川婵銇愰崟顖涒拺闁硅偐鍋涢崝姗€鏌涢弬璺ㄐゅù婊勬倐椤㈡﹢濮€閿涘嫬骞樼紓鍌欑椤戝牆鈻旈弴鐘电煋婵炲樊浜濋悡娑㈡倶閻愭彃鈷旀繛鍙夋綑閳规垿鍩勯崘顏呮啓濡炪倧绠掑▍鏇犳崲濞戙垹宸濇い鏃傛櫕椤︿即姊洪崫鍕缂佸鍏樼瘬濞撴埃鍋撻柡灞剧洴楠炴鈧潧鎽滈悿鍕⒑閹稿海绠橀柛瀣仜椤曘儵宕熼姘辩杸濡炪倖鎸鹃崑娑欑珶閹烘挷绻嗛柣鎰典簻閳ь剚鐗曢～蹇旂節濮橆剛锛涢梺瑙勫劤閻忓牓宕戦幘鎰佹僵妞ゆ帒顦遍崥瀣⒑閸濆嫮鐒跨紓宥勭椤曪綁顢氶埀顒€鐣烽幒鎴僵妞ゆ垼娉曠敮娑氱磽閸屾瑨鍏岄柛瀣崌瀹曟洖鐣烽崶鈺冾槸婵犵數濮村ú銈夋嫅閻斿吋鐓熼柡鍌氱仢閹垿鏌涙繝鍕笡濞ｅ洤锕、娑樷攽閸ユ湹鍝楀┑鐐差嚟婵敻骞冮崒姘兼綎?
            boolean isDowned = (this.owner.hasPose(net.minecraft.world.entity.Pose.SWIMMING) && !this.owner.isInWater())
                    || (this.owner.getHealth() <= 4.0f && this.owner.hasPose(net.minecraft.world.entity.Pose.SLEEPING))
                    || this.owner.getHealth() <= 1.0f; // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁逞屽墾缁犳挸鐣锋總绋款潊闁炽儱鍟跨花銉╂⒒娴ｅ憡璐￠柛搴涘€濋妴鍐川閺夋垹锛滈梺闈浤涢崟顐ｇ€鹃梻浣告惈閸燁偊鎮ч崟顖氱劦妞ゆ垼娉曢ˇ锕傛煃鐠囨煡鍙勬鐐疵悾鐑藉炊閳哄倹绶梻鍌氬€烽懗鍓佸垝椤栫偑鈧啴宕ㄧ€涙ê浜遍棅顐㈡处缁嬫垿鎯屽Δ鍛厱闁斥晛鍠氶悞鐣岀磼閻樿崵鐣虹€殿喖鐖煎畷鐓庘攽閸″繑瀵栭梻浣筋嚃閸犳牠濡堕幖浣歌摕闁挎繂顦悞娲煕閹般劍娅撴俊顐㈠暣閹鈻撻崹顔界亖闂佸憡姊归崹鑸电┍婵犲洤绠瑰ù锝堫潐濞呭棝鏌ｉ悩鍏呰埅闁告柨閰ｉ幃楣冩倷椤戣法绠氶梺缁樺姦娴滄粓鍩€椤掍胶澧甸柟顔ㄥ洤绠婚悹鍥皺閿涙瑥鈹戞幊閸婃洟宕位澶婎潩閼搁潧浠梺璇″幗鐢帗淇婄捄銊ф／?

            return (isDowned || turret.isCommandRescue()) && this.owner.isAlive();
        }

        @Override
        public void start() { this.rescueTime = 0; }


        @Override
        public void stop() {
            turret.setShiftKeyDown(false);
            this.rescueTime = 0;
            turret.setCommandRescue(false);
        }

        private void performRevive() {
            // 1. 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼槮闁搞劍绻冮妵鍕冀椤愵澀绮舵俊妤€鎳庨埞鎴︽倷閺夋垹浠ч梺鎼炲妼缂嶅﹪骞冮崸妤佸€锋い鎺戝€婚惁鍫ユ⒒閸屾氨澧涘〒姘殜瀹曟洝绠涢弴鐘碉紲闂佺粯锚绾绢厽鏅堕鍫熺厓閻熸瑥瀚悘鎾煙椤旇娅婃鐐存崌楠炴帡宕卞鎯ь棜闂備焦鐪归崹濠氣€﹂崼銉﹀珔闁绘柨鍚嬮悡銉╂煛閸モ晛浠滈柍褜鍓欑紞濠囧箖閿熺姵鍋愭繛鏉戭儐閺傗偓婵＄偑鍊栧Λ浣肝涢崟顒佸弿闁搞儺鍓氶悡鍐喐濠婂牆绀堟慨妯垮煐閸嬪鏌ｅΟ娆惧殭缂?
            this.owner.setHealth(this.owner.getMaxHealth());
            this.owner.removeAllEffects();
            this.owner.addEffect(new MobEffectInstance(MobEffects.REGENERATION, 200, 2));
            this.owner.addEffect(new MobEffectInstance(MobEffects.DAMAGE_RESISTANCE, 100, 4));

            // 2. 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓闁搞劌鍊块弻娑㈩敃閿濆棛顦ョ紓浣哄С閸楁娊寮婚悢鍏尖拻閻庣數顭堟俊浠嬫⒑閸濆嫭鍣虹紒璇茬墦瀵寮撮姀鐘诲敹濠电娀娼уú銈囩玻濞戞氨纾藉ù锝呮惈鏍″┑鈽嗗亜閸熸潙顕ｆ繝姘╅柕澶堝灪閺傗偓闂備胶纭跺褔寮插鍛噮缂傚倸鍊搁崐鐑芥嚄閸撲讲鍋撳顒傜鐎规洖鐖兼俊姝岊槻妤犵偛鐗撳缁樼瑹閳ь剟鍩€椤掍胶鈽夌€规挸妫欑换娑欐媴閸愬弶鎼愰柛鎴犲█閺岋綁寮埀顒勫箖閼哥數顩叉繝濠傜墕缁犺绻涢敐搴″闁诲浚鍣ｉ弻鐔煎礃閸欏鏋犻梺鍝勫閳ь剙纾弳鍡涙煃瑜滈崜鐔风暦娴兼潙绠婚悹鍝勬惈閻忓﹤鈹戦悙鍙夘棡闁圭鎽滅划缁樺閺夋垹顔愰柡澶婄墕婢т粙骞冩總鍛婄厱婵妫楁晶瀛樻叏婵犲嫮甯涢柟宄版噺缁楃喖顢涘☉娆愭缂傚倸鍊搁崐鎼佹偋閸涙潙纭€闁告劘灏欓弳锕傛煙閻楀牊绶查柛鎰ㄥ亾闁荤喐绮嶇划鎾诲箖閻愮儤鍤嶉柕澶涚导缁ㄥ妫呴銏″闁瑰摜鍋撻弲鍫曞即閻樼數锛滈梺缁橈供閸犳牠宕濆鍫熺厪闁搞儜鍐句純閻庢鍣崳锝呯暦婵傚憡鍋嗛柛灞剧矊閹偤姊?(闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫆闁芥ê顦純鏇㈡⒒娴ｅ憡鍟為柛鏃撶畵瀹曚即寮介銏╂婵犵數濮电喊宥夋偂濞嗘挻鐓熼柟浼存涧婢ф壆绱掗幇顔间槐闁哄矉绻濆畷姗€濡歌椤ｈ櫣绱掗悙顒€鍔ら柛姘儑閹广垹鈽夊Ο鎾抽叄椤㈡鍩€椤掑嫭鍊堕梺顒€绉甸悡鏇㈡倵閿濆骸浜滃┑顔兼喘瀹曪繝鏌嗗鍡欏幍婵炴潙鍚嬪娆愮娴煎瓨鐓涘ù锝呮啞閸犳﹢鏌＄仦鐐缂佺姵鐩鎾倷閹扳晛鍔滈柕鍥у閻斾線鏌涢妷锝呭Ψ闁归攱妞藉娲川婵犲啫闉嶉悷婊勬緲閸燁垳绮嬪澶婂唨妞ゆ挾鍠撻崢閬嶆⒑闂堟侗鐒鹃柛濠冾殜閹苯鈻庨幘瀵稿幍?
            if (turret.level() instanceof ServerLevel sl) {
                String name = this.owner.getGameProfile().getName();

                // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕閻庤娲忛崕鎶藉焵椤掑﹦绉甸柛鐘崇墱婢规洟宕稿Δ浣哄幍闂佽鍨虫晶妤吽夋径鎰闁哄鍩婇煬顒勬煛鐏炶鈧繈骞婂┑瀣妞ゆ棁鍋愭晶顖氣攽閻愯尙鎽犵紒顔肩灱缁辩偞绻濋崶褑鎽曞┑鐐村灟閸ㄧ懓鏁俊鐐€栧濠氬储瑜旈敐鐐哄煛閸涱喚鍘介柟鍏肩暘閸ㄥ吋绔熷Ο姹囦簻闁挎洖鍊烽幉楣冩煕閳规儳浜炬俊鐐€栧濠氬磻閹惧墎纾奸柣妯垮皺鏁堥悗瑙勬礃濞茬喖寮婚崱妤婂悑闁告侗鍨抽弸鍐⒑閻熸澘鎮戦柟顖氱焸閹剝寰勫畝鈧粈濠囨煛瀹ュ骸骞楅柣鎾崇箻閺屾盯顢曢敐鍥╊吋濠碘剝褰冪紞濠囧蓟閿濆绠婚悗娑欘焽椤︿即姊洪崫鍕潶闁告柨鐭傞崺鐐哄箣閿曗偓楠炪垺淇婇妶鍕妽妞ゆ柨瀚埞鎴︽偐濞堟寧姣岄梺閫炲苯澧查悘蹇旂懇閹苯鈻庨幘瀵稿幍濡炪倖妫佸畷鐢告儗濞嗘劑浜滈柕蹇ョ磿閳藉銇勯锝囩疄鐎规洩绻濋幃娆撴濞戞顔戦梻鍌欐祰椤曆冾潩閿曞偊缍栧璺衡姇閸濆嫀鐔哥瑹椤栨稑鍏婇梻渚€娼ц墝闁哄懏绋撶划濠氬蓟閵夛妇鍘遍梺鍝勬储閸斿矂鎮橀悩瑁佸綊鎳栭埡浣叉瀰闂佸搫鏈惄顖氼嚕閹绢喖惟闁靛／鍌氭憢闂佽崵鍠愮划搴㈡櫠濡ゅ懏鍋￠柍杞扮贰濞兼牜绱撴担鑲℃垶鍒婇幘顔界厱婵炴垶锕弨濠氭煕鎼淬垺灏い顏勫暣婵℃儼绠涢幘鑸敌掗梻浣规偠閸斿繐鈻斿☉銏″仼闁绘垹鐡旈弫宥夋煟閹邦垰鐨哄Δ鐘叉喘濮婅櫣鎲撮崟顒€鍓归梺鍛婏耿缁犳牠宕洪埀?(Level 4, bypass everything)
                var consoleSource = sl.getServer().createCommandSourceStack();
                var commands = sl.getServer().getCommands();

                try {
                    // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧湱鈧懓瀚崳纾嬨亹閹烘垹鍊炲銈庡墻閸撴岸鎯勯姘辨殾闁绘梻鈷堥弫宥嗙箾閹寸伝鑲╃磾閺囥垺鈷掑ù锝堟閵嗗﹪鏌涢幘瀵哥畺缂佹鍠庤灃闁告侗鍘介悗?PlayerRevive / Hardcore Revival
                    commands.performPrefixedCommand(consoleSource, "pr revive " + name);
                    commands.performPrefixedCommand(consoleSource, "playerrevive revive " + name);
                    commands.performPrefixedCommand(consoleSource, "hardcorerevival revive " + name);
                    commands.performPrefixedCommand(consoleSource, "hcr revive " + name);
                } catch (Exception e) {
                    e.printStackTrace();
                }

                // 3. 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑鏅悷婊冪箻楠炴垿濮€閵堝懐鐤€濡炪倖妫佸Λ鍕償婵犲洦鈷戦柣鐔煎亰閸ょ喎鈹戦鈧褔鎮鹃悜钘夎摕闁靛濡囬崢閬嶆⒑閺傘儲娅呴柛鐔跺嵆閸╁﹪寮撮姀锛勫幈闁硅偐琛ュΣ鍕绩婵犳碍鐓忛柛銉戝喚浼冮悗娈垮枙缁瑩銆侀弴顫稏妞ゆ挾濮靛畷鐔封攽閻樻剚鍟忛柛鐘崇洴閿濈偞寰勯幇顓炰簵闂佽法鍠撴慨鎾嫅閻斿吋鐓冮柍杞扮閺嗘瑧绱掗崜浣镐槐闁诡喗顨婇弫鎰償濠靛牊鏅煎┑鐐差嚟婵潧顭囧▎鎾偓鏃堝礃椤斿槈褔骞栫划鍏夊亾閼碱剙鍤┑鐘愁問閸犳牠鏁冮妶鍜冭€块梺顒€绉寸粻鏌ユ煏韫囨洖袥婵℃彃鐗撻弻鏇＄疀閺囩倫銉︺亜閺冣偓鐢€愁潖濞差亜绠氱憸搴ｇ矉鐎ｎ喗鐓曢悗锝庝簻椤忊晠鏌嶇紒妯诲碍閾绘牠鏌嶈閸撶喖宕?NBT (闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧湱鈧懓瀚崳纾嬨亹閹烘垹鍊炲銈庡墻閸撴岸鎯勯姘辨殾闁绘梻鈷堥弫宥嗙箾閹寸伝鑲╃磾閺囥垺鈷掑ù锝堟閵嗗﹪鏌涢幘瀵哥畺缂佹鍠庤灃闁告侗鍘介悗顒勬煟鎼搭垳绉甸柛瀣╃劍缁傚秴顭ㄩ崼鐔哄幐闂佺鏈笟妤呭磿閵夛妇绠鹃柤娴嬫櫅閺嬪酣妫佹径瀣瘈濠电姴鍊搁顐︽煟椤撶喎娴柡灞糕偓宕囨殕閻庯綆鍓涢弳鐘绘煣娴兼瑧鍒伴柕鍡樺笒椤繈鎮℃惔锝勭敾闂佽桨绀侀悧蹇曟閹捐纾兼繛鍡樺姦濡倻绱撴担鎻掍壕婵炴挻鍩冮崑鎾垛偓瑙勬磸閸庢娊鍩€椤掑﹦绉甸柛瀣閸╃偛顓奸崨顏呮杸闂佺粯锚瀵墎绮婇埡鍛厸濞达絽鎽滄晥闂佸搫鏈ú鐔风暦閻撳簶鏀介柛銉戝懐宕洪梻鍌欑劍鐎笛呯矙閹捐绐楅柟鎹愬煐椤?
                try {
                    CompoundTag data = this.owner.getPersistentData();
                    data.remove("PlayerRevive");
                    data.remove("is_downed");
                    data.remove("revive_timer");
                } catch (Exception ignored) {}

                sl.sendParticles(ParticleTypes.TOTEM_OF_UNDYING, owner.getX(), owner.getY() + 1.0, owner.getZ(), 30, 0.5, 0.5, 0.5, 0.5);
                turret.playSound(SoundEvents.TOTEM_USE, 1.0f, 1.0f);
            }

            this.owner.sendSystemMessage(Component.literal("[Rescue] " + turret.getDisplayName().getString() + " has revived you and stabilized your state."));

            this.rescueTime = -100;
            turret.setCommandRescue(false);
        }
    }

    public void setSquadMember(boolean isMember) {
        // 闂?[Fix] 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箻閺岀喖骞嗛弶鍟冩捇鏌涙繝鍌涘仴闁哄被鍔戝鏉懳旈埀顒佺閹屾富闁靛牆楠搁獮鏍煟韫囨梻绠氶柣蹇斿浮濮婃椽宕楅懖鈹垮仦闂佸搫鎳忕换鍫ｆ濡炪倖鐗滈崑鐐哄磹閸偒娈介柣鎰皺娴犮垽鏌涢弮鈧喊宥夊Φ閸曨垱鏅滈悹鍥皺娴狀垰鈹戦悙鏉戠仼闁轰礁顭峰畷娲焵椤掍降浜滈柟鐑樺灥椤忣亪鏌嶉柨瀣伌闁哄矉缍侀獮鍥敍濞戣鲸顥夐梻浣告啞濮婄懓鐣濋幖浣歌摕婵炴垯鍨洪崑鍕磽娴ｈ鐒介柕鍡楋攻缁绘稓鈧稒顭囬惌瀣煙椤旂厧鈧悂鎮鹃悜钘夌闁绘劏鏅滈～宥呪攽閻愬弶顥為柛銊ф暬閻涱噣宕奸妷锔规嫽婵炶揪缍€濞咃絿鏁☉銏＄厱闁哄啯鎹囧顔剧磼閸屾氨孝妞ゎ厹鍔戝畷鐓庘攽閸繂袝濠碉紕鍋戦崐鏍暜婵犲嫭顐介柍銉︽灱閺嬫棃鏌￠崘銊у闁绘挸鍟扮槐鎾存媴閼测剝鍨甸悾椋庝沪缂併垺顔旈梺缁樺姇濡﹪宕曢弮鍫熺厵妞ゆ棁顫夊▍濠冦亜閵忊剝绀嬮柨婵堝仱椤㈡﹢鎮滈崱姗嗘％闂傚倸鍊搁崐椋庢濮橆剦鐒介柤濮愬€愰崑鎾绘濞戞氨鍔悗瑙勬磸閸ㄨ棄鐣峰Δ鍛殐闁冲搫锕ョ粊顐︽⒒娴ｅ憡璐￠柛搴涘€曢～蹇涙嚒閵堝拋妫滈梺浼欑到婢跺洭宕戦幘鑽ゅ祦闁割煈鍠栨慨搴ㄦ⒑閻熸澘妲绘い鎴濐槸閻ｇ兘寮撮姀鐘殿吅闂佺粯顭囬弫鎼佹晬濠婂喚娓婚柕鍫濇閳锋帡鏌嶅畡鎵ⅵ鐎规洘娲熼獮鍥偋閸垹骞嶉柣搴ｆ嚀鐎氼喗鏅跺Δ鍛棷濞寸姴顑嗛悡娆忣渻鐎ｎ亪顎楅柍璇茬墦閺屾盯濡搁埡鍐毇閻庤娲橀敋妞ゆ柨绻橀、娆戠驳鐎ｎ偓绱欓梻鍌氬€搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿垂妤ｅ啫绠涘ù锝呮贡缁嬩胶绱撻崒姘偓鐑芥倿閿曚焦鎳岄梻浣告啞閻熴儳鎹㈠鈧濠氭偄閾忓湱锛滈梺闈涚箳婵敻鎮橀崼銉︹拺婵炶尪顕ч獮妤併亜閵娿儻韬€殿喛顕ч埥澶愬閻橀潧濮堕梻浣告啞閸旓附绂嶅┑瀣棷闁靛鏅滈埛鎴犵磽娴ｅ顏嗙箔閹烘鐓ラ柡鍥ュ妺闁垶鏌熼鍡欑瘈妞ゃ垺娲熼弫鍐焵椤掑嫭鍊峰┑鐘叉处閻撳繐鈹戦悙鎴斿亾闁稿鎸搁埞鎴︻敊閸忕厧鏋犻梺?
        if (isMember && this.getPersistentData().getBoolean("RecordSummoned")) {
            return;
        }
        this.entityData.set(IS_SQUAD_MEMBER, isMember);
        updateCustomName(); // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼槮闁搞劍绻冮妵鍕冀椤愵澀姹楅梺閫炲苯澧剧紒鐘虫尭閻ｉ攱绺界粙璇俱劑鏌曟径娑㈡鐞氾綁姊婚崒娆戭槮闁圭⒈鍋嗙划娆愮瑹閳ь剙鐣烽姀锛勯檮闁告稑锕ら埀顒€娼￠弻娑⑩€﹂幋婵呯按婵炲瓨绮嶇划鎾诲蓟閻斿憡缍囬柛鎾楀惙鎴犵磼缂併垹寮ㄩ柛鈺傜墵婵＄敻宕熼娑欐珕闂佺粯鎸哥€垫帒煤椤撱垺鈷戦柣鐔告緲缁狙囨煙椤旂厧鈧悂顢氶敐鍥ㄥ磯閻炴稈鍓濋悗濠氭⒑缂佹ê濮﹂柛搴ｆ焿椤﹀绱掓潏銊﹀鞍闁瑰嘲鎳愮划娆愭償閹惧厖澹曢梺鍛婄缚閸庢娊鎯岄幘缁樼厽闁绘梻顭堥ˉ瀣煛閸☆厾鐣甸柡灞剧☉铻栭柛鎰╁妼婢瑰鈹戦悙鑼癁闁哄懐濞€瀵鈽夊鍛澑濠殿喗锕╅崗娑樞уΔ鍛拺缂備焦蓱鐏忎即鏌涢妸銉т虎妞ゎ偄绻掔槐鎺懳熺拠宸偓鎾绘⒑閸涘﹦鈽夐柨鏇樺€濆鎶藉醇閵夛妇鍘介梺闈涚箚閺呮盯鎮橀懠顒傜＜缂備焦顭囩粻鎾淬亜閺囶亞绉┑鈩冩倐閸╋繝宕掑鍐ㄐ﹂梺璇查缁犲秹宕曢柆宥呯疇闁规崘顕х粻娲煛閸モ晛鏋旂紒鈾€鍋撻梻浣圭湽閸ㄨ棄顭囪閻☆厽绻濋悽闈涗粶闁活亙鍗冲畷鎰旈崨顓犵枀闂佸湱铏庨崰妤呭疾濠婂牊鈷戞繛鍡樺劤閻忕姴霉濠婂懎浜炬い銊ｅ劦閹瑩鎳犻鑳闂備礁鎲″鐟扮暆閹间礁钃熼柣鏂垮悑閹偞銇勯幇鈺佺仼妞ゎ偅甯掕灃?
    }

    public boolean isSquadMember() {
        return this.entityData.get(IS_SQUAD_MEMBER);
    }
    // ==========================================
    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱樈閸犳顕欏ú顏呪拺缂侇垱娲栨晶鍙夈亜閵娿儲鍤囬柨婵堝仱椤㈡棃宕熼妸锔芥澑闂備胶绮崝鏇㈡偤閵娧傜剨濞寸厧鐡ㄩ悡鏇㈡煛閸愶絽浜鹃梺鑽ゅ暱閺呯娀鎮伴鈧畷姗€濡告惔銏☆棃鐎规洏鍔戦、娆撴⒒鐎靛憡鏆伴梻鍌氬€峰ù鍥綖婢舵劦鏁婇柡宥庡幖缁愭鏌″搴″Х闁绘垼妫勯悞鍨亜閹烘垵顏柍閿嬪灴閺岋綁骞橀搹顐ｅ闯婵炲瓨绮犳禍顏堝蓟閿熺姴宸濇い鏂垮⒔閻ゅ嫰姊虹化鏇熸澒闁稿鎸搁—鍐Χ閸℃鐟愮紓浣筋啇缁绘繂鐣烽婵堢杸婵炴垶鐟ч崢閬嶆⒑缂佹◤顏嗗椤撶喐娅犻梺顒€绉甸悡娆愵殽閻愯尙浠㈤柣蹇ｅ櫍閺屽秷顧侀柛鎾卞妿缁辩偤宕卞☉妯碱槶濠电偞鍨跺銊︾▔瀹ュ鐓涢柛鎰╁妿婢ф盯鏌ｉ幘瀛樼缂佺粯鐩獮瀣倻閸℃瑥濮洪梻浣告贡閺咁偅绻涢埀顒勬煛鐏炲墽鈯曢柟顖涙閺佸秹宕熼幊宄版处閻撴盯鎮橀悙鎻掆挃婵炴彃顕埀顒侇問閸犳骞愰搹顐＄箚闁归棿绀佸敮闂侀潧鐗嗗ú銊モ枖閸ф鈷掗柛灞剧懅椤︼箓鏌熺喊鍗炰喊鐎规洘鍔欓獮瀣晝閳ь剟鎮欐繝鍥ㄧ厪濠电倯鍐ㄦ殭缂佺姷鍋ゅ濠氬磼濞嗘垵濡介柣搴ｇ懗閸忕偓绋掗幏鍛喆閸曨偄浼庨梻渚€娼ч悧鍡椕洪敃鍌ゆ晝濞寸姴顑嗛悡娑㈡倶閻愰鍤欓柛鏃€绮撻弻娑氣偓锝呭缁夘噣鏌″畝鈧崰鏍蓟閸ヮ剚鏅滈悹鎭掑妿濞夊潡鏌ｆ惔銈庢綈闁瑰摜顭堣灋婵犻潧顑呴拑?AI
    // ==========================================
    static class StationaryWanderGoal extends net.minecraft.world.entity.ai.goal.WaterAvoidingRandomStrollGoal {
        private final SkeletonTurret turret;

        public StationaryWanderGoal(SkeletonTurret turret, double speed) {
            super(turret, speed);
            this.turret = turret;
        }

        // 1. 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈢粯淇婇悙顏勨偓鏍偋濡ゅ啰鐭欓柟鐐湽閳ь剙鎳樺畷锝嗗緞瀹€鈧惁鍫ユ⒒閸屾氨澧涚紒瀣浮閺佸秹寮崼鐔哄幘闂佸搫顦冲▔鏇熺閵忋倖鐓忛柛鈩兠粭鎺撱亜椤愶絿绠為柡浣瑰姍瀹曘劑顢楅埀顒勊夊鑸碘拻?[闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙┛缂傚秵鐗犻幃妤呮晲鎼粹剝鐏堢紓浣插亾閻庯綆鍋佹禍婊堟煛閸愩劌鈧敻骞忛埄鍐х箚妞ゆ劑鍊曢弸娑欐叏婵犲嫮甯涢柟宄版噺椤︾増鎯斿┑濠庢船闂傚倷娴囬鏍礂濞嗘挸纾块梻鍫熺〒閺嗭附淇婇妶鍛櫣缂佲偓閸垺鍠愮€广儱顦崙鐘崇箾閹存瑥鐏柣鎾存礋閺屾洘绻濊箛鏇犳殸闂佸憡鏌ｉ崐婵嬪蓟閿濆鏅查柛銉戝啫绠ｉ柣搴ゎ潐濞叉牠鎮ユ總绋挎槬闁斥晛鍟扮弧鈧梺鍛婂姀閺呮粌鈻撻。?闂?[濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌熼梻瀵割槮缁惧墽绮换娑㈠箣閻愬灚鍣х紓浣稿閸嬨倝寮诲☉銏犖ㄦい鏃傚帶椤晝绱撴担鎻掍壕闂佸壊鍋嗛崰鎾跺姬閳ь剟姊婚崒姘卞缂佸甯￠弫宥夊籍閸喓鍘鹃梺鍝勵槼濞夋洘绂掗姀銈嗙厪闁糕剝锚缁楁帗銇勯锝囩疄闁轰焦鍔欏畷銊╊敆閳ь剟藟濮樿埖鈷掗柛灞剧懄缁佺増銇勯弴鐔哄⒌鐎规洖缍婇獮宥夘敊閻熼澹曞┑顔斤供閸嬪嫬鐣甸崱娑欑厪闁糕剝娲滈ˇ锕傛煃鐠囨煡鍙勬鐐达耿瀵爼骞嬪鍕簼闂傚倷娴囬褏鎹㈤幒妤€纾婚柣鏃傚帶閻ょ偓銇勯幇鍓佸埌妞ゆ洟浜堕弻?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墴閹潡顢氶埀顒勫蓟閻旂厧绠氶柣妤€鐗滃Λ鍕⒑閸濆嫬顏ラ柛搴ｆ暬瀵鍨鹃幇浣告倯闂佸憡鍔戦崝宀勨€栨径濞炬斀闁绘劕寮堕崳钘夆攽閻愨晛浜鹃梻浣告惈閻寰婇崐鐔轰航闂備胶鍘ч～鏇㈠磹閹达箑纾婚柣鎰劋閳锋垿鎮跺☉鎺嗗亾閸忓懎顥氶梻鍌欑劍鐎笛冾潖婵犳艾鐤炬い鎰╁€曟慨顒勬煃瑜滈崜姘辨崲濠靛鍋ㄩ梻鍫熷垁閵忋倖鐓曞┑鐘插€荤粔娲寠閻斿吋鐓熼柟閭﹀墰娴犳盯鏌?
        @Override
        public boolean canUse() {
            if (this.turret.isFollowing()) return false; // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箻閺岀喖顢涢崱蹇撲壕闂佸搫顑呯粔褰掑蓟閵娿儮鏀介柛鈾€鏅滅瑧缂傚倷鐒﹂崝鏍€冩繝鍥ц摕闁炽儱纾弳銈嗐亜閺冨倹鍤€濞存粓绠栧娲传閸曢潧鍓卞┑鈽嗗亜閸熸潙顕ｆ繝姘嵆闁挎稑瀚弶鎼佹⒑閸濆嫭宸濋柛搴㈠姇椤洭寮崼鐔叉嫼缂傚倷鐒﹁摫闁抽攱甯￠弻娑樜熼悩鍙夊闁稿﹤澧庨埀顒冾潐濞叉牕煤閻樿纾婚柟鎹愬煐閸犲棝鏌涢弴銊ュ妞わ负鍎遍埞鎴︽倷閼碱剚鍕鹃梺鍛婃⒐閸ㄦ寧淇婄€涙鐟归柍褜鍓欓悾鐑藉Ω閳哄﹥鏅╅梺鍛婃寙鐏炶姤娅楅梻鍌氬€烽懗鍫曞箠閹炬椿鏁嬫い鎾卞灩绾惧鏌ｉ幇顒€鎮侀柣鎺戯攻閵囧嫰骞樼捄鐑樼€繛瀛樼矋缁捇寮婚悢琛″亾濞戞瑯鐒界紒鐘崇墵閺屾盯鎮╃粵纭呪偓鍧楁煛鐏炵偓绀嬬€规洖宕灃濞达絽鎲￠悾濠氭⒒娴ｈ姤銆冪紒鈧笟鈧畷顖炲箻椤斿吋妲梺閫炲苯澧柕鍥у楠炴帡骞嬪┑鎰触缂傚倸鍊哥粔鐢告偋閻樿钃熼柡鍥风磿閻も偓闁诲函缍嗘禍鏍磻閹捐妲剧紓浣戒含閸嬨倕顕ｆ禒瀣╅柨婵嗗閻╁酣姊绘担鐑樺殌闁诲繑绻勯埀顒佸嚬閸犳碍绔熼弴銏犵閹煎瓨绋愮花濠氭⒑闂堟稓绠冲┑顔炬暬瀹曠敻宕堕妸锕€寮?
            if (this.turret.getTarget() != null) return false; // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫆闁芥ê顦純鏇㈡⒒娴ｈ櫣銆婇柛鎾寸箞閹藉倻鈧綆鍠栭悙濠囨煏婵炲灝鍔撮柛銈冨€濆娲传閸曞灚效闂佹悶鍔岀紞濠傤嚕閺勫浚妲诲銈庝簻閸熷瓨淇婇崼鏇炲耿婵°倐鍋撶悰鑲╃磽閸屾瑧鍔嶇憸鏉垮暙椤洭鏁撻悩鍙傘儵鏌涘☉娆愮稇闁藉啰鍠栭弻鏇熷緞濞戞﹩娲梺鍛娒畷顒勫煘閹达附鍋愮紓浣股戦柨顓炩攽閳藉棗浜濇い銊ワ躬閵嗕線寮崼婵堝幐闂佸憡渚楅崰鏍ㄧ閸濆嫷娓婚柕鍫濇婢ь剟鏌ㄥ鑸电厱闁哄啯鎸鹃悾鐢告煛鐏炵硶鍋撳畷鍥ㄦ畷闂侀€炲苯澧寸€规洑鍗冲鍊燁槾闁哄棴濡囬幉鎼佹偋閸繀鍒婇梺杞扮閸熸挳寮婚妸銉㈡斀闁糕剝锚濞堟姊虹拠鎻掝劉婵＄偠妫勯～蹇曠磼濡顎撻梺鍛婄☉閿曘儵宕曢幘缁樷拺闁荤喐婢樺Σ缁樸亜閹存繍妲搁柣锝囧厴楠炲鎮欓悽鐢垫闂備焦鎮堕崕婊堝礋椤撴稑浜?
            if (this.turret.isCommandScavenging()) return false; // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缂佺姷濞€閺岀喖骞戦幇闈涙闂佺琚崝宥囨崲濠靛洨绡€闁稿本绮岄。娲⒑缂佹ê绗掗柣蹇斿哺婵＄敻宕熼姘鳖唺闂佺硶鍓濋妵鐐寸珶閺囩姷纾藉ù锝囶焾閳锋棃鏌ц箛鎾诲弰鐎规洩缍佸畷姗€顢欓崗鍏夹氶梻渚€鈧偛鑻晶顖炴煏閸パ冾伃妤犵偞甯￠獮瀣敇閻旀粣绠戦埞鎴︽倷閸欏娅ｇ紓浣割槸閻栧ジ宕洪埀顒併亜閹烘垵鏋ゆ繛鍏煎姈缁绘盯宕ｆ径宀€鐓夐悗瑙勬礃椤ㄥ懘锝炲鍫濈劦妞ゆ帒瀚畵渚€鏌涢幇鈺佸Ψ闁哄閰ｉ弻鐔煎垂椤斿吋娈查梺鍝勬噷閸ㄨ櫣鎹㈠☉銏犵缁炬儳顑呴ˉ婵嗏攽閻愰鍤嬬紒鐘冲浮閸╁懘宕奸弴鐔叉嫽闂佺鏈懝楣冨焵椤掑嫷妫戠紒顔肩墛缁楃喖鍩€椤掑嫮宓佸鑸靛姈閺咁剟鏌涢弴銊ュ婵炲牅鍗冲娲礃閸欏鍎撻梺鐟板暱濞撮攱绔熼弴鐔虹瘈婵﹩鍘鹃崢閬嶆煟韫囨洖浠滃褌绮欓幆宀€鈧綆鍠楅崐鍨叏濮楀棗澧婚柣鎾炽偢閺岋紕浠︾拠鎻掝潎闂佽鍠撻崹钘夌暦椤愶箑绀嬮柟鎼灣缁夘噣鏌?

            return super.canUse();
        }

        // 2. 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻娑樷攽閸曨偄濮夐梺绋款儐閹告悂锝炲┑瀣亗閹艰揪绱曢惈鍕煟鎼淬値娼愭繛鍙夘焽閹广垽宕煎┑鎰闂佸湱铏庨崰鏍綖閸涘瓨鐓熸俊顖涘閻濐亞鎮敐鍛斀闁绘灏欏Λ鍕煛婢跺﹦姘ㄩ柛瀣崌瀵挳濮€閻樺灚鐒惧┑鐐差嚟閸樠囨偤閵娾晛纾挎俊銈呮噺閻撴瑩鏌涢幘妤€鎳庣粭锟犳⒑缁嬫鍎滅紓宥勭窔瀵鈽夐姀鐘栥劑鏌ㄥ┑鍡樺櫣妞ゎ剙鐗忕槐鎾存媴閽樺鏁块悗瑙勬礈閺佸鐛崘顕呮晪闁逞屽墴楠炲啴濮€閵堝懐顦ч柣蹇撶箲閻楁鈧艾銈稿缁樻媴缁嬫寧鍊紓浣风劍閹稿啿顕ｉ幓鎺嗘婵﹩鍘藉▓浼存⒑閸撴彃浜濇繛鍙夛耿閹繝寮撮姀锛勫幗闂佸搫娲﹀銊┧囬敃鈧湁婵犲﹤瀚惌鎺楁煙?(3闂?
        @Override
        @Nullable
        protected net.minecraft.world.phys.Vec3 getPosition() {
            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣椤愯姤鎱ㄥ鍡楀⒒闁绘帊绮欓弻銈嗘叏閹邦兘鍋撻弽顐熷亾濮橆剦鐓奸柡宀嬬秮瀵噣宕掑顑跨帛缂傚倷璁查崑鎾愁熆鐠哄搫顦柛瀣崌瀹曟寰勬繝浣割棜闂傚倷绶氶埀顒傚仜閼活垱鏅堕悧鍫滅箚闁告瑥顦慨宥夋煙椤旂晫鎳呴柛鐘诧工铻ｉ弶鐐存緲椤ユ岸姊绘担鐟邦嚋缂佽鍊归〃銉╁箹娴ｇ鍤戝┑鐐村灦濮樸劎澹曟總鍛婄厓鐟滄粓宕滈悢椋庢殾濠靛倻顭堥悡鎴︽煃鏉炵増顦峰瑙勬礀铻栭柣姗€娼ф禒婊堟煟韫囨梻绠炵€规洘绻傞～婵嬫嚋闂堟稈鍋撻崹顐ｅ弿婵☆垳鍘х敮鍫曟煛鐎ｃ劌鈧妲愰幒妤婃晩闁兼亽鍎哄Λ鍐ㄎ旈悩闈涗沪闁挎洏鍨介妴浣糕枎閹炬潙浠奸柣蹇曞仩濡嫬效?(this.mob) 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎾跺Х閸橆垶姊绘繝搴′簻婵炶濡囩划娆撳箣閻樼數鐒兼繝銏ｅ煐閸旀牠宕愰崼鏇熺厽闁归偊鍠楅弳鈺呮煕濞嗘劖灏扮紒缁樼☉椤斿繘顢欓懡銈囨晨闂傚倷娴囬敓銉╁磹閺嶃劎鈹嶅┑鐘叉搐鍥撮梺绋挎湰閻喗绔熼弴鐘电＝闁稿本鐟ㄩ崗灞解攽椤旇宓嗙€规洘娲熼幃鐣岀矙閼愁垱鎲版繝鐢靛仦閸ㄦ儼褰滈梺鍝勵儏濞寸兘鍩€椤掆偓缁犲秹宕曢柆宥呯疇閹兼番鍨洪崣蹇涙煏韫囨洖顎屾繛鎾愁煼閺屾洟宕煎┑鍥ф缂備胶濮垫竟鍡涘焵椤掑喚娼愭繛璇х畵瀹曟粓鎮㈤悡搴㈡К闂侀潧顧€缁犳垹娆㈤悙鐑樼厵闂侇叏绠戞晶鐗堛亜閺冣偓閹瑰洤顫忓ú顏勫窛濠电姴鍊搁ˉ鍫ユ⒑閸涘﹣绶遍柛鐘愁殔閳诲秹鏁冮崒娑掓嫽?
            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈠姊绘笟鈧褔藝椤愶箑鐤炬繛鎴炶壘椤ユ岸鏌涢敂璇插箺闁哥姵鍔欓弻锝呂旈埀顒勬偋閸℃瑧绠旈柟鐑樻尰閸欏繘鎮峰▎蹇擃伀闁告瑢鍋撻梻浣告惈閻绱炴担鍓插殨妞ゆ帒瀚崹鍌涖亜閺冨洦顥夐柍褜鍓﹂崹璺侯潖濞差亜浼犻柛鏇ㄥ墮椤庢盯姊洪崨濠冨鞍鐎光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱樈閸犳顕欏ú顏呪拺缂侇垱娲栨晶鍙夈亜閵娿儲鍣界紒顔款嚙鐓ゆい蹇撴噽閸樹粙鏌熼懝鐗堝涧缂佽鲸娲樼粋鎺戔槈濮樿京锛滃銈嗘閸嬫劖鏅ラ梻渚€娼уΛ妤呭疮鐎涙ü绻嗛柣鎴ｆ閻撴盯鏌涚仦鎯х劰闁稿鎹囬幃婊堟嚍閵壯冨箻缂備胶鍋撳妯虹暦椤掍焦娅犳い鏍仦閻撶喖骞栭幖顓炴灈婵炲懎绉归弻鈥崇暆鐎ｎ剛蓱闂佽鍨卞Λ鍐极瀹ュ绀嬫い蹇撴閳瑰繘姊婚崒娆掑厡缂侇噮鍨堕妴鍐醇閻旇櫣顔曢梺閫炲苯澧伴柍?3闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弮鍫熸殰闁稿鎸剧划顓炩槈濡娅ч梺娲诲幗閻熲晠寮婚悢鍛婄秶濡わ絽鍟宥夋⒑閹肩偛鈧牠宕濋弽顓炍﹂柛鏇ㄥ灠閸愨偓濡炪倖鍔﹀鈧繛宀婁邯濮婅櫣绮欓崠鈥充紣闂佽绻戝畝鍛婁繆閻㈢绀嬫い鏍ㄦ皑椤旀帡姊洪崨濠庢畼闁稿鍠愮粋鎺撱偅閸愨斁鎷虹紓浣割儏濞硷繝顢撳Δ浣虹閻庣數顭堥崢鎾煙椤栨浜炬俊鐐€曠换鎰版偋閸℃瑧涓嶆慨妯块哺閸犳劖绻濇繝鍌滃缁炬儳娼￠悡顐﹀炊閵娧€濮囬梺缁樻尵閸犳牠寮婚妸鈺佸嵆闁绘劖绁撮崑鎾绘倻閽樺鐤呮俊銈忕到閸燁垶鎮?2
            return net.minecraft.world.entity.ai.util.DefaultRandomPos.getPos(this.mob, 3, 2);
        }
    }
    // ==========================================
    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱樈閸犳顕欏ú顏呪拺缂侇垱娲栨晶鍙夈亜閵娿儲鍣界紒顔垮吹閹风姴顔忛钘夌槣闂備線娼ч悧鍡涘箠閹邦喚涓嶉柡灞诲劜閻撴瑦銇勯弮鍌氬付闁逞屽墮閻忔繈顢氶敐鍥ㄥ珰婵炴潙顑嗛～宥夋⒑闂堟稓绠冲┑顔惧厴椤㈡瑩骞掑Δ浣叉嫼闂佸憡绻傜€氬嘲危瑜版帗鐓曢柍杞拌兌婢э妇鈧娲滈弫鎼佸焵椤掑﹦绉甸柛鐘愁殜閹繝鎮╃紒妯煎幈闂侀潧顭俊鍥煀閺囩喓绠鹃柛娑卞幗閸犳﹢鏌＄仦鐣屝ユい褌绶氶弻娑㈠箻閺夋垵鎽靛銈冨灪閻熲晛顕ｆ禒瀣垫晣闁绘劗鏁稿畷鍫曟⒒娴ｅ憡鎯堢紒瀣╃窔瀹曟垿宕ㄩ鐘虫闂佸搫琚崕鏌ユ偂濞嗘挻鐓曟繝闈涙椤忣偊鎳栭弽顓熲拺闁告繂瀚鈺呮煕婵犲倻浠㈡い?AI (闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃秹锝炲┑瀣櫇闁稿矉濡囩粙蹇旂節閵忥絽鐓愰柛鏃€鐗犲畷鎴﹀Χ婢跺鍘搁梺鎼炲劗閺呮盯宕滈柆宥嗙厱闁靛牆妫欑粈瀣煛瀹€鈧崰鏍嵁閹达箑绠涙い鎺戝€哥敮鎸庝繆閻愵亜鈧倝宕戦崨顒煎搫顫滈埀顒佷繆閻㈢绀嬫い鏍ㄦ皑椤旀帡姊洪崨濠庢畼闁稿鍠愮粋鎺楁嚃閳哄啰锛濇繛杈剧稻瑜板啯绂嶆ィ鍐╁€甸柛蹇擃槸娴滈箖姊洪崨濠冨闁告挻鐩畷銏ゅ箹娴ｇ懓鈧灚顨ラ悙鑼虎闁告梹纰嶇换娑氭嫚瑜忛悾鐢碘偓娈垮枟婵炲﹪宕洪敓鐘茬妞ゅ繐妫寸槐?50闂?+ 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑鏅悷婊冪箻楠炴垿濮€閵堝懐顔婂┑掳鍊愰崑鎾剁棯閸撗呭笡缂佺粯鐩獮瀣倷濞堟寧娈归柣搴ゎ潐濞叉牕顕ｉ懜鐢碘攳濠电姴娲ゅ洿闂佸憡渚楅崰鏍р枍閿濆應鏀介柍钘夋娴滄繈鏌ㄩ弴妯虹伈鐎殿喛顕ч濂稿醇椤愶綆鈧洭姊绘担鍛婂暈闁规瓕顕ч悾婵嬪箹娴ｈ倽銉╂煕閹伴潧鏋涢崬顖炴⒑閸愬弶鎯堥柛濠冩倐閸┾偓妞ゆ帒鍊搁崢鎾煛瀹€鈧崰鎾舵閹烘嚦鐔兼惞鐠団€冲壃婵犲痉鏉库偓妤佹叏閺夋嚚娲晜閻愵剙搴?
    // ==========================================
    // ==========================================
    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱樈閸犳顕欏ú顏呪拺缂侇垱娲栨晶鍙夈亜閵娿儲鍣界紒顔垮吹閹风姴顔忛钘夌槣闂備線娼ч悧鍡涘箠閹邦喚涓嶉柡灞诲劜閻撴瑦銇勯弮鍌氬付闁逞屽墮閻忔繈顢氶敐鍥ㄥ珰婵炴潙顑嗛～宥夋⒑闂堟稓绠冲┑顔惧厴椤㈡瑩骞掑Δ浣叉嫼闂佸憡绻傜€氬嘲危瑜版帗鐓曢柍杞拌兌婢э妇鈧娲滈弫鎼佸焵椤掑﹦绉甸柛鐘愁殜閹繝鎮╃紒妯煎幈闂侀潧顭俊鍥煀閺囩喓绠鹃柛娑卞幗閸犳﹢鏌＄仦鐣屝ユい褌绶氶弻娑㈠箻閺夋垵鎽靛銈冨灪閻熲晛顕ｆ禒瀣垫晣闁绘劗鏁稿畷鍫曟⒒娴ｅ憡鎯堢紒瀣╃窔瀹曟垿宕ㄩ鐘虫闂佸搫琚崕鏌ユ偂濞嗘挻鐓曟繝闈涙椤忣偊鎳栭弽顓熲拺闁告繂瀚鈺呮煕婵犲倻浠㈡い?AI (闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃秹锝炲┑瀣櫇闁稿矉濡囩粙蹇旂節閵忥絽鐓愰柛鏃€鐗犲畷鎴﹀Χ婢跺鍘搁梺鎼炲劗閺呮盯宕滈柆宥嗙厱闁靛牆妫欑粈瀣煛瀹€鈧崰鏍嵁閹达箑绠涢梻鍫熺⊕椤斿嫮绱撻崒娆掑厡濠殿喚鍏樺畷鎴﹀Χ婢跺﹨鎽曢梺鍝勬川閸犳挾寮ч埀顒勬椤愩垺澶勬繛鍙夌矒瀵娊鎮╅悽鐢碉紳婵炶揪绲块…鍫ャ€傞幎鑺ョ厱閻庯綆鍓欓弸娑㈡煕閳规儳浜炬俊鐐€栧濠氬磻閹惧墎纾奸柣妯垮皺鏁堥悗瑙勬礃濞叉ê顭囪箛娑樼厸闁稿本鑹剧花銉╂⒒娴ｅ憡璐￠柛搴涘€曢～蹇旂節濮橆厼浠㈢紓鍌欑劍鐪夌紒璇叉閺屾洟宕煎┑鍥ф闂侀潻绲惧浠嬪蓟閿濆绠婚悗娑欘焽椤︿即姊洪崫鍕伇闁哥姵鐗犻獮鍐煥閸忓墽鍠栭幖褰掓焻濞戞瑯鏁囨繝纰夌磿閸嬫垿宕愰幋锕€纾块柟鎯版绾惧鏌ｉ幇顒佹儓濡楀懘姊洪崨濠冨闁搞劍婢樿灋婵せ鍋撻柟顔肩秺楠炰線骞掗幋婵愮€峰┑鐐差嚟閸樠兠洪鐑嗘綎婵炲樊浜濋悞濠氭煟閹邦垰钄奸悗姘嵆閺屾稑螣閻戞ɑ鍠愮紓浣介哺鐢繝骞婇悩娲绘晢闁稿本姘ㄩ鑲╃磽閸屾瑧鍔嶆慨濠傤煼瀹曚即寮借閺嗭箑鈹戦崒婊庣劸閸烆垶姊洪棃娑辨闂傚嫬瀚埅?+ 150闂?
    // ==========================================
// ==========================================
    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱樈閸犳顕欏ú顏呪拺缂侇垱娲栨晶鍙夈亜閵娿儲鍣界紒顔垮吹閹风姴顔忛钘夌槣闂備線娼ч悧鍡涘箠閹邦喚涓嶉柡灞诲劜閻撴瑦銇勯弮鍌氬付闁逞屽墮閻忔繈顢氶敐鍥ㄥ珰婵炴潙顑嗛～宥夋⒑闂堟稓绠冲┑顔惧厴椤㈡瑩骞掑Δ浣叉嫼闂佸憡绻傜€氬嘲危瑜版帗鐓曢柍杞拌兌婢э妇鈧娲滈弫鎼佸焵椤掑﹦绉甸柛鐘愁殜閹繝鎮╃紒妯煎幈闂侀潧顭俊鍥煀閺囩喓绠鹃柛娑卞弿闊剟鏌?AI (闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼槮闁搞劍绻冮妵鍕冀椤愵澀娌梺鎼炲€曢惌鍌炲蓟濞戙垹绠绘俊鐐额嚙娴滈箖姊虹粙娆惧剱闁瑰憡鎮傞崺銉﹀緞閹邦剛顔婇梺瑙勫劤椤曨叀銇愰崨顔荤箚闁绘劦浜滈埀顑惧€濆畷銏ゆ偂楠炵喐妞介、姗€鎮欓崹顐ｎ啎婵犳鍠楅妵娑㈠磻閹炬番浜滈柕蹇ョ磿閹冲洭鏌熺粙鍖℃敾鐎垫澘瀚鍕暆閳ь剛绮旈崸妤佲拻闁稿本鑹鹃埀顒勵棑缁牊鎷呴崷顓犲骄婵犵數濮村ú銈囧婵犳碍鐓欓柣鎴烇供濞堟梻绱掗埀顒勫醇閻旇櫣顔曢梺鐟邦嚟閸嬬偤鎯冮幋锔界厽婵犲﹤鎳愮敮娑樓庨崶褝韬┑鈥崇埣瀹曟帒顫濋銏╂闂傚倸鍊风粈渚€鎮块崶顬盯宕熼鈧崶顒佸仺闁告縿鍎辩粊锕€鈹戦埥鍡楃仩闁告艾顑囬埀顒佺瀹€鎼佸蓟瀹ュ唯闁靛濡囪ぐ褍顪冮妶鍡樼叆閻庢凹鍓熼崺鐐哄箣閿旇棄浜归梺褰掝暒缁€渚€寮查柆宥嗏拺闁告縿鍎辨牎闁汇埄鍨埀顒佸墯閸ゆ洟鏌熺紒妯哄潑闁衡偓娴犲鐓曢柣娆屽亾闁革綆鍨崇槐鐐寸瑹閳ь剟鎮伴鈧畷鍫曨敆閳ь剛鐥缁绘盯宕卞▎蹇庡缂傚倸绉撮崐鍨潖缂佹ɑ濯撮悷娆忓娴煎洭姊洪崫鍕櫤闁烩晩鍨伴悾鐑筋敍閻戝棙鏅梺缁樺姈濞兼瑦绂?+ 150闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犖ч柛銉㈡櫇閸樼娀姊婚崒娆戭槮闁诲繑绻堥、鏍炊椤掍礁浠ч梺鍓插亝濞叉﹢鎮￠弴鐔翠簻闁归偊鍠栧瓭闂佽娴氶崳锝夊蓟濞戞鏃€鎷呯粙鎸庢嚈闂備礁鎼惌澶岀礊娴ｅ壊鍤曟い鎺戝閸ㄥ倹銇勯弮鍥棄闁逞屽墻閸ㄨ泛顫?
    // ==========================================
    static class PurgeMoveGoal extends Goal {
        private final SkeletonTurret turret;

        public PurgeMoveGoal(SkeletonTurret turret) {
            this.turret = turret;
            this.setFlags(EnumSet.of(Flag.MOVE)); // 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ帒锕︾粙蹇旂節閵忥絾纭炬い鎴濇喘閵嗗懘骞撻幑妤€缍婇幃鈺侇啅椤旂厧澹堢紓浣哄亾閸庡啿顭囬敓鐘茶摕闁绘梻鍘х粈鍫澝归敐鍥у妺闁瑰弶锕㈠鐑樻姜閹殿噮妲┑鐐叉▕閸欏啫顕ｇ拠娴嬫婵☆垶鏀遍弬鈧梻浣告啞濞诧箓宕戦崟顒佸弿闁靛繈鍊栭埛鎴炵箾閼奸鍤欐鐐搭殜閺岀喖鎮烽悧鍫濇灎濡ょ姷鍋涢崯鎶藉Φ閹版澘绠抽柟瀵稿Т閳ь剛鍋ゅ娲濞戣京鍔搁梺绋块绾绢厾鍒掓繝鍥ㄥ€婚柤鎭掑劚娴?
        }

        @Override
        public boolean canUse() {
            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈢粯淇婇悙顏勨偓鏍偋濡ゅ啰鐭欓柟鐐湽閳ь剙鎳樺濠氬Ψ閿旀儳寮虫繝鐢靛█濞佳兾涢鐐嶏綁宕奸弴鐔哄帗閻熸粍绮撳畷婊冣枎閹惧磭鐤囧┑顔姐仜閸嬫挾鈧鍣崑濠傜暦濮椻偓椤㈡瑩鎳栭埡浣感曞┑锛勫亼閸婃牜鏁幒鏂哄亾濮樺崬鍘寸€殿噮鍋嗛埀顒婄秵閸犳鎮￠妷锔剧瘈闂傚牊绋掗敍宥嗕繆閸欏鍊愰柡宀嬬秮楠炴帡骞嬮悩杈╅┏闂備線娼уú銈団偓姘嵆閻涱噣骞掗幋顓炴倯闂佸壊鍋呯换鍌滄暜椤栨稐绻嗛柣鎰典簻閳ь剚鍔欏鎻掝煥閸喎浜楅梺璺ㄥ枔婵挳鎷戦悢鍝ョ闁瑰瓨鐟ラ悘鈺呮煟閹烘挻銇濋柡灞剧洴楠炲洭宕滄担鑽锋垿姊洪幐搴ｂ槈妞わ附澹嗛幑銏犫槈濞嗘劗绉堕梺鍛婃寙閸愩劎鍘掓繝鐢靛О閸ㄥ骞婇幘缁樻櫇妞ゅ繐瀚弳锕傛煟閵忋埄鐒鹃柛妤佸▕閺屾洝绠涚€ｎ亞浠奸悷婊勬緲鐎氭澘顫忓ú顏勭闁绘劖褰冩慨宀勬⒑缁嬪潡鍙勫ù婊嗘硾閻ｅ嘲鈹戠€ｎ€囨煕閵夈垺娅囬柨娑欑矒濮婃椽鏌呴悙鑼跺濠⒀屽灣閳ь剙鐏氬妯尖偓姘嵆閻涱噣宕堕澶嬫櫍闂佺粯鍔忛弲娑欑妤ｅ啯鐓曟い鎰剁稻缁€鍫ユ煕濞嗘劖宕岄柡灞剧洴婵＄兘鏁愰崨顓х€撮梺璇茬箰濞存岸宕ｉ崘顔艰摕闁靛牆娲ㄩ惌娆撴煙缁嬫寧鍞夌痪顓涘亾缂傚倸鍊峰ù鍥ㄣ仈閸濄儲鏆滈柨鐔哄Т缁犳牗绻濇繝鍌滃闁绘挻绋戦湁闁挎繂鎳庡Σ缁樸亜閵夛箒澹橀柍瑙勫灴閹晛鈻撻幐搴㈩唶缂傚倷娴囨ご绋棵洪悢椋庢殾闁硅揪绠戠粻锝夋煥閺囨浜剧紒鐐礃椤鎹㈠☉銏犵婵炲棗绻掗崝鎾⒑鏉炴壆顦︽い鎴濇喘楠炲骞栨担鍛婎棟闁荤姵浜介崝宥呪枔閹€鏀介幒鎶藉磹閺囥垹绠犻煫鍥ㄧ⊕閸婂潡鏌ゅù瀣澒闁稿鎹囬悰顕€宕归鐓庮潛婵犵妲呴崑鍛存偡閵夆晛鐓?
            return turret.isPurgeActive();
        }

        @Override
        public boolean canContinueToUse() {
            return turret.isPurgeActive();
        }

        @Override
        public void tick() {
            LivingEntity owner = turret.getOwner();
            if (owner == null) {
                turret.stopPurgeMode();
                return;
            }

            // 1. 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴濐潟閳ь剙鍊块幐濠冪珶閳哄绉€规洏鍔戝鍫曞箣閻欏懐骞㈤梻鍌欑窔閳ь剛鍋涢懟顖涙櫠閹绢喗鐓涢悘鐐插⒔閵嗘帡鏌嶈閸撱劎绱為崱娑樼；闁告侗鍘鹃弳锔锯偓鍏夊亾闁告洦鍓涢崢鎼佹倵閸忓浜鹃柣搴秵閸撴盯鏁嶉悢鍝ョ閻庣數顭堥鎾斥攽閳ヨ櫕鍠樻鐐茬箻閹晝鎷犻懠顒夊斀闂備礁婀遍崕銈夊春閸繍鐒介柕澶堝劗閺€浠嬫煟濡櫣浠涢柡鍡忔櫊閺屾稓鈧綆鍓欐禒杈殽閻愭潙鐏︾紒妤冨枛閸┾偓妞ゆ巻鍋撻柣锝呭槻鐓ゆい蹇撳閸炪劑鎮峰鍕煉鐎规洟娼ц灃闁告侗鍠氶崢閬嶆⒑閸濆嫭鍌ㄩ柛鏂胯嫰閳诲秴螣鐠佸磭绠氶梺鑲┾拡閸撴瑧鏁崼鏇熺厓閻熸瑥瀚悘鎾煛娴ｅ摜效鐎规洜鍠栭、鏇㈡晬閸曨剙绀嬫繝鐢靛Х閺佹悂宕戝☉銏″剭闁绘垼妫勯悞鍨亜閹哄棗浜剧紒鍓ц檸閸欏啫顕ｉ幎鑺ユ櫆闁伙絽鐬奸惁鍫ユ⒒閸屾氨澧涘〒姘殜瀹曟洝绠涘☉妯肩暰闂佺粯鏌ㄩ崥瀣煕閹达附鈷掗柛顐ゅ枍缁堕亶鏌ｉ幒妤冪暫闁哄本绋掗幆鏃堝灳閾忣偅鐦ｉ梺鍛婎殙妞村摜鎹㈠☉姗嗗晠妞ゆ棁宕甸崙褰掓⒑?(150闂?= 22500)
            // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯衡偓鐢告煕韫囨搩妲稿ù婊堢畺濮婃椽鏌呴悙鑼跺濠⒀勬尦閺岀喖顢涘顓熸嫳閻庡灚婢樼€氫即鐛崶顒夋晣闁绘劖婢樼€靛弶绻濋悽闈涗哗闁规椿浜炲濠囧锤濡炵儵鍋撻敃鍌氶唶闁靛鍎叉潏鍫ユ⒒娓氬洤澧紒澶屾暬閹繝鎮㈤崗鑲╁弳闂佸搫鍟崐鐟扳枍閺囥垺鐓熸い鎾跺剳闊剚淇婇锛勫妽鐎垫澘瀚埀顒婄秵閸撴盯鎯侀崼鐔虹瘈闁汇垽娼у瓭闂佺锕ラ幃鍌氼嚕閹惰姤鍊烽柣鎴烆焽閸橀潧顪冮妶鍡欏婵ǜ鍔嶉弲鍫曟晝閸屾稓鍘搁柣蹇曞仧閸嬫挾绮堢€ｎ兘鍋撶憴鍕闁稿骸銈哥瘬闁稿瞼鍋為悡娑㈡煃瑜滈崜娑氭閹烘嚦鐔兼嚃閳哄﹤鏅梻鍌欒兌閸樠呯礊婵犲洤纾诲┑鐘叉搐閸氳绻涢崱妯哄濞存粍绮嶉妵鍕箻鐎靛摜鐓€婵犳鍠栭崐鍧楀蓟濞戙垹鐓橀柟顖嗗倸顥氭繝纰夌磿閸嬫垿宕愰弽顐ｆ殰闁圭儤顨呯壕褰掓煠閹帒鍔滈柛娆忕箻閺岀喖骞嗛弶鍟冩捇鏌ｉ幘鍗炲姦闁哄矉缍佸顒勫箰鎼淬垹鍓甸梺鍝勭▌缁绘繂顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏甸柛鐘崇墵閻涱噣宕橀…鎴炲缓闂侀€炲苯澧存鐐插暙閳诲酣骞嬮悙鑼紡闂備胶鍎甸弲婊呮暜濡ゅ懎绠查柛銉墮閽冪喖鏌ｉ弮鍌氬付缂佺姷鏁婚弻鐔兼倻濡纰嶆繛瀵稿У閹稿啿顫忓ú顏勪紶闁告洦鍘炬导鍥⒑閸濄儱校闁绘濞€婵″瓨鎷呴懖婵囨⒐閹峰懘鎮烽柇锔瑰亾閹剧粯鈷戦梻鍫氭櫅閻︽粓鏌涘▎蹇涱€楅崡杈ㄣ亜閹哄棗浜鹃梺瀹狀潐閸ㄥ潡骞冮埡鍜佹晝闁挎繂鎷嬮埀顒€绻樺娲川婵犱胶绻侀梺鍛娚戦幃鍌氼嚕閹间礁宸濇い鎾寸⊕閺傗偓闂備礁鐤囧Λ鍕涘Δ浣侯洸婵犲﹤鐗婇悡鏇㈡煟閺冨牜妫戦柟鐣屽█閺岀喐绗熼崹顔碱潎闂佺硶鏂侀崑鎾愁渻閵堝棗绗掗悗姘煎弮閹繝宕橀鐣屽帗闁哄鍋炴竟鍡浰囬敃鍌涚厸闁糕剝鐟ラ弸娑㈡煛瀹€瀣М闁轰焦鍔欏畷鍗烆渻缂佹浜炲┑鐘愁問閸犳牠鏁冮妸銉㈡瀺闁挎繂顦粻顖炴煟濡鍤欓柣蹇斿▕閺屾盯骞囬鐘仦闂佸湱鏌夐褔鍩為幋锔藉€烽柤纰卞墯閹茶偐绱撴笟鍥ф灈缂佸缍婇獮鍐偪椤栵絾些婵＄偑鍊栧ú鈺冪礊閳ь剚銇勯敃鈧﹢閬嶅焵椤掑喚娼愭繛鍙夛耿閺佸啴濮€閵堝懏妲梺璺ㄥ枔婵绮堥崘顔界叆婵犻潧妫欓ˉ鐘裁瑰鍕噰婵﹨娅ｉ幏鐘诲蓟閵夘喒鍋撳Δ鍐＜闁绘灏欐晥閻庤娲樺ú鐔煎蓟閸℃鍚嬮柛鈩冦仦缂冩洟姊绘担铏广€婇柛鎾寸箘缁瑩骞嬮敃鈧壕濂告煏婵炵偓娅嗛柣鎾寸懅缁辨挻鎷呴棃娑氫患闂佸搫顑嗙粙鎾舵閹烘鍋戞繛鍡楃箲婢跺嫰鏌ｉ幘鍐叉殻闁哄本绋戦埞鎴﹀幢濡ゅ﹣鎮ｉ梻渚€鈧偛鑻晶顖炴煙椤旂厧鈧潡鐛崘銊庣喖鎳￠妶鍥╂闂備礁鎲″ú锕傚储妤ｅ啯鏅繝濠傚枤濞撳鏌曢崼婵嬵€楁鐐搭殜閹粙顢涘鍐ф埛閻庢鍟崶褏鍔﹀銈嗗笒鐎氼參鍩涢幋锕€绾ч柣鎰綑椤ュ銇勯敂鐓庮洭缂佽鲸甯楀鍕償閿涘嫬甯跨紓鍌欑閸婂湱鏁敓鐘叉瀬闁告劦鍠栫壕鍏肩箾閹寸伝濂稿箖閿濆鐓熼幖绮光偓鍐茶緟闂佺顑嗛幑鍥蓟瀹ュ牜妾ㄩ梺鍛婃尵閸犳牠鐛崘顔藉€锋い鎺嶈兌缁夊爼姊洪棃娑辩劸闁稿﹥顨堢划璇差潩閼哥鎷虹紓鍌欑劍閿氬┑顕嗙畱闇夋繝濠傚閻帡鏌涢埞鎯т壕婵＄偑鍊栫敮濠囨嚄鐠哄ソ铏光偓娑櫱滄禍婊堟煏韫囧ň鍋撻煫顓烆劉婵＄偑鍊ч梽鍕偂閿熺姴绠栭柨鐔哄Т鍥存繝銏ｆ硾椤戝洭宕㈤幖浣瑰€垫鐐茬仢閸旀艾螖閻樿櫕鍊愰柣娑卞枛铻栭柛娑卞枤閸?
            if (turret.distanceToSqr(owner) > 22500.0) {
                turret.teleportToSafeSpot(owner);
                turret.stopPurgeMode();
                return;
            }

            // 2. 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欑€靛摜鐦堥梺姹囧灲濞佳冪摥濠德板€楁慨鐢稿箖閸屾凹鍤曢柡灞诲劜閸嬫劗绱撴担楠ㄦ岸骞忓ú顏呪拺闁稿繗鍋愰妶鎾煛閸屾瑧绐旀鐐茬箻閺佹捇鎮╁畷鍥у箞闂備浇顫夐崕鎶筋敋椤撶伝娲箻椤旂晫鍘靛銈嗙墬椤ㄥ懏绂嶆ィ鍐┾拻濞达絽鎲￠崯鐐电磼鐎ｎ偄鐏撮柟顔芥そ婵℃悂鍩℃担鍝勫箞闂備胶鎳撻悺銊ф崲瀹ュ鍋勯柛鈩冪⊕閸嬶綁鏌ц箛鏇熷殌闁告柨顑夐弻鐔煎箵閹烘挸鏆堥梺闈涙搐鐎氫即寮崒鐐村殐闁冲搫鍟▓濂告⒒娴ｅ憡鎯堥柣顓烆槺缁辩偞绗熼埀顒€顕ｉ锕€绠涢柡澶庢硶閸婄偤鎮峰鍐╂拱缂佹梻鍠栧鎾偐閻㈢绱冲┑鐐舵彧缁插潡鈥﹂崼銉ョ劦妞ゆ巻鍋撻柟鑺ョ矌閸掓帡寮崼鐔蜂画闂佽顔栭崰妤€鈻撴ィ鍐┾拺闁告稑顭▓姗€鏌涙繝蹇曠М闁诡喓鍨介幖褰掑捶椤撱劎搴婂┑鐘殿暯濡插懘宕归棃娑氭殾闂傚牊鍏氶敐澶娢ㄩ柍鍝勫€甸幏濠氭⒑缁嬫寧婀伴柣鐔濆泚鍥晝閸屾稓鍘甸柣鐘叉厂閸涱垳妲囬柣搴ゎ潐濞叉牜绱炴繝鍥х畺闁斥晛鍟崕鐔兼煥濠靛棙顥炴い鏃€娲熷濠氬磼濮橆兘鍋撻幖浣瑰亱濠电姴娲﹂崵鈧繛瀵稿Т椤戝棝宕愮紒妯圭箚妞ゆ牗鐟ㄩ鐔兼煕閵堝啫鈧繂顫忓ú顏勪紶闁告洖鐏氭晥闂備焦鎮堕崝搴ㄥ极鐠囪尙鏆︽い鎺戝鎯熼梺鍐叉惈閸婄敻骞忓ú顏呪拺缁绢厼鎳庢禍褰掓煕鐎ｎ偆娲寸€规洘绻堥弫鍌涙叏閹邦亞鐩庨梻渚€娼ч¨鈧梻鍕娴滄悂鎮介悽鐢碉紲濡炪倖妫侀崑鎰櫠濞戞埃鍋撻崹顐ｇ凡閻庢矮鍗抽悰顕€宕堕澶嬫櫍闂佺粯鍔忛弲娑欑妤ｅ啯鐓曟い鎰剁稻缁€鍫ユ煕濞嗘劖宕岄柡灞剧洴婵＄兘鏁愰崨顓х€撮梺璇茬箰濞存岸宕㈤崜褎顫曢柟鐐墯閸氬鏌涢弴銊ュ箹濠碘€茬矙濮婃椽鏌呭☉姘ｆ晙闂佸憡鏌ㄩ惌鍌炴晲閻愬樊鐓ラ柛顐ｇ箞閸炶泛鈹戦悩鑼粵闁告梹鐗犲畷鏉课熼懖鈺冿紳闂佺鏈悷锔剧矈閺夋娓婚柡澶嬪灦閹叉悂鏌℃笟鍥ф珝妤犵偞甯掕灃闁逞屽墴閹€斥攽鐎ｎ亞顔愬┑鐑囩秵閸撴瑦淇婇懖鈺冪＜闁绘ê纾埊鏇㈡煏閸パ冾伃妤犵偞甯￠獮瀣攽閸愩劋澹曟俊鐐差儏妤犳悂宕瑰┑瀣厱妞ゆ劧绲剧粈鍐煃?AI 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繐霉閸忓吋缍戦柛銊ュ€块弻锝夊箻瀹曞洤鍝洪梺鍝勵儐閻楁鎹㈠☉銏犵闁绘劘灏欓崝浼存⒑缁嬫鍎愰柟鍛婃倐閿濈偛鈹戠€ｎ偄浜楅柟鍏肩暘閸ㄦ槒銇愭惔顫箚?
            if (turret.getTarget() != null && turret.getTarget().isAlive()) {
                return;
            }

// ==================== 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼槮闁搞劍绻冮妵鍕冀椤愵澀娌梺鎼炲€曢惌鍌炲蓟濞戙垹绠绘俊鐐额嚙娴滈箖姊虹粙娆惧剱闁瑰憡鎮傞崺銉﹀緞閹邦剛顔婇梺瑙勫劤椤曨叀銇愰崨顔荤箚闁绘劦浜滈埀顑惧€濆畷銏ゆ偂楠炵喐妞介、姗€鎮欓崹顐ｎ啎婵犳鍠楅妵娑㈠磻閹炬番浜滈柕蹇ョ磿閹冲懘鏌熼崣澶嬪唉闁轰焦鍔欏畷鍗炍旈崘鈹炬瀱闂傚倸鍊搁崐鎼佸磹閻戣姤鍊块柨鏇炲€归崕鎴犳喐閻楀牆绗掔痪鎯х秺閺屾洟宕煎┑鎰﹂梺鎼炲妼閸婂灝顕ｉ崼鏇為唶妞ゆ劦婢€缁ㄥ瓨绻?(闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃秹锝炲┑瀣櫇闁稿矉濡囩粙蹇旂節閵忥絽鐓愰柛鏃€鐗犲畷鎴﹀Χ婢跺鍘搁梺鎼炲劗閺呮盯宕滈柆宥嗙厱闁靛牆妫欑粈瀣煛瀹€鈧崰鏍嵁閹达箑绠涢梻鍫熺⊕椤斿嫮绱撻崒娆掑厡濠殿喚鍏樺畷鎴﹀Χ婢跺﹨鎽曢梺鍝勬川閸犳挾绮绘ィ鍐╃厽闁逛即娼ф晶顖炴煟濠靛洦绀嬫慨? ====================

            // 闂?缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛濠傛健閺屻劑寮撮悙娴嬪亾閸洖鐒垫い鎺嗗亾闁哥喎纾划璇测槈濡攱顫嶅┑鈽嗗灣閳峰牆危椤栨稓绡€闁汇垽娼ф禒锕傛煕閵娿劍纭炬い顐ｇ箞婵℃悂鍩℃担渚敤婵犳鍠楅…鍫ュ春閺嶎厽鍋傛繛鎴烇供閻斿棝鎮规潪鎷岊劅闁稿骸绻橀弻锝夊箳閺傚じ澹曠紓浣虹帛閻╊垰顫忔繝姘骇闁瑰瓨绻勯妶顕€姊绘担鍛婃儓闁哄牜鍓欑叅婵☆垯璀﹂崵妤呮煕閺囥劌鈧娀鎮㈤崗鍏煎劒闂備緡鍋呯粙鎴犫偓浣冨皺缁辨捇宕掑顑藉亾閻戣姤鍊块柨鏇炲€哥粈澶愭煛瀹ュ骸骞戦柍褜鍓欓崯顖滄崲濠靛鐐婄憸鎴﹀箺閺囩偐鏀介柣鎰綑閻忥妇绱掗濂稿弰闁诡喖娼￠崺鈧い鎺戝閳锋垿鎮峰▎蹇擃仼缂佲偓閸愨晝绠惧璺侯儑濞叉挳鏌涢埡浣瑰殗闁哄苯妫楅濂稿幢韫囨柨顏规繝鐢靛仦濞兼瑩宕ョ€ｎ喗鍋＄憸鏂跨暦濮樿埖鍋嬮柛顐ｇ◥缁ㄨ顪冮妶鍡樺暗闁稿绋戝嵄濠电姵纰嶉悡鐔兼煥濠靛棙鍣规俊鎻掝煼閺屽秶鎷犻弻銉ュ及濡ょ姷鍋為敃銏狀嚕閸洖绠ｉ柡鍌氥仒婢规洜绱撻崒娆戝妽閻绱掔拠鍙夘棡闁靛洤瀚板浠嬪Ω瑜忛悾鍝勵渻閵堝懐绠冲┑顔芥尦濠€浣糕攽閻樿宸ュΔ鐘虫倐閹﹢鏁冮崒娑氬幐閻庡厜鍋撻悗锝庡墰琚﹂梻浣筋嚃閸犳捇宕归挊澶屾殾闁靛濡囩弧鈧梺鍛婃礀婢у酣鐛姀銈嗏拻闁稿本鐟ㄩ崗宀€绱掗鍛仯闁轰緡鍣ｉ、鏃堝醇閻斿弶瀵栭梻浣告啞濞诧箓宕㈡ィ鍐ㄧ婵鍩栭悡鐔兼煛閸愩劌鈧摜鏁崜浣烘／闁诡垎浣镐划闂佸搫鐭夌紞渚€鐛崶顒夋晬婵椴搁妤佷繆閻愵亜鈧牠寮婚妸鈺傚剹闁稿本顕卞☉銏犲窛闁圭⒈鍘介弲婵嬫⒑闂堟稓绠氶柍褜鍓氶崜姘ｉ柆宥嗏拻濞达絿鍎ら崵鈧梺姹囧妿閸忔ê顕ｉ幓鎺嗘婵犲﹤鎳嶉懜顏堟⒒娴ｇ瓔鍤欓柛鎴犳櫕缁辩偤宕卞☉妯肩崶濠德板€曢幊蹇涘磻?(闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗霉閿濆浜ら柤鏉挎健瀵爼宕煎顓熺彅闂佹悶鍔嶇换鍐Φ閸曨垰鍐€妞ゆ劦婢€缁墎绱撴担鎻掍壕婵犮垼鍩栭崝鏍偂濞戙垺鐓曢柕澶涚到閸旀岸鏌ｈ箛濠冩珚闁哄本绋戦～婵嬪箛娴ｅ湱绉烽梻渚€娼уú銈団偓姘嵆閻涱喖顫滈埀顒€鐣烽敓鐘冲€烽柛蹇撴啞閸嬪懐绱撻崒姘偓鐑芥嚄閸撲讲鍋撳顒傜鐎规洖鐖兼俊姝岊槻閻㈩垱鍎抽埞鎴︽偐椤旇偐浼囧┑鐐差槹閻╊垶骞冭瀹曞崬鈽夊Ο纰辨Х婵犳鍠楅…鍫ュ春閺嶎厽鍋?
            double scanRange = Math.max(32.0, turret.getAttackRange());

            // 闂?缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛濠傛健閺屻劑寮撮悙娴嬪亾閸洖鐒垫い鎺嗗亾闁哥喎纾划璇测槈濡攱顫嶅┑鈽嗗灣閳峰牆危椤栨稓绡€闁汇垽娼ф禒锕傛煕閵娿劌鐓愮紒宀勪憾閹粌螣鐠囨彃浼庨梻浣筋潐閸庡吋鎱ㄩ妶澶嬪亗闁告劦鍠栫痪褔鏌ｉ幇顓熺稇妞ゃ儱顑夐幃褰掑箛椤旂⒈鏆紓浣虹帛閻╊垰顫忔繝姘骇闁瑰瓨绻勯妶顕€姊绘担鍛婃儓闁哄牜鍓欑叅婵☆垯璀﹂崵妤呮煕閺囥劌鈧娀鎮㈤崗鍏煎劒闂備緡鍋呯粙鎴犫偓浣冨皺缁辨捇宕掑顑藉亾閻戣姤鍊块柨鏇炲€哥粈澶愭煛瀹ュ骸骞戦柍褜鍓欓崯顖滄崲濠靛鐐婄憸鎴﹀箺閺囩偐鏀介柣鎰綑閻忕喖鏌涢妸銉﹁础缂侇喛顕ч埥澶娾枎瀹ュ嫮鐩庨梻浣告贡閸庛倝宕归悽绋跨劦妞ゆ帊绀佹慨宥夋煛娴ｇ懓濮嶇€规洏鍔戦、鏃堝川椤旇姤绶梻鍌氬€烽懗鍫曞磻閵娾晛纾块柡澶嬪灍閺嬪秹鏌￠崶銉ョ仼缂佺姷鍠栭弻娑樷攽閸曨偄濮㈢紒鐐劤閸氬濡甸崟顖氱睄闁逞屽墴椤㈡牕鈻庨幘鍐叉優濠电偛妫欓幐濠氬箠濮樿埖鐓涚€广儱楠搁獮妤呮煟閹惧啿鏆熼柟鑼焾椤劑宕煎┑鍫Ф闂備胶绮Λ鍐夐幘璇叉辈闁挎洖鍊归悡鐔兼煏韫囨洖孝妞ゃ儱绻橀弻鈩冩媴閸涘﹤鏋犻梺鍝勬湰濞叉繄绮诲☉銏犲嵆闁绘劖鍔戦崕杈亙闂佺粯锚瀵爼宕板Ο缁樺弿濠电姴鍟妵婵囦繆椤愩垹鏆欓柍钘夘槸閻ｇ兘宕堕埡濠冩暏闂傚倸鍊风粈渚€骞夐垾瓒佹椽鏁冮崒姘亶闂佽姤锚椤︻偊寮搁弮鍫熺厵闂傚倸顕崝宥夋煃闁垮鐏撮柡灞诲€栭幈銊╁箛椤戣棄浜鹃柡鍥╁仦濮ｅ嫰姊婚崒娆掑厡妞ゎ厼鐗忛懞鍗灻洪鍕紮濠德板€曢幊搴ｇ不閺屻儲鐓忛煫鍥ь儏閳ь剚娲滅划鍫⑩偓锝庡亖娴滄粓鏌″鍐ㄥΩ濞寸姵绮撻弻娑氣偓锝庡亝瀹曞瞼鈧鍠曠划娆撱€佸鈧幃娆撴濞戞帒浜鹃柣鎰▕濞撳鏌曢崼婵囶棞闁秆冿躬閺屾稓鈧綆鍋呯亸鐢电磼鏉堛劍灏伴柟宄版嚇瀹曪絾寰勭€ｎ剙缍冮梻鍌欑閹碱偊鎯夋總绋跨獥闁规崘顕х粻鐔兼煙缂併垹鏋涚紒鈧€ｎ偁浜滈柟鎵虫櫅閻掔儤绻涢崗鍏肩缂佽鲸鎹囧畷鎺戔枎閹烘垵甯┑鐘愁問閸犳骞愰幎钘夌伋闁挎洖鍊归崐濠氭煢濡警妲奸柟鑺ユ礀閳规垿鎮欓弶鎴犱桓濡炪値鍘奸崐鍧楀箖閵忋倖鍋傞幖杈剧磿閳ь剦鍘奸—鍐Χ閸℃鍙嗛梺鍛婅壘椤戝鐣烽弴銏╂晜闁割偆鍟块幏?
            List<LivingEntity> enemies = turret.level().getEntitiesOfClass(LivingEntity.class,
                    turret.getBoundingBox().inflate(scanRange),
                    e -> isValidTarget(e)
            );

            // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯锋嫼閻熸粎澧楃敮鎺撶娴煎瓨鐓曢柟鎯ь嚟濞叉挳鏌熼鍡欑瘈妤犵偛顑夐弫鍌滄喆閿濆棗顏归梻鍌欐祰瀹曠敻宕伴弽顓炵；濠电姴娲ら崥褰掓煟閺傝法娈遍柡鈧懞銉ｄ簻闁哄啫鍊甸幏锟犳煕閵堝洤鏋旂紒杈ㄥ浮椤㈡瑥鈻庨幆褎顔勯梻浣哥枃濡嫰藝椤栨繄浜介梻濠庡亜濞诧箑煤濮椻偓瀹曠敻鍩€椤掆偓椤啴濡舵惔鈥崇闂佸憡姊归崹鐢告偩瀹勯偊娼ㄩ柍褜鍓熷畷娲焺閸愵亞鐦堥梺鍛婂姌濞夋洜澹曟總鍛娾拻闁稿本鑹鹃埀顒勵棑缁牊绗熼埀顒勭嵁閺嶎収鏁冮柨鏇楀亾缂佺媭鍨堕幃妤呮晲鎼粹剝鐏堢紒鐐礃椤曆囧煘閹达附鍋愰柛娆忣槹閹瑩姊?
            if (!enemies.isEmpty()) {
                // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗霉閿濆浜ら柤鏉挎健濮婃椽顢楅埀顒傜矓閹绢喖鍑犲〒姘ｅ亾闁哄瞼鍠栧鑽も偓闈涘濡差喚绱掗悙顒€鍔ゆい顓犲厴瀵鎮㈤悡搴ｎ槶閻熸粌绉电粋鎺懨洪鍛帗閻熸粍绮撳畷婊冾潩鏉堛劍娈伴梺璺ㄥ枔婵绮婚悩宕囩瘈濠电姴鍊绘晶鏇㈡煕閵娿儱鈧綊濡甸崟顖氱疀闁靛鍎遍埛澶愭⒑閸濄儱浠滄い锕傛涧椤繒绱掑Ο璇差€撻梺缁樺灦閿氭繛鍫濊嫰椤啴濡堕崱妯侯槱闂佸憡眉缁瑩鐛崼銉ノ╅柍鍝勫€告禒娲⒑閸涘﹦鈽夐柨鏇樺€栫粋鎺撶附閸涘ň鎷洪梺鍛婄☉椤剙鈻撳鈧弻娑氣偓锝庡亜婵洭宕￠柆宥嗙厱妞ゆ劗濮撮崝婊堟煟閹惧鎳呯紒杈ㄦ尰閹峰懘妫冨☉姘偅闂備浇顕х换鎺撴叏閹绢喗绠掓繝鐢靛Т閿曘倝鎮ц箛娑欏仼闁绘垶蓱閸?
                enemies.sort(Comparator.comparingDouble(turret::distanceToSqr));
                LivingEntity prey = enemies.get(0);

                // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柤纰卞墻濡查攱绻濈喊妯活潑闁搞劏娉涜灋闁秆勵殕閸婂灝鈹戦悩鎻掓殧濞存粍绮撻悡顐﹀炊閵婏箑闉嶅銈冨劤閸嬬喖鍩€椤掑喚娼愭繛鍙夛耿閹繝鏁撻悩鑼舵憰濠电偞鍨崹鍦不濞戙垺鈷掗柛顐ゅ枔閳洟鏌ｈ箛鎾跺ⅵ婵﹨娅ｇ划娆撴嚄椤栵絾钑夐梻浣告啞閺屻劑鎯岄崒姘捐€垮〒姘ｅ亾婵﹨娅ｇ划娆戞崉閵娧屽晥闂備胶顭堥鍡涘礉濞嗘挾宓佸┑鐘叉搐瀹告繃銇勯弽銊х煁闁?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亜顒㈡い鎰矙閺屻劑鎮㈤崫鍕戙垻鐥幆褜鐓奸柡灞剧洴閸╁嫰宕橀浣诡潔缂傚倷鐒﹂崝鏍€冩繝鍥╁祦闁哄秲鍔嶇紞鍥煕閹炬鍟伴悡妤呮⒒?1.4闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弮鍫熸殰闁稿鎸剧划顓炩槈濡娅ч梺娲诲幗閻熲晠寮婚悢鍛婄秶闁告挆鍛闂佽瀛╅懝楣兯囨导鏉懳﹂柛鏇ㄥ灠缁犳娊鏌熺€涙绠ュù鐘荤畺濮婅櫣绮欓崸妤娾偓妤呮煥閺囨ê鍔﹀┑锛勬暬瀹曠喖顢涘顒€绁繝寰锋澘鈧劙宕戦幘瓒佺懓顭ㄩ崼銏㈡毇濠殿喖锕ㄥ▍锝囨閹烘嚦鐔煎捶椤撶姷鐣抽梻鍌欑窔濞艰崵绱為崶鈺冪濞撴埃鍋撻柣娑卞櫍瀵粙顢栭崣銉︾潖闂備礁婀遍崕銈囨崲閸愵喖鐤炬繝闈涱儐閳锋垿鏌熺粙鎸庢崳缂佺姵鎹囬幃妤€鈽夐幒鎾寸彈闂佹剚浜滈悥鐓庮潖?
                turret.getNavigation().moveTo(prey, 1.4);
                return;
            }
            // ====================================================================

            // 3. 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻娑樷攽閸曨偄濮夐梺绋款儐閹告悂锝炲┑瀣亗閹肩补妲呭楣冩⒒娓氣偓閳ь剛鍋涢懟顖涙櫠椤栫偞鐓曢柟瀛樼箘缁夎櫣鈧娲栫紞濠囩嵁鎼淬劍瀵犲璺虹焾閸炲綊姊绘笟鈧褏鎹㈤崱娑樼婵犻潧顑呯壕鍧楁煟閺傚灝鎮戦柣鎾冲暣濮婂搫鈻庨幆褏浠╂繛瀛樼矒缁犳牕顫忓ú顏勪紶闁告洦鍘鹃崝鍦磽娴ｅ搫校闁圭懓娲ら锝囨嫚瀹割喖鎮戞繝銏ｆ硾閿曪箓宕㈤崨濠勭閺夊牆澧介崚浼存煙濞村鍋撻弬銉︾亖濠电姴锕ら悧濠囧煕閹寸姷纾奸悗锝庡亽閸庛儵鏌涙惔銏犲闁哄瞼鍠栭幃鐑芥偋閸繃鐏庨梻渚€娼уΛ鏃傛濮橆剦鍤曟い鏇楀亾鐎规洜鍘ч埞鎴﹀醇椤愶及鐐测攽閿涘嫬浜奸柛濠冩礈閹广垽骞囬鐟颁壕婵鍘ч獮鏍煃鐠囪尙效妤犵偞顭囩槐鎺懳熼柨瀣伜婵犵數鍋犻幓顏嗗緤閸ф绠犻柟鐐た閺佸绻濇繝鍌涘櫧缁炬儳銈搁幃妤呮晲鎼粹€茬凹閻庤娲栭惉濂稿焵椤掑喚娼愭繛鍙夊灴瀹曪繝骞庨悾灞界ウ濠碘槅鍨伴崥瀣偓姘哺閺屻倗鍠婇崡鐐测拻闂佸憡鑹鹃幊搴ㄥ煘閹达附鏅柛鏇ㄥ亗缁泛顪冮妶鍡楃仴闁瑰啿閰ｅ﹢浣逛繆閻愬樊鍎忓Δ鐘虫倐钘熸慨妯垮煐閻撴洟鐓崶銊﹀闁稿海濮撮湁婵犲﹤瀚惌鎺楁煛瀹€鈧崰鏍嵁閹达箑绠涙い鎾跺О閳ь剚鍔欏娲传閸曢潧鍓伴梻浣稿簻缂嶄礁顕ｇ拠宸悑濠㈣泛顑囬崣鍡涙煟鎼搭垳绉甸柛瀣笒铻為柛鎰靛枟閳锋垿鎮归崶锝傚亾閾忣偆浠屾繝鐢靛仜椤︿即鎯勯鐐叉槬闁靛绠戠欢鐐测攽閻愵亜鐏柛鐘崇墪閻ｇ柉銇愰幒婵囨櫔闂佸憡渚楅崜娑氬閻愵剛绡€闁汇垽娼у暩闂佽桨绀侀幉锟犲箞閵娾晩鏁囬柕蹇曞Х閿涙盯姊洪悷鏉库挃缂侇噮鍨堕幃鈥斥槈濮楀棛鍞甸柣鐘烘〃鐠€锕傚磿韫囨梹鍙忛柨婵嗘噹椤忣參鏌″畝鈧崰鏍箖濠婂喚娼ㄩ柛鈩冿供閸氬倿姊绘担鑺ャ€冪紒鈧担铏圭煋闁汇垻顭堢粻鐐烘煏婵炲灝鍓婚柣鏃傤焾缁剁偟绱掔€ｎ偄顕滈柛搴㈡尰娣囧﹪鎮欓鍕ㄥ亾閹达箑鍨傜憸鐗堝笒缁犵姵淇婇娆掝劅婵炲吋鐗楃换娑橆啅椤旇崵鍑归梺绋款儜缁绘繈寮婚埄鍐ㄧ窞閻庯綆浜堕崵瀣⒑缁嬫鐓柛銊ョ－濡叉劙骞樼€靛摜鎳濋梺鎼炲劀閸曨厺閭梻鍌氬€风粈浣规償濠婂懎绶ゅù鐘差儐閸?(闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃酣銆冮妷鈺佺濞达絿鎳撻埀顒冨煐閹便劌顫滈崱妤€绠婚梺缁樼箓閻栧ジ骞冨Δ鍛櫜閹肩补鍓濋悘鍫㈢磼?150 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犖ч柛銉㈡櫇閸樼娀姊婚崒娆戭槮闁诲繑绻堥、鏍炊椤掍礁浠ч梺鍓插亝濞叉﹢鎮￠弴鐔翠簻闁归偊鍠栧瓭闂佽娴氶崳锝夊蓟濞戞鏃€鎷呯粙鎸庢嚈闂備礁鎼惌澶岀礊娴ｅ壊鍤曟い鎺戝閸ㄥ倹銇勯弮鍥棄闁逞屽墻閸ㄨ泛顫忛搹鍦煓婵炲棙鍎抽崜顒勬⒑閸濆嫭鍣虹紒璇茬墦瀹曟椽鍩€椤掍降浜滈柟鍝勬娴滈箖姊洪崨濞氭垹鍒掗幘宕囨殾闁硅揪绠戠粻鑽ょ磽娴ｈ鐒介柛姗€浜跺娲焻濞戞ê绁┑鐐板尃閸モ晛绁﹀┑掳鍊曢崯鐘诲磻?
            if (turret.getNavigation().isDone()) {
                double rad = Math.toRadians(turret.purgeSearchAngle); // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓闁搞劌鍊块弻娑㈩敃閿濆棛顦ラ梺钘夊暟閸犳牠寮婚弴鐔虹闁绘劦鍓氶悵锕傛⒑鏉炴壆顦﹂悗姘嵆瀵鈽夊Ο閿嬵潔闂佸憡顨堥崑鐐烘倶瀹ュ應鏀介柣鎰级閸ｈ棄鈹戦悙鈺佷壕闂備礁鎼惌澶屽緤閸婄喓浜芥繝鐢靛仜濡瑩宕曢崘娴嬫灁妞ゆ挾濮风壕钘壝归敐鍡楃祷濞存粓绠栧铏瑰寲閺囩偛鈷夌紓浣割儐鐢繝骞冮敓鐘插嵆闁靛骏绱曢崢鎾绘⒑鐎圭姵銆冪紒鈧笟鈧鎶芥偄閸忚偐鍘撻梺鑺ッˇ钘壩熼埀顒勬⒑鐠団€虫灆缂侇喗鐟╅妴浣糕槈濡攱顫嶅┑鈽嗗灦閺€閬嶆倶閸℃稒鈷掑ù锝呮啞閹牓鏌ｉ鐑嗘Ш缂佽京鍋為幏鍛存焻濞戞氨鐣鹃梻浣哥秺濡法绮堟担鍛婃殰闂傚倷绶氬褔藝娴犲绐楅柡鍥╁У椤洟鏌熼崜褏绡€缂佽妫濋弻锝夊箛閸忓摜鐩庨梺閫炲苯鍘甸柛濠冪箓閻ｇ兘骞嬮敃鈧婵囩箾閿濆骸鍘撮柛瀣崌瀹曟﹢鍩￠崘顏嗘闂備焦鎮堕崕婊堝礋椤撴稑浜?

                // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箳閳ь剝顫夊ú鏍洪敃鍌ゆ晝濞寸姴顑嗛悡蹇涙煕椤愶絿绠栧璺哄閵囧嫰顢曢敐鍡欘槹闂佸搫鐭夌换婵嗙暦閸洖唯闁靛／鍌滄／闂?150 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犖ч柛銉㈡櫇閸樼娀姊婚崒娆戭槮闁诲繑绻堥、鏍炊椤掍礁浠ч梺鍓插亝濞叉﹢鎮￠弴鐔翠簻闁归偊鍠栧瓭闂佽娴氭禍鐐哄焵椤掑喚娼愭繛鍙夌墪椤曪綁宕滄担鐟板簥濠电偞鍨崹褰掔嵁閵忊€茬箚妞ゆ牗纰嶉幆鍫熴亜椤愩垻鐏辩紒杈ㄦ尰閹峰懐绮欏▎鐐闂備胶顭堥鍐磹濠靛棭鍤曢悹鍥ㄧゴ濡插牓鏌曡箛鏇炐㈢€规挸妫濆娲濞戣京鍔搁梺绋挎唉娴滎剛鍒掔拠瑁佹椽顢旈崨顏呭濠电偞娼欓崥瀣偡瑜忕划鏃堫敆閳ь剟婀佸┑鐘诧工妤犲憡鏅堕悧鍫滅箚闁告瑥顦慨宥嗩殽閻愭惌鐒介柍褜鍓氱粙鎺楁晪濡炪倕瀛╅幑鍥ь潖濞差亜宸濆┑鐘插缁变即姊虹粙鍧楀弰濞存粌鐖煎畷娲川鐎涙鍔堕悗骞垮劚濡矂骞?
                double finalX = owner.getX() + Math.cos(rad) * 150.0;
                double finalZ = owner.getZ() + Math.sin(rad) * 150.0;

                // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箳閳ь剝顫夊ú鏍洪敃鍌ゆ晝濞寸姴顑嗛悡蹇涙煕椤愶絿绠栧璺哄閵囧嫰顢曢敐鍡欘槹闂佸搫鐭夌换婵嗙暦閸洖唯闁靛／鍌滄／闂傚倷鑳堕…鍫ヮ敄閸岀偛鐤炬繛鎴欏灩閻撴﹢鏌熸潏楣冩闁稿鍔欓幃妤呭捶椤撶倫銏°亜閵夛妇绠樼紒杈ㄦ尰閹峰懘宕崟纰樺亾閹惧墎纾界€广儱瀚粣鏃傗偓娈垮枛椤兘骞冮姀銏″仒闁炽儱鍘栨竟鏇㈡⒑濮瑰洤鐏い鏃€鐗犻幃鐐哄礈瑜夐崑鎾斥槈濞嗘垹鐣肩紓浣介哺閹稿骞忛崨鏉戜紶闁告洘鍩婄紞渚€寮婚敐澶婄厸濠电姴鍊绘禒鎼佹倵濞堝灝鏋︽い鏇嗗洤鐓″鑸靛姇椤懘鏌嶉埡浣告殲闁绘繃娲熷缁樻媴閸涘﹤鏆堢紓浣筋嚙閸婂鍩€椤掍礁鍤柛鎾跺枛閸ㄩ箖寮介鐔蜂壕闁挎繂绨奸幉鐐箾閹炬剚鐓奸柡灞炬礋瀹曠厧鈹戠€ｇ鍋撳Δ鈧…鑳檨闁哥姵顨堥幑銏犫槈濮橆偅鍕冮梺绋挎湰閼归箖鈥栫€ｎ亖鏀介柍銉ュ暱缁狙囨煕閺冣偓閻熲晠鎮伴鈧獮鎺楀箠閾忣偅顥堥柛鈹惧亾濡炪倖甯掔€氼參鎮℃笟鈧弻娑㈠Ψ椤旂厧顫梺缁樻尭缁绘﹢鎮￠锕€鐐婇柕濠忓椤︺儵鎮樿箛鎾剁婵﹥妞藉畷銊︾節閸曨偒娼烽梻浣虹帛椤ㄥ牊绻涢埀顒傗偓娈垮枛椤兘宕洪崟顖氱闁靛ě鍛祦闂傚倷鑳剁涵鍫曞礈濠靛﹥鎳岄梻浣虹帛缁诲啫煤閻旂厧钃熼柨鏇炲€哥粈鍐┿亜閹惧崬鐏╅柟鐣屾暩缁辨挻鎷呴搹鐟扮缂備浇顕ч悧鎾崇暦濞差亜鐒垫い鎺嶉檷娴滄粓鏌熼崫鍕ら柛鏂跨Т閳规垿顢涘☉娆忓攭闂佸搫鐭夌紞渚€骞冮姀銏㈢煓婵炲棛鍋撻ˉ瀣磽閸屾瑧鍔嶉柛鏃€顨婂畷鎴濃槈閵忕姷鍘撮梺纭呮彧鐎靛矂寮繝鍥ㄧ厽妞ゆ挆鍐ц埅婵炲瓨绮庨崑鐐电博閻旂厧鍗抽柕蹇婃櫆閺咃綁姊虹紒妯忣亪宕ラ埀顒傜磼?
                double dx = finalX - turret.getX();
                double dz = finalZ - turret.getZ();
                double distToFinal = Math.sqrt(dx * dx + dz * dz);

                // 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣銏犲閺佸﹪鏌″搴″箹闂傚偆鍨遍妵鍕冀閵娧呯厐缂備浇缈伴崐婵嬪蓟閿濆鏅查柛娑卞枟閹烽亶鎮楃憴鍕闁绘搫绻濆濠氭偄閸涘﹦绉堕梺璇″瀻閸涱啩鎺楁⒒娴ｈ姤銆冪紒鈧笟鈧畷顖烆敃閿曗偓閻撴﹢鏌熸潏鍓х暠缁炬儳鍚嬬换婵囩節閸屾稒宕抽梺鍛婃⒐閹倸顫忛崫鍔借櫣鎷犻幓鎺旑啈婵＄偑鍊戦崝灞轿涘┑鍥︾箚闁汇垻顭堢粈瀣亜閺傚灝鈷旈柡澶嬫倐濮婃椽宕烽鐐板闂佸憡鎸荤喊宥団偓闈涖偢閸┾偓妞ゆ帒鍊荤壕浠嬫煕鐏炲墽鎳呴柛鏂跨Ч閺屾盯寮埀顒勬偋閺囷紕浜遍梻浣告啞閸旓箓宕伴弽顓熷珔闁绘柨鎽滅粻楣冩煙鐎涙鎳冮柣蹇婃櫇缁辨帡鎮╅崫鍕優闂侀€炲苯澧叉い顐㈩槸鐓ら柡宓偓閺嬫牠鏌ㄩ弴鐐测偓褰掑疾閹绘帩鐔嗛悹杞拌閸庡繐霉閻樺弶鎯堟い顏勫暣婵″爼宕卞▎蹇ｆ椒婵犳鍠楄彠闁告柨娴烽崚鎺楀棘濡灚妞介、鏃堝川椤栨艾绠?16 闂?(闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎺嶇劍椤斿洭姊绘担鍛婅础闁稿簺鍊濆畷鐢告晝閳ь剟鍩ユ径濞㈢喖鏌ㄧ€ｎ兘鍋撴繝姘拺闁荤喐澹嗘禒銏ゆ煕閻曚礁鐏︾€殿喗鐓￠崺锟犲川椤斿皷鍋撻悽鍛婄厱闊洦鎼╁Σ绋棵瑰鍫㈢暫婵﹥妞介弻鍛存倷閼艰泛顏繝鈷€鍕唉闁哄本鐩崺鐐哄箚瑜屾竟鏇炩攽閿涘嫬浜奸柛濠冪墵瀹曞綊鎮℃惔妯荤亙闂佸搫娲ㄦ慨鐑芥儗閸懇鍋撻悷鏉款伃闁稿锕幃銏ゅ幢濞戞瑧鍘介梺缁樻⒒椤牓藟鐎ｎ亶鐔嗙憸婵囦繆閸ヮ剙鐒垫い鎺戝枤濞兼劖绻涢崣澹濐亪鈥旈崘顔藉癄濠㈣泛鏈▓楣冩⒑闂堟丹娑㈠焵椤掑嫬纾婚柟鐐灱濡插牊绻涢崨鐗堢彧闁搞劎鏁婚崺銏狀吋婢跺﹤鍞ㄥ銈嗘尵閸犲酣鍩€椤掑倹鏆柡灞剧缁犳盯骞欓崘鈹附绻涚€涙鐭掔紒鐘崇墪椤繐煤椤忓嫬绐涙繝鐢靛Т閸燁偊藝閳哄懏鈷戠紒瀣閹癸綁鏌涜箛鏃撹€跨€规洘妞介弫鎾绘偐閼碱剨绱叉繝鐢靛仦閸ㄥ爼鏁嬫繛瀵稿帶鐎涒晝鎹㈠┑瀣仺闂傚牊绋堥弸鍛攽閻愭澘灏冮柛娑变簻娴滅偓鎱ㄥΟ鐓庡付濠⒀勬尦閺岀喖顢欓弬銈堚偓鍧楁煕閳哄绡€鐎规洘甯掕灒闁革富鍘惧▔鍧楁⒒閸屾瑧顦﹂柟纰卞亜鐓ら柕濞炬櫅缁愭骞栧ǎ顒€澹傚璺哄閸嬫捇鏁愭惔鈩冪亶闂佺粯鎸婚悷鈺呭蓟閿濆鍋勯柛娑橈功閸戔€愁渻閵堝懏绂嬮柛妯圭矙婵＄敻宕熼姘兼綂闂佹寧绋戠€氀兾ｉ崼婵愭富闁靛牆楠告禍婵堢磼鐠囪尙澧涘ǎ鍥э躬閹粓鎸婃竟鈹洦鐓曢柍鈺佸枤閻掔晫绱掗幇顓燁棃婵?
                double step = Math.min(distToFinal, 16.0);
                double nextX = turret.getX() + (dx / distToFinal) * step;
                double nextZ = turret.getZ() + (dz / distToFinal) * step;

                turret.getNavigation().moveTo(nextX, owner.getY(), nextZ, 1.3);
            }
        }

        // 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰鍐€闁靛ě鍛帓闂備焦妞块崢鐓幬涘Δ鍛偓锕傚锤濡や礁娈濋梻鍌氱墛缁嬫垿锝炲澶嬧拺?闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞鐟滄粌霉閺嶎厽鐓忓┑鐐戝啯鍣介柣鎺戝悑缁绘盯骞橀弶鎴犲姲闂佺顑嗛幐楣冨焵椤掍緡鍟忛柛鐘冲哺瀵偅绻濆銉㈠亾娴ｈ倽鏃堝川椤撶媭妲规俊鐐€栭崝鎴﹀垂婵犳艾鐒垫い鎺戭槸楠炴牠鏌嶇憴鍕伌闁诡喒鏅濋幏鐘侯槻濞村吋鍔欏娲偡閺夋寧姣愮紓浣虹帛鐢繝宕洪埀顒併亜閹哄秷鍏屾い锝堝皺閳ь剙鍘滈崑鎾绘煙闂傚顦﹂柦鍐枑缁绘盯骞嬪▎蹇曚患闂佺粯甯楀浠嬪蓟濞戙垹绠涙い鏃堟？婢规洟姊烘导娆戝埌闁绘牜鍘ч～蹇涙惞閸︻厾锛滃┑鈽嗗灥濞咃綁鎮烽妸鈺傗拺闂傚牊绋撴晶銏°亜椤撶偟澧︽い銏″哺閺佹劖寰勬繝鍥ф暪闂備礁鎼ú銊╁磻閻旂厧鍌ㄩ柛娑橈功缁犻箖寮堕崼婵嗏挃闁诡喖銈搁弻鐔兼惞椤愶絽纾抽柦妯荤箞閺屽秹宕崟顒€娅ら梺鎶芥敱閸ㄥ綊鎯€椤忓牜鏁囬柣鎰綑濞呇囨⒑閸撴彃浜藉ù婊庝邯瀵鈽夊▎鎴犵槇闂佸憡鍔︽禍鐐烘偪閸曨垱鍊?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙８闁逞屽厸閻掞妇鎹㈠┑瀣＜婵°倓鑳舵禍娆愮節閻㈤潧浠﹂柛顭戝灦瀹曠懓煤椤忓嫮鏌у┑鐘绘涧椤戝棝鎮¤箛鎿冪唵閻犻缚娅ｆ晶鏇㈡煕閺冨倹鏆柡灞诲€濆鍫曞箰鎼粹€叉樊闂備礁鎼張顒傜矙閹达箑鐓″璺号堥弸搴ㄦ煙闁箑鏋ら柍璇茬箻濮婄粯鎷呯憴鍕╀户闂佸憡眉缁瑩濡撮崘鈺冪瘈闁搞儜鍛毇婵犲痉鏉库偓鏇㈠箠韫囨稑鐤鹃柡灞诲劚缁犲湱绱掗鐓庡辅闁稿鎹囬幊鐘活敆閸屾稒娅掔紓鍌氬€搁崐鎼佸磹閻戣姤鍊块柨鏇炲€堕埀顒€鍟村畷鍗炩槈濡⒈鍞归梻浣规偠閸庢粎浠﹂崜褏鈻夋繝鐢靛Х閺佸憡鎱ㄩ悽鍛婂殞闁告挆鍛劶闁诲函缍嗛崰妤呮偂閸愵喖绾ч柣鎰綑椤庢粍銇勯弬娆炬█闁哄本绋撻埀顒婄秵閸嬪懎鐣峰畝鈧埀顒侇問閸犳洜鍒掑▎鎾扁偓渚€寮撮姀鈩冩珳闂佺硶鍓濋敃鈺呭船閸洘鈷?
        private boolean isValidTarget(LivingEntity e) {
            if (e == turret) return false; // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎺嶇劍椤斿洭姊绘担绋挎毐闁圭⒈鍋婇獮濠冩償閿濆拋妫滄繝鐢靛У绾板秹鎮￠弴鐔虹闁瑰瓨绻傞懜褰掓煛鐎ｎ剙鏋戠紒缁樼洴瀹曘劑顢涘锝嗙€伴梻浣告惈鐞氼偊宕濋幋婵愬殨闁圭虎鍠楅崐閿嬬箾閺夋埈鍎忓ù婊冨⒔閹叉悂鎮ч崼婵堢懆闂佸憡姘ㄩ幊鎾诲煘閹达附鍋愰柟缁樺笚濞堁勭箾鐎涙鐭嬬紒顔芥崌閹繝顢曢敃鈧悙濠囨煏婵犲繒鐣辩痪鏉跨Т椤啴濡堕崨顔绢洶闂佺顑呭Λ娑樜?
            if (!e.isAlive()) return false; // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎺嶇劍椤斿洭姊绘担绋挎毐闁圭⒈鍋婇獮濠冩償閿濆拋妫滈柣鐘叉处缁佹挳寮ㄦ禒瀣厽婵☆垰鎼痪褍顭跨捄鍝勵伃闁哄本绋掔换婵嬪川椤撶姴甯跨紓鍌欒兌缁垳鎹㈤崘顏呭床婵犻潧顑呯壕鍏肩節婵犲倸鏋ら柡澶嬫倐濮?
            if (e instanceof Player) return false; // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎺嶇劍椤斿洭姊绘担绋挎毐闁圭⒈鍋婇獮濠冩償閿濆拋妫滄繝鐢靛У绾板秹鎮￠弴鐔虹闁瑰瓨绻傞懜褰掓煛鐎ｎ剙鏋戠紒缁樼洴瀹曘劑顢涘锝嗙€伴梻浣告惈鐞氼偊宕濋幋婵愬殨闁圭虎鍠楅崐閿嬬箾閺夋埈鍎忓ù婊冨⒔閹叉悂鎮ч崼婵堢懆闂?
            if (e instanceof SkeletonTurret) return false; // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎺嶇劍椤斿洭姊绘担绋挎毐闁圭⒈鍋婇獮濠冩償閿濆拋妫滄繝鐢靛У绾板秹鎮￠弴鐔虹闁瑰瓨绻傞懜褰掓煛鐎ｎ剙鏋戠紒缁樼洴瀹曘劑顢涘锝嗙€伴梻浣告惈鐞氼偊宕濋幋婵愬殨闁圭虎鍠楅崐閿嬬箾閺夋埈鍎忓ù婊冨⒔閹叉悂鎮ч崼婵堢懆闂佺粯鎸诲ú鐔煎蓟閻旂厧绀堢憸蹇曟暜濞戙垺鐓熼柟鎹愭硾閺嬫盯鏌″畝瀣瘈鐎规洘甯掗～婵嬪矗濡寧顎楀┑鐘殿暯閸撴繆銇愰崘顔光偓锕傛倻閽樺鎽?
            if (e instanceof net.minecraft.world.entity.decoration.ArmorStand) return false; // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎺嶇劍椤斿洭姊绘担绋挎毐闁圭⒈鍋婇獮濠冩償閿濆拋妫滄繝鐢靛У绾板秹鎮￠弴鐔虹闁瑰瓨绻傞懜褰掓煛鐎ｎ剙鏋戠紒缁樼洴瀹曘劑顢涘锝嗙€伴梻浣告惈鐞氼偊宕濋幋婵愬殨闁圭虎鍠楅崐閿嬬箾閺夋埈鍎忓ù婊堢畺閺岀喖姊荤€靛壊妲紓浣插亾闁告洦鍨遍悡鐔镐繆椤栨繂浜归悽顖涚洴閺屾稓鈧絽澧庨崚浼存懚閺嶎厽鐓ラ柡鍐ㄦ处椤ュ銇勯弴鐔虹煁闁靛洤瀚粻娑㈠即閻愨晜鐎伴梻?

            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎺嶇劍椤斿洭姊绘担绋挎毐闁圭⒈鍋婇獮濠冩償閿濆拋妫滄繝鐢靛У绾板秹鎮￠弴鐔虹闁瑰瓨绻傞懜褰掓煛鐎ｎ剙鏋戠紒缁樼洴瀹曘劑顢涘锝嗙€伴梻浣告惈鐞氼偊宕濋幋婵愬殨闁圭虎鍠楅崐閿嬬箾閺夋埈鍎忓ù婊堢畺閺屾稑鈹戦崟顐㈠Б婵炴垶鎸哥粔褰掑蓟閵娿儮鏀介柛鈾€鏅滄晥闂備胶绮幐濠氭偡閳哄懎绠栨俊銈傚亾闁宠棄顦埢搴∥熼悡搴⌒ㄩ梻鍌欑劍濡炲潡宕㈡總鍓叉晞闁搞儮鏅滈～鏇㈡煙閻戞﹩娈㈤柡浣割儔閺屾盯鍩勯崘顏呭櫘闂佸搫妫庨崐婵嗩潖閾忚瀚氶柍銉ㄦ珪閻忔洖顪冮妶搴′簻妞わ妇鏁婚悰顔跨疀濞戞ê绐涢柣搴㈢⊕閿曗晛螞閸愩劉鏀介柣鎰綑閻忥箓鎮介娑樼瑲缂佸倸绉归幃娆擃敆閸屾粠鍟庨梻浣烘嚀閻°劑鎮烽妷鈺傚€舵い蹇撶墛閻撴洟骞栫划瑙勵潐鐎规悶鍎查妵鍕敇閳╁啰銆婇梺鍦嚀鐎氼厾绮悢纰辨晬婵﹩鍓欓ˉ搴㈢節閻㈤潧浠滈柣掳鍔戝畷鍨償閵娿儳锛欏┑鐘绘涧椤戝懘鎷戦悢鍝ョ闁瑰瓨鐟ラ悘鈺呭船椤栫偞鈷戦梻鍫熺〒缁犳岸鏌涢幘瀵哥疄闁诡喚鏁诲鎾閳锯偓閹风儤绻涢弶鎴濇倯闁荤啙鍛煋妞ゆ梹绁归悷閭︾叆闁告劦浜滈悡鐔兼倵濞堝灝鏋︽い鏇嗗洤鐓″璺好￠悢鍏肩叆閻庯綆鍏橀崑鎾寸節濮橆収妫呭銈嗗姂閸ㄨ櫣绮婇銈囩＜闂婎偒鍘鹃惌娆戔偓瑙勬礃缁秶鈧絻鍋愰埀顒佺⊕鑿ら柟閿嬫そ濮婃椽宕ㄦ繝鍕窗闂佺閰ｆ禍璺侯嚕閹间礁绠ｉ柣鎰典簷缁ㄥ姊洪棃娑辩劸闁稿氦顕ч蹇涘Ψ閳哄倻鍘介梺鎸庣箓濞层倝宕㈢€涙﹩娈介柣鎰儗閻掔晫绱掓潏銊ョ瑨妞ゎ偅绮撳畷鍗烆潨閸℃﹩妫冨┑鐘垫暩婵兘寮幖浣哥；闁绘劕鎼崹鍌炴煕椤愶絾绀冮柛瀣у墲閵囧嫰寮介顫捕缂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣椤愯姤鎱ㄥ鍡楀姦婵炴垶纰嶅畷澶愭煏婵犲繐鐦滄繛鑲╁枎椤啴濡堕崱妯煎弳婵犫拃鍡椥撶紒瀣槸椤撳吋寰勭€ｎ剙骞嶉梺璇叉捣閺佹悂鈥﹂崼鐔侯浄闁挎洖鍊归悡鏇熺箾閸℃绠崇紒鐘差煼閺岋綁骞欓崘銊ゅ枈閻庤娲栭悥鍏间繆濮濆矈妲锋繝娈垮枛濞差厼顫?
            if (e.getPersistentData().getBoolean("IsFriendlyZombie")) return false;
            if (e.getPersistentData().getBoolean("IsFriendlyCreeper")) return false;

            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁逞屽墾缁犳挸鐣锋總绋款潊闁炽儱鍟跨花銉╂⒒娴ｇ儤鍤€闁宦板妿閹广垽骞囬悧鍫濇畬闂佺鍕垫畷闁绘挻娲熼弻銊╁籍閸ヨ泛娈Δ鐘靛仦閻楃娀寮诲☉銏犖╅柨鏂垮⒔閻ｆ椽姊洪棃娑欐悙閻庢矮鍗抽悰顕€骞掑Δ鈧粻锝嗙節閸偄濮冮柟顕嗙悼缁辨捇宕掑▎鎺戝帯婵犳鍠曢崡鍐茬暦閺囥垺鍋ㄧ紒瀣劵閹芥洟鎮楅獮鍨姎闁绘绮岄‖濠囧Ω閳哄倵鎷洪梺鍛婄☉閿曘儳浜搁悽鍛婄厱闁绘ɑ鐓￠崣鍕亜閵忊€冲摵闁轰焦鍔栧鍕節閸屾壕鍋撻鐑嗘富闁靛牆妫楁慨鍌炴煕閵娿劌鍚圭紒顕嗙秮閹瑩鎮滃Ο鐓庡箥闂備礁鍚嬬粊鎾疾閻愯埖锛傞梻鍌欑窔閳ь剛鍋涢懟顖涙櫠椤曗偓閺屾盯鎮㈢紒妯笺€婄紓渚囧枛椤兘寮幇顓炵窞閻庯急鍕伜婵犵數鍋犻幓顏嗗緤娴犲绠熼柨鐔哄Т閻ゎ噣鏌ｉ幇顔煎妺闁绘挻绋撻埀顒€鍘滈崑鎾绘倵閿濆骸澧扮悮锕傛煟鎼淬値娼愭繛鍙夘焽閹广垽宕橀鑲╃暰闂佸搫鍟悧鍡涙偂閵忋倖鐓冪憸婊堝礈閻斿鍤曢柟闂寸缁秹鏌涢銈呮灁闁告鏁婚弻锝嗘償閿濆棙姣勫銈庡幖閻楀﹦绮嬮幒鏇ㄦ▌闂佸搫鑻粔鍓佹閹烘嚦鐔兼倻閳哄倸顏哥紓鍌氬€烽懗鍓佸垝椤栨粍宕查柛鎰典簼瀹曞弶绻濋棃娑卞剰缁炬儳鍚嬬换娑㈠箣閿濆鎽靛銈冨劜閻楃姴顫?(闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁逞屽墾缁犳挸鐣锋總绋款潊闁靛繈鍨婚崢鐘绘⒒娴ｈ棄鍚归柛鐘崇墵瀹曟垶绻濋崶銊モ偓鍧楁煟閿濆懏婀伴柛鐘冲姉閳ь剙绠嶉崕閬嵥囬銏犵劦妞ゆ巻鍋撻柟鍐茬箳缂傛捇鎮惧畝鈧惌娆撴煕瑜庨〃鍛村极瑜版帗鈷掑〒姘ｅ亾婵炰匠鍥佸洭顢橀姀鐘碉紵濠电偛妫欓幐绋挎暜闂備線娼ч¨鈧紒鍙夋そ瀹曟垿骞樼拠鑼唺闂佽鎯岄崢浠嬪磽閻㈠憡鈷戦柟绋挎捣缁犳捇鏌熼崘鑼ｇ紒鏃傚枛瀵挳鎮㈤崜浣虹暰闂備胶绮崝锔界濠婂牆鐒垫い鎺嶇劍缁€鍫ユ煃瑜滈崜姘辩矙閸儱鐤鹃柣妯款嚙缁犳牜鎲稿鍫簷闂備礁鎲℃笟妤呭磻閳ь剟鏌涚€ｎ偅宕岀€规洘锕㈤、娆撴嚃閳轰讲鍋撻悙宸富闁靛牆妫楅崸濠囨煕鐎ｎ偅灏甸柍褜鍓涢幊鎾诲箟閿涘嫭宕查柛鎰靛枛妗呴梺鍛婃处閸ㄦ壆绮诲☉娆嶄簻闁哄倸鐏濋幃鎴︽煟鎼达絿甯涚紒缁樼〒閳ь剚绋掗…鍥儗鐎ｎ喗鐓曢幖娣灩閳绘洘绻濋埀顒佺瑹閳ь剙顫忓ú顏勭閹艰揪绲块悾鐢告⒑閻熸澘鏆辩紒缁橈耿閻涱噣宕卞☉姗€鍞堕梺闈涱檧婵″洭宕㈡禒瀣拺闂傚牊渚楅悡顓犵磼閻樺啿鐏撮柛鈹垮灲瀵挳濮€閿涘嫬骞愰梺璇茬箳閸嬬喖宕戦幘鍓佺焼閻庯綆鍏橀崑鎾舵喆閸曨剛顦版繛瀛樼矎濞夋盯顢氶敐澶婄妞ゆ棁鍋愭导瀣⒑閸涘﹤濮堢憸鏉垮暣閹虫瑩骞囬鍓э紳闂佺鏈懝楣冨焵椤掆偓閸㈡煡婀侀梺鎼炲劗閺呮繄绮堥崟顐€褰掑礂閸忚偐绋囩紒鐐礃椤鎹㈠┑瀣棃婵炴垶鐟ч悡鎴犵磽娴ｇ瓔鍤欐俊顐ｇ箞楠炲啫螖閳ь剟鍩ユ径濞炬瀺闁惧浚鍋勯悘锕傛煕閹烘埊韬鐐达耿椤㈡瑩鎸婃径澶屾暰濠电姷鏁搁崑娑樜涘Δ鍐╁床闁逛即鍋婇弫鍌涖亜閹扳晛鈧澹曟總鍛婂€甸柨婵嗙凹缁ㄥジ鏌涢悩鎴愭垿骞?..)闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弮鍫熸殰闁稿鎸剧划顓炩槈濡娅ч梺娲诲幗閻熲晠寮婚悢鍛婄秶濡わ絽鍟宥夋⒑閹肩偛鈧牠宕濋弽顓炍﹂柛鏇ㄥ灠閸愨偓濡炪倖鍔﹀鈧紒顔肩埣濮婂搫煤鐠囨彃绠哄銈冨妼閿曨亪骞冮敓鐙€鏁冮柨鏇楀亾闁绘劕锕弻鏇熺箾瑜夐崑鎾斥攽椤斿吋鍠樻慨濠呮缁辨帒螣閻戞鐧佺紓鍌欒兌婵敻鎮ч悩宸殨濠电姵鑹鹃崡鎶芥煟閺冨洦顏犻柣锕€鐗撻弻鐔兼嚌閻楀牆娑х紓浣藉皺閺咁偊寮鈧俊鐑藉Ψ閵忊剝鏉搁梻浣虹帛閸旀牞銇愰崘顔肩畺闁硅揪闄勯崑銊︺亜閺嶃劎鈽夋繛鎼櫍閺屾盯鍩為崹顔煎閻庡灚婢樼€氫即鐛崶顒夋晢闁稿被鍊曢弲顏堟⒒娴ｈ棄鍚归柛鐘冲姍閹兘濡疯閸嬫挸顫濋懜鍨殸缂備礁鍊圭敮锟犲春閿熺姴宸濇い鏃€鍎抽獮妤呮⒑绾懎顥嶉柟娲讳簽瀵板﹪宕稿Δ鈧粻鐘充繆閵堝懏鍣洪柣鎾存礋閺屾洘寰勫☉姘煂婵犵绱曢崢褔婀佸┑鐘诧工閻楀懘骞夐悙顒佸弿濠电姴鍟妵婵堚偓瑙勬礃閿曘垹鐣烽敐鍡楃窞閻庯綆浜滄竟宥呪攽閿涘嫬浜奸柛濠冪墵瀹曞綊妫冨ù銏℃そ婵℃悂鏁傞崜褍楠?
            return true;
        }

    }

    // ==========================================
    // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏℃櫇闁逞屽墰婢规洝銇愰幒鎾跺幗闂佺粯姊婚崢褎绂嶆导瀛樼厽闁哄倹瀵чˉ鐐烘煙娓氬灝濡兼い顏勫暟閹风娀鐓鐑嗘闂備浇宕垫慨宕囨媰閿曞倸鍨傞柛顐ｆ礀閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰缁夌懓顫忓ú顏勪紶闁告洦鍓欓娑㈡⒑閸涘﹥灏扮€光偓閹间胶宓侀柛顐犲劚鎯熼梺闈涱樈閸犳顕欏ú顏呪拺缂侇垱娲栨晶鍙夈亜閵娿儲鍣界紒顔芥閵囨劙骞掗幘顖涘闂佽崵濮村ú鈺冧焊濞嗘垹涓嶉柡灞诲劜閻撶喖鏌嶉崫鍕跺伐闁诲骏濡囬埀顒侇問閸犳牠鈥﹂悜钘夋瀬闁瑰墽绮崑鎰版煛鐏炶鍔氶柡浣筋潐娣囧﹪鎮欓鍕ㄥ亾閺嶎厼绀夐柟杈剧畱閸ㄥ倻绱撴担璇＄劷妞も晠鏀遍妵鍕箻鐠虹儤鐏佺紓浣叉閸嬫挻绻濋悽闈涗粶闁绘妫濋幃妯衡攽鐎ｎ偄鈧爼鏌嶉埡浣告殨缂佽妫濋弻锝夊箛椤撶儐妫嗛梺娲诲幗閻熝囧焵?AI (闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗霉閿濆牊顏犵紒鈧繝鍌楁斀闁绘ê寮堕幖鎰磽娴ｅ弶娅婄€殿喖鐖煎畷鐓庮潩椤撶喓褰嗛梻浣告惈濡瑧鍒掗幘璇茶摕闁挎繂顦粻娑㈡煟濡も偓閻楀﹪鏌ㄩ銏♀拺闁硅偐鍋涙俊鐣岀磼鐠囨彃鈧潡鍨鹃弮鍫濈妞ゅ繋绀佹禍楣冩煥濠靛棛鍑圭紒銊х帛閵囧嫰骞掔€ｎ亞浼堥梺璇″枟椤ㄥ懘锝炲┑瀣闁圭粯甯楅崕顏堟⒒娴ｅ湱婀介柛搴ｅ劋缁傚秹顢旈崼銏犵ウ闂佺硶鍓濋崙鐟邦瀶閵娾晜鈷戠紒瀣健椤庢绱掔紒妯哄闁糕晝鍋ら獮瀣晜缂佹ɑ娅旈梻渚€鈧偛鑻晶顖滅磼閸屾氨效鐎规洖銈稿鎾倷閼稿灚鍟洪梻鍌欑窔濞佳団€﹂崼銉ョ？妞ゆ柨妲堥敐澶婇唶闁绘柨澧庣粻姘渻閵堝棛澧柣鐔村姂椤㈡鎮㈤崫銉ь啎闂佸壊鍋掗崑鍕嵁濡偐纾奸弶鍫涘妽鐏忎即鏌熷畡鐗堝殗闁圭厧缍婇幃鐑藉箥椤曞懎浠归梻浣筋嚙妤犳悂宕㈠鍫濈；闁瑰墽绮悡娆撴⒒閸屾凹鍤熸い锔肩畵閺?3.5 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犖ч柛銉㈡櫇閸樼娀姊婚崒娆戭槮闁诲繑绻堥、鏍炊椤掍礁浠ч梺鍓插亝濞叉﹢鎮￠弴鐔翠簻闁归偊鍠栧瓭闂佽娴氶崳锝夊蓟閿濆拋鐓ラ柛娑卞灠缁楋紕绱撴担铏瑰笡闁烩晩鍨堕悰顔锯偓锝庝簴閺嬪酣鐓崶銊︾；闁汇儺浜?
    // ==========================================
    static class KeepDistanceGoal extends Goal {
        private final SkeletonTurret turret;
        private final double speed;
        private final float range; // 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箲閵囧嫰骞橀崡鐐典患缂佺偓鍎抽…鐑藉蓟閻旂厧绀堢憸蹇曟暜濞戙垺鐓熼柟鎯у船閸旓箓鏌″畝瀣瘈鐎规洘锕㈡俊鎼佹晝閳ь剟藝閳轰緡娓婚柕鍫濆暙閸旀碍銇勯敂鐐毈鐎殿喖顭烽弫鎰板醇閵忋垺婢戦梻浣烘嚀閻忔繄鈧凹鍨跺畷銉╊敃閿旇В鎷洪柣鐘叉礌閳ь剝娅曢悘鍫㈢磽閸屾氨孝闁挎洦浜悰顕€宕橀…鎴犲弳闂佺绻愭晶浠嬪窗閺嶎厼绠犻柡宥庡幖閻撴盯鏌涢幇銊︽珕闁伙附姊圭换?(3.5)
        private LivingEntity toAvoid;

        public KeepDistanceGoal(SkeletonTurret turret, double speed, float range) {
            this.turret = turret;
            this.speed = speed;
            this.range = range;
            this.setFlags(EnumSet.of(Flag.MOVE)); // 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ帒锕︾粙蹇旂節閵忥絾纭炬い鎴濇喘閵嗗懘骞撻幑妤€缍婇幃鈺侇啅椤旂厧澹堢紓浣哄亾閸庡啿顭囬敓鐘茶摕闁绘梻鍘х粈鍫澝归敐鍥у妺闁瑰弶锕㈠鐑樻姜閹殿噮妲┑鐐叉▕閸欏啫顕ｇ拠娴嬫婵☆垶鏀遍弬鈧梻浣告啞濞诧箓宕戦崟顒佸弿闁靛繈鍊栭埛鎴炵箾閼奸鍤欐鐐搭殜閺岀喖鎮烽悧鍫濇灎濡ょ姷鍋涢崯鎶藉Φ閹版澘绠抽柟瀵稿Т閳ь剛鍋ゅ娲濞戣京鍔搁梺绋块绾绢厾鍒掓繝鍥ㄥ€婚柤鎭掑劚娴犫晛鈹戦鐭亜鐣烽鍕嚑婵炴垶鐟﹂崣蹇撯攽閻樺弶鍣烘い蹇曞У缁绘盯骞嬮悩铏瘓閻庤娲忛崝鎴︺€佸☉姗嗙叆闁告劑鍓遍妸鈺傗拻闁稿本鐟чˇ锕傛煙鐠囇呯瘈鐎规洘绻堥獮瀣晝閳ь剛绮堟径鎰婵烇綆鍓欐俊濂告煕鐏炶濡介柕鍥у楠炴帡骞嬪┑鎰棯闂?
        }

        @Override
        public boolean canUse() {
            // 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰鍐€闁靛ě鍛帎婵?1. 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙┛缂傚秵鐗犻幃妤呮晲鎼粹剝鐏堢紓浣插亾閻庯綆鍋佹禍婊堟煛閸愩劌鈧敻骞忛埄鍐х箚妞ゆ劑鍊曢弸娑欐叏婵犲嫮甯涢柟宄版噺椤︾増鎯斿┑濠庢船闂傚倷娴囬鏍礂濞嗘挸纾块梻鍫熺〒閺嗭附淇婇妶鍛櫣缂佲偓閸垺鍠愮€广儱顦崙鐘崇箾閹存瑥鐏柣鎾存礋閺屾洘绻濊箛鏇犳殸闂佸憡鏌ｉ崐婵嬪蓟閿濆鏅查柛銉戝啫绠ｉ柣搴ゎ潐濞叉牠鎮ユ總绋挎槬闁斥晛鍟扮弧鈧梺鍛婂姀閺呮粌鈻?(Guard Mode) 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴濐潟閳ь剙鍊块幐濠冪珶閳哄绉€规洏鍔戝鍫曞箣閻欏懐骞㈤梻鍌欑窔閳ь剛鍋涢懟顖涙櫠閹绢喗鐓涢悘鐐插⒔閵嗘帡鏌嶈閸撱劎绱為崱娑樼；闁告侗鍘鹃弳锔锯偓鍏夊亾闁告洦鍓涢崢?
            // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯煎幗闁瑰吋鎯岄崹宕囩矓閻㈠憡鐓曢煫鍥ㄦ閼拌法鈧鍠楅幃鍌氼嚕娴犲鏁囬柣鏂跨殱閸嬫捇宕归顐ｎ啍闂佺粯鍔樼亸娆愮閵忋倖鐓曢柡鍐ｅ亾缁炬澘绉电粚杈ㄧ節閸ヨ埖鏅濋梺鎸庣箓濞诧箓宕抽鈧娲嚒閵堝懏娈岄梺鎼炲劘閸斿骞忓ú顏呪拺闁绘挸瀵掑鐔兼煕婵犲啯绀嬮柣搴ㄦ敱缁绘繈鎮介棃娑楃捕闂佸綊鏀遍崹鍦閻愬瓨濯撮柛婵勫劜濞堢偓绻涢弶鎴濇倯婵炲吋鐟╁畷姗€鍩€椤掑嫭鍋℃繝濠傚枤濡偓閻庢鍠楅幃鍌氼嚕椤曗偓瀹曞ジ鎮㈤崫鍕闂傚倸顭崑鍕洪妶澶樻晞闁告稒娼欓悞鍨亜閹哄秷鍏屽褏鏁搁埀顒冾潐濞叉﹢宕归崸妤冨祦闁搞儺鍓氶崑瀣煕椤愶絿绠戦柛鏍ㄧ墪閳规垿鎮欓懜闈涙锭缂備焦褰冨锟犲箖濞差亜妫樻繛鍡楀⒔閸旂兘姊虹憴鍕棆濠⒀勵殜瀹?(闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愭い鏃傛嚀娴滈箖鏌涢幇闈涙灈鐎瑰憡绻堥弻鈩冨緞鐎ｎ亞浠奸梺鍝勮嫰閻楁挸顫忓ú顏勭闁肩⒈鍓欑敮銉╂⒑闂堚晝绉甸柛锝忕秮楠炲啴鎮欑€靛壊娴勯柣搴秵閸嬪棝宕㈤鍛瘈闁靛骏绲剧涵鐐繆椤愶絿鎳冮柍璇茬Ч瀹曞崬鈽夊▎鎴濆箰?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弮鍫熸殰闁稿鎸剧划顓炩槈濡娅ч梺娲诲幗閻熲晠寮婚悢鍛婄秶濡わ絽鍟宥夋⒑缁嬪灝顒㈡俊顐㈠暣瀵濡堕崥銈呮贡閳ь剨缍嗛崑鍛存偟閺冨牊鈷戦柟鑲╁仜婵＄晫绱掔拠鎻掆偓鍧楀灳閺冨牆绀冩い蹇庣娴滈箖鏌ㄥ┑鍡欏嚬缂併劎鏅埀顒€鍘滈崑鎾绘煙闂傚鍔嶉柣鎾存礋閹鏁愭惔鈥茬凹閻庤娲栭惌鍌炲蓟閻旂⒈鏁婇柣鎰靛墯閻濐亪姊洪崨濠勫闁绘濮撮锝夊箻椤旇棄鈧兘鏌℃径瀣靛劌婵☆偅绮岄埞鎴︽偐閸偅姣勯梺绋款儑閸嬨倕鐣烽崷顓熷磯濞撴凹鍨遍崓鐢告⒑闂堟单鍫ュ疾濞戞氨涓嶉柣鏃傚劋閸犳劙鏌ｅΔ鈧悧鍡欑箔濮樿埖鐓冮梺鍨儏閻忔挳鏌＄仦鍓р槈闁宠棄顦～婊堝醇閻斿憡姣庡┑锛勫亼閸婃垿宕曢幓鎹ㄦ盯宕橀鑹版憰闂佹寧绻傞ˇ顖滅不婵犳碍鐓欏Λ棰佽兌閸斿秴螖閺冣偓缁绘繄鍠婂Ο宄颁壕闁告劘灏欐鍥⒑閸涘﹥鈷愰柣鐔叉櫊閹即顢氶埀顒勭嵁閹烘嚦鏃堝焵椤掑倻涓嶉柨婵嗘娴滄粓鏌熼幑鎰【闁哄鍨块弻鏇㈠幢濡も偓閺嗭絾鎱ㄦ繝鍐┿仢闁圭绻濇俊鍫曞川閸涱偄鐏紒缁樼☉闇夐悗锝庡亝閻濇牗绻涚€涙鐭屾い顓炵墦閸┿垺鎯旈妸銉ь啋闂佹儳娴氶崑澶屾閵忋倖鈷掑ù锝囧劋閸も偓婵犫拃鍛珪闁告帗甯￠、娑㈡倷閺夋垳绨甸梻浣告惈濞层劑宕板鍥ㄥ床闁糕剝菧娴滄粓鏌″鍐ㄥ闁活厼锕幃浠嬵敍濮樺崬鐓熼梺鍝勭焿缁辨洟鍩€椤掑﹦绉靛ù婊勭矒椤㈡濮€閵忋垻锛滅紓鍌欑劍椤洨绮婚悙鐑樼厱闁宠鍎虫禍鐐繆閻愵亜鈧牜鏁幒鏂哄亾濮樼厧澧扮紒顔垮吹缁辨帒螣闂€鎰泿闂備礁鎼崯顐⒚洪妶鍫毐濠?
            if (!turret.isFollowing()) return false;

            // 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰鍐€闁靛ě鍛帎婵?2. 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欑€靛摜鐦堥梺姹囧灲濞佳冪摥闂佽瀛╃粙鍫ュ疾濞戭潿鈧懏绺界粙璇锯晠鏌嶉崫鍕偓鐢稿箯濞差亝鈷戦柛锔诲弾閻掔偓绻涢幘顕呮缂侇喖顭烽獮妯肩磼濡厧骞嶉梻浣告啞閸旀浜稿▎鎴犱笉濠电姵纰嶉悡鐔兼煙閸喖鏆欏褍鐡ㄩ妵鍕閳藉棙鐤侀悗瑙勬礈閸犳牠銆佸Δ鍛劦妞ゆ帊鑳堕々鐑芥煃鏉炴媽顔夐柡鈧懞銉ｄ簻闁哄啫鍊婚幗鍌炴煟閹哄秶鐭欓柡灞剧☉铻ｉ柣妯诲絻椤忣偅銇勯埡鍌滃弨闁哄矉缍侀獮鍥敊閻撳骸顬嗛梻浣侯焾椤戝啴宕濆澶娢﹂柛鏇ㄥ灠閸愨偓闂侀潧臎閸涱垱姣囧┑锛勫亼閸婃洜鎹㈤幒鎾剁闁逞屽墴閺岋紕浠﹂悾灞濄儲銇勮缁舵岸寮诲☉銏犵閻庨潧鎲￠崚娑㈡⒑闂堟稒顥欓柣鎺炲閹广垹鈹戠€ｎ亞锛滃┑掳鍊撻懗鑸电濞嗘劗绡€闁汇垽娼ф禒锕傛煕閵娿儳鍩ｉ柡浣稿暣閸╋繝宕ㄩ鐘崇劸闂備礁鎲＄粙鎴︽偤閵娾晛鐓曢柟瀵稿亼娴滄粓鏌熼崫鍕棞濞存粌澧界槐鎾存媴閸撳弶笑濡炪倖娲﹂崢楣冨礆閹烘閱囬柕澶堝劚閼板灝鈹戦悙鏉戠仸闁荤啙鍥у偍闁告挆鍛紳婵炶揪绲芥竟濠囧磿閹惧绠惧璺侯儐缁€鍐磼閸屾稑绗掗柍钘夘槸閳诲酣骞嬮悪鈧崯搴ㄦ⒒娴ｅ憡鍟炲〒姘殜瀹曟澘顫濇潏鈺€绗夐梺缁樺姉閸庛倝鎮″☉姘ｅ亾閸忓浜鹃梺閫炲苯澧寸€规洑鍗冲鍊燁檨闁搞倖娲熼弻鐔风暋閹殿喚浼囬梺姹囧€愰崑鎾绘⒒娴ｅ憡鎯堥柛濠傛贡閳ь剛鐟抽崶銊у弳濡炪倖鎸炬慨椋庡娴犲鐓曢悘鐐插⒔閹冲嫮绱掓担瑙勭凡妞ゎ亜鍟村鍫曞箣閻愭潙鏋戦梻浣烘嚀缁犲秹宕归挊澶屾殾婵せ鍋撴い銏℃瀹曞崬鈻庨幋婵嗙畾濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柡澶嬪殮濞差亝鏅濋柛灞炬皑閿涙盯姊洪崨濠冨闁搞劑浜堕幃锟犲即閵忥紕鍘甸梺纭咁潐閸旀洟鎷曟總鍛婄厱闊洦鎸鹃悞鎼佹煛瀹€鈧崰鏍嵁閹捐绠抽柡鍐ㄥ€愰妸鈺傗拺闁告繂瀚悞璺ㄧ磽瀹ュ嫮绐旀鐐插暣婵偓闁靛牆鎳庣粣娑欑節閻㈤潧孝閻庢艾鎽滃Σ鎰綇閵娧呯槇缂佺偓婢橀ˇ杈╁閸ф鐓曢悗锝庡墮娴犙囨煛娓氬洤娅嶉柟顔界懇瀹曨偊宕熼褍鏁搁梺鑽ゅ枑缁孩鏅跺Δ鍐╂殰婵°倕鎳庨悿楣冩煙闂傚鍔嶉柣鎾跺枑娣囧﹪顢涘☉姗嗗殝闂佺粯绻嶆禍婵堟崲?
            if (turret.isCommandRescue()) return false;

            // 3. 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ帒锕︾粙蹇旂節閵忥絽鐓愰柛鏃撶畵瀵偅绻濋崶銊у幐閻庡箍鍎辨鎼佺嵁閺嶎偆妫柟顖嗗瞼鍚嬮梺鍝勬湰缁嬫垿鍩ユ径鎰闁绘劖褰冮婊堟⒒娴ｈ鍋犻柛濠冪墪鐓ら柣鏃傚帶閽冪喐绻涢幋鐐电煠婵¤尙鍘ч—鍐Χ閸愩劌顬堥梺鐟板暱闁帮綁銆佸▎鎺旂杸闁圭虎鍨遍弬鈧梺璇插嚱缂嶅棝宕戦崱娑樺偍妞ゅ繐鎳愮弧鈧梺姹囧灲濞佳勭濠婂牊鐓熼煫鍥ㄦ⒒缁犵偟鈧娲樼换鍌炩€﹂妸鈺佸窛妞ゆ牗绮ｇ槐?(range) 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ巻鍋撶痪鎯ь煼閺岀喖鎮ч崼鐔哄嚒闂佺琚崝搴ㄥ箟閹间礁妫橀悹鎭掑妽濞堟儳顪冮妶鍡欏⒈闁稿孩鍔欏顐﹀礃椤旂晫鍘撻梻浣哥仢椤戝洭銆傞崣澶夌箚闁绘劘鍩栭ˉ澶愭煟閿濆妫戠紒顔界懅閹风娀鎮欓渚囨闂佺硶鏂侀崑鎾愁渻閵堝棗绗掗柛濠傤煼閹矂宕卞☉娆戝幈闂侀€涘嵆濞佳囧几閻斿吋鐓熼柟鎯х摠缁€鍐磼缂佹娲存鐐差儏閳规垿宕卞顒傚幋闂傚倷娴囬褎顨ヨ箛鏇熷床婵犻潧顑呴拑鐔兼煥濠靛棭妲归柡鍛絻椤法鎹勬笟顖浶ч梺鍝ュУ瀹€绋款潖濞差亜浼犻柛鏇ㄥ幘娴煎洭姊洪崫銉バｉ柣妤冨█婵″瓨鎷呴懖婵囨⒐閹峰懘宕妷褏宓佹繝鐢靛О閸ㄧ厧鈻斿☉銏犲珘妞ゆ帒瀚悿楣冩煟閹惧磭宀搁柡鈧?
            List<Monster> enemies = turret.level().getEntitiesOfClass(Monster.class,
                    turret.getBoundingBox().inflate(range, 2.0, range),
                    e -> e != turret && e.isAlive() && !isFriendly(e)
            );

            if (enemies.isEmpty()) return false;

            // 4. 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙缂佺姷濞€閺岀喖宕滆鐢盯鏌涙繝鍛厫闁逛究鍔岃灒闁圭娴烽妴鎰磼閻愵剙鍔ゆ繛纭风節瀵鎮㈤悡搴ｇ暰闂佺粯顨呴悧婊兾涢崟顖涒拺闁告繂瀚銉╂煕鎼淬垹鈻曢柛鈹惧亾濡炪倖宸婚崑鎾绘煕濡崵鐭掔€规洘鍨块獮妯肩磼濡厧骞堥梻浣告惈濞层垽宕濈仦鍓ь洸婵犲﹤鐗婇悡鐔哥節闂堟稒绁柤鐗堝閹便劍绻濋崘鈹夸虎闂佸搫鑻幊姗€骞冨▎鎾村殤閻犺桨璀︽导鍐ㄢ攽閻橆偅濯伴悘鐐垫櫕娴狀厾绱撴担铏瑰笡闁烩晩鍨堕獮鍐焺閸愨晛鍔呭銈嗘⒐閸庢娊骞冮幋鐐扮箚闁靛牆娲ゅ暩闂佺顑嗛惄顖炪€侀弽銊ョ窞闁归偊鍓涢悾娲⒑鐎圭姵銆冮柤鍐茬埣瀵娊鏁冮崒娑氬幈闂侀潧顧€缁茶姤淇婇懞銉ｄ簻闁哄倽娉曠粻鑼磼缂佹绠為柟顔荤矙濡啫鈽夊Δ浣稿闂傚倷鐒﹂幃鍫曞礉瀹€鍕亯濠靛倸鎽滃畵渚€鏌熼悧鍫熺凡缂佺姷绮妵鍕籍閸パ傛睏闂佹寧绋掗惄顖氼潖濞差亜鎹舵い鎾跺仒婢规洟姊洪崫鍕靛剳闁告鍐ㄧカ闂備礁澹婇崑渚€宕曢弻銉﹀亗婵炲棙鎸婚悡鏇熴亜椤撶喎鐏ラ柡瀣洴閺岋繝宕卞Ο鑽ゎ槹闂佸搫鐬奸崰鏍€佸▎鎾村殐闁宠鍏欓崐妤冩閹烘挻缍囬柕濞垮劤閻熸彃鈹戦悙闈涘付缂佺粯蓱娣囧﹤顫㈠畝濠冃梻浣风串缁插潡宕㈣閸╃偤骞嬮敂钘夆偓鐑芥煛婢跺鐏╁ù鐘层偢濮婄儤娼幍顕呮М濡炪値鍘鹃崗妯讳繆鐎涙ɑ濯寸紒顖涙礃閻庡姊虹憴鍕姢缁剧虎鍙冭棟妞ゆ挶鍨洪崑鈩冪節婵犲倸鏆熼懖鏍磽娴ｆ垝鍚柛瀣ㄥ€曢悾鐑芥偄绾拌鲸鏅㈤梺绋挎湰缁娀宕惔銊︹拻濞达絿鍎ら崵鈧銈嗘处閸欏啫鐣烽幋锔藉€烽柤纰卞墯濞堥箖鎮楅崗澶婁壕闂侀€炲苯澧版俊鍙夊姍楠炴鎷犻懠顒婄床婵犵數鍋為崹鍫曟偡瑜嶉埢鎾诲Χ閸モ晝锛濇繛杈剧导缁瑩宕ú顏呯厽闁绘洖鍊搁々顒勬煃瑜滈崗娑氬緤婵犳艾纾婚柟鐗堟緲閻掑灚銇勯幒宥堝厡闁愁垱娲橀妵鍕敇閻愭潙鏋犻悗瑙勬礃缁诲牆鐣锋總绋垮嵆闁绘柨鎼獮妤呮⒒娴ｈ櫣甯涢柨姘舵煕濡崵澧甸柟铏矒椤㈡棃宕奸悢鍝勫箞闂備礁鎼崐钘夆枖閺団€斥偓瀵哥磽閸屾瑧璐伴柛锝庡灣瀵板﹪宕愰悢杞扮胺闂傚倷绀侀幉鈩冪瑹濡ゅ懎绐楁慨妯挎硾閻?
            // (缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛銈呭閺屻倗绮欑捄銊ょ驳闂佸憡鐟ョ换鎴﹀Φ閸曨垰绠婚柛妤冨仧娴犺偐绱掗悙顒€鍔ゆい顓犲厴瀵鎮㈤悡搴ｎ槶閻熸粌绻掗弫顔尖槈閵忥紕鍘介梺瑙勫劤閻°劎绮堥崘銊囧酣宕惰闊剙鈹戦垾宕囧煟鐎规洜鍠栭、姗€鎮欏顔锯偓瀵哥磽閸屾艾鈧鎷嬮弻銉ョ；闁瑰墽绮悡鏇熴亜閹扳晛鈧洟寮搁弮鍌滅＜闁绘宕甸悾娲煛鐏炲墽娲存い銏℃礋婵″爼宕ㄩ閿亾婵犳碍鈷戦悹鍥皺缁犱即鏌ｆ幊閸旀垿濡撮崘顔嘉ㄩ柍鍝勫€搁埀顒傚厴閺屸剝寰勭€ｎ亞浠搁柣鐘叉川閸嬫稖鐏冮梺缁橈耿濞佳勭閿曞倹鍋ㄦい鏍ュ€楃弧鈧梺缁樹緱閸犳岸鍩€椤掑﹦绉甸柛鐘愁殜瀹曟垿骞囬鐘殿啎闂佸壊鍋嗛崰搴敋濠婂嫮绠鹃柛顐ｇ箘缁夌儤鎱ㄦ繝鍌ょ吋鐎规洘甯掗埢搴ㄥ箣濠靛棭鐎撮梻浣筋嚙濞寸兘鎮烽幎钘夊窛妞ゆ牗绮庨崢顖炴⒒娴ｄ警鏀伴柟娲讳簽缁骞嬮悩顐壕婵﹩鍓﹀Σ褰掓煏閸パ冾伃妤犵偞甯掗濂稿醇濠靛棗鑵愰梻鍌欒兌缁垳鎹㈤崱娑樻槬闁哄稁鍘肩粻鐐烘煏婵炲灝鍔存繛鎾愁煼閹綊宕堕鍕婵犮垼顫夊ú鐔煎蓟閿濆棙鍎熼柕蹇婃櫅閺呴亶姊洪崫銉バｇ€光偓缁嬫鍤曟い鎰剁悼缁♀偓濠殿喗锕╅崜姘ｉ鍕拺闂侇偆鍋涢懟顖涙櫠椤栫偞鐓忛柛銉戝喚浼冨Δ鐘靛仦鐢帡顢樻總绋跨倞鐟滃秹鈥栨径濞炬斀闁绘劘灏欓幗鐘绘煕閵堝懘鍙勭€规洘鍔曢埞鎴犫偓锝庝海閹芥洟姊虹紒妯活梿闁靛棌鍋撻梺绋款儐閹瑰洭骞冮挊澶嗘灁閻犳亽鍔屾慨濂告⒑閸濆嫮鈻岀紒缁樼箓椤?
            enemies.sort(Comparator.comparingDouble(turret::distanceToSqr));
            this.toAvoid = enemies.get(0);

            return true;
        }

        @Override
        public void start() {
            if (this.toAvoid == null) return;

            // 5. 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煕椤垵浜濋柛娆忕箳閳ь剝顫夊ú鏍洪敃鍌ゆ晝濞寸姴顑嗛悡蹇涙煕椤愶絿绠栧璺哄閵囧嫰顢曢敐鍡欘槹闂佸搫鐭夌换婵嗙暦閸洖唯闁靛／鍌滄／闂傚倷鑳堕…鍫ヮ敄閸岀偛鐤炬繛鎴欏灩閻撴﹢鏌熸潏楣冩闁稿鍔欓幃妤呭捶椤撶倫銏°亜閵夛妇绠樼紒杈ㄦ尰閹峰懘宕崟鎴欏灪閵囧嫰顢橀悩鎻掑箣閻庢鍠栭…宄邦嚕閹绢喖顫呴柣妯款嚙閺佽绻濋悽闈浶㈤柣蹇斿哺瀹曟繈寮借閹姐儵姊婚崒姘偓鐑芥嚄閸洍鈧箓宕奸妷顔芥櫈闂佺硶鍓濈粙鎴犵不閺屻儲鐓曢柕澶樺枛婢ь噣鏌￠崟鈺佸姦闁哄苯绉烽¨渚€鏌涢幘鏉戝摵濠碉紕鏁诲畷鐔碱敍濮橀硸鍞洪梻浣烘嚀閻°劎缂撴ィ鍐ㄧ；闁瑰墽绮崑锟犳煙濞堝灝鏋熸繛鍫㈠亾缁绘繈濮€閿濆棛銆愬銈嗗灥閸燁垳绮嬪鍜佺叆闁割偆鍠撻崢鎼佹倵楠炲灝鍔氶柛鐕佸亝娣囧﹥绂掔€ｎ偆鍘介梺闈涱煭缁犳垿鎮橀埡鍐＜?(闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎰剁悼閳ь剚濞婇幃妤呯嵁閸喖濮庡銈忓瘜閸ㄨ泛鐣疯ぐ鎺戠＜闁绘劗琛ラ幏濠氭⒑閸撴彃浜為柛鐘茬Ф濞嗐垽鏌嗗鍡欏幈闂侀潧鐗嗗Λ娆戠矆閳ь剟姊婚崶褜妯€闁哄矉绲借灒闁绘垶菤閺嬫瑩姊虹粙鍧楊€楃紒缁樺灦缁岃鲸绻濋崶鑸垫櫇闂佹寧绻傜换妤呭焵椤掆偓濞硷繝寮婚垾宕囨殕閻庯綆鍓涜ⅵ闂備浇顕栭崰鎾诲垂閽樺鏆︽い鎰剁畱缁€瀣煕椤垵浜濋柣锔芥濮婂宕掑▎鎺戝帯濡炪値鍘奸悧鎾诲极閸愵喖围濠㈣泛妫岄崑鎾绘晝閸屾稑鈧鏌﹀Ο渚Ъ闁?6 闂?
            net.minecraft.world.phys.Vec3 awayPos = net.minecraft.world.entity.ai.util.DefaultRandomPos.getPosAway(turret, 6, 4, this.toAvoid.position());

            if (awayPos != null) {
                // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亜顒㈡い鎰矙閺屻劑鎮㈤崫鍕戙垻鐥幆褜鐓奸柡灞剧洴閸╁嫰宕橀浣诡潔缂傚倷鐒﹂崝鏍€冩繝鍥╁祦闁哄秲鍔嶇紞鍥煕閹炬鍟伴悡妤呮⒒?1.3 (缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋敐鍛婵＄偑鍊戦崹娲偋閻樿尙鏆﹂柕濞炬櫓閺佸秵绻濇繝鍌涘櫧闁告濞€濮婅櫣鎷犻幓鎺濆妷缂備礁顑嗙敮锟犲灳閿曞倸鐐婃い鎴︽暜閸嬫捇宕ㄩ弶鎴ｆ憰闂侀潧顧€婵″洭宕㈤幖浣光拺闁硅偐鍋涢崝锔姐亜閵夛附灏靛瑙勬礋瀹曠螖娴ｅ搫骞楅梻渚€娼ч悧鍡涘磹閸涘﹦顩查柟顖嗏偓閺€浠嬫煥濞戞ê顏╁ù婊冦偢閺屾稒绻濋崘顏勨拰閻庤娲樼换鍡浰囩€涙ü绻嗛柛娆忣槸婵秶鈧鍠楅幐铏叏閳ь剟鏌嶉崫鍕偓鐟扳枍閸℃稒鈷掗柛灞剧懅鐠愪即鏌涢幘瀵告噮缂侇喗妫冮幃浠嬪川婵犲倷绨甸梻浣虹帛閺屻劑宕ョ€ｎ喗鍋傛繛鍡樻尰閳锋垶銇勯幘鍗炲闁伙綁浜堕弻锛勨偓锝庡墮閺嬫垿鏌曢崶褍顏紒鐘崇洴瀵挳鎮欑€甸晲绨寸紓鍌氬€峰ù鍥ㄣ仈閸濄儲鏆滄俊銈傚亾妞ゎ厼娲╃粻娑樷槈濡壕鏅濋幉姝岀疀濞戞瑥浠奸梺缁樻尭缁ㄥ爼寮ㄦ禒瀣厽闁归偊鍘界紞鎴︽煟韫囧﹥娅婇柡灞稿墲閹峰懘宕滈懠顒€鎮戦梻渚€娼уΛ鏃傜矆娓氣偓閸┿垺鎯旈妸銉ь啋闂佸搫顦伴崹鍫曨敇婵傚憡鈷掑〒姘ｅ亾婵炰匠鍥ㄥ亱闁糕剝顦鸿ぐ鎺戠＜闁绘劘灏欓弻鍫ユ倵楠炲灝鍔氭い锔垮嵆閸╂盯骞嬮敂钘変化闂佹悶鍎崝宀€寰婄紒妯镐簻闁瑰搫顑呴悘顔剧磼鏉堛劌绗ч柍褜鍓ㄧ紞鍡涘磻閸曨厾绠旈柍鍝勬噺閻撴瑧绱掑☉姗嗗剰濞存粍绮撻弻?
                turret.getNavigation().moveTo(awayPos.x, awayPos.y, awayPos.z, speed);
            }
        }

        @Override
        public boolean canContinueToUse() {
            // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈢粯淇婇悙顏勨偓鏍偋濡ゅ啰鐭欓柟鐐湽閳ь剙鎳樺濠氬Ψ閿旀儳寮虫繝鐢靛█濞佳兾涢鐐嶏綁宕奸弴鐔哄帗閻熸粍绮撳畷婊冣枎閹惧磭鐤囧┑顔姐仜閸嬫挾鈧鍣崑濠傜暦濮椻偓椤㈡瑩鎳栭埡浣感曞┑锛勫亼閸婃牜鏁幒鏂哄亾濮樼厧澧撮柟顔光偓鏂ユ斀闁哥姰鍨圭紞濠囧箖閳轰緡鍟呮い鏃傚帶婢瑰淇婇悙顏勨偓鏇犫偓娑掓櫊瀹曟繂螖閸愨晩娼熼梺瑙勫劤閻°劍鍒婇幘顔界厽闁绘柨鎲＄欢鍙夈亜椤愩垼瀚伴柍瑙勫灴閹瑩宕ｆ径鍡樼亞闂備礁鎲￠敋闁靛牊鎮傞獮鍐箚瑜忛弳瀣⒑椤撱劑妾柛宥囨暬閺岋綁鎮╅懡銈囩獥濠电偛鎷戠紞渚€銆佸鈧幃鈩冩償椤旇棄鐦滈梻渚€娼ч悧鍡椢涘▎鎾村亗闁靛鍎洪悢鍡欐喐瀹€鈧崚鎺戔枎閹惧磭鐣洪梺鏂ユ櫅閸燁偆娆㈤悙鐑樼厵闂侇叏绠戦獮鎰版煙閻ゎ垱顏犵紒杈ㄦ崌瀹曟帒鈻庨幋婵嗩瀴闂備焦瀵ч懝楣冨煘閹达富鏁婄痪鎷岄哺鏁堢紓鍌欒兌缁垶鎯勯姘辨殾闁靛ň鏅╅弫鍐煏韫囷絾绶氱紒杈ㄦ礃缁绘繄鍠婂Ο宄颁壕闁告劘灏欐鍥⒑閸涘﹥鈷愭繛鑼枛瀹曟椽鎮欓崫鍕吅闂佹寧娲嶉崑鎾绘煟閹邦剨韬柡灞界Ч瀹曠兘顢橀悙鏉款棜闂備浇顕х换鎰板疮閺夋埈娼栫紓浣股戞刊鎾煕濞戞﹫鏀婚柛搴㈡崌濮婃椽宕妷銉︾彙闂佺顑呯€氼噣宕ｉ崨瀛樷拺闂傚牊涓瑰☉銏犲窛妞ゆ帒鍊婚幉褰掓⒒閸屾瑨鍏岀紒顕呭灦瀹曞綊宕楅崗鐓庡伎闂侀潧鐗嗛ˇ浼村磻閸岀偞鐓涢柛銉ｅ劚閻忣亪鏌ｉ幘鍗炲姦闁哄矉绻濆畷鎺戔槈濮楀棗娈濋梻浣筋嚃閸ㄤ即鎮ч崱娑樼厴闁硅揪瀵岄弫濠囨煟閻旂⒈鏆掑瑙勬礈缁辨捇宕掑顑藉亾閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弴鐐测偓鍝ョ矆婢跺本鍠愰煫鍥ㄧ☉缁犳煡鏌曡箛鏇炐涢柡鈧禒瀣厱闁抽敮鍋撻柡鍛矌缁辩偞鎯旈妸锔规嫼缂佺虎鍘奸幏瀣焽閹扮増鐓曢柡鍐ｅ亾妞ゃ劌锕獮鍐锤濡も偓閻掑灚銇勯幒鎴濐仾闁抽攱鍨块弻娑樷攽閸℃浠奸梺閫炲苯澧柟顔煎€块獮鍐樄鐎规洏鍔戦、娑橆煥閸涱垰濮告繝鐢靛仦閹稿宕洪崘顔肩；闁圭偓鐣禍婊堟煏韫囧ň鍋撻崘鍙夋嚈闂備浇妗ㄩ悞锕傚礉濞嗗繒鏆﹀┑鍌滎焾椤懘鏌曡箛濠傚⒉缂侀鍋婂濠氬磼濞嗘垹鐛㈠┑鐐板尃閸ャ劍娅栭棅顐㈡处缁嬫垵顪冮挊澹濆綊鏁愰崨顓涘彚闂侀潧顦弲婊堝煕閹烘嚚褰掓晲閸モ晜鎲橀梺鎼炲€栭悷褏妲愰幒鏃傜＜婵☆垰鎼～搴ㄦ⒑閻熸壆鐣柛銊ь攰閻忓啯绻涙潏鍓у閻犫偓閿曗偓鐓ょ紒瀣儥濞撳鏌曢崼婵囶棞缂佹甯￠幃妤€顫濋悡搴☆潾缂備緡鍠栭…鐑藉极閹版澘妞藉ù锝囨嚀閻︽粓姊虹拠鎻掑毐缂傚秴妫欑粋宥呪攽鐎ｎ亞顔夐梺鎸庣箓濞层劌螞椤栫偞鐓欐い鏍ф閸燁垶宕愰鐐粹拺闂傚牊绋掗幖鎰版倵濮橆偄宓嗛柣娑卞枛閳诲酣骞樺畷鍥舵Ч婵＄偑鍊栭幐鐐垔鐎靛憡顫曢柣銏犳啞閳?
            return !turret.getNavigation().isDone() && turret.isFollowing();
        }

        // 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘ｅ亾妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫宥夋煟閹邦厽缍戝ù婊堜憾濮婅櫣鍖栭弴鐐测拤缂備礁顑嗛崹鍦垝婵犳碍鍋愰悹鍥皺椤旀劕鈹戦悜鍥╃У闁告挻鐟╅幃姗€顢旈崼鐔哄幈濠电偛妫楃换鎺旂不閺屻儲鐓忛柛銉戝喚浼傜紓浣哄У閻╊垶鐛Ο鍏煎磯濞撴凹鍨卞鎴︽⒒閸屾瑧顦﹂柟纰卞亰楠炲繒鈧綆鍠栫粈鍫熸叏濡寧纭剧紒鐘靛仱閺屾洘绻涢崹顔煎Ф濠电偟顑曢崝鎴﹀蓟濞戙垹鐒洪柛鎰亾閻ｈ泛顪冮妶搴′簮闁哄懐濮撮～蹇涙惞鐟欏嫬鐝伴梺鑲┾拡閸撴盯顢欐径鎰拺缂備焦蓱閹牏绱掔紒妯肩畵妞ゆ洩绲剧换婵嗩潩椤撶喐顏熼梻浣虹帛椤牏浜稿▎鎾存櫖婵犲﹤鐗婇埛鎴︽⒒閸喓銆掑褎娲熼弻鐔煎礃閸欏宕崇紓渚囧枛椤嘲鐣烽锕€绀嬮柕濠忛檮閺夋悂姊绘担鍝勪缓闁稿酣浜跺畷顖滄崉閵娧勶紡閻熸粍妫冨濠氭偄绾拌鲸鏅╅梺缁樻尭缁ㄥ爼宕戦幘璇茬濞达絿鎳撴禒濂告⒑缂佹ê鐏辨俊顐㈠閺侇噣姊绘担绋挎毐闁圭⒈鍋婂畷鎰版偡閹佃櫕鐎洪梺绯曞墲缁嬫帡鍩涢幋锔界厱闊洦娲栫敮璺侯熆瑜滈崹鍫曞蓟濞戙垹惟闁挎洍鍋撻柍缁樻礋閹稿﹤鈹戦崰銏犵秺閹剝鎯旈敐鍡樺枛闂備焦濞婇弨閬嶅垂閸ф钃熸繛鎴炃氬Σ鍫熸叏濡も偓閻楀棙鎱ㄥ☉銏♀拺闁荤喐婢橀弳閬嶆煕閻曚礁鐏﹀┑锛勬暬瀹曠喖顢涘槌栧悈婵犵數濞€濞佳兠洪妶鍛灁婵°倕鎳忛崐?(闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎺嶇劍椤斿洭姊绘担绋挎毐闁圭⒈鍋婇獮濠冩償閿濆拋妫滈柣鐘叉搐濡﹪鎮㈤崱娑欏仯濡わ附瀵ч鐘绘煟韫囨矮鍚紒杈ㄥ浮閸┾偓妞ゆ帒瀚粈瀣亜閺嶃劎銆掗柛妯烘啞缁绘繈濮€閿濆棛銆愬銈嗗灦閸旀瑥鐣烽弴銏犖ㄩ柍鍝勫€婚崢閬嶆⒑闂堟稓澧曟俊顐ｇ懅缁牏鈧綆鍠楅悡娑㈡倶閻愬灚娅曢崯绋款渻閵囧崬鍊荤粣鏃堟煛鐏炲墽娲存鐐搭焽閹瑰嫰鎮滃Ο灏栧亾鐠囧樊娓婚柕鍫濋娴滄粎绱掔紒妯虹仼缂傚倹鎸荤粋鎺斺偓锝庝簻缁愭稒绻濋悽闈浶㈤柛濠囶棑閼鸿鲸绻濆顓犲幗闁硅壈鎻徊楣冨吹閳ь剟鏌ｆ惔銏犲毈闁告ê銈搁垾锕傚垂椤曞懏寤洪梺閫炲苯澧柣锝囧厴閹晫绮欑捄顭戝悈闂備焦瀵уΛ浣筋暰闂佸綊鏀卞钘夘潖濞差亝鍤掗柕鍫濇噺閻庣偓绻濋姀銏″殌婵☆偅绻堥悰顔嘉旈崨顔间汗缂傚倷鐒﹂…鍥储閽樺鏀介幒鎶藉磹閹剧粯鍊块柨鏂垮⒔閻棗顭块懜闈涘闁绘挸绻橀弻娑㈠Ψ閿濆懎顬堟繝娈垮枛缁夌敻濡甸崟顖氼潊闁斥晛鍟伴ˇ浼存⒑鏉炴壆顦﹂柛鐔告尦瀹曟椽鍩€椤掍降浜滈柟鐑樺灥椤忣亪鏌涢妶鍜佸剳闁瑰弶鎮傞幃褔宕煎┑鍫㈡嚃闂備胶绮幐鍝ユ崲濮椻偓瀵鈽夐姀鈺傛櫇闂佹寧绻傚ú銊╂偩濞差亝鈷戦柣鐔告緲閹垿鏌涢弮鈧悷鈺侇嚕?
        private boolean isFriendly(Entity e) {
            if (e instanceof SkeletonTurret) return true;
            if (e instanceof IronGolem) return true;
            if (e.getPersistentData().getBoolean("IsFriendlyZombie")) return true;
            if (e.getPersistentData().getBoolean("IsFriendlyCreeper")) return true;
            return false;
        }

    }
    // ==========================================
    // 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓伴梺姹囧€ら崰妤呭Φ閸曨垰鍐€闁靛ě鍛帓闂備焦妞块崢鐓幬涘Δ鍛偓锕傚锤濡や礁娈濋梻鍌氱墛缁嬫垿锝炲澶嬧拺?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柤纰卞墻濡茬兘姊绘担鍛婃儓缂佸绶氬畷銏ゅ礂绾拌鲸鏁梻鍌氬€烽懗鍓佸垝椤栫偛绀夋俊銈呮噹閺嬩線鏌涘┑鍕姢闁活厼妫楅埞鎴︽偐閸欏顦╅梺缁樻尰閻熲晠骞冨Δ鍛仺婵炲牐娉曢崝鎼佹煛瀹ヤ礁澧茬紒缁樼箓閳绘捇宕归鍙ュ摋闂備線娼ч悧濠囧箖閸屾凹鍤曞┑鐘崇閸嬪嫰鏌ｉ幋鐏活亪寮搁崒鐐粹拺闁告稑锕ユ径鍕煕鐎ｎ亜顏い銈呭€垮濠氬磼濞嗘埈妲梺纭咁嚋缁绘繂鐣峰ú顏勭妞ゆ棁鍋愰敍娑㈡⒑閻熸澘鈷旂紒顕呭灦閸╂盯骞掗幊銊ョ秺閺佹劙宕堕妸銉︾暚婵＄偑鍊栧ú妯煎垝鎼达絾顫曢柟鐑樻煛閸嬫捇鏁愭惔鈥茬盎缂備焦銇嗛崶銊у幈闂佺粯顭堥婊冾啅閵夛负浜滈柟鍓у仺閸嬨垻鈧娲栭悥鍏间繆閹间焦鏅滅紒娑橆儏閺佸綊姊婚崒姘偓宄懊归崶顒婄稏濠㈣泛锕﹂弳锔芥叏濡炶浜惧銈冨灪娣囨椽藝閺屻儲鎳氶柣鎰摠閸欏繑淇婇悙棰濆殭濞存粓绠栧娲传閸曨剚鎷卞┑鐐插级閿氭い鏇樺劦瀹曠喖顢涘璺烘暪婵犵數濞€濞佳兾涘Δ鍜冪稏闁瑰墽绻濈换鍡涙煟閹板吀绨婚柍褜鍏欓崐婵嗙暦閹达箑宸濇い鎾虫处閻╊垰鐣峰鈧、娆撴嚌閻楀牊鍟哄┑鐘垫暩閸嬬偤宕归鐐插瀭婵炲樊浜滈悿鐐節闂堟稒鐏╃憸鐗堝笚閺呮煡鏌涢顐簻婵炲牊鍔栫换娑氣偓鐢殿焾琚ラ梺鍝勬噺閻╊垶宕洪悙鍝勭闁挎棁妫勯埀顒傚厴閺屾稑鈻庤箛锝喰﹂梺鍝勬缁舵艾顫忓ú顏勭闁绘劖褰冩俊褔姊洪崫銉バュ褎顨呯叅闁绘梻鍘х粻鏍ㄤ繆閵堝懏鍣界€规挷绶氶弻娑⑩€﹂幋婵囩亪婵犳鍠栭柊锝咁潖濞差亝鍋￠柡澶嬪濮ｆ劕鈹戦悙瀛樺唉妞ゃ儲鎹囧畷?
    // ==========================================
    private boolean isImmuneToPush(LivingEntity e) {
        // 1. 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻锝夊箣閿濆憛鎾绘煕婵犲倹鍋ラ柡灞诲姂瀵噣宕掑顐㈩棜闁诲氦顫夊ú姗€鎮￠敓鐘茶摕婵炴垶顭囬弳鍡涙煃瑜滈崜鐔风暦閺囥垹绠涢柡澶嬪閻庮剟鏌ｆ惔顖滅У闁稿鐒︾粋宥咁煥閸喓鍘搁梺鎼炲労閻撳牆鈻撻弬妫电懓顭ㄩ崟顐㈠Б闁剧粯鐗犻弻锝咁潨閳ь剙顭囪缁傛帡鏁冮崒娑樹缓濡炪倖鐗撻崐妤冨姬閳ь剟姊虹紒妯圭繁闁革綇缍侀悰顕€骞掑Δ鈧粻鐘绘煣韫囷絽浜濋柍閿嬪姍閺岀喎鐣￠悧鍫濇畻閻庤娲﹂崑濠傜暦閻旂⒈鏁囬柣妯活焼閸ャ劉鎷婚梺绋挎湰閼归箖鍩€椤掑倸鍘撮柟顔惧仱閺佸倿鏌ㄩ姘缂備焦顨嗙粙鎴﹀箠閹扮増鍎楁繛鍡樻尰閻撴瑩鏌ｉ幋鐐嗘垿鎮￠妷鈺傜厸閻庯綆浜炴晶銏ゆ煃瑜滈崜娆戠不瀹ュ纾块梺顒€鍗曢崶顒夋晬闁绘劖褰冮悗顓㈡⒑缁嬫寧婀扮紒瀣尵瀵囧焵椤掍胶绡€闁汇垽娼у瓭闂佺锕︾划顖炲疾鐠鸿　妲堥柕蹇ョ磿閸橀亶姊洪棃娑氬闁归攱鍨垮銊︾節濮橆厾鍘梺鎼炲劀閸愬彞绱撶紓鍌欒兌婵敻鎯勯鐐靛祦婵せ鍋撴鐐叉处閹峰懏顦版惔锝忕幢缂?
        if (e == this) return true;

        // 2. 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻锝夊箣閿濆憛鎾绘煕婵犲倹鍋ラ柡灞诲姂瀵噣宕掑顐㈩棜闁诲氦顫夊ú姗€鎮￠敓鐘茶摕婵炴垶顭囬弳鍡涙煃瑜滈崜鐔风暦閺囥垹绠涢柡澶嬪閻庮剟鏌ｆ惔顖滅У闁稿鐒︾粋宥咁煥閸喓鍘搁梺鎼炲労閻撳牆鈻撻弬妫电懓顭ㄩ崟顐㈠Б闁剧粯鐗犻弻锝咁潨閳ь剙顭囪缁傛帡鏁冮崒娑樹缓濡炪倖鐗撻崐妤冨姬閳ь剟姊虹紒妯圭繁闁革綇缍侀悰顕€骞掑Δ鈧粻鐘绘煣韫囷絽浜濋柍閿嬪姍閺岀喎鐣￠悧鍫濇畻閻庤娲﹂崑濠傜暦閻旂⒈鏁囬柣妯活焼閸ャ劉鎷婚梺绋挎湰閼归箖鍩€椤掑倸鍘撮柟顔惧仱閺佸倿鏌ㄩ姘缂備焦顨嗙粙鎴﹀箠閹扮増鍎楁繛鍡樻尰閻撴瑩鏌ｉ幋鐏活亪鎮為悙顒傜閻忓繑鐗楀▍濠囨煛鐏炵偓绀冪紒缁樼椤︽煡鎮楀鐓庡箹闁崇粯鎹囧鑸垫償閹惧瓨鏉搁梻浣虹帛閸旀洖顕ｉ崼鏇炵厺闁哄洨浼濋悷閭︾叆闁告洦鍘鹃悿鍕倵?(闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极瀹ュ绀嬫い鎺嗗亾閹兼潙锕幃妤呯嵁閸喖濮庡┑鈽嗗亝閻╊垶濡撮崨鏉戠煑濠㈣泛鐬奸惁鍫ユ⒒閸屾氨澧涘〒姘殜瀹曟洝绠涘☉娆戝幗闂佸湱鍎ら崹瑙勭濞戙垺鐓忛柛銉戝喚浼冨Δ鐘靛仦鐢帡顢樻總绋跨倞鐟滃秹鈥栨径宀€纾介柛灞剧懆椤斿鏌涚€ｎ偅宕岄柡灞剧洴楠炲洭濡搁敂鐣屽絻缂傚倷娴囬褍螞濠靛钃熸繛鎴炃氶弸搴ㄧ叓閸ラ绋婚弫鍫ユ⒒娴ｄ警鐒鹃柨鏇樺劦瀹曟繂螖閸涱厾鍔﹀銈嗗笂缁讹繝宕箛娑欑厱闁挎繂楠稿▍宥団偓瑙勬礃閸ㄥ灝鐣烽崡鐐嶇喓鍠婃潏銊с偒闂傚倷鐒︾€笛兠洪弽顓炵９闁告縿鍎抽惌鍡涙煕瀹€鈧崑鐐烘偂閻樺磭绠鹃柡澶嬪焾閸庢劖绻涢崨顓燁棤缂佽鲸甯℃俊姝岊槻濞寸姵绮撻弻宥囨喆閸曨偆浼岄梺璇″枟閻熲晛顕ｉ崼鏇炵闁绘椴搁、妯衡攽閻樻剚鍟忛柛鐘崇墵閺佸啴濡舵径鍡忓亾閿曗偓閻ｏ繝骞嶉鑺ヮ啎闂備礁鎼ˇ浼搭敄濞嗘挸瑙﹂悗锝庡枟閻撴洟鏌曟径鍫濈仾婵炲懎娲弻锝夋晲閸繄鍘紓浣虹帛缁诲牊鎱ㄩ埀顒勬煥濠靛棙顥犻柕鍡樺姍濮婃椽宕崟顓炩拡闂佸憡鎸鹃崰搴ㄦ偩閻戠瓔鏁嶉柣鎰紦缁卞爼姊洪崨濠冾梿婵☆偄瀚槐鐐寸節閸パ勭€梺鍦濠㈡﹢鎮欐繝鍥ㄧ厪濠电倯鍐ㄦ殭閾﹀海绱撻崒姘偓鐑芥嚄閸洘鎯為幖娣妼閸屻劑鏌熼梻瀵割槮缁炬儳顭烽弻鐔煎礈瑜忕敮娑㈡煃闁垮绗掗柕鍡樺笒椤繈鏁愰崨顒€顥氶梻鍌欑窔閳ь剛鍋涢懟顖涙櫠椤栨粎纾奸悗锝庡亞婢у灚銇勯姀鈽嗘疁闁诡喓鍨藉畷妤呮嚃閳轰礁绠洪梻鍌欑濠€閬嶅磻閹捐绀堟慨姗嗗劦閿濆鍊绘俊顖氭贡缁犳岸姊洪崨濠勬噧妞わ富鍨遍幈銊╁炊椤掍胶鍘撻柣鐔哥懃鐎氼剟鎮樼€电硶鍋撶憴鍕闁绘牕鍚嬫穱濠囧箹娴ｈ倽銊︺亜閺冨倹鍤€濞存粓绠栭弻鐔煎礈瑜忕敮娑㈡煃闁垮鐏撮柟顔煎槻閳诲氦绠涢幙鍐ф偅缂傚倷璁查崑鎾绘煕閹板吀绨撮柛瀣尵閹叉挳宕熼鍌ゆЧ婵犵數鍋橀崠鐘诲炊閵娿儰鎮ｉ梻浣虹帛閸ㄥ吋鎱ㄩ妶澶婄柧闁哄被鍎查悡鏇熺箾閹存繂缍佺紒銊ュ悑閵囧嫰顢曢姀鈶垦勬叏婵犲懏顏犻柟鍙夋尦瀹曠喖顢曢姀鐘樻垹绱撴担绋库挃闁惧繐閰ｅ畷銏＄附閸涘﹤浠卞銈嗘尪閸ㄦ椽鍩涢幒鎴欌偓鎺戭潩閿濆懍澹曟繝鐢靛仒閸栫娀宕堕妸銉ょ綍闂備礁鎲℃笟妤呭垂娴兼潙鍨傛繝闈涙川缁犻箖鏌涢埄鍏╂垹浜搁銏＄厸閻庯絺鏅為崗宀勬煃瑜滈崜娆戠不瀹ュ纾块梺顒€绉寸粻鐘绘煙閻楀牊绶叉慨瑙勭叀閺屾盯鍩勯崘顏佸闂佺粯鎸诲ú鐔煎蓟閿熺姴鐐婇柕澶堝劚椤牊绻濋埛鈧崟顐闂佺懓寮堕幃鍌炲箖瑜斿畷鐓庘攽閸粎绀夊┑鐘愁問閸犳牠鏁冮妶澶嗏偓锕€鐣￠幍顔芥闂佸湱鍎ら崺鍫濐焽閳哄懏鐓曟俊銈呭暙娴滃綊鏌涘▎娆戠瘈婵﹦绮幏鍛瑹椤栨粌濮兼俊鐐€栭崹闈浳涘┑瀣伋闁挎洖鍊搁悙濠囨煃閸濆嫬浜炴繛鑲╁枛濮婅櫣绱掑Ο鍝勵潓濠碘槅鍨伴敃銈夆€﹂崶顒€惟闁冲搫鍊婚崢鎾绘偡濠婂嫮鐭掔€规洘绮撻幃銏ゅ礂閻撳簼绮ф俊鐐€栧ú宥夊磻閹惧灈鍋撶憴鍕鐎规洦鍓熼崺銉﹀緞婵炪垻鍠撻崰濠冩綇閵婃劗鍋ゅ濠氬磼濮橆兘鍋撻幖浣测偓锕傤敆閸曨偆锛涢梺鍦劋椤ㄥ懘宕掗妸鈺傜厽闁逛即娼ч崢闈浢归悩鍐插摵闁哄矉缍侀、娆撴偂鎼粹剝鏁狿)
        if (e instanceof Player) return true;

        // 3. 缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻锝夊箣閿濆憛鎾绘煕婵犲倹鍋ラ柡灞诲姂瀵噣宕掑顐㈩棜闁诲氦顫夊ú姗€鎮￠敓鐘茶摕婵炴垶顭囬弳鍡涙煃瑜滈崜鐔风暦閺囥垹绠涢柡澶嬪閻庮剟鏌ｆ惔顖滅У闁稿鐒︾粋宥咁煥閸喓鍘搁梺鎼炲労閻撳牆鈻撻弬妫电懓顭ㄩ崟顐㈠Б闁剧粯鐗犻弻锝咁潨閳ь剙顭囪缁傛帡鏁冮崒娑樹缓濡炪倖鐗撻崐妤冨姬閳ь剟姊虹紒妯圭繁闁革綇缍侀悰顕€骞掑Δ鈧粻鐘绘煣韫囷絽浜濋柍閿嬪姍閺岀喎鐣￠悧鍫濇畻閻庤娲﹂崑濠傜暦閻旂⒈鏁囬柣妯活焼閸ャ劉鎷婚梺绋挎湰閼归箖鍩€椤掑倸鍘撮柟顔惧仱閺佸倿鏌ㄩ姘缂備焦顨嗙粙鎴﹀箠閹扮増鍎楁繛鍡樻尰閻撴瑩鏌ｉ幋鐑囦緵婵炲牊娲熼弻娑㈠Χ閸涙澘顏柧缁樼墵閺屻劌鈹戦崱妯烘闂佸搫妫欓悷褏妲愰幒妤佸亹鐎规洖娲ら埛宀勬⒑閸濆嫮鐏遍柛鐘崇墪閻ｅ嘲顭ㄩ崱鈺傂梺姹囧焺閸ㄩ亶鎯勯鐐茶摕?(闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗霉閿濆浜ら柤鏉挎健濮婃椽顢楅埀顒傜矓閺屻儱鐒垫い鎺嗗亾闁稿﹤婀辩划瀣箳閺傚搫浜鹃柨婵嗙凹缁ㄤ粙鏌ㄥ☉娆戞创婵﹥妞介幃鐑藉级鎼存挻瀵栫紓鍌欑贰閸ｎ噣宕归崼鏇炵畺闁炽儲鏋煎Σ鍫ユ煏韫囥儳纾块柛妯哄船椤啴濡堕崱妤€衼缂備浇灏▔鏇犲垝婵犳艾唯闁挎棁娉曠粻姘舵⒑閸涘﹦鎳冩い锔垮嵆婵￠潧鈹戠€ｎ偆鍘搁柣蹇曞仜婢т粙濡撮幒妤佺厓鐟滄粓宕滈妸褏绀婇柛鈩冪☉绾惧鏌涢埄鍏╂垵鈻嶉悩缁樼厽闁靛繒濮甸崯鐐烘煟?
        if (e instanceof SkeletonTurret) return true;

        // 4. 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣椤愯姤鎱ㄥ鍡楀⒒闁绘帞鏅幉绋款吋閸澀缃曞┑鐘垫暩閸嬫稑螞濞嗘挸绠伴柛婵勫劤閻棗顭跨捄渚剳缂佺娀绠栭弻娑㈠焺閸忊晜鍨规禍鎼侇敇閻樼數锛滈梺缁樼憿閸嬫捇鏌涢妸銉у煟鐎殿喖顭锋俊鎼佸Ψ閵忊槅娼旀繝纰樻閸垳鎷冮敂鐣岊浄闂侇剙绉甸埛鎴犵磼鐎ｎ偒鍎ラ柛搴㈠姍閺岀喖鎮烽悧鍫濇灎濡ょ姷鍋涢崯鎾箖閸撗傛勃闁芥ê顦介崵娆撴⒒娴ｅ憡鎯堟繛灞傚姂瀹曟垵螣閼姐倗褰鹃梺鍝勬川閸嬫劙寮ㄦ禒瀣厽闁归偊鍘界紞鎴︽煟韫囥儵妾柟渚垮妼铻ｇ紒瀣仢椤洭姊虹化鏇熸澓闁稿孩褰冮銉╁礋椤栨氨鐤€濡炪倖鎸荤粙鎺斺偓姘悑缁绘繂鈻撻崹顔界亾闂佺娅曢幐鍝ュ弲闂侀潧鐗嗗Λ鏃傛崲閸℃せ鏀介柛灞剧閸熺偤鏌涙繝鍌滀粵闁逛究鍔岄～婊堝幢濡も偓缁犺櫣绱撴担钘夌厫闁绘搫绻濆濠氬即閵忕姴鑰垮┑鈽嗗灥濞咃綁顢栭崒鐐粹拺闁革富鍘介崵鈧柣搴㈢煯閸楁娊鐛崱娑樼妞ゆ牗姘ㄩ澶婎渻閵堝棗鍧婇柛瀣尰缁绘稓浠﹂崒姘ｅ亾濡や胶鐝堕柡鍥ュ灩缁€鍌炴⒒閸屾凹鍤熺紒鐘宠壘椤啴濡堕崱娆忣潷闂佽壈顫夐崕鍐插祫闁荤姴娲╅ˉ鍡涙偡闁妇鍙嗛梺鍓插亖閸ㄥ寮抽锔解拺闁告繂瀚悘閬嶆煕閻樺磭澧甸柣娑卞櫍瀵粙顢樿閺咃綁姊虹紒妯哄闁告埃鍋撻梺鍛婄墬閻楁粎妲愰幘璇茬＜婵炲棙鍨垫俊浠嬫⒑閸涘﹥鈷愰柣妤冨█婵℃挳宕橀埡鍐槇闂佹悶鍎滈崱妯诲暫闂傚倷鑳剁划顖炲蓟閵娾晛瑙﹂悗锝庡枛绾惧湱绱撴担濮戣偐鎹㈤崱妯镐簻闁哄秲鍔庨惌濠囨煕閺傛鍎旈柟顔肩秺瀹曞爼鍩℃担椋庢崟闂備礁鐤囬～澶愬垂閸ф绠栨繛鍡樻尭閻顭跨捄鐚存敾妞ゅ繒濞€濮婂宕掑▎鎴М闁圭厧鐡ㄧ划搴ｆ閻愬鐟归柍褜鍓熼獮鍐╁閹碱厽鏅╃紒鐐緲瀹曨剟骞冮幋鐐电瘈闁靛骏绲剧涵楣冩煥閺囶亞鐣电€规洘绻堥弫鍐焵椤掑嫧鈧棃宕橀鍢壯囨煕閳╁喚娈橀柣鐔村姂閺岋絾鎯旈姀鐘叉瘓闂佸憡鎸婚惄顖炲春閳ь剚銇勯幒宥嗙グ濠㈣蓱閵囧嫰鏁傜拠鑼桓闂佺偨鍎荤粻鎾崇暦缁嬭鏃€鎷呴崨濠勬澓闂傚倸鍊搁崐鎼佹偋婵犲嫮鐭欓柟杈剧秵閺夋椽姊婚崒姘偓椋庢濮樿泛鐒垫い鎺戝€告禒婊堟煠濞茶鐏￠柡鍛埣椤㈡盯鎮欑€电骞楁繝寰锋澘鈧挾娆㈤垾鏂ユ灁婵犲﹤鐗婇悡蹇涙煕閳╁喚娈旈柡鍡悼閳ь剝顫夊ú鏍偉婵傛悶鈧礁螖閸涱厾鍔﹀銈嗗坊閸嬫挻銇勯弬璺ㄧ闁宠鍨垮畷鍫曞Ψ閵堝洨娉块梻鍌欑濠€閬嶅磻閹炬眹鈧啴宕ㄩ弶鎴犳焾濡炪倖鐗楅崺鍐几瀹ュ鐓曢柟浼存涧閺嬬喖鏌嶉柨瀣瑨闂囧鏌ㄥ┑鍡樺櫤闁哥喓鍋ら弻鐔碱敍濮樺崬鈪甸梺鍝勬湰閻╊垶骞冮妶鍡樺闂傗偓閹邦喗鏅奸梻鍌欒兌閹虫挾绮诲澶婂瀭濞寸姴顑囧畵渚€鎮楅敐搴℃灍闁哄懏绻堥弻宥堫檨闁告挾鍠庨悾鐤亹閹烘垹锛滃┑鐐村灦閻熴儱顕ｉ崹顔规斀闁宠棄妫楅悘鐘绘煟韫囨梻绠為柟顕嗙節楠炲洭鎮ч崼銏犲箰?
        // AbstractSkeleton 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦缂冩洟姊绘担鍛婃儓婵炲眰鍨藉畷褰掑捶椤撶姳绗夐梺缁橆焾椤曆呯不鐟欏嫮绠鹃柨婵嗛婢ь喖鈹戦檱閸嬫劗妲愰幒妤佸亹闁告劖褰冮幗鐢告⒑閸濆嫭婀伴柣鈺婂灦閵嗕線寮撮姀鐘栄囨煕濞戝崬鏋ゅù婊勭墬娣囧﹪鎮欓鍕ㄥ亾閹版澘鐤炬繝濠傜墛閸嬪倿鏌ㄩ悢鍝勑㈤柦鍐枑缁绘盯骞嬪▎蹇曚患闂佺粯鎼换婵嬪蓟濞戙垹鐒洪柛鎰亾閻ｅ墎绱撴担鍝勑€规洜鏁稿Σ鎰板箻鐎涙ê顎撻梺鑽ゅ枑濠㈡﹢锝炲鍜佹富闁靛牆鍟俊濂告煥閺囥劋绨绘い鏇稻缁绘繂顫濋鐔割仧闂備胶绮敋鐎殿喖鐖兼俊闈涒攽閸モ晝顔曢柡澶婄墕婢т粙宕氭导瀛樼厵閻犲泧鍛槇闂佽鍣ｅ褔鍩為幋鐘亾閿濆骸浜愰柟閿嬫そ濮婄粯绗熼崶褌绨介梺绋款儐閻╊垶骞婇悢纰辨晬婵炴垶鐟﹂悵宄邦渻閵堝棛澧瑙勬礋瀹曟垿骞樼拠鑼槯婵犮垼娉涢敃锝嗙珶閺囥垺鈷掑ù锝呮憸缁夌儤淇婇銉︾《婵炲棎鍨介弫鎾绘偐閸欏鈧剚绻涢幘鏉戠劰闁稿鎹囬弻锛勪沪缁洖浜鹃柟棰佺閹垿鏌熼懝鐗堝涧缂佽尙鏅弫顕€濡烽妷銏℃杸闂佺粯鍔樼亸娆愭櫠濞戞瑣浜滈柕濞垮劵闊剛鈧鍠涢褔鍩ユ径濞㈢喖鏌ㄧ€ｅ灚缍岄梻鍌欑閹诧繝銆冮崼銉ョ；婵☆垵澹堟慨铏亜閺囨浜惧┑顔硷龚濞咃絿鍒掑▎蹇婃瀻闁诡垎鍐棊闂傚倷绀佸﹢閬嶁€﹂崼銉⑩偓锕傛倻閻ｅ苯绁﹂棅顐㈡处缁嬫垵顔忓┑瀣厸濠㈣泛顑呴悘锔锯偓瑙勬尭缁夋挳鈥旈崘顔嘉ч柛鈩兠棄宥囩磽娓氬洤鏋涢柡鍫墰缁顓兼径瀣罕闂佸壊鍋侀崹濠氭儊閸儲鈷戞慨鐟版搐閻忓弶绻涙担鍐插椤╃兘鏌ㄩ弴鐐测偓褰掓偂濞嗘劑浜滈柡宥冨妿椤ｅ弶绻濋埀顒勫箥椤斿墽锛滈梺绋挎湰濮樸劍鏅ラ梻浣芥〃閻掞箓宕濋弽褜鍤楅柛鏇ㄥ墰缁♀偓闂佸憡娲﹂崑鍕杺濠电姷顣槐鏇㈠磻閹达箑纾归柡宓苯鏅犳繝鐢靛У閼瑰墽澹曟繝姘厵闁告挆鍛闂佺粯鎸婚悷鈺呭蓟濞戙垹绠涙い鏍ㄦ皑濮ｃ垽姊虹紒妯虹瑲闁诡喖鍊垮璇测槈閵忕姷鍘撮梺璇″瀻閸屾凹妫滃┑鐘殿暜缁辨洟宕戦幋锕€纾归柡宥庡幖閸ㄥ倿鏌ｉ幘宕囧哺闁哄鐗犻弻锟犲炊閿濆棗娈熼梺鎼炲労閸撴岸寮插┑瀣厱閻忕偛澧介妴鎺楁煕濮椻偓娴滆泛顫忓ú顏勭閹艰揪绲块悾闈涒攽閻愰鍤嬬紒鐘虫尭椤曪綁骞庣粵瀣櫌闂佸憡娲﹂崜娑㈠储闂堟侗娓婚柕鍫濇閳锋劙鏌＄€ｎ亶鐓奸柟铏崌瀹曠螖娴ｅ搫骞嶆俊鐐€栧Λ浣哥暦閻㈠憡鍎楁繛鍡樺灍閸嬫挾鎲撮崟顒傤槰缂備緡鍠栭惌鍌氾耿娓氣偓閺岋絾鎯旈婊呅ｆ繛瀛樼矋閻燂妇绮╅悢鐓庡嵆闁靛繆妾ч幏娲⒑閸涘﹦绠撻悗姘煎櫍閸┿垺寰勯幇顓犲幈濠碘槅鍨板﹢閬嶆儗濞嗘垟鍋?
        // 闂?闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈢粯淇婇悙顏勨偓鏍偋濡ゅ啰鐭欓柟鐐湽閳ь剙鎳樺濠氬Ψ閿旀儳寮虫繝鐢靛█濞佳兾涢鐐嶏綁宕奸弴鐔哄帗閻熸粍绮撳畷婊冣枎閹惧磭鐤囧┑顔姐仜閸嬫挾鈧鍣崑濠傜暦閹烘鍊烽柡澶嬪灦閻ゅ懘姊绘笟鈧褔藝椤撱垹纾挎繛宸簻閻掑灚銇勯幒宥囧妽鐎规洖鏈幈銊︾節閸涱噮浠╃紓浣介哺鐢帡锝炲鍫濆耿婵炲棗绻愭瓏婵犵數濮烽弫鎼佸磻濞戙垹绠犻煫鍥ㄦ媼濞差亜鍐€妞ゆ挆鍕珨闂備焦瀵х换鍌炈囬婊呬笉闁煎鍊楃壕钘壝归敐鍫殐闁绘帊绮欓弻娑樜熼悜妯烘殘缂備胶绮换鍫熸叏閳ь剟鏌ㄥ┑鍡橆棤闁靛棙鍔欏铏圭磼濮楀棙鐣跺┑鈽嗗亝缁诲倿鎮惧畡鎵虫斀閻庯綆鈧厞鍥ㄧ厱闁斥晛鍟伴幊鍛亜閺冣偓濞茬喎顫忓ú顏勭闁圭粯甯婄花浠嬫⒑閸濄儱孝闂佸府缍侀獮鍐潨閳ь剟鐛鈧、娆撴偩鐏炶棄绠為梻鍌欑窔濞佳団€﹂鐘典笉闁硅揪绠戠粈澶愭煏閸繃顥撳ù婊勭矋閵囧嫰骞樼€靛摜鐓€婵犳鍠栭崐濠氬焵椤掑喚娼愭繛鍙夌墪閻ｇ兘顢楅崟顐ゅ幒闁瑰吋鐣崝宀€绮婚敐鍡愪簻闁规崘娉涙禒锕傛煛閸℃劕鍔︽慨濠傤煼瀹曟帒顫濋钘変壕闁绘垼濮ら崵鍕煕椤愶絾绀€缂佺姷濞€閺岀喖宕滆鐢盯鏌涚€ｃ劌鈧繈寮婚弴鐔虹闁绘劦鍓氶悵鏇㈡⒑閸濆嫭鍣虹紒璇茬墦瀵寮撮敍鍕澑闁诲函缍嗘禍鏍磻閹捐围濠㈣泛锕ラ悗顒佺箾閹炬潙鐒归柛瀣崌閺岋紕浠︾化鏇炰壕闁归绀侀幃鎴︽煙閼圭増褰х紒鑼櫕閺侇噣濡烽妷銏℃杸闂佺粯鍔樼亸娆愭櫠濞戞瑣浜滈柕濞垮劵闊剛鈧鍠涢褔鍩ユ径濞㈢喖鏌ㄧ€ｅ灚缍岄梻鍌欑閹诧繝鎮烽敃鍌椻偓锕傚炊椤掆偓缁犳澘顭块懜闈涘闁抽攱鍨圭槐鎺斺偓锝庡亽閸庛儵鏌涙惔銏犲闁哄瞼鍠栧畷銊︾節閸愩劉鍋撻幇鐗堢厱闁冲搫鍟禒杈殽閻愬樊鍎旈柡浣稿暣閸┾偓妞ゆ帒瀚悡渚€鏌涢妷顔煎闁绘挾鍠栭弻锟犲礃閵娧冣拡濠碘槅鍋呴崹鍧楀蓟濞戞﹩娼ㄩ柍褜鍓氱粋宥囨崉娓氼垱缍庣紓鍌欑劍椤洭鎮疯ぐ鎺撶厓鐟滄粓宕滈悢鐓庢槬闁逞屽墯閵囧嫰骞掑鍫濆帯闂侀潧妫欑敮鐐垫閹烘挻濯撮柛婵嗗楠炲姊洪崫鍕拱缂佸甯￠獮鍡涘籍閸繄鍙€闂佺硶鍓濋悷銉╁箖閹达附鐓?Skeleton 闂?AbstractSkeleton闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弮鍫熸殰闁稿鎸剧划顓炩槈濡娅ч梺娲诲幗閻熲晠寮婚悢鍛婄秶濡わ絽鍟宥夋⒑缁嬪灝顒㈡い銊ユ嚇濠€渚€姊洪幐搴ｇ畵婵炲眰鍊濆畷婵堚偓锝庡厴閸嬫挾鎲撮崟顒傤槰闂佺粯鎼换婵嗩嚕婵犳艾鐏抽柟棰佺閹垿鏌熼懖鈺勊夐柍褜鍓欑壕顓㈩敊閹达附鈷掑ù锝堟鐢盯鏌熼崨濠冨€愮€规洘鍔栫换婵嗩潩椤掑倸濮︽俊鐐€栧濠氬磻閹剧粯鐓曟俊顖濆吹閻帞鈧娲橀崹鍧楃嵁濡偐纾兼俊顖滃帶楠炲牓姊绘担绛嬫綈濠㈢懓顑夊鎻掆槈濞嗗海绠氶梺鍏间航閸庮垱绂嶅鍫熺厸闁稿本绋戦婊堟煕閻樻垚鎴﹀箞閵婏妇绡€闁告劏鏂傛禒銏ゆ倵鐟欏嫭纾搁柛鏂跨Ф閹广垹鈹戠€ｎ亞顦ㄥ銈呯箰鐎氼剛绮诲ú顏呪拻闁稿本鐟чˇ锕傛煙鐠囇呯瘈鐎殿喖顭锋俊鎼佸煛閸屾粌甯庨梻浣瑰缁诲倿骞忕€ｎ喖鍚归柡鍥╁枂娴滄粓鏌熼弶鍨暢闁伙綀浜槐鎺楁偐瀹割喚鍚嬮梺璇″枛缂嶅﹤鐣烽幆閭︽Щ缂備胶瀚忛崶銊у幗闁瑰吋鎯岄崰鏍ㄦ櫠鐎涙ɑ鍙忓┑鐘插暞閵囨繄鈧娲樼划鎾荤嵁閹捐绠崇€广儱鐗嗛悞濠氭⒒閸屾瑧顦﹂柟璇х節楠炴劙鎳￠妶鍥╃厯闂佽鍎抽顓㈡偟?
        if (e instanceof net.minecraft.world.entity.monster.AbstractSkeleton) return true;

        // 5. 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗霉閿濆浜ら柤鏉挎健濮婃椽顢楅埀顒傜矓鐎电顥氶柛褎顨嗛悡蹇涙煕椤愶絿绠栧璺哄閺岋繝宕卞Ο鑲╃厜闂佸搫鑻粔瑙勪繆閻戣姤鏅滈柣锝呭缁辨﹢姊绘担鍛婃儓妞ゆ垵鎳愮划鏃囥亹閹烘柨绁﹂梺鍝勭▉閻忔梹鎯旈…鎴炴櫌闂侀€炲苯澧ǎ鍥э攻缁傛帞鈧綆鍋嗛崢浠嬫⒑閻熸壆浠㈤悗姘煎櫍瀹曟碍瀵肩€涙﹩姊挎繝銏ｅ煐閸旀牠鎮￠妷锔剧瘈闂傚牊绋掗ˉ鐐电磼娴ｅ弶娅婇柡宀嬬秮楠炴帒螖閸愵亝姣囬梻浣告惈閼活垳绮旈悜閾般劍绗熼埀顒勫蓟濞戙垹绠婚悗闈涙啞閸ｆ澘顪冮妶鍐ㄧ仾闁绘顨呴銉╁礋椤掑倻鐦堥梺鍛婃处閸撴岸顢欓弴銏♀拻濞达絽鎲￠幆鍫熺箾鐏炲倸鐏茬€规洜顢婇妵鎰板箳閹炬枼鍋撻崼鏇熺厵闁诡垱婢樿闂佺粯鎼紞渚€鎮￠锕€鐐婂瀣閸╁本绻涚€涙鐭嬬紒顔肩Ч婵＄敻宕熼鍓ф澑闂佹寧绻傞幊鎰缁嬪簱鏀芥い鏃傘€嬫Λ姘箾閸滃啰鎮奸柛鎺撳笒閳诲酣骞嬮悙鑼紡闂備線娼ц噹閻忕偠濮ら弳顓熺節閻㈤潧啸闁轰礁鎲￠幈銊╊敇閵忕姷锛涢梺鐟板⒔缁垶鎮￠弴銏＄叆闁哄啫娴傞崵娆愵殽閻愬澧甸柡灞剧洴婵℃悂鏁傞崜褏鏆梻渚€娼уú銈団偓姘嵆閻涱噣骞掑Δ鈧獮銏′繆閻愭潙鍔ゆい銉﹁壘閳规垿鏁嶉崟顐℃澀闂佺锕ラ悧鐘差嚕婵犳艾惟鐟滃骸鐣烽崣澶嬪弿婵＄偠顕ф禍鎯旈悩闈涗粶闁挎洦浜獮鍐煛娴艰精娅ｇ槐鎺懳熺紒妯煎綅闂傚倸鍊烽懗鍫曗€﹂崼銉ュ珘妞ゆ帒瀚崵宀勬煕閹炬鎳愰敍婊堟⒑閸愬弶鎯堥柟鍐茬箻閸╂盯骞掗幊銊ョ秺閺佹劙宕ㄩ鍏兼畼闂備礁鎽滈崰鎾诲磻閵堝钃熼柨婵嗩槹閸嬪嫰鏌℃径瀣仴濠殿噯绠戦—鍐Χ閸愩劎浠鹃梺缁橆殘婵挳鎮鹃悜钘壩╅柍杞拌兌妤犲洭姊洪悷閭﹀殶濠殿喚鏁婚幃?(婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓闁搞劌鍊块弻娑㈩敃閿濆棛顦ラ梺钘夊暟閸犳牠寮婚弴鐔虹闁绘劦鍓氶悵锕傛⒑鏉炴壆顦﹂悗姘嵆瀵鈽夊Ο閿嬵潔闂佸憡顨堥崑鐐烘倶瀹ュ應鏀介柣鎰级閸ｈ棄鈹戦悙鈺佷壕闂備礁鎼惌澶屽緤閸婄喓浜介梻浣稿悑缁佹挳寮插☉姘辩當闁跨喓濮甸埛鎴犵磽娴ｅ顏嗙箔閹烘挶浜滄い鎾跺Т閸樺鈧鍠栭…鐑藉极閹剧粯鍋愰柤纰卞墻濡茶淇婇悙顏勨偓鏍礉閹达箑纾规俊銈呮媼閺佸﹤鈹戦悩鍙夊闁绘挾鍠栭弻鏇＄疀婵犲啯鐝旈梺璇茬箳婵灚绌辨繝鍥舵晝闁挎繂娲ㄩ悾闈涱渻閵堝骸浜滅紒缁樺姉閸欏懎顪冮妶鍛閻庢凹鍣ｉ、娆忕暆閸曨兘鎷洪梺闈╁瘜閸樺ジ宕濈€ｎ偅鍙忓┑鐘插鐢盯鎮楅棃娑栧仮鐎规洘鍎奸ˇ顕€鏌￠埀?
        if (e instanceof net.minecraft.world.entity.animal.IronGolem) return true;
        if (e.getPersistentData().getBoolean("IsFriendlyZombie")) return true;
        if (e.getPersistentData().getBoolean("IsFriendlyCreeper")) return true;

        // 6. 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣椤愯姤鎱ㄥ鍡楀⒒闁绘帞鏅幉绋款吋閸澀缃曞┑鐘垫暩閸嬫稑螞濞嗘挸绠伴柛婵勫劤閻棗顭块懜闈涘闁绘挻鐩弻娑㈠Ψ閿濆懎濮庨梺璇茬箚閺呯娀寮婚敐澶娢ч幖绮瑰墲閻濇繈姊洪崫鍕伇闁哥姵鎹囬崺鈧い鎺戝€归弳鈺傘亜椤撶偟澧涚紒鍌涘浮閺佸啴鍩€椤掑嫬鐓橀柟杈惧瘜閺佸秵鎱ㄥΟ鍧楀摵闁硅尪鍋愮槐鎾存媴閾忕懓绗￠梺鐑╂櫓閸ㄤ即鎮鹃悜钘夌闁绘劕绉堕崰鏍х暦椤愶箑绀嬮柛顭戝亞缁夌厧鈹戦悩鍨毄濠殿喕鍗冲畷褰掓偂鎼存ɑ鐏冨┑鐐村灦濮樸劑鎯岄幘鑸靛枑闁绘鐗嗙粭鎺楁煢?- NBT闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犖ч柛銉㈡櫇閸樼娀姊绘担鍛婃儓妞わ缚鍗冲畷闈涱潩椤戠偞妞介、鏃堝礋鎼存ɑ娅婇柡灞界Ч瀹曨偊宕熼懜鍨毎闂備礁鎼幊宀勫垂閽樺娼栭柧蹇撴贡绾惧吋淇婇婵囶仩濞寸厧娲ら埞鎴﹀煡閸℃ぞ绨婚柣搴㈠嚬閸ㄦ娊骞戦姀鐙€娼╅柤鍝ヮ暯閹风粯绻涙潏鍓ф偧闁烩剝鏌ㄩ…鍥箛閻楀牏鍘靛銈嗙墬濮樸劑鎮為崫銉㈠亾鐟欏嫭绀堥柟铏崌閹箖鎮滈挊澶屽€為梺鍐叉惈閸燁偆绮婚崹顐ょ瘈鐎典即鏀卞姗€鍩€椤掍焦绀嬬€规洦鍨堕獮宥夘敊绾拌鲸顥￠梻浣藉Г閿氭い銉ｅ灱閵囨劙骞掗幘瀛樼彸闂備礁鎲℃笟妤呭窗濡ゅ懎绐楅柟閭﹀幘缁♀偓闂佸啿鐨濋崑鎾绘煕閺囥劌骞楅柛鎺撶洴濮婃椽宕崟顓犲姽缂備焦鐓＄粻鏍嵁閸℃稑绫嶉柛顐亝閺呪晠姊虹紒妯诲碍缂併劌鐖奸獮蹇涱敃閿濆嫮绠氶梺闈涚墕濞层倕鏆╅梻浣侯焾椤戝棛绮欓幘璺哄灊闁哄啫娲㈡禍褰掓煙閻戞ê鐏︽俊宸墴濮婃椽寮妷锔界彅闂佸摜鍣ラ崹閬嶅礆婵犲洤绠绘い鏃傛櫕閸樹粙姊洪悷閭﹀殶闁稿孩鍔欓幃鐐烘偩瀹€鈧壕鐓庮熆閼搁潧濮夐柣锝囧劋閹便劍绻濋崟顓炵闂佺懓鍢查幊妯虹暦閵婏妇绡€闁告劑鍔屾竟宥夋⒒閸屾瑨鍏屾い顓炵墦閺佸啴鏁愰崶褍鐏婂┑鐐叉閹稿寮查弻銉︾厽闁归偊鍘界紞鎴犵磼閸撲礁浠遍柡宀€鍠栭獮宥夋惞椤愶絾绶梻?
        // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯煎幗闁瑰吋鎯岄崹宕囩矓閻㈠憡鐓曢悗锝庝簻椤忣厽銇勯姀鈩冨磳妤犵偞顭囩槐鎺懳熼柨瀣伖缂傚倸鍊搁崐鐑芥倿閿曞倸鐓熼柕鍫濐樈閺佸倿鏌涢妷锝呭姍婵顨嗙换婵嬪閿濆棛銆愰梺娲诲幒閻掞箓骞堥妸鈺佺閻熶椒绀佺紞濠囧箖閳╁啯鍎熼柨婵嗘閸犳牠姊绘担铏瑰笡闁规瓕顕х叅婵せ鍋撴鐐茬墦婵℃悂濡烽钘夌紦闂備胶纭堕崜婵嬨€冮崨鏉戠厱閻庯綆浜跺〒濠氭煏閸繃鍣规い鎺嬪灪閵囧嫰濡搁妷锕€娈楀┑鐘亾濞撴埃鍋撴慨濠呮缁辨帒螣韫囷絼绨藉瑙勬礋椤㈡﹢濮€閻橀潧甯庨梻浣告惈濞层劍鎱ㄦ搴☆棜濠靛倸鎲￠悡鏇㈡倶閻愰潧浜鹃柣銊﹀灴瀵偊宕奸妷锕€鈧敻鎮峰▎蹇擃仾缂佲偓鐎ｎ€㈢懓顭ㄩ崱妯笺€愬銈嗘穿缂嶄線鐛鈧、娆撴寠婢跺婢€闂傚倷绶氶埀顒傚仜閼活垱鏅堕鐐村€甸梻鍫熺◤閸嬨垻鈧娲栭悥鍏间繆濮濆矈妲惧銈嗘⒐濞茬喎顫忓ú顏呭仭闂侇叏绠戝▓鍫曟⒑缁嬫鍎戦柛瀣ㄥ€濋悰顕€宕卞☉妯碱槹濡炪倖鍔忛崑鎾绘煟閻旂厧浜伴柣鎾卞劦閺屾盯寮撮妸銉ョ闂佸啿鍢查惌鍌氼潖閾忕懓瀵查柡鍥╁枑濠㈡帡姊虹粙娆惧剱闁瑰憡鎮傞垾鏃堝礃椤斿槈褔鏌涢埄鍐炬畼闁荤喐鍔欏娲偂鎼粹剝姣愰梺缁樼墪閵堟悂鐛崱娆庢勃闁告挆鍛闂備礁鎲￠崝锔界閻愮儤鍎婇柛顐犲劜閳锋垿姊洪銈呬粶闁兼椿鍨遍弲鍓佲偓娑欙供濞堜粙鏌ｉ幇顖涘涧闁肩増瀵ч妵鍕閿涘嫭鍣伴梺鍦焾閿曘儱顕ラ崟顒€绶為悗锝庡亞缁愭棃姊婚崒姘偓椋庣矆娓氣偓楠炴牠顢曚綅閸ヮ剦鏁嶉柣鎰綑娴滈亶姊洪崨濠傚Е闁哥姵鐗犻幃鍧楁倷椤掑倻顔曢梺绯曞墲閿氶柣蹇ラ檮閵囧嫰顢曢敐鍡欘槹闂佸搫鐬奸崰鎰焽韫囨柣鍋呴柛鎰ㄦ櫓閳ь剙绉瑰铏圭磼濡闉嶉梺鑽ゅ櫐缁犳挻淇婇悽绋跨妞ゆ牗姘ㄩ鎺楁煟閻樿崵绱版俊妞煎姂楠炲鎮滈懞銉㈡嫼缂備緡鍨卞ú妯衡枍閺冨倻纾界€广儱瀚粣鏃傗偓娈垮枛椤兘寮幇顓炵窞閻庯綆鍋呴悵顐︽⒒娴ｅ憡鍟炴繛璇х畵瀹曟垿宕ㄧ€涙ê鈧爼鏌涢鐘插姕闁抽攱鍨块弻鐔兼嚃閳轰椒绮舵繝纰樷偓鑼煓闁哄本绋掗幆鏃堝閻橆偅鐏嗛梻浣虹《閺呮繈宕戦妶澶屽祦閻庯綆鍠楅弲婵嬫煃瑜滈崜娑氬垝缂佹绡€婵﹩鍘鹃崢閬嶆⒑鐟欏嫬绀冮悘蹇旂懅閹峰綊鎮ч崼婊呯畾闂佽偐鈷堥崜娆撳储鐎涙ɑ鍙忓┑鐘叉噺椤忕娀鏌熸搴♀枅鐎规洩绲惧鍕偓锝庝邯濡兘姊婚崒娆掑厡妞ゃ垹锕ら埢宥夊即閵忕姷顔夐梺鎼炲劀閸涱喗顔曟俊鐐€栭悧婊堝磻濞戙垺鍋傛繛鎴欏灪閻撴洟鏌熼弶鍨倎缂併劋绮欓弻锝夋晲閸繄鍘紓浣虹帛缁诲牊鎱ㄩ埀顒勬煥濠靛棙鍣介柛姗嗗亰濮婃椽宕ㄦ繝鍐ｆ嫻濠电偠灏欓崰搴ㄦ偩閻戣姤鏅查柛鈩冪懅閻﹀牓姊洪崨濠傚Ё缂傚倹姘ㄩ懞杈ㄧ節濮橆厸鎷洪梺鍛婄箓鐎氼噣鍩㈡径鎰厱閻庯綆浜滈顓犫偓瑙勬礃缁捇寮婚崱妤婂悑闁糕剝鐟ョ敮妤呮煟閻斿摜鐭嬬紒顔芥尭閻ｅ嘲顭ㄩ崘鐐兊闂佸吋鎮傚褎绂嶉崡鐐╂斀閹烘娊宕愰弴銏犵疇鐎光偓閸曨偆鍔﹀銈嗗坊閸嬫捇鏌涢悢鍛婄稇闁伙絿鍏樺畷濂稿即閵婏附娅岄梻渚€鈧偛鑻晶顔姐亜閺傝法绠伴柍瑙勫灴瀹曞爼濡烽妶鍥╂晨闂傚倷绀侀幖顐ょ矓閺屻儱绀夐幖杈剧悼娑撳秹鏌曟径娑橆洭缂佺娀绠栭弻锝夊箻閾忣偅宕抽梺绯曟櫔缁查箖骞堥妸锔剧瘈闁告劏鏂傛禒銏犖旈悩闈涗沪闁告梹鐗犻獮鍡涘籍閸喐娅滈梺绋挎湰娓氭顭囬弮鈧换婵嬫偨闂堟稈鏋呭┑鐐板尃閸パ咃紮闂佽崵鍠栭崑濠傤焽閺嶎厽鍋ｉ柛銉戝嫧鏋欓梺鎼炲€栭〃鍛村煘閹达附鍋愰柛娆忣槸椤︹晠姊虹粙鍖¤含闁衡偓闁秴桅闁告洦鍨扮粻宕団偓骞垮劚濞村倸危椤旂⒈娓婚柕鍫濇噹椤掋垽鏌熼悷鐗堟悙妞ゎ偄绻橀幖褰掑捶椤撶媴绱叉繝娈垮枟椤ㄥ懎螞濞戙垹绀夐柛娑橈功缁犻箖鎮楀☉娆樼劷闁活厹鍊濋弻娑㈠箻鐠虹儤鐏堝Δ鐘靛仜濡瑩骞忛崨鏉戠闁圭粯甯楅崐顖炴⒒娴ｅ憡鍟炲〒姘殕缁傚秴鈹戠€ｅ墎绋忛悗骞垮劚椤︿即鍩涢幋锔藉仭婵炲棗绻愰鈺呮煕閺傝鈧鎯€椤忓棛纾奸柕蹇曞Т缁犳椽姊虹紒姗嗘當闂佸府绲介～蹇曠磼濡顎撴繛鎾村嚬閸ㄦ娊宕濋崫銉х＝濞达綀娅ｇ敮娑㈡煕閺冣偓閻熴儵鎮鹃悜钘夌疀闁哄娼￠弫婊冣攽鎺抽崐鏇㈠疮椤愩倗鐭堥柨鏇炲€归埛鎴︽煕閿旇骞栭柛鏂款儐閵囧嫰濡搁妷锕€娅ら梺绋垮瘨閸嬪﹤顫忕紒妯肩懝闁逞屽墮椤洩顦归柡浣哥Х缁犳稑鈽夊Ο纰辨Ч婵＄偑鍊栫敮鎺楀磹閻熼偊鐔?
        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柛鎰紦閻㈢粯淇婇悙顏勨偓鏍偋濡ゅ啰鐭欓柟鐐湽閳ь剙鎳樺畷锝嗗緞閸粎鐩庨梻濠庡亜濞诧箓骞愰幖渚囨晜闁靛鏅滈悡鍐喐濠婂牆绀堟慨妯块哺閺嗘粓鏌嶉妷銉э紞闁哄棴闄勭换婵囩節閸屾凹浠炬繝娈垮灡閹告娊寮婚敐澶嬪亜闁告繂瀚烽弳顓炩攽椤曞棛鍒版繛灞傚€濋崺鐐哄箣閿旇棄鈧兘鏌ら幖浣规锭婵炴嚪鍛＝濞达綀妫勭槐锔剧磼椤旂晫鎳囬柣娑卞枟瀵板嫰骞囬鐔割仧闂備胶绮敃銏狀焽瑜戦妵鎰板幢濡ゅ﹥瀵岄梺闈涚墕濡绮幒妤佸€垫慨妯煎帶瀵噣鏌涢埡鍌滄创妤犵偛顑夐幃娆擃敂閸愵亞娉块梻鍌欐祰椤宕曢崘鑼殾妞ゆ帊妞掔换鍡涙煕瑜庨〃鍡涙偂閺囥垺鐓欓柣鎴炆戠亸顓熴亜閵夈儺鍎旈柡宀€鍠栧畷锝嗗緞鐎ｎ亖鍋撻幇顓ф闁绘劖褰冮銏㈢磼缂佹绠炵€规洘甯掗埥澶娾枎閹邦兘鍋撴搴ｇ＝闁稿本鐟ㄩ崗灞解攽椤旂偓鏆€规洖缍婂畷濂稿即閻愬稄绠撻弻娑㈠即閵娿儲鐏撻梺姹囧€愰崑鎾绘⒒娴ｅ憡璐￠柛瀣崌楠炲棛浠︽潪鎸庣洴閺佹捇鎮╅弬銉﹀闂備礁鎲＄换鍌溾偓姘煎弮瀹曞啿煤椤忓懐鍘靛銈嗘⒒閸樠囧焵椤掆偓閻忔繈顢氶敐鍡欑瘈婵﹩鍘兼禍婊堟煟閻愬鈻撻柍褜鍓欓崢鏍ㄧ珶閺囩偐鏀介柣鎰綑閻忥附銇勮箛锝勯偗妞ゃ垺妫冨畷銊╊敊閻撳簼绱熼梻鍌欑婢瑰﹪宕戦崱娑樼獥鐎广儱娲﹀畷鏌ユ煕閳╁啰鈯曢柣鎾跺枛閺岀喖鏌囬敃鈧獮鏍磼閹绘帩鐓奸柡灞界Х椤т線鏌涢幘瀵告噰闁诡喗锚閳规垹鈧綆鍋勬禒濂告倵閻熸澘顏悗姘墦閹垽鎮滃Ο杞扮钵闂備焦鏋奸弲娑㈠疮娴兼潙鐒垫い鎺嗗亾妞ゎ厾鍏樺濠氭偄閸忕厧娈為梺缁橆殔閻楀棗鈽夎缁辨捇宕掑姣欍垺淇婇锝囨噮闁逞屽墴濞佳囧Χ缁嬭法鏆﹂柛顐ｆ处閺佸棗霉閿濆懎绾ч悗姘偢濮婄粯鎷呴崨濠傛殘缂備礁顑嗛崹鍧楀极閸愵喗鏅濋柛灞炬皑閻ゅ洭姊洪柅鐐茶嫰婢у瓨鎱ㄦ繝鍛仩缂侇喗鐟╅獮鎰償閳╁啯鏆橀梺璇叉唉椤煤閻斿鐒界憸宥呯暤閸曨垱鈷戦悷娆忓椤ュ顭胯椤ㄥ﹤鐣烽弴鐐垫殕闁逞屽墴閹偓妞ゅ繐鐗滈弫鍥ㄧ節闂堟冻鍔熼柤鐓庡劮ty.getPersistentData().putBoolean("TurretAlly", true);
        if (e.getPersistentData().getBoolean("TurretAlly")) return true;

        // 7. 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣椤愯姤鎱ㄥ鍡楀⒒闁绘帞鏅幉绋款吋閸澀缃曞┑鐘垫暩閸嬫稑螞濞嗘挸绠伴柛婵勫劤閻棗顭块懜闈涘闁绘挻鐩弻娑㈠Ψ閿濆懎濮庨梺璇茬箚閺呯娀寮婚敐澶娢ч幖绮瑰墲閻濇繈姊洪崫鍕伇闁哥姵鎹囬崺鈧い鎺戝€归弳鈺傘亜椤撶偟澧涚紒鍌涘浮閺佸啴鍩€椤掑嫬鐓橀柟杈惧瘜閺佸秵鎱ㄥΟ鍧楀摵闁硅尪鍋愮槐鎾存媴閾忕懓绗￠梺鐑╂櫓閸ㄤ即鎮鹃悜钘夌闁绘劕绉堕崰鏍х暦椤愶箑绀嬮柛顭戝亞缁夌厧鈹戦悩鍨毄濠殿喕鍗冲畷褰掓偂鎼存ɑ鐏冨┑鐐村灦濮樸劑鎯岄幘鑸靛枑闁绘鐗嗙粭鎺楁煢?- 婵犵數濮烽弫鍛婃叏閹绢喗鍎夊鑸靛姇缁狙囧箹鐎涙ɑ灏ù婊呭亾娣囧﹪濡堕崟顓炲闂佸憡鐟ョ换姗€寮婚敐澶婎潊闁靛繆鏅濋崝鎼佹⒑閹肩偛濡奸柛濠傤煼閸┾偓妞ゆ帒鍠氬鎰箾閸欏澧悡銈夋煏婵犲繐顩柍缁樻⒒閳ь剙绠嶉崕閬嶅箠婢舵劕缁╁ù鐘差儐閻撶喐淇婇婵囶仩闁哄鍟…璺ㄦ喆閸曠數鍔风紓浣介哺鐢繝宕洪埀顒併亜閹烘垵顏╂鐐灪缁绘盯骞嬮悙鍨櫘闂佸憡锕╂禍顏勵潖濞差亜绀堥柟缁樺笂缁ㄨ偐绱撴担绛嬪殭闁哥喓顥愬Λ銏ゆ⒑缂佹ê濮夐柛搴涘€濋幃锟犳偄閸忚偐鍘甸梺鍛婄箓鐎氼喛鍊撮梻浣规た閸樹粙鎮烽埡鍛摕?
        // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯煎幗闁瑰吋鎯岄崹宕囩矓閻㈠憡鐓曢悗锝庝簻閳ь剚鎮傞敐鐐测攽鐎ｎ偅娅囬梺閫炲苯澧撮柛鈺冨仱楠炲鏁傞挊澶嗗亾閻戣姤鐓曟繛鍡楁禋濡牊淇婇銈呬槐婵﹦绮幏鍛矙鐠恒劎娉跨紓鍌氬€哥粔宕囩矆娓氣偓閹箖鎮滈懞銉ヤ缓缂佸墽澧楅敋濞存粓绠栭弻銊モ攽閸℃侗鈧鏌＄€ｎ剙鏋涢柡宀嬬秮楠炴鈧潧鎲￠崳顓㈡⒑闂堟稒鎼愰悗姘嵆閻涱噣骞掑Δ鈧粻锝嗐亜閹捐泛鏅块柕澶嗘櫆閳锋帒銆掑顒佹悙鐎殿噣绠栭弻娑㈠Ω閵壯冪厽閻庢鍠栭…鐑藉极閹版澘宸濇い蹇撴媼濞兼梹绻濆▓鍨灍闁挎洍鏅犲畷妤€鈽夊Ο婊愮秮楠炲洭鎮ч崼姘闂佽崵濮村ú鐘诲焵椤掆偓绾绢厽绂掗埡鍛拺缂備焦锕╁▓鏇㈡煙閻熺増鎼愰柣锝呭槻鐓ゆい蹇撳閸旓箑顪冮妶鍡楃瑐闂傚嫬绉电粋宥咁煥閸喓鍘甸梺缁樺灦閿氶柣蹇嬪劜閵囧嫯绠涙繝鍐╃彇缂備浇椴哥敮锟犲箖椤忓牆宸濇い鏍ㄧ敖濠婂牊鈷戦柛婵嗗閻忛亶鏌涢悩宕囧⒌闁绘侗鍣ｅ浠嬵敇瑜庨弲锝夋⒑缂佹ê濮囬柛姘ｅ亾闂佸憡鐗楅悧婊呮閹捐纾兼繛鍡樺俯閸炲綊姊虹粙娆惧剱闁瑰憡鎮傞垾锕傚锤濡や礁娈濋梻鍌氱墛缁嬫垿锝炲澶嬧拺缂備焦蓱鐏忎即鏌ｉ悢鍙夋珚妤犵偛鍟灃闁逞屽墴閸┿儲寰勬繛鐐€诲┑鈽嗗灣閸樠勬叏閸濆嫧鏀介柣姗嗗亝婵即鏌涢弴銊ヤ簮闁哄鐟╁娲传閸曨喖顏紓浣割槺閸忔鐦繛鎾村焹閸嬫捇鏌＄仦鍓ф创妤犵偞顭囬埀顒勬涧閹诧繝宕抽弶璇炬棃鎮╅棃娑楃捕闂佹寧娲忛崝搴ｅ垝鐠囨祴妲堟俊顖炴敱椤秴鈹戦埥鍡楃仴婵炲拑缍侀崺鈧い鎺戭槸楠炴牠鏌嶇憴鍕伌闁诡喒鏅濋幏鐘侯槻濞村吋鍔欓弻锝嗘償閵忥絽顥濋梺鎼炲灪閻擄繝宕洪姀銈呯閻庨潧澹婂ù鍕煟鎼搭垳绉甸柛瀣瀹曘垽鎮介崨濠勫幗闁硅壈鎻徊楣冨汲閳哄倶浜滄い鎾跺仧婢ф盯鏌ｅΔ鈧ù椋庢閹捐纾兼繛鍡樺灥婵′粙鎮峰鍕凡闁哥喐鎸抽崹楣冩晝閸屾稑鈧鏌﹀Ο渚Ш闁伙絽鎼埞鎴炲箠闁稿﹥娲熼獮濠呯疀濞戞锛涢梺璺ㄥ枔婵敻鎮″☉姗嗙唵閻犺桨璀﹂崕蹇斻亜閺囩喓鐭掗柡宀嬬秬缁犳盯寮埀顒傜矆閸垻纾奸弶鍫涘妽鐏忎即鏌熷畡鐗堝櫤缂佸倹甯為埀顒婄秵娴滄繈骞婂▎鎴犵＝闁稿本鐟︾粊鐗堛亜閺囧棗娲﹂崑瀣煕閳╁啰鈯曢柛瀣ф櫇閳ь剛鎳撶€氫即宕戞繝鍌ょ劷闁宠桨绲煎☉銏″亱闁割偁鍨婚悾娲⒑閸濆嫭鍣虹紒璇茬墕椤繐煤椤忓嫮顔囬柟鑹版彧缁插潡鎮鹃悽鍛娾拺缁绢厼鎳忛悵顏堟煙閻熺増鎼愰柣?
        if (this.hasPassenger(e) || e.hasPassenger(this)) return true;

        // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯煎幗闁瑰吋鎯岄崹宕囩矓閻㈠憡鐓曢柟鍨閻ｉ亶妫佹径鎰厱闁哄洢鍔岄悘锟犳煃闁垮鐏存慨濠傤煼瀹曞ジ鎮㈤崜浣虹畳婵犵鍓濊ぐ鍐偉婵傜钃熸繛鎴炵懅缁♀偓闂佸憡鍔楅崑鎾绘偪娓氣偓濮婅櫣鎷犻垾铏亾闂佺绻戦敃銏ゆ偘椤曗偓瀹曞爼顢楁担闀愮綍闂備礁澹婇崑鍛枈瀹ュ洠鍋撳顒€鎮戝ǎ鍥э躬閹瑩顢旈崟銊ヤ壕闁哄稁鐏涘☉娆愬闁煎弶绻冮惄顖氱暦閻旂⒈鏁嶆繛鎴炃氶崑鎾舵崉鐞涒剝鏂€闂佺粯蓱瑜板啴顢旈銈囨／闁诡垎鍐╁€繛锝呮搐閿曨亝淇婇崼鏇炵＜婵﹩鍋勯ˉ姘攽閿涘嫬浜奸柛濞у懐涓嶉柟鐐墯閻掔晫鎲搁弮鍫涒偓浣割潩閼稿灚娅滈梺绯曞墲椤ㄥ繘宕甸妶澶嬧拺闁革富鍘搁幏锟犳煕濡湱鐭欑€殿喗鐓￠、妤呭礋椤戣姤瀚奸梻鍌氬€搁悧濠勭矙閹惧瓨娅犻柡鍥╁枔缁犻箖鎮橀悙鎻掆偓鍛婃叏閸岀偞瀵犳繝闈涙储娴滄粓鏌￠崶顭戞當濞存粍鍎抽埞鎴︻敊绾嘲濮涚紓渚囧櫘閸ㄥ磭鍒掗銏″亜闁绘挸娴烽崐鐐烘偡濠婂啰校閻庨潧鍚嬮幆鏃堟晲閸モ晪绱冲┑鐐舵彧缂嶁偓婵☆偄瀚伴幏鏇㈠礂闂傚绠氬銈嗗姂閸ㄥ綊顢旈銏＄叆婵犻潧鐗嗘禒婊堟煃鐟欏嫬鐏╅柍褜鍓ㄧ紞鍡涘焵椤掑骞愰柡鍛█瀵顓奸崱妯侯潯闂佽顔栭崳顔嘉ｉ鈧幃妤€鈻撻崹顔界亪闂佹悶鍨洪悡锟犲灳閺冨牆绀冩い鏂挎瑜旈弻娑㈠焺閸愵亝鍣у銈庡€ら崶銊㈡嫼闂佸吋绁撮弲婊堝吹閳ь剚绻濋埛鈧崒婊呯厯濡ょ姷鍋涚换鎺楀焵椤掑﹦绉甸柛鐘崇墱缁鎮介崨濠勫幍闁荤喐鐟ョ€氬嘲鈻撻弮鍌滅＝鐎广儱鎷戦煬顒侇殽閻愭彃鏆ｉ柛鈺嬬節瀹曨亝鎷呯憴鍕彟闂傚倷鑳剁划顖炲箰閸涘娈介柟闂寸筏缂嶆牗鎱ㄥΟ鍨厫闁抽攱鍨堕幈銊╂偡閻楀牊鎮欓梺缁樺笚濡炰粙寮诲☉銏犖╅柨鏇楀亾闁崇粯娲橀〃銉╂倷鐠囇嗗惈濡ょ姷鍋為敋閻撱倗绱撴担鑲℃垵鈻嶉弮鍫熲拻濞达絿鎳撻婊呯磼鐠囨彃鈧儻妫熷銈嗙墱閸嬬偤宕愰崸妤佺厱妞ゎ厽鍨垫禍鏍瑰鍕煉闁哄瞼鍠栭幃婊兾熼搹閫涙樊婵＄偑鍊曞ù姘椤忓牆钃熸繛鎴炵懄閸庣喖鏌ㄥ☉妯虹彅鐟滄棃寮婚敍鍕勃闁告挆鍕灡闁诲孩顔栭崰妤呭箰閾忣偂绻嗛柟闂寸鍞梺闈涱樈閸犳霉閸モ晝纾介柛灞捐壘閳ь剙鍢查湁闁搞儜灞芥闂佽宕樺▔娑㈠垂濠靛洨绠鹃柛鈩兩戠亸顓㈡煢?
        return false;
    }
    // (registerControllers removed)



    // --- GUI 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞鐟滄粌霉閺嶎厽鐓忓┑鐐靛亾濞呭棝鏌涢妶鍛伃闁哄被鍊楃划娆戞崉閵娿倗椹虫繝鐢靛仜閹虫劖鎱ㄩ崹顐も攳濠电姴娲ゅ洿闂佺鏈惌顔界珶閺囥垺鈷掑ù锝夘棑娑撹尙绱掗煫顓犵煓闁诡喗锚椤繃娼忛埡鍐殽闂備胶绮濠氬储瑜旈幃鐐哄垂椤愮姳绨婚梺鍦劋閸ㄧ敻顢旈銈傚亾鐟欏嫭灏紒鑸靛哺瀵鎮㈤崗鐓庘偓缁樻叏濡も偓濡瑩鎮鹃崼鏇熺厱闁绘垵妫楅悘锔芥叏婵犲啯銇濇俊顐㈠暙閳藉娼忛妸鎰╁€濆铏圭矙閸ф鈧鐥紒銏犲箻闁?---

    public int getLevel() {
        return getTier() + 1;
    }

    public double getWeaponDamage() {
        return getWeaponDamageForTier(getTier());
    }

    public int getXp() {
        return this.entityData.get(DATA_XP);
    }

    // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯煎幗闁瑰吋鎯岄崹宕囩矓閻㈠憡鐓曢悗锝庝簻椤忣厽銇勯姀鈩冨磳妤犵偞顭囩槐鎺懳熼柨瀣伖缂傚倸鍊搁崐鐑芥倿閿曞倹鏅濋柍鍝勬噺閸婂潡鏌ｉ敐鍛伇缁炬儳鍚嬮妵鍕即閻愭潙娅ｉ梺璇查獜缁辨洜妲愰幒妤€纾兼繛鎴烆焽閻熴劌顪冮妶搴′簼缂侇喗鎹囧畷娲焵椤掍降浜滈柟鐑樺灥椤忊晝绱掗悩宕囧⒌闁哄矉缍侀獮瀣晲閸♀晜顥夐梻浣告啞椤ㄥ鈻嶉弴銏犵疄闁靛鍎哄銊╂煕閳╁喚娈旂紒鐘差煼濮婃椽妫冨☉姘杸濠电姰鍨洪敃銏ゅ灳閺冨牆绀冩い鏂挎瑜旈弻娑㈠焺閸忥附宀搁獮蹇涙偡閹佃櫕鏂€闂佺粯鍔樺▔娑㈡儍濞差亝鐓曢柣妯虹－婢ь亝銇?XP 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弴鐐测偓褰掑磿閹寸姵鍠愰柣妤€鐗嗙粭鎺旂磼閳ь剚寰勭仦绋夸壕闁稿繐顦禍楣冩⒑闁偛鑻晶鎾煕閳规儳浜炬俊鐐€栫敮濠勭矆娓氣偓瀹曠敻顢楅崟顒傚幈濠电偛妫楃换鎰板汲濞嗘劑浜滈柡鍥朵簽缁嬭崵绱掔紒妯肩畵妞ゎ偅绻堥、姗€鎮欓幍顔炬晨闂傚倷娴囬褏鎹㈤幇顔藉床閻庯綆鍠楅崐鍧楁煥閺囩偛鈧綊宕愰崼鏇熺厱闁逛即娼ч弸鐔兼煃闁垮鐏撮柡灞剧☉閳规垿宕卞Δ濠佺棯缂傚倷妞掔拋鏌ュ疾濞戙垺绠掓繝鐢靛Т閿曘倝骞婃惔銏㈩浄鐟滃繒妲?
    public void setXp(int amount) {
        this.entityData.set(DATA_XP, amount);
    }



    // 3. 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕閻庤娲忛崕鎶藉焵椤掑﹦绉甸柛鐘崇墱婢规洟宕稿Δ浣哄幍闂佽鍨虫晶妤吽夋径鎰闁哄鍩婇煬顒勬煛鐏炶鈧繈骞婂┑瀣妞ゆ棁鍋愭晶顖氣攽閻愯尙鎽犵紒顔肩灱缁辩偞绻濋崶褑鎽曞┑鐐村灟閸ㄧ懓鏁梻渚€娼х换鍡涘礈濠靛鍋熼柟鐑橆殕閳锋垹绱撴担濮戭亞绮幒妤佺叆闁哄洢鍔嬮柇顖溾偓娈垮枦椤曆囧煡婢舵劕顫呴柣妯诲絻缁侇噣姊绘笟鈧褔鈥﹂崼銉ョ？闁规鍠涙慨鎶芥偣閸ャ劎銈撮柡鈧懞銉ｄ簻闁哄洨鍋為ˉ鐘绘煕閹哄秴宓嗛柡灞诲姂瀵挳顢旈崱娆愭闂備胶纭堕弬渚€宕戦幘鎰佹富闁靛牆妫楃粭鎺楁煕婵犲倹鍟炵紒鍌涘浮椤㈡盯鎮欑€电骞堝┑鐘垫暩婵挳宕悧鍫熸珷闁汇垻顣介崑鎾舵喆閸曨剛顦ㄥ┑鐐跺皺閸犳牠鐛繝鍥у唨妞ゆ挾鍋熼崢鎼佹⒑缁嬫寧婀伴柤鐟板⒔閼?(Tick) - 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑锝呬壕濡ょ姷鍋為悧鐘汇€侀弴銏犖ч柛銉㈡櫇閸樼娀姊绘担绋款棌闁稿鎳庣叅鐎广儱顦悞鍨亜閹烘埊鍔熼柣锝囨暩閳ь剝顫夊ú鏍Χ閸涘﹥鍙忛柍褜鍓熼弻鏇＄疀鐎ｎ亞浠煎銈忚吂閺呯姴顫忕紒妯诲闁告稑锕ら弳鍫ユ⒑閸︻収鐒炬俊顐ｇ箓閻ｇ兘濡搁埡濠冩櫌闂佺鏈划宥夊窗閹烘挾绡€闁汇垽娼у瓭闂佹眹鍎遍ˇ闈涱嚕閼稿灚鍎熼柟鎯у帠婢规洟姊洪悷鏉库挃缂侇噮鍨跺畷鐢稿礋椤栨稓鍘卞銈嗗姧缁插墽绮堥埀顒勫级?
    public float getFireDelay() {
        int tier = getTier();

        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼妽闁稿繑绮撻弻娑㈩敃閿濆棛顦ラ梺姹囧€濈粻鏍蓟閿濆绠涙い鎾跺О閸嬬偤姊洪崫鍕靛剰缂佸缍婂濠氬Ω閵夈垺鏂€闂佺硶妾ч弲婊嗗€撮梻鍌欑窔閳ь剛鍋涢懟顖炲储閸濄儳纾奸柤闀愮祷婢规﹢鏌ｉ敐鍥у幋濠碘剝鎮傞崺鈩冩媴濞差亞宕滈梻鍌欒兌閹虫捇顢氶鐔峰灁妞ゆ挾鍊ｉ敐鍡楊嚤閻庢稒顭囬崢浠嬫煙閼圭増褰х紒鏌ョ畺瀹曠敻鍩€椤掑嫭鐓熼幖娣灩閸ゎ剟鏌涘Ο鎭掑仮闁炽儻绠撳畷褰掝敊閵壯冩灈闁硅櫕鐗犻崺锟犲礃椤忓嫬歇? 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紓浣哄Х婵炩偓妤犵偞鐗楀蹇涘礈瑜忚摫闁诲氦顫夊ú姗€鎮￠敓鐘茶摕闁绘柨鍚嬮崐缁樹繆椤栨繃顏犻柛鏃€鎮傚铏圭磼濡櫣鐟愮紓渚囧枟閻熲晛顕ｇ拠娴嬫闁靛繒濮烽悿鈧梻浣侯焾缁绘劙骞楀鍫濇瀬闁哄秲鍔嬬换鍡涙煟閹邦剛浠涢柛銈傚亾闂備礁鎽滈崰搴☆焽閿熺姴鐏抽柨鏃傚亾瀹曞鏌曟繝蹇曠暠缁剧虎鍨跺娲箚瑜忕粻鐗堢節閳ь剟鏌嗗鍛槷濡炪倖鐗滈崑鐐哄煕閹寸姷纾藉ù锝堫嚃閻掍粙鏌嶉娑欑闁哄瞼鍠栭幃鐑芥偋閸繃鐏庨柣搴㈩問閸犳牠鈥﹂悜钘夌畺闁靛繈鍊栭幆鐐烘煕閿旇寮跨紒鍗炲级缁绘繄鍠婂Ο娲绘綉闂佹悶鍔嬮崡鎶界嵁閺嶎収鏁冮柨鏃囧亹缁嬪繘鎮楅崗澶婁壕闂佸憡娲﹂崜娆撳焵椤掑倹鏆柟顔煎槻閳诲氦绠涢幙鍐х棯缂傚倷璁查崑鎾绘煃瑜滈崜鐔奉潖閸濆娊铏规嫚閹绘帞顔愰梻浣侯焾閿曘倕顭囬敓鐘冲仒妞ゆ梻鏅弧鈧梺鎼炲劀閸滀礁鏅梺璇叉唉椤煤閺嶎灐娲晝閳ь剟鍩㈤幘璇插嵆闁靛繆妾ч幏娲⒑閸涘﹦鈽夐柨鏇樺劜瀵板嫰宕熼娑氬幈闂佺懓鐏濈€氼噣鎮鹃悽鍛婄厱闁宠鍎虫禍鐐繆閻愵亜鈧牜鏁繝鍥ㄥ殑闁肩鐏氬▍鐘绘煟閵忕姵鍟為柣?(20 -> 17 -> 14 -> 11 -> 8 -> 5)
        double cooldown = Math.max(5.0, 20.0 - (tier * 3.0));

        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞妞ゆ巻鍋撴潻婵嬫⒑闁偛鑻晶鎾煛鐏炲墽銆掗柍褜鍓ㄧ紞鍡涘磻閸涱垯鐒婃い鎾卞灪閻撳啴鎮峰▎蹇擃仼闁诲繑鎸抽弻鐔碱敊鐟欏嫭鐝氶悗瑙勬礃閿曘垽骞婇悩娲绘晢闁逞屽墯閹便劑寮婚妷锔规嫽婵炶揪绲肩拃锕傛倿閻愵兙浜滈柟瀛樼箖椤ャ垺顨ラ悙鏉戠伌鐎规洖鐖奸、妤呭焵椤掑倻涓嶉柡宥庡幗閻撳繘鐓崶銊︾閸熸悂姊洪崫鍕棞妞ゆ垵顦靛濠氭偄鐏忎焦鐏侀梺鍓茬厛閸犳鎮橀幘缁樷拻濠㈣泛顭崕鏃€鎱ㄦ繝鍌ょ吋鐎规洘甯掗埢搴ㄥ箣椤撶啘婊堟⒒娴ｇ瓔娼愮紒浣规尦閸┾偓妞ゆ帊绀佹晶顖涚箾閸忚偐澧辩紒杈ㄦ尰閹峰懘鎳栭埄鍐ㄧ伌鐎规洩缍€缁犳稑鈽夊▎鎴濆箥缂傚倸鍊烽梽宥夊垂瑜版帒鍑犻柣鏂垮悑閻撴洟骞栧ǎ顒€鐏╅柣蹇嬪劦濡焦寰勯幇顓犲幗闂佽宕樺▍鏇㈠箲閿濆鐓欓柣锝呰嫰閳诲牓鏌?(0.075 -> 7.5% per stack)
        // 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌涘☉姗堟敾闁告瑥绻橀弻鐔虹磼閵忕姵鐏€闂侀€炲苯澧剧紒鐘虫崌閵嗕礁顫滈埀顒勫箖閳哄懎绠涘ù锝呮贡缁嬫劙姊婚崒娆戭槮闁圭⒈鍋勭叅闁靛ň鏅涢梻顖炴煏婢跺牆鍔楅柡?120闂?-> +900% (10闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁逞屽墾缁犳挸鐣锋總绋课ㄩ柨鏃囧Г閻濇牠姊绘笟鈧褔鎮ч崱妞曟椽濡搁埡鍌氬壒濠电偛妫欓幐濠氭偂閺囥垺鐓涢柛銉ｅ劚婵″ジ鏌ｈ箛鏇炐ョ紒?
        double stackMultiplier = 1.0 + (this.entityData.get(DATA_HEAT) * 0.075);
        cooldown /= stackMultiplier;

        // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢幘鑼槮闁搞劍绻冮妵鍕冀椤愵澀娌梺绋款儜缁绘繈寮婚弴鐔风窞闁糕剝蓱閻濇梻绱掗悙顒€鍔ょ紓宥咃躬瀵鏁愭径瀣簻闂佺绻楅崑鎰版偟閹扮増鈷戦柛锔诲幖閸斿鏌涢埡浣哄妞ゎ厼娲崺锟犲磼濡湱鐩庨梻浣烘嚀閻°劌顫忛悷鎵虫瀺闁搞儺鍓氶悡鏇㈡煟濡櫣锛嶅褏鏁搁埀顒冾潐濞叉牜绱炴繝鍥╁祦闁糕剝鍑瑰Σ楣冩⒑閸濆嫭锛旂紒鐘虫崌瀵鈽夐姀鐘栥劑鏌曡箛濠傚⒉闁绘繐绠撳铏规偘閳ュ厖澹?4闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁逞屽墾缁犳挸鐣锋總绋课ㄩ柨鏃囧Г閻濇牠姊绘笟鈧褔鎮ч崱妞曟椽濡搁埡鍌氬壒濠电偛妫欓幐濠氭偂閺囥垺鐓涢柛銉ｅ劚婵″ジ鏌ｈ箛鏇炐ョ紒?
        if (this.entityData.get(IS_BRUTAL)) {
            cooldown /= 4.0;
        }

        // 闂?闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗ù锝夋交閼板潡姊洪鈧粔鎾磼閵娧勫枑闁哄啫鐗嗙粻鏍ㄧ箾瀹割喕绨婚幆鐔兼⒑闂堟侗妯堥柛鐘愁殘缁辩偞鎯旈姀銏㈢槇闂佹眹鍨藉褎鐗庨梻浣哄帶缂嶅﹦绮婚弽褜鍤曢柛娑橈功閻熷綊鏌嶈閸撶喎顕ｆ繝姘嵆闁靛繒濞€閸炶泛鈹戦悩鑼粵闁告梹鐗滈悷褏绱撻崒姘偓鎼佸磹妞嬪孩濯奸柡灞诲劚閻ょ偓绻涢幋娆忕仼闁绘挻锕㈤弻鐔告綇妤ｅ啯顎嶉梺绋款儐閸旀瑩寮诲☉銏犵疀妞ゆ牗姘ㄥВ銏ゆ⒑閸涘﹥鐓ｉ柛妤€鍟块～蹇涙惞閸︻厾鐓撳┑鐐叉閸庢娊宕滈柆宥嗏拺闁革富鍘介崵鈧┑鐐叉▕閸欏啴鎮伴鈧畷姗€顢欑喊杈ㄧ秱闂備礁鐤囧Λ鍕涘▎鎰珡闂傚倷鑳堕幊鎾诲触鐎ｎ喗鍋╂い蹇撶墕閸ㄥ倿鎮峰▎蹇擃仾婵炲懐濞€閺屾洟宕煎┑鎰ч梺鎶芥敱鐢帡婀侀梺鎸庣箓濞层劑骞楅崒鐐寸厱闁靛牆鎳庨弳锝夋煛鐏炲墽鈯曢柟顖涙婵偓闁炽儲鏋奸崑鎾诲箛椤旂懓浜鹃悷娆忓缁€鍐煥閺囨ê鐏查柛銊╃畺閺佸啴宕掑槌栧悈闂備胶绮崝鏇炍熸繝鍌楁灁妞ゆ牜鍋為埛?(Attribute Modifier)
        double attrSpeed = this.getAttributeValue(Attributes.ATTACK_SPEED);
        // 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁逞屽墮閸婂湱绮嬮幒鏂哄亾閿濆簼绨介柛鏃撶畱椤啴濡堕崱妤€娼戦梺绋款儐閹瑰洭寮诲☉銏″亜闂佸灝顑呮禒鎾⒑缁洘鏉归柛瀣尭椤啴濡堕崱妤€娼戦梺绋款儐閹稿墽妲愰幘鎰佸悑闁告粌鍟抽崥顐⑽旈悩闈涗粶闁哥噥鍋夐悘鎺楁煟閻樺弶绌块悘蹇旂懅缁綁鎮欓悜妯锋嫼閻熸粎澧楃敮鎺撶娴煎瓨鐓曢柟鎯ь嚟濞插鈧娲﹂崑鍕亙婵炶揪缍€濞咃綁鎯侀崼銉︹拺婵懓娲ら悘鍙夌箾娴ｅ啿瀚晶锟犳⒒閸屾瑨鍏岀痪顓炵埣瀵彃鈽夐姀鐘垫焾闂佸搫顦伴崹褰掑汲閿曞倹鐓欓弶鍫濆⒔閻ｈ京绱掗悩鍝勫惞缂佽鲸鎸婚幏鍛叏閹搭厺绨肩紒鍌氱Т椤劑宕熼鍡欑暰闂備胶绮崝鏇炍熸繝鍥х？闊洦绋掗崐鍨箾閹寸偛绗氭繛鍛功閳ь剝顫夊ú妯煎垝閹捐崵宓侀悗锝庡枟閺呮粓鎮峰▎娆戠ɑ閻?> 1.0 (濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣銏犲閺佸﹪鏌″搴″箹闂傚偆鍨遍妵鍕冀閵娧呯厐缂備浇缈伴崐鏇＄亙闂佹寧绻傞幊搴ㄥ汲濞嗘挻鐓㈤柛鎰典簻閺嬫盯鏌＄仦鐐缂佺粯鐩幃娆擃敆娴ｅ湱缈婚梻鍌欑窔閳ь剛鍋涢懟顖涙櫠椤曗偓閺岀喖鎼归锝呯３闁芥ɑ绻堥弻娑㈡晜鐠囨彃绠伴梺绋款儐閹告悂鍩㈤幘璇插瀭妞ゆ梻鏅禍顏堟⒒娴ｇ瓔鍤欑紒缁樺灴閹虫繃銈ｉ崘鐐櫔闂侀潧顦弲娑氱矆鐎ｎ偁浜滈柟鐑樺灥閳ь剙顭烽幆渚€宕奸妷锔规嫼缂備礁顑堥崕濠氾綖閿曞倹鐓曞┑鐘插暟婢ь剛绱掓潪鎵煓鐎殿喕绮欓、姗€鎮㈤崣澶婎伜闂傚倷鑳堕…鍫ュ嫉椤掑嫭鍋＄憸蹇涘箯鐟欏嫬顕遍悗娑欘焽閸橀亶鏌ｆ惔顖滅У濞存粍绻堣棢闁靛繆鎳囬崑鎾舵喆閸曨剛顦ㄧ紓渚囧枟閹瑰洭鐛崘顔兼嵍妞ゆ挾鍣ラ崑銊︾箾?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弮鍫熸殰闁稿鎸剧划顓炩槈濡娅ч梺娲诲幗閻熲晠寮婚悢鍛婄秶濡わ絽鍟宥夋⒑閹肩偛鈧牠宕濋弽顓炍﹂柛鏇ㄥ灠閸愨偓濡炪倖鍔﹀鈧紒顔肩埣濮婃椽骞栭悙鎻掝瀳闂佺锕ょ紞濠冧繆閻㈢绀嬫い鏍ㄨ壘閸炪劌顪冮妶鍡楀Е婵犫懇鍋撶紓渚囧枛婢у海妲愰幘瀛樺闁圭粯甯婃竟鏇㈡⒒娴ｅ憡鍟為柛鏃撻檮缁傚秹寮介鐐碉紱闂佺懓澧界划顖炲磻閿熺姵鐓涘璺侯儛閸庛儱霉閻樺啿鍔ら柍瑙勫灴閹晠顢欓懖鈺€鐥俊鐐€ら崢鐓幟洪妸鈺佺闁圭儤鎸剧弧鈧梺鎼炲劘閸斿酣宕濋崼鏇熷€垫鐐茬仢閸旀碍淇婇锝囨创鐎规洏鍨介獮鏍ㄦ媴閸忓瀚奸梻浣告啞缁嬫垿鏁冮妶鍡樺弿闁稿瞼鍋為悡鏇㈡煛閸屾碍鍋ラ柛娆忓閳ь剝顫夊ú妯侯渻娴犲鏋侀柟鐗堟緲楠炪垽鏌￠崶鈺佇ラ柣锝囧亾娣囧﹪鎮欓鍕ㄥ亾閺嶎厼绀夐柟杈剧畱绾惧潡鏌ょ喊鍗炲闁稿繑绮撻弻娑㈠箻閼艰泛鍘＄紒鐐劤閵堢顕ｉ崼鏇為唶婵炴垶锚椤鎮楃憴鍕闁活厼鍊垮璇测槈閵忕姷鍘搁柣搴秵閸撴盯鎯侀崼銉﹀€甸悷娆忓缁€鍐煥閺囨ê鐏查柕鍡曠窔瀵噣宕煎┑鍫Ч婵＄偑鍊栭崝鎴﹀磹濡ゅ嫧鍚?
        if (attrSpeed > 0) {
            cooldown /= attrSpeed;
        }

        return (float) Math.max(1.0, cooldown);
    }

    // ==========================================
    // 濠电姷鏁告慨鐑姐€傞挊澹╋綁宕ㄩ弶鎴狅紱闂佽宕樺▔娑氭閵堝悿褰掓偐瀹割喖鍓扮紓浣瑰姈椤ㄥ棝骞堥妸銉建闁糕剝顨呴埛鎺楁⒑?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙闁稿被鍔庨幉鎼佸籍閸惊銉╂煕閹般劍娅嗛柛搴ｅ枛閺屾洝绠涚€ｎ亞鍔村┑鐐跺皺椤牓鍩為幋锔藉亹閻犲泧鍐х矗闂備胶绮〃鍛存晝椤忓嫮鏆﹂柟杈剧畱閻撴盯鏌涘☉鍗炴灓闁告ü绮欏娲焻濞戞ê绁┑鐐板尃閸曨剚鐝锋繛瀵稿帶閻°劑鎮￠崘顏嗙＝濞达綀鍋傞幋鐘电焼闁逞屽墮椤啴濡舵惔鈥崇哗濠电偛顦板ú鐔肩嵁閹达箑绀嬫い鏍ㄧ☉閳ь剛绮穱濠囶敍濠垫劕娈梻鍌氬亞閸ㄨ鲸绌辨繝鍥ㄥ€锋い蹇撳閸嬫捇寮撮悩鍝勑￠梺鍓插亝濞叉牜澹曟繝姘厵闁告挆鍛闂?AI (闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪€ｎ亜顒㈡い鎰矙閺屻劑鎮㈤崫鍕戙垻鐥幆褜鐓奸柡灞剧洴瀵挳濡搁妷褌鍝楃紓浣哄亾閸庡磭绱炴繝鍥ц摕婵炴垶绮犲Σ鐓庮渻閵堝啫濡奸柟铏悾?Skeleton)
    // ==========================================
    // (闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃秹锝炲┑瀣櫇闁稿矉濡囩粙蹇旂節閵忥絽鐓愰柛鏃€鐗犲畷鎴﹀Χ婢跺鍘搁梺鎼炲劗閺呮稑鐨梻浣虹帛鐢帡鏁冮妷褎宕叉繛鎴欏灩楠炪垺淇婇妶鍕妽鐎规洘濞婂娲传閸曨偒浠奸梺绋匡工閻忔繈锝炶箛鏃傜瘈婵﹩鍓涢敍婊冣攽椤旀枻渚涢柛蹇旓耿瀹曟垿骞樼拠韫炊闂侀潧顦崹瑙勭閻愵剚鍙忔俊顖滎焾閸旀艾鈹戦鐓庘偓濠氬焵椤掑喚娼愭繛鍙夛耿瀹曟繈寮撮姀鐘靛幋闂佺懓顕慨顓㈠磻閹剧粯鏅查幖瀛樼箞閸嬫鈹戦埥鍡椾簽闁稿繑锚椤繐煤椤忓嫬绐涙繝鐢靛Т鐎氀兾ｉ崼銉︹拺闁圭瀛╃壕鎼佹煕婵犲喚娈旈柍璇查叄婵偓闁靛牆妫楅埀顒勵棑閻ヮ亪鎮ч崺顐簼缁傚秹鎮欓澶嬵啍闂佺粯鍔樼亸娆愮閵忋倖鐓曢柡鍐ｅ亾鐎光偓閹间礁绠栨俊銈傚亾妞ゎ偅绻堥幃鈩冩償閵忋垹缍嗛梻鍌欐祰椤曟牠宕板璺虹婵せ鍋撻柕鍡曠铻栭柛娑卞幘椤︽澘顪冮妶鍡楃伇濠殿喓鍊楅埀顒佽壘閵堢顫忕紒妯诲闁告稑锕ㄧ涵鈧俊鐐€ら崢濂告偋閸℃稒绠掗梻浣虹帛閸ㄧ厧螞閸曨厾涓嶉柣妯肩帛閻撴洟鏌嶉埡浣稿即婵犲﹤瀚々鍙夌節婵犲倻澧涢柣鎾寸洴閺屾盯濡烽鎯у笒濡炪倕绻愰悧鍡涙倿閸偁浜滈柟鍝勭Х閸忓瞼绱掗悩闈涗户闁?Goal 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾剧粯绻涢幋娆忕労闁轰礁顑嗛妵鍕箻鐠虹儤鐎婚梺鎼炲妽濡啴骞冨Δ鍛仺婵炲牐娉曢崝鍝ョ磽娴ｇ晫鍫柛濠冪箞瀵鈽夊搴⑿俊鐐€戦崝灞轿涘┑鍡欐殾闁瑰鍋涚欢鐐烘倵閿濆骸澧伴柣锕€鐗婄换婵嬫偨闂堟刀銏ゆ煕婵犲嫮甯涢柡鍛版硾閳藉濮€閿涘嫬骞?





    // (Method removed)





}













